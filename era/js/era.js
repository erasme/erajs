navigator.isGecko=(navigator.userAgent.match(/Gecko\//i)!=null);navigator.isWebkit=(navigator.userAgent.match(/WebKit\//i)!=null);navigator.isIE=(navigator.userAgent.match(/MSIE/i)!=null);navigator.isOpera=((navigator.userAgent==undefined)||(navigator.userAgent.match(/Opera\//i)!=null));navigator.isChrome=(navigator.userAgent.match(/ Chrome\//)!=null);navigator.isSafari=(navigator.userAgent.match(/ Safari\//)!=null);navigator.iPad=(navigator.userAgent.match(/iPad/i)!=null);navigator.iPhone=(navigator.userAgent.match(/iPhone/i)!=null);var svgNS="http://www.w3.org/2000/svg";var htmlNS="http://www.w3.org/1999/xhtml";Core={};Core.Util={};Core.Util.idGenerator=0;Core.Util.generateId=function(){return ++Core.Util.idGenerator};String.prototype.utf8Encode=function(){var b="";for(var a=0;a<this.length;a++){var d=this.charCodeAt(a);if(d<128){b+=String.fromCharCode(d)}else{if((d>=128)&&(d<2048)){b+=String.fromCharCode((d>>6)|192);b+=String.fromCharCode((d&63)|128)}else{b+=String.fromCharCode((d>>12)|224);b+=String.fromCharCode(((d>>6)&63)|128);b+=String.fromCharCode((d&63)|128)}}}return b};String.prototype.utf8Decode=function(){var b="";var a=0;var d;while(a<this.length){d=this.charCodeAt(a++);if(d<128){b+=String.fromCharCode(d)}else{if((d>=192)&&(d<224)){b+=String.fromCharCode(((d&31)<<6)|(this.charCodeAt(a++)&63))}else{b+=String.fromCharCode(((d&15)<<12)|((this.charCodeAt(a++)&63)<<6)|(this.charCodeAt(a++)&63))}}}return b};String.prototype.toBase64=function(){var g=this.utf8Encode();var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var f="";var b=0;while(b+2<g.length){var e=g.charCodeAt(b++)&255;var d=g.charCodeAt(b++)&255;var c=g.charCodeAt(b++)&255;var l=a[e>>2];var k=a[((e&3)<<4)|(d>>4)];var j=a[((d&15)<<2)|(c>>6)];var h=a[c&63];f+=l+k+j+h}if(b+1<g.length){var e=g.charCodeAt(b++)&255;var d=g.charCodeAt(b++)&255;var l=a[e>>2];var k=a[((e&3)<<4)|(d>>4)];var j=a[(d&15)<<2];f+=l+k+j+"="}else{if(b<g.length){var e=g.charCodeAt(b++)&255;var l=a[e>>2];var k=a[(e&3)<<4];f+=l+k+"=="}}return f};String.prototype.fromBase64=function(){var d=this;var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var b="";var a=0;while(a<d.length){enc1=c.indexOf(d[a++]);enc2=c.indexOf(d[a++]);enc3=c.indexOf(d[a++]);enc4=c.indexOf(d[a++]);char1=(enc1<<2)|(enc2>>4);char2=((enc2&15)<<4)|(enc3>>2);char3=((enc3&3)<<6)|enc4;b+=String.fromCharCode(char1);if(enc3!=64){b+=String.fromCharCode(char2);if(enc4!=64){b+=String.fromCharCode(char3)}}}return b.utf8Decode()};if(navigator.isIE){SVGTextContentElement.prototype.__getStartPositionOfChar=SVGTextContentElement.prototype.getStartPositionOfChar;SVGTextContentElement.prototype.getStartPositionOfChar=function(b){var a=this.__getStartPositionOfChar(b);return a.matrixTransform(this.getScreenCTM().inverse())};SVGTextContentElement.prototype.__getEndPositionOfChar=SVGTextContentElement.prototype.getEndPositionOfChar;SVGTextContentElement.prototype.getEndPositionOfChar=function(b){var a=this.__getEndPositionOfChar(b);return a.matrixTransform(this.getScreenCTM().inverse())};SVGTextContentElement.prototype.__getCharNumAtPosition=SVGTextContentElement.prototype.getCharNumAtPosition;SVGTextContentElement.prototype.getCharNumAtPosition=function(a){return this.getCharNumAtPositionHelper(a.x,0,this.getNumberOfChars()-1)};SVGTextContentElement.prototype.getCharNumAtPositionHelper=function(a,e,b){startX=this.getStartPositionOfChar(e).x;endX=this.getEndPositionOfChar(b).x;if((a<startX)||(a>endX)){return -1}if(e==b){return e}var c=Math.floor((e+b)/2);var d=this.getCharNumAtPositionHelper(a,e,c);if(d!=-1){return d}return this.getCharNumAtPositionHelper(a,c+1,b)}}if(window.JSON==undefined){var json={};json.parse=function(json){return eval("("+json+")")};json.stringify=function(b){var c="";var f=true;var a=(this.constructor.toString().indexOf("function Array()")!=-1);for(var g in this){try{var e=this[g];if((typeof(e)!="number")&&(typeof(e)!="string")&&(typeof(e)!="object")){continue}if(f){f=false}else{c+=", "}if(!a){c+='"'+g+'": '}if(typeof(e)=="object"){c+=JSON.stringify(e)}else{if(typeof(e)=="number"){c+=e}else{if(typeof(e)=="string"){c+='"'+e.replace('"','\\"')+'"'}}}}catch(d){}}if(a){c="[ "+c+" ]"}else{c="{ "+c+" }"}return c};window.JSON=json}Object.prototype.toString=function(){if(this.classType!=undefined){return"[object "+this.classType+"]"}else{return"[object Object]"}};Object.prototype.dump=function(a){if(a!=undefined){a=new RegExp(a,"i")}console.log(this+":");for(var d in this){try{var c=true;if(a!=undefined){c=a.test(d)}if(c){console.log(d+" => "+this[d])}}catch(b){}}};Object.prototype.serialize=function(){return JSON.stringify(this)};Object.prototype.constructorHelper=function(a,b){if(b==undefined){b=this.__proto__}if(b==undefined){return}if(a==undefined){a={}}if(b.__baseclass__!=undefined){this.constructorHelper.call(this,a,b.__baseclass__)}else{if(b.__proto__!=undefined){this.constructorHelper.call(this,a,b.__proto__)}}if(b.__constructor!=undefined){b.__constructor.call(this,a)}};Function.prototype.extend=function(classType,classDefine,classOverride){var tab=classType.split(".");var namespace="";var current=window;for(var i=0;i<tab.length-1;i++){if(namespace!=""){namespace+="."}namespace+=tab[i];if(current[tab[i]]==undefined){current[tab[i]]={}}current=current[tab[i]]}var shortName=tab[tab.length-1];var func=eval("( "+classType+" = function "+shortName+" (config) { this.constructorHelper.call(this, config); } )");if(navigator.isIE){for(var prop in this.prototype){func.prototype[prop]=this.prototype[prop]}func.prototype.__proto__=func.prototype}else{func.prototype.__proto__=this.prototype}func.prototype.__baseclass__=this.prototype;func.base=this.prototype;for(var prop in classDefine){if(prop=="constructor"){func.prototype.__constructor=classDefine[prop]}else{if((typeof(classDefine[prop])=="object")&&(classDefine[prop]!=null)){throw ("object are not allowed in classDefine ("+prop+"). Create object in the constructor")}if(func.prototype[prop]!=undefined){if(func.prototype[prop]!=classDefine[prop]){throw ("Try to override "+prop+" on class "+classType+". Use classOverride you want to do it")}}else{func.prototype[prop]=classDefine[prop]}}}if((navigator.isIE)&&(classDefine.constructor!==Object.prototype.constructor)){func.prototype.__constructor=classDefine.constructor}if(classOverride!=undefined){for(var prop in classOverride){if((typeof(classOverride[prop])=="object")&&(classOverride[prop]!=null)){throw ("object are not allowed in classOverride ("+prop+"). Create object in the constructor")}func.prototype[prop]=classOverride[prop]}}func.prototype.classType=classType;return func};Object.prototype.addEvents=function(){if(this.events==undefined){this.events=[]}for(var a=0;a<arguments.length;a++){this.events[arguments[a]]=[]}};Object.prototype.fireEvent=function(a){var b=[];for(var c=1;c<arguments.length;c++){b[c-1]=arguments[c]}var d=false;for(var c=0;(c<this.events[a].length)&&!d;c++){d=this.events[a][c].method.apply(this.events[a][c].scope,b);if(d==undefined){d=false}}return d};Object.prototype.connect=function(d,b,f,a){if(a==undefined){a=false}if(d.addEventListener!=undefined){var e=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};e.scope=this;e.callback=f;e.eventName=b;e.capture=a;d.addEventListener(b,e,a);if(d.events==undefined){d.events=[]}d.events.push(e)}else{if(d.attachEvent!=undefined){var e=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};e.scope=this;e.callback=f;e.eventName=b;e.capture=a;d.attachEvent("on"+b,e);if(d.events==undefined){d.events=[]}d.events.push(e)}else{var c={scope:this,method:f,capture:a};d.events[b].push(c)}}};Object.prototype.disconnect=function(d,a,f){if(d.removeEventListener!=undefined){for(var b=0;b<d.events.length;b++){var e=d.events[b];if((e.scope==this)&&(e.eventName==a)){if((f!=undefined)&&(e.callback!=f)){continue}d.removeEventListener(e.eventName,e,e.capture);d.events.splice(b,1);b--}}}else{for(var b=0;b<d.events[a].length;b++){var c=d.events[a][b];if(c.scope==this){if((f!=undefined)&&(c.method!=f)){continue}d.events[a].splice(b,1);b--}}}};Object.prototype.isSubclass=function(a){var b=this;while(b!=undefined){if(b.classType==a){return true}b=b.__baseclass__}return false};Object.extend("Core.DelayedTask",{delay:1,scope:undefined,callback:undefined,arguments:undefined,isDone:false,constructor:function(a){if(a.delay!=undefined){this.delay=a.delay}if(a.scope!=undefined){this.scope=a.scope}if(a.arguments!=undefined){this.arguments=a.arguments}if(a.callback!=undefined){this.callback=a.callback}else{throw ("callback MUST be given for a DelayedTask")}var b=function(){arguments.callee.delayedtask.handle=undefined;arguments.callee.delayedtask.callback.apply(arguments.callee.delayedtask.scope,arguments.callee.delayedtask.arguments);arguments.callee.delayedtask.isDone=true};b.delayedtask=this;this.handle=setTimeout(b,this.delay*1000)},abort:function(){if(this.handle!=undefined){clearTimeout(this.handle);this.handle=undefined}},});Object.extend("Core.Timer",{interval:1,scope:undefined,callback:undefined,arguments:undefined,constructor:function(a){if(a.interval!=undefined){this.interval=a.interval}if(a.scope!=undefined){this.scope=a.scope}if(a.arguments!=undefined){this.arguments=a.arguments}if(a.callback!=undefined){this.callback=a.callback}else{throw ("callback MUST be given for a Timer")}this.wrapper=function(){var e=(new Date().getTime())/1000;var f=arguments.callee.timer;f.callback.apply(f.scope,f.arguments);var d=(new Date().getTime())/1000;var c=d-e;if(c<0){c=0}var b=(f.interval*1000)-c;if(b<0){b=0}if(f.handle!=undefined){f.handle=setTimeout(f.wrapper,b)}};this.wrapper.timer=this;this.handle=setTimeout(this.wrapper,0)},abort:function(){if(this.handle!=undefined){clearTimeout(this.handle);this.handle=undefined}},});Object.extend("Core.HttpRequest",{url:undefined,method:"GET",binary:false,constructor:function(a){if(a.url!=undefined){this.url=a.url}else{throw ("url MUST be given for an HttpRequest")}if(a&&(a.method!=undefined)){this.method=a.method}if(a.binary!=undefined){this.binary=a.binary}this.request=new XMLHttpRequest();if(this.binary){this.request.overrideMimeType("text/plain; charset=x-user-defined")}this.request.open(this.method,this.url,true);var b=function(){var c=arguments.callee.httprequest;if(c.request.readyState==4){if(c.request.status==200){c.fireEvent("done")}else{c.fireEvent("error",c.request.status)}}};b.httprequest=this;this.request.onreadystatechange=b;this.addEvents("error","done")},setRequestHeader:function(b,a){this.request.setRequestHeader(b,a)},abort:function(){this.request.abort()},send:function(){this.request.send.apply(this.request,arguments)},getResponseText:function(){return this.request.responseText},getResponseBase64:function(){var g=this.request.responseText;var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var f="";var b=0;while(b+2<g.length){var e=g.charCodeAt(b++)&255;var d=g.charCodeAt(b++)&255;var c=g.charCodeAt(b++)&255;var l=a[e>>2];var k=a[((e&3)<<4)|(d>>4)];var j=a[((d&15)<<2)|(c>>6)];var h=a[c&63];f+=l+k+j+h}if(b+1<g.length){var e=g.charCodeAt(b++)&255;var d=g.charCodeAt(b++)&255;var l=a[e>>2];var k=a[((e&3)<<4)|(d>>4)];var j=a[(d&15)<<2];f+=l+k+j+"="}else{if(b<g.length){var e=g.charCodeAt(b++)&255;var l=a[e>>2];var k=a[(e&3)<<4];f+=l+k+"=="}}return f},getResponseJSON:function(){var a;try{a=JSON.parse(this.getResponseText())}catch(b){a=undefined}return a},getResponseXML:function(){var c=new DOMParser();try{var a=c.parseFromString(this.getResponseText(),"text/xml");return a}catch(b){}return undefined},});Object.extend("Core.Socket",{host:undefined,service:"/",port:80,mode:undefined,websocket:undefined,emuopenrequest:undefined,emupollrequest:undefined,emusendrequest:undefined,emuid:undefined,emumessages:undefined,lastPosition:0,readSize:true,size:0,data:"",constructor:function(a){if(a.host!=undefined){this.host=a.host}else{this.host=document.location.hostname}if(a.port!=undefined){this.port=a.port}else{if((document.location.port!=undefined)&&(document.location.port!="")){this.port=document.location.port}else{this.port=80}}if(a.service!=undefined){this.service=a.service}if(a.mode!=undefined){this.mode=a.mode}else{if(Core.Socket.supportWebSocket){this.mode="websocket"}else{if(Core.Socket.supportStreamSocket){this.mode="stream"}else{this.mode="poll"}}}if(this.mode=="websocket"){this.websocket=new WebSocket("ws://"+this.host+":"+this.port+this.service);this.connect(this.websocket,"open",this.onWebSocketOpen);this.connect(this.websocket,"error",this.onWebSocketError);this.connect(this.websocket,"message",this.onWebSocketMessage);this.connect(this.websocket,"close",this.onWebSocketClose)}else{if(this.mode=="stream"){this.emumessages=[];this.emuopenrequest=new XMLHttpRequest();this.emuopenrequest.open("GET","http://"+this.host+":"+this.port+this.service+"?socket=stream&command=open",true);var b=function(){var c=arguments.callee.socket;c.onEmuSocketChange.call(c)};b.socket=this;this.emuopenrequest.onreadystatechange=b;this.emuopenrequest.send()}else{this.emumessages=[];this.emuopenrequest=new Core.HttpRequest({url:"http://"+this.host+":"+this.port+this.service+"?socket=poll&command=open"});this.connect(this.emuopenrequest,"done",this.onEmuSocketOpenDone);this.connect(this.emuopenrequest,"error",this.onEmuSocketOpenError);this.emuopenrequest.send()}}this.addEvents("error","message","close","open")},send:function(a){if(this.websocket!=undefined){this.websocket.send(a.serialize())}else{if(this.emusendrequest==undefined){this.emusendrequest=new Core.HttpRequest({url:"http://"+this.host+":"+this.port+this.service+"?socket="+this.mode+"&command=send&id="+this.emuid+"&messages="+encodeURIComponent(a.serialize().toBase64())});this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone);this.connect(this.emusendrequest,"error",this.onEmuSocketSendError);this.emusendrequest.send()}else{this.emumessages.push(a.serialize().toBase64())}}},close:function(){if(this.websocket!=undefined){this.websocket.close()}else{if(this.emutimer!=undefined){this.emutimer.abort();this.emutimer=undefined}if(this.emusendrequest!=undefined){this.emusendrequest.abort();this.emusendrequest=undefined}if(this.emuopenrequest!=undefined){this.emuopenrequest.abort();this.emuopenrequest=undefined}if(this.emupollrequest!=undefined){this.emupollrequest.abort();this.emupollrequest=undefined}}},onWebSocketOpen:function(){this.fireEvent("open",this)},onWebSocketError:function(){this.fireEvent("error",this)},onWebSocketMessage:function(a){this.fireEvent("message",this,JSON.parse(a.data))},onWebSocketClose:function(a){this.fireEvent("close",this)},emuSocketDataAvailable:function(a){if(this.emuid==undefined){this.emuid=a;this.fireEvent("open",this)}else{this.fireEvent("message",this,JSON.parse(a.fromBase64()))}},emuSocketUpdate:function(c){for(var a=0;a<c.length;a++){var b=c[a];if(this.readSize){if(b==":"){this.readSize=false;this.size=parseInt("0x"+this.data);this.data=""}else{this.data+=b}}else{this.data+=b;if(this.data.length>=this.size+2){this.emuSocketDataAvailable(this.data.substring(0,this.data.length-2));this.readSize=true;this.data=""}}}},onEmuSocketChange:function(){if(this.emuopenrequest.readyState==2){if(this.emuopenrequest.status!=200){this.emuopenrequest.onreadystatechange=undefined;this.emuopenrequest.abort();this.emuopenrequest=undefined;this.fireEvent("error",this)}}else{if(this.emuopenrequest.readyState==3){var a=this.emuopenrequest.responseText;if(a.length!=this.lastPosition){var b=a.substring(this.lastPosition);this.emuSocketUpdate(b);this.lastPosition=a.length}}else{if(this.emuopenrequest.readyState==4){if(this.emuopenrequest.responseText.length!=this.lastPosition){var b=this.emuopenrequest.responseText.substring(this.lastPosition);this.emuSocketUpdate(b);this.lastPosition=this.emuopenrequest.responseText.length}this.emuopenrequest.onreadystatechange=undefined;this.emuopenrequest=undefined;this.fireEvent("close",this)}}}},onEmuSocketSendDone:function(){var a=this.emusendrequest.getResponseJSON();if(a.messages!=undefined){for(var b=0;b<a.messages.length;b++){var d=JSON.parse(a.messages[b].fromBase64());this.fireEvent("message",this,d)}}if(this.emumessages.length>0){var c="";for(var b=0;b<this.emumessages.length;b++){if(c!=""){c+=";"}c+=this.emumessages[b]}this.emusendrequest=new Core.HttpRequest({url:"http://"+this.host+":"+this.port+this.service+"?socket="+this.mode+"&command=send&id="+this.emuid+"&messages="+encodeURIComponent(c)});this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone);this.connect(this.emusendrequest,"error",this.onEmuSocketSendError);this.emurequest.send();this.emumessages=[]}else{this.emusendrequest=undefined}},onEmuSocketSendError:function(){this.emusendrequest=undefined},onEmuSocketOpenDone:function(){var a=this.emuopenrequest.getResponseJSON();this.emuid=a.id;this.emuopenrequest=undefined;if(a.status!="open"){this.fireEvent("error",this)}else{this.emutimer=new Core.Timer({interval:5,scope:this,callback:this.onEmuSocketTimer});this.fireEvent("open",this)}},onEmuSocketOpenError:function(){this.emuopenrequest=undefined;this.fireEvent("error",this)},onEmuSocketTimer:function(){if(this.emupollrequest==undefined){this.emupollrequest=new Core.HttpRequest({url:"http://"+this.host+":"+this.port+this.service+"?socket=poll&command=poll&id="+this.emuid});this.connect(this.emupollrequest,"done",this.onEmuSocketPollDone);this.connect(this.emupollrequest,"error",this.onEmuSocketPollError);this.emupollrequest.send()}},onEmuSocketPollDone:function(){var a=this.emupollrequest.getResponseJSON();if(a.status!="open"){this.close();this.fireEvent("close",this)}else{if(a.messages!=undefined){for(var b=0;b<a.messages.length;b++){var c=JSON.parse(a.messages[b].fromBase64());this.fireEvent("message",this,c)}}}this.emupollrequest=undefined},onEmuSocketPollError:function(){this.emupollrequest=undefined;this.fireEvent("error",this);this.close()},});Core.Socket.supportWebSocket="WebSocket" in window;Core.Socket.supportStreamSocket=true;if(navigator.isIE){Core.Socket.supportStreamSocket=false}Object.extend("Anim.TimeManager",{clocks:undefined,timer:undefined,start:0,constructor:function(a){this.clocks=[];this.start=new Date().getTime();this.addEvents("tick")},add:function(a){this.clocks.push(a);if(this.clocks.length==1){this.timer=new Core.Timer({callback:this.onTick,scope:this,interval:1/60})}},remove:function(b){var a=0;while((a<this.clocks.length)&&(this.clocks[a]!=b)){a++}if(a<this.clocks.length){this.clocks.splice(a,1)}if(this.clocks.length==0){this.timer.abort();this.timer=undefined}},onTick:function(){var b=(new Date().getTime())-this.start;b/=1000;for(var a=0;a<this.clocks.length;a++){this.clocks[a].update(b)}this.fireEvent("tick")},});Anim.TimeManager.current=new Anim.TimeManager();Object.extend("Anim.EasingFunction",{mode:"in",constructor:function(a){if(a.mode!=undefined){this.setMode(a.mode)}},setMode:function(a){this.mode=a},getMode:function(){return this.mode},ease:function(a){if(this.mode=="in"){return this.easeInCore(a)}else{if(this.mode=="out"){return 1-this.easeInCore(1-a)}else{if(a<=0.5){return this.easeInCore(a*2)/2}else{return 0.5+((1-this.easeInCore(2-(a*2)))/2)}}}},easeInCore:function(a){return a},});Anim.EasingFunction.extend("Anim.PowerEase",{power:2,constructor:function(a){if(a.power!=undefined){this.setPower(a.power)}},setPower:function(a){this.power=a},getPower:function(){return this.power},},{easeInCore:function(a){return Math.pow(a,this.power)},});Anim.EasingFunction.extend("Anim.ElasticEase",{oscillations:3,springiness:3,constructor:function(a){if(a.oscillations!=undefined){this.setOscillations(a.oscillations)}},setOscillations:function(a){this.oscillations=a},getOscillations:function(){return this.oscillations},setSpringiness:function(a){this.springiness=a},getSpringiness:function(){return this.springiness},},{easeInCore:function(a){return Math.sin(a*(this.oscillations*2+0.5)*Math.PI)*Math.pow(a,this.springiness)},});Anim.EasingFunction.extend("Anim.BounceEase",{bounces:3,bounciness:2,constructor:function(a){if(a.oscillations!=undefined){this.setOscillations(a.oscillations)}},setBounces:function(a){this.bounces=a},getBounces:function(){return this.Bounces},setBounciness:function(a){this.bounciness=a},getBounciness:function(){return this.bounciness},},{easeInCore:function(a){var c=Math.exp((1/this.bounciness)*Math.log(a));var b=Math.floor(c*(this.bounces+0.5));var d=(c*(this.bounces+0.5))-b;return Math.sin(d*Math.PI)/Math.exp(this.bounces-b)},});Object.extend("Anim.Clock",{parent:undefined,time:undefined,iteration:undefined,progress:undefined,isActive:false,globalTime:0,startTime:0,lastTick:0,beginTime:0,isPaused:false,speed:1,duration:"forever",pendingState:"none",autoReverse:false,repeat:1,target:undefined,scope:undefined,callback:undefined,ease:undefined,constructor:function(a){if(a.parent!=undefined){this.parent=a.parent}if(a.beginTime!=undefined){this.beginTime=a.beginTime}if(a.autoReverse!=undefined){this.autoReverse=a.autoReverse}if(a.duration!=undefined){this.duration=a.duration}if(a.repeat!=undefined){this.repeat=a.repeat}if(a.speed!=undefined){this.speed=a.speed}if(a.callback!=undefined){this.callback=a.callback}if(a.target!=undefined){this.target=a.target}if(a.scope!=undefined){this.scope=a.scope}else{this.scope=this.target}if(a.ease!=undefined){this.ease=a.ease}if(this.duration=="automatic"){this.duration="forever"}this.addEvents("complete","timeupdate")},setParent:function(a){this.parent=a},getParent:function(){return this.parent},getGlobalTime:function(){return this.globalTime+(this.lastTick-this.startTime)*this.speed},getIsActive:function(){return this.isActive},getTime:function(){return this.time},getIteration:function(){return this.iteration},getProgress:function(){return this.progress},begin:function(){if(this.parent==undefined){Anim.TimeManager.current.add(this)}else{if(this.scope==undefined){this.scope=this.parent.scope}}this.pendingState="active";if((this.target!=undefined)&&(this.target.setAnimClock!=undefined)){this.target.setAnimClock(this)}},pause:function(){this.pendingState="paused"},resume:function(){this.pendingState="resumed"},stop:function(){this.pendingState="stopped"},onComplete:function(){if(this.parent==undefined){Anim.TimeManager.current.remove(this)}this.fireEvent("complete")},onTimeUpdate:function(b){var a=this.getProgress();if(this.ease!=undefined){a=this.ease.ease(a)}if(this.callback!=undefined){this.callback.call(this.scope,this,a,b)}this.fireEvent("timeupdate",this,a,b)},update:function(b){var d;do{d=this.pendingState;this.pendingState="none";if(d=="none"){if(this.isActive&&!this.isPaused){var g=b-this.lastTick;this.lastTick=b;var a=this.getGlobalTime();a-=this.beginTime;if(a>=0){if((this.duration!="forever")&&(this.duration!="automatic")){var c=a/this.duration;var f=Math.floor(c+1);var e=a%this.duration;if(this.autoReverse){if((f&1)==0){e=this.duration-e}c/=2;f=Math.floor(c+1)}if(this.repeat=="forever"){this.iteration=f;this.time=e;this.progress=e/this.duration;this.onTimeUpdate(g)}else{if(c>=this.repeat){this.pendingState="stopped";this.iteration=this.repeat;this.time=this.duration;if(this.autoReverse){this.progress=0}else{this.progress=1}this.onTimeUpdate(0)}else{this.iteration=f;this.time=e;this.progress=e/this.duration;this.onTimeUpdate(g)}}}else{this.time=a;this.progress=0;this.iteration=undefined;this.onTimeUpdate(g)}}}}else{if(d=="active"){if(!this.isActive){this.isActive=true;this.globalTime=0;this.startTime=b;this.lastTick=this.startTime;if(this.beginTime>0){this.time=undefined;this.progress=undefined;this.iteration=undefined}else{this.time=0;this.progress=0;this.iteration=1;this.onTimeUpdate(0)}}}else{if(d=="paused"){if(!this.isPaused&&this.isActive){this.isPaused=true;this.globalTime=this.getGlobalTime();this.startTime=0;this.lastTick=0}}else{if(d=="resumed"){if(this.isPaused&&this.isActive){this.isPaused=false;this.startTime=b;this.lastTick=b}}else{if(d=="stopped"){if(this.isActive){this.progress=undefined;this.time=undefined;this.iteration=undefined;this.isActive=false}}}}}}}while(this.pendingState!="none");if((this.parent==undefined)&&!this.isActive){this.onComplete()}},});Anim.Clock.extend("Anim.ClockGroup",{children:undefined,constructor:function(a){this.children=[]},appendChild:function(a){a.setParent(this);this.children.push(a)},},{begin:function(){Anim.ClockGroup.base.begin.call(this);for(var a=0;a<this.children.length;a++){this.children[a].begin()}},pause:function(){Anim.ClockGroup.base.pause.call(this);for(var a=0;a<this.children.length;a++){this.children[a].pause()}},resume:function(){Anim.ClockGroup.base.resume.call(this);for(var a=0;a<this.children.length;a++){this.children[a].resume()}},stop:function(){Anim.ClockGroup.base.stop.call(this);for(var a=0;a<this.children.length;a++){this.children[a].stop()}},onCompleted:function(){Anim.ClockGroup.base.onCompleted.call(this);for(var a=0;a<this.children.length;a++){this.children[a].onCompleted()}},update:function(b){do{Anim.ClockGroup.base.update.call(this,b);var d=true;for(var c=0;c<this.children.length;c++){var a=this.children[c];a.update(this.getGlobalTime());if(a.getIsActive()){d=false}}if(this.getIsActive()&&d){this.pendingState="stopped"}}while(this.pendingState!="none")},});Object.extend("Ui.Matrix",{svgMatrix:undefined,constructor:function(a){if(a.SVGMatrix!=undefined){this.svgMatrix=a.SVGMatrix}else{this.svgMatrix=Ui.App.current.svgRoot.createSVGMatrix()}},translate:function(a,b){this.svgMatrix=this.svgMatrix.translate(a,b)},rotate:function(a){this.svgMatrix=this.svgMatrix.rotate(a)},scale:function(b,a){if(a==undefined){a=b}this.svgMatrix=this.svgMatrix.scaleNonUniform(b,a)},multiply:function(a){this.svgMatrix=this.svgMatrix.multiply(a.svgMatrix)},inverse:function(){this.svgMatrix=this.svgMatrix.inverse()},setMatrix:function(h,g,l,k,j,i){this.svgMatrix.a=h;this.svgMatrix.b=g;this.svgMatrix.c=l;this.svgMatrix.d=k;this.svgMatrix.e=j;this.svgMatrix.f=i},getA:function(){return this.svgMatrix.a},getB:function(){return this.svgMatrix.b},getC:function(){return this.svgMatrix.c},getD:function(){return this.svgMatrix.d},getE:function(){return this.svgMatrix.e},getF:function(){return this.svgMatrix.f},},{toString:function(){return"matrix("+this.svgMatrix.a.toFixed(4)+", "+this.svgMatrix.b.toFixed(4)+", "+this.svgMatrix.c.toFixed(4)+", "+this.svgMatrix.d.toFixed(4)+", "+this.svgMatrix.e.toFixed(4)+", "+this.svgMatrix.f.toFixed(4)+")"},});Ui.Matrix.createRotate=function(b){var a=new Ui.Matrix();a.rotate(b);return a};Ui.Matrix.createTranslate=function(a,c){var b=new Ui.Matrix();b.translate(a,c);return b};Ui.Matrix.createScale=function(c,b){var a=new Ui.Matrix();a.scale(c,b);return a};Ui.Matrix.createMatrix=function(h,g,m,l,k,j){var i=new Ui.Matrix();i.setMatrix(h,g,m,l,k,j);return i};Object.extend("Ui.Point",{svgPoint:undefined,x:0,y:0,constructor:function(a){if(a.SVGPoint!=undefined){this.svgPoint=a.SVGPoint}else{this.svgPoint=Ui.App.current.svgRoot.createSVGPoint()}if(a.point!=undefined){this.setX(a.point.x);this.setY(a.point.y)}if(a.x!=undefined){this.setX(a.x)}if(a.y!=undefined){this.setY(a.y)}},matrixTransform:function(a){this.svgPoint=this.svgPoint.matrixTransform(a.svgMatrix);this.x=this.svgPoint.x;this.y=this.svgPoint.y},setPoint:function(a,b){this.svgPoint.x=a;this.svgPoint.y=b;this.x=a;this.y=b},getX:function(){return this.x},setX:function(a){this.svgPoint.x=a;this.x=a},getY:function(){return this.y},setY:function(a){this.svgPoint.y=a;this.y=a},},{toString:function(){return"point("+this.x.toFixed(4)+", "+this.y.toFixed(4)+")"},});Object.extend("Ui.Keyboard",{shiftKey:false,altKey:false,ctrlKey:false,altGraphKey:false,metaKey:false,elementCapture:undefined,constructor:function(a){},capture:function(a){if(this.elementCapture!=undefined){throw ("keyboard capture already done on element (type: "+this.elementCapture.type+", id: "+this.elementCapture.id+", newid: "+a.id+")")}this.elementCapture=a},release:function(){if(this.elementCapture!=undefined){this.elementCapture=undefined}else{throw ("keyboard capture release but no element capture the keyboard")}},getShiftKey:function(){return this.shiftKey},getAltKey:function(){return this.altKey},getCtrlKey:function(){return this.ctrlKey},getAltGraphKey:function(){return this.altGraphKey},getMetaKey:function(){return this.metaKey},});Ui.Keyboard.current=new Ui.Keyboard();Object.extend("Ui.Element",{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0,parent:undefined,width:undefined,height:undefined,renderNext:undefined,renderValid:true,drawing:undefined,measureValid:false,measureConstraintWidth:0,measureConstraintHeight:0,measureWidth:0,measureHeight:0,arrangeValid:false,arrangeX:0,arrangeY:0,arrangeWidth:0,arrangeHeight:0,layoutX:0,layoutY:0,layoutWidth:0,layoutHeight:0,isLoaded:false,verticalAlign:"stretch",horizontalAlign:"stretch",clipToBounds:false,clipX:undefined,clipY:undefined,clipWidth:undefined,clipHeight:undefined,focusable:false,transform:undefined,transformOriginX:0.5,transformOriginY:0.5,transformOriginAbsolute:false,animClock:undefined,opacity:1,disabled:undefined,parentDisabled:undefined,style:undefined,parentStyle:undefined,mergeStyle:undefined,constructor:function(a){this.drawing=document.createElementNS(htmlNS,"div");this.drawing.style.position="absolute";this.drawing.style.left="0px";this.drawing.style.top="0px";this.addClass(this.classType.toLowerCase().replace(/\./gi,"-"));var b=this.render();if(b!=undefined){this.drawing.appendChild(b)}if(a.width!=undefined){this.setWidth(a.width)}if(a.height!=undefined){this.setHeight(a.height)}if(a.verticalAlign!=undefined){this.setVerticalAlign(a.verticalAlign)}if(a.horizontalAlign!=undefined){this.setHorizontalAlign(a.horizontalAlign)}if(a.margin!=undefined){this.setMargin(a.margin)}if(a.marginTop!=undefined){this.setMarginTop(a.marginTop)}if(a.marginBottom!=undefined){this.setMarginBottom(a.marginBottom)}if(a.marginLeft!=undefined){this.setMarginLeft(a.marginLeft)}if(a.marginRight!=undefined){this.setMarginRight(a.marginRight)}if(a.opacity!=undefined){this.setOpacity(a.opacity)}if(a.focusable!=undefined){this.setFocusable(a.focusable)}if(a.clipToBounds!=undefined){this.setClipToBounds(a.clipToBounds)}if(a.id!=undefined){this.setId(a.id)}else{this.setId(Core.Util.generateId())}this.addEvents("keypress","keydown","focus","blur","load","unload","enable","disable")},getDrawing:function(){return this.drawing},getLayoutX:function(){return this.layoutX},getLayoutY:function(){return this.layoutY},getLayoutWidth:function(){return this.layoutWidth},getLayoutHeight:function(){return this.layoutHeight},setId:function(a){this.drawing.setAttributeNS(null,"id",a)},getId:function(){return this.drawing.getAttributeNS(null,"id")},setFocusable:function(a){this.focusable=a;if(a){this.drawing.setAttributeNS(null,"tabindex",0)}else{this.drawing.setAttributeNS(null,"tabindex",-1)}},getFocusable:function(){return this.focusable},setRole:function(a){if(a==undefined){if(this.drawing.hasAttributeNS("http://www.w3.org/2005/07/aaa","role")){this.drawing.removeAttributeNS("http://www.w3.org/2005/07/aaa","role")}}else{this.drawing.setAttributeNS("http://www.w3.org/2005/07/aaa","role",a)}},measure:function(c,a,g){if((this.measureValid)&&(this.measureConstraintWidth==c)&&(this.measureConstraintHeight==a)){return{width:this.measureWidth,height:this.measureHeight}}this.measureConstraintWidth=c;this.measureConstraintHeight=a;var f=this.getMarginLeft();var e=this.getMarginRight();var d=this.getMarginTop();var h=this.getMarginBottom();var b=this.measureCore(c-(f+e),a-(d+h),g);if((this.width!=undefined)&&(b.width<this.width)){this.measureWidth=this.width+f+e}else{this.measureWidth=b.width+f+e}if((this.height!=undefined)&&(b.height<this.height)){this.measureHeight=this.height+d+h}else{this.measureHeight=b.height+d+h}this.measureValid=true;return{width:this.measureWidth,height:this.measureHeight}},measureCore:function(b,a,c){return{width:0,height:0}},invalidateMeasure:function(){this.invalidateArrange();if(this.measureValid){this.measureValid=false;if((this.parent!=undefined)&&(this.parent.measureValid)){this.parent.onChildInvalidateMeasure(this)}}},onChildInvalidateMeasure:function(a){this.invalidateMeasure()},arrange:function(h,g,c,i,a){if(((a!=undefined)&&a)||(!this.arrangeValid)||(this.arrangeX!=h)||(this.arrangeY!=g)||(this.arrangeWidth!=c)||(this.arrangeHeight!=i)){this.arrangeX=h;this.arrangeY=g;this.arrangeWidth=c;this.arrangeHeight=i;if(this.verticalAlign=="top"){i=this.measureHeight}else{if(this.verticalAlign=="bottom"){g+=i-this.measureHeight;i=this.measureHeight}else{if(this.verticalAlign=="center"){g+=(i-this.measureHeight)/2;i=this.measureHeight}}}if(this.horizontalAlign=="left"){c=this.measureWidth}else{if(this.horizontalAlign=="right"){h+=c-this.measureWidth;c=this.measureWidth}else{if(this.horizontalAlign=="center"){h+=(c-this.measureWidth)/2;c=this.measureWidth}}}var d=this.getMarginLeft();var f=this.getMarginRight();var b=this.getMarginTop();var e=this.getMarginBottom();h+=d;g+=b;c-=d+f;i-=b+e;this.layoutX=h;this.layoutY=g;this.layoutWidth=c;this.layoutHeight=i;this.drawing.style.setProperty("left",this.layoutX+"px",null);this.drawing.style.setProperty("top",this.layoutY+"px",null);this.updateTransform();this.drawing.style.setProperty("width",c+"px",null);this.drawing.style.setProperty("height",i+"px",null);if(this.clipToBounds){this.clipX=0;this.clipY=0;this.clipWidth=this.layoutWidth;this.clipHeight=this.layoutHeight;this.updateClipRectangle()}this.arrangeCore(c,i,a)}this.arrangeValid=true},arrangeCore:function(b,a,c){},invalidateArrange:function(){if(this.arrangeValid){this.arrangeValid=false;if(this.parent!=undefined){this.parent.invalidateArrange()}}},render:function(){return undefined},updateRender:function(){if(!this.renderValid){this.drawing.style.opacity=this.opacity;this.updateTransform();this.updateClipRectangle();this.updateRenderCore();this.renderValid=true}},updateRenderCore:function(){},invalidateRender:function(){if(this.renderValid){this.renderValid=false;Ui.App.current.enqueueRender(this)}},getWidth:function(){return this.width},setWidth:function(a){if(this.width!=a){this.width=a;this.invalidateMeasure()}},getHeight:function(){return this.height},setHeight:function(a){if(this.height!=a){this.height=a;this.invalidateMeasure()}},getVerticalAlign:function(){return this.verticalAlign},setVerticalAlign:function(a){this.verticalAlign=a;this.invalidateArrange()},getHorizontalAlign:function(){return this.horizontalAlign},setHorizontalAlign:function(a){this.horizontalAlign=a;this.invalidateArrange()},getClipToBounds:function(){return this.clipToBounds},setClipToBounds:function(a){if(this.clipToBounds!=a){this.clipToBounds=a;if(a){this.clipX=0;this.clipY=0;this.clipWidth=this.layoutWidth;this.clipHeight=this.layoutHeight}else{this.clipX=undefined;this.clipY=undefined;this.clipWidth=undefined;this.clipHeight=undefined}this.invalidateRender()}},setClipRectangle:function(b,d,c,a){this.clipX=b;this.clipY=d;this.clipWidth=c;this.clipHeight=a;this.invalidateRender()},updateClipRectangle:function(){if(this.clipX!=undefined){x=Math.round(this.clipX);y=Math.round(this.clipY);width=Math.round(this.clipWidth);height=Math.round(this.clipHeight);this.drawing.style.setProperty("clip","rect("+y+"px "+(x+width)+"px "+(y+height)+"px "+x+"px)",null)}else{this.drawing.style.removeProperty("clip")}},checkClass:function(d){var a=this.drawing.getAttributeNS(null,"class");if((a==undefined)||(a=="")){return false}var c=a.split(" ");for(var b=0;b<c.length;b++){if(c[b]==d){return true}}return false},addClass:function(b){var a=this.drawing.getAttributeNS(null,"class");if(!a){this.drawing.setAttributeNS(null,"class",b)}else{if(!this.checkClass(b)){this.drawing.setAttributeNS(null,"class",a+" "+b)}}},removeClass:function(e){if(e==undefined){return}var a=this.drawing.getAttributeNS(null,"class");if(a){var d=a.split(" ");var c="";for(var b=0;b<d.length;b++){if((d[b]==e)||(d[b]=="")){continue}if(c!=""){c+=" "}c+=d[b]}this.drawing.setAttributeNS(null,"class",c)}},replaceClass:function(c,b){var a=this.drawing.getAttributeNS(null,"class");if(!a){this.drawing.setAttributeNS(null,"class",b)}else{var f=a.split(" ");var e="";for(var d=0;d<f.length;d++){if(f[d]==""){continue}if(e!=""){e+=" "}if(f[d]==c){e+=b}else{e+=f[d]}}this.drawing.setAttributeNS(null,"class",e)}},setMargin:function(a){this.setMarginTop(a);this.setMarginBottom(a);this.setMarginLeft(a);this.setMarginRight(a)},getMarginTop:function(){return this.marginTop},setMarginTop:function(a){if(a!=this.marginTop){this.marginTop=a;this.invalidateMeasure()}},getMarginBottom:function(){return this.marginBottom},setMarginBottom:function(a){if(a!=this.marginBottom){this.marginBottom=a;this.invalidateMeasure()}},getMarginLeft:function(){return this.marginLeft},setMarginLeft:function(a){if(a!=this.marginLeft){this.marginLeft=a;this.invalidateMeasure()}},getMarginRight:function(){return this.marginRight},setMarginRight:function(a){if(a!=this.marginRight){this.marginRight=a;this.invalidateMeasure()}},getOpacity:function(){return this.opacity},setOpacity:function(a){if(this.opacity!=a){this.opacity=a;this.invalidateRender()}},focus:function(){var a=this;while(a.parent!=undefined){a=a.parent}if(a.isSubclass("Ui.App")){a.askFocus(this)}},blur:function(){var a=this;while(a.parent!=undefined){a=a.parent}if(a.isSubclass("Ui.App")){a.removeFocus(this)}},setTransform:function(a){if(this.transform!=a){this.transform=a;this.invalidateRender()}},setTransformOrigin:function(a,c,b){if((this.transformOriginX!=a)||(this.transformOriginY!=c)||(this.transformOriginAbsolute!=b)){this.transformOriginX=a;this.transformOriginY=c;if(b==undefined){this.transformOriginAbsolute=false}else{this.transformOriginAbsolute=b}this.updateTransform()}},transformToPage:function(){if(navigator.isWebkit){var p=new Ui.Matrix();var o=this.drawing;while(o!=undefined){var h=window.getComputedStyle(o,null).getPropertyValue("-webkit-transform");if(h!="none"){var z=window.getComputedStyle(o,null).getPropertyValue("-webkit-transform-origin");var n=0;var l=0;if(z!="0px 0px"){var g=z.split(" ");n=new Number(g[0].replace(/px$/,""));l=new Number(g[1].replace(/px$/,""))}var q=new WebKitCSSMatrix(h);var j=Ui.Matrix.createMatrix(q.a,q.b,q.c,q.d,q.e,q.f);p.translate(o.offsetLeft-n,o.offsetTop-l);p.multiply(j);p.translate(n,l)}o=o.offsetParent}return p}else{if(navigator.isGecko){var p=new Ui.Matrix();var o=this.drawing;while(o!=undefined){var h=window.getComputedStyle(o,null).getPropertyValue("-moz-transform");if(h!="none"){var k=h.split(" ");var w=new Number(k[0].slice(7,k[0].length-1));var v=new Number(k[1].slice(0,k[1].length-1));var u=new Number(k[2].slice(0,k[2].length-1));var t=new Number(k[3].slice(0,k[3].length-1));var s=new Number(k[4].slice(0,k[4].length-3));var r=new Number(k[5].slice(0,k[5].length-3));var z=window.getComputedStyle(o,null).getPropertyValue("-moz-transform-origin");var n=0;var l=0;if(z!="0px 0px"){var g=z.split(" ");n=new Number(g[0].replace(/px$/,""));l=new Number(g[1].replace(/px$/,""))}var j=Ui.Matrix.createMatrix(w,v,u,t,s,r);p.translate(o.offsetLeft-n,o.offsetTop-l);p.multiply(j);p.translate(n,l)}o=o.offsetParent}return p}else{if(navigator.isOpera){var p=new Ui.Matrix();var o=this.drawing;while(o!=undefined){var h=window.getComputedStyle(o,null).getPropertyValue("-o-transform");if((h!="none")&&(h!="matrix(1, 0, 0, 1, 0, 0)")){var k=h.split(" ");var w=new Number(k[0].slice(7,k[0].length-1));var v=new Number(k[1].slice(0,k[1].length-1));var u=new Number(k[2].slice(0,k[2].length-1));var t=new Number(k[3].slice(0,k[3].length-1));var s=new Number(k[4].slice(0,k[4].length-1));var r=new Number(k[5].slice(0,k[5].length-1));var z=window.getComputedStyle(o,null).getPropertyValue("-o-transform-origin");var n=0;var l=0;if(z!="0px 0px"){var g=z.split(" ");n=new Number(g[0].replace(/px$/,""));l=new Number(g[1].replace(/px$/,""))}var j=Ui.Matrix.createMatrix(w,v,u,t,s,r);p.translate(o.offsetLeft-n,o.offsetTop-l);p.multiply(j);p.translate(n,l)}o=o.offsetParent}return p}else{if(navigator.isIE){var p=new Ui.Matrix();var o=this.drawing;while(o!=undefined){var h=window.getComputedStyle(o,null).getPropertyValue("-ms-transform");if((h!="none")&&(h!="matrix(1, 0, 0, 1, 0, 0)")){var k=h.split(" ");var w=new Number(k[0].slice(7,k[0].length-1));var v=new Number(k[1].slice(0,k[1].length-1));var u=new Number(k[2].slice(0,k[2].length-1));var t=new Number(k[3].slice(0,k[3].length-1));var s=new Number(k[4].slice(0,k[4].length-1));var r=new Number(k[5].slice(0,k[5].length-1));var z=window.getComputedStyle(o,null).getPropertyValue("-ms-transform-origin");var n=0;var l=0;if(z!="0px 0px"){var g=z.split(" ");n=new Number(g[0].replace(/px$/,""));l=new Number(g[1].replace(/px$/,""))}var j=Ui.Matrix.createMatrix(w,v,u,t,s,r);p.translate(o.offsetLeft-n,o.offsetTop-l);p.multiply(j);p.translate(n,l)}o=o.offsetParent}return p}else{var m=document.createElementNS(svgNS,"svg");if(this.drawing.firstChild==undefined){this.drawing.appendChild(m)}else{this.drawing.insertBefore(m,this.drawing.firstChild)}var i=m.getScreenCTM();this.drawing.removeChild(m);return Ui.Matrix.createMatrix(i.a,i.b,i.c,i.d,i.e,i.f)}}}}},transformFromPage:function(){var a=this.transformToPage();a.inverse();return a},transformToElement:function(b){var a=this.transformToPage();a.multiply(b.transformFromPage());return a},pointToPage:function(a){if(navigator.isWebkit){return window.webkitConvertPointFromNodeToPage(this.drawing,new WebKitPoint(a.x,a.y))}else{a=new Ui.Point({point:a});a.matrixTransform(this.transformToPage());return a}},pointFromPage:function(a){if(navigator.isWebkit){return window.webkitConvertPointFromPageToNode(this.drawing,new WebKitPoint(a.x,a.y))}else{a=new Ui.Point({point:a});a.matrixTransform(this.transformFromPage());return a}},pointFromElement:function(b,a){return this.pointFromPage(b.pointToPage(a))},getIsLoaded:function(){return this.isLoaded},getMeasureWidth:function(){return this.measureWidth},getMeasureHeight:function(){return this.measureHeight},show:function(){this.drawing.style.visibility="visible"},hide:function(){this.drawing.style.visibility="hidden"},disable:function(){if((this.disabled==undefined)||!this.disabled){var a=this.getIsDisabled();this.disabled=true;if(!a){this.onInternalDisable()}}},enable:function(){if((this.disabled==undefined)||this.disabled){var a=this.getIsDisabled();this.disabled=false;if(a){this.onInternalEnable()}}},getIsDisabled:function(){if(this.disabled!=undefined){return this.disabled}else{if(this.parentDisabled!=undefined){return this.parentDisabled}else{return false}}},setParentDisabled:function(b){var a=this.getIsDisabled();this.parentDisabled=b;if(a!=this.getIsDisabled()){if(this.getIsDisabled()){this.onInternalDisable()}else{this.onInternalEnable()}}},onInternalDisable:function(){this.onDisable();this.fireEvent("disable",this)},onDisable:function(){},onInternalEnable:function(){this.onEnable();this.fireEvent("enable",this)},onEnable:function(){},mergeStyles:function(){if(this.parentStyle==undefined){this.mergeStyle=this.style}else{if(this.style==undefined){this.mergeStyle=this.parentStyle}else{this.mergeStyle={};for(var a in this.parentStyle){this.mergeStyle[a]=this.parentStyle[a]}for(var a in this.style){this.mergeStyle[a]=this.style[a]}}}},setParentStyle:function(a){if(this.parentStyle!=a){this.parentStyle=a;this.mergeStyles();this.onInternalStyleChange()}},setStyle:function(a){this.style=a;this.mergeStyles();this.onInternalStyleChange()},getStyleProperty:function(a){if((this.mergeStyle!=undefined)&&(this.mergeStyle[a]!=undefined)){return this.mergeStyle[a]}else{return undefined}},onInternalStyleChange:function(){this.onStyleChange()},onStyleChange:function(){},setIsLoaded:function(a){if(this.isLoaded!=a){this.isLoaded=a;if(a){this.onLoad()}else{this.onUnload()}}},updateTransform:function(){var b=new Ui.Matrix();if(this.transform!=undefined){var a=this.transformOriginX;var c=this.transformOriginY;if(!this.transformOriginAbsolute){a*=this.layoutWidth;c*=this.layoutHeight}b.translate(a,c);b.multiply(this.transform);b.translate(-a,-c)}if(navigator.isIE){this.drawing.style.msTransform=b.toString();this.drawing.style.msTransformOrigin="0% 0%"}else{if(navigator.isGecko){this.drawing.style.setProperty("-moz-transform","matrix("+b.svgMatrix.a.toFixed(4)+", "+b.svgMatrix.b.toFixed(4)+", "+b.svgMatrix.c.toFixed(4)+", "+b.svgMatrix.d.toFixed(4)+", "+b.svgMatrix.e.toFixed(0)+"px, "+b.svgMatrix.f.toFixed(0)+"px)",null);this.drawing.style.setProperty("-moz-transform-origin","0% 0%",null)}else{if(navigator.isWebkit){this.drawing.style.webkitTransform=b.toString();this.drawing.style.webkitTransformOrigin="0% 0%"}else{if(navigator.isOpera){this.drawing.style.setProperty("-o-transform",b.toString(),null);this.drawing.style.setProperty("-o-transform-origin","0% 0%",null)}}}}},setAnimClock:function(a){if(this.animClock!=undefined){this.animClock.stop()}this.animClock=a;if(a!=undefined){this.connect(a,"complete",function(){this.animClock=undefined})}},onLoad:function(){if(this.parent!=undefined){this.setParentStyle(this.parent.mergeStyle);this.setParentDisabled(this.getIsDisabled())}this.fireEvent("load")},onUnload:function(){if(this.animClock!=undefined){this.animClock.stop();this.animClock=undefined}this.fireEvent("unload")},});Ui.Element.extend("Ui.SVGElement",{svg:undefined,constructor:function(a){},renderSVG:function(){return undefined},},{render:function(){this.svg=document.createElementNS(svgNS,"svg");this.svg.style.position="absolute";this.svg.style.left="0px";this.svg.style.top="0px";var a=this.renderSVG();if(a!=undefined){this.svg.appendChild(a)}return this.svg},});Ui.Element.extend("Ui.Container",{children:undefined,childChanged:false,constructor:function(a){this.children=[]},appendChild:function(a){a.parent=this;this.children.push(a);this.childChanged=true;this.invalidateMeasure();this.invalidateRender();a.setIsLoaded(this.isLoaded)},removeChild:function(b){b.parent=undefined;this.childChanged=true;var a=0;while((a<this.children.length)&&(this.children[a]!=b)){a++}if(a<this.children.length){this.children.splice(a,1)}this.invalidateMeasure();this.invalidateRender();b.setIsLoaded(false)},insertBefore:function(c,b){this.childChanged=true;var a=0;while((a<this.children.length)&&(this.children[a]!=b)){a++}if(a<this.length){this.children=this.children.splice(a,0,c)}else{this.children.push(c)}this.invalidateMeasure();this.invalidateRender();c.setIsLoaded(this.isLoaded)},getChildren:function(){return this.children},},{setIsLoaded:function(a){if(a!=this.isLoaded){for(var b=0;b<this.children.length;b++){this.children[b].setIsLoaded(a)}Ui.Container.base.setIsLoaded.call(this,a)}},updateRenderCore:function(){if(this.childChanged){this.childChanged=false;for(var a=0;a<this.children.length;a++){var e=this.children[a];e.getDrawing().style.zIndex=a;var c=false;for(var b=0;(b<this.getDrawing().childNodes.length)&&!c;b++){if(this.getDrawing().childNodes[b]===e.getDrawing()){c=true}}if(!c){this.getDrawing().appendChild(e.getDrawing())}}var d=[];for(var b=0;b<this.getDrawing().childNodes.length;b++){var c=false;for(var a=0;(a<this.children.length)&&!c;a++){var e=this.children[a];if(e.getDrawing()===this.getDrawing().childNodes[b]){c=true}}if(!c){d.push(this.getDrawing().childNodes[b])}}for(var a=0;a<d.length;a++){this.getDrawing().removeChild(d[a])}}if(this.children.length!=this.getDrawing().childNodes.length){throw ("updateRenderChildren PROBLEM")}},onInternalStyleChange:function(){this.onStyleChange();for(var a=0;a<this.children.length;a++){this.children[a].setParentStyle(this.mergeStyle)}},onInternalDisable:function(){Ui.Container.base.onInternalDisable.call(this);for(var a=0;a<this.children.length;a++){this.children[a].setParentDisabled(true)}},onInternalEnable:function(){Ui.Container.base.onInternalEnable.call(this);for(var a=0;a<this.children.length;a++){this.children[a].setParentDisabled(false)}},});Ui.Container.extend("Ui.LBox",{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,constructor:function(a){if(a.padding!=undefined){this.setPadding(a.padding)}if(a.paddingTop!=undefined){this.setPaddingTop(a.paddingTop)}if(a.paddingBottom!=undefined){this.setPaddingBottom(a.paddingBottom)}if(a.paddingLeft!=undefined){this.setPaddingLeft(a.paddingLeft)}if(a.paddingRight!=undefined){this.setPaddingRight(a.paddingRight)}},setPadding:function(a){this.setPaddingTop(a);this.setPaddingBottom(a);this.setPaddingLeft(a);this.setPaddingRight(a)},getPaddingTop:function(){return this.paddingTop},setPaddingTop:function(a){if(this.paddingTop!=a){this.paddingTop=a;this.invalidateMeasure()}},getPaddingBottom:function(){return this.paddingBottom},setPaddingBottom:function(a){if(this.paddingBottom!=a){this.paddingBottom=a;this.invalidateMeasure()}},getPaddingLeft:function(){return this.paddingLeft},setPaddingLeft:function(a){if(this.paddingLeft!=a){this.paddingLeft=a;this.invalidateMeasure()}},getPaddingRight:function(){return this.paddingRight},setPaddingRight:function(a){if(this.paddingRight!=a){this.paddingRight=a;this.invalidateMeasure()}},append:function(a){this.appendChild(a)},remove:function(a){this.removeChild(a)},},{measureCore:function(e,n,d){var g=this.getPaddingLeft();var l=this.getPaddingRight();var k=this.getPaddingTop();var b=this.getPaddingBottom();var j=e-(g+l);var a=n-(k+b);var c=0;var m=0;for(var h=0;h<this.getChildren().length;h++){var f=this.getChildren()[h];var o=f.measure(j,a,d);if(o.width>c){c=o.width}if(o.height>m){m=o.height}}c+=g+l;m+=k+b;return{width:c,height:m}},arrangeCore:function(e,a,f){var h=this.getPaddingLeft();var d=this.getPaddingRight();var g=this.getPaddingTop();var b=this.getPaddingBottom();e-=h+d;a-=g+b;for(var c=0;c<this.getChildren().length;c++){this.getChildren()[c].arrange(h,g,e,a,f)}},});Ui.Container.extend("Ui.Box",{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,uniform:false,spacing:0,star:0,vertical:true,constructor:function(a){if(a.padding!=undefined){this.setPadding(a.padding)}if(a.paddingTop!=undefined){this.setPaddingTop(a.paddingTop)}if(a.paddingBottom!=undefined){this.setPaddingBottom(a.paddingBottom)}if(a.paddingLeft!=undefined){this.setPaddingLeft(a.paddingLeft)}if(a.paddingRight!=undefined){this.setPaddingRight(a.paddingRight)}if(a.uniform!=undefined){this.setUniform(a.uniform)}if(a.spacing!=undefined){this.setSpacing(a.spacing)}if(a.orientation!=undefined){this.setOrientation(a.orientation)}},getOrientation:function(){if(this.vertical){return"vertical"}else{return"horizontal"}},setOrientation:function(b){var a=true;if(b!="vertical"){a=false}if(this.vertical!=a){this.vertical=a;this.invalidateMeasure()}},setPadding:function(a){this.setPaddingTop(a);this.setPaddingBottom(a);this.setPaddingLeft(a);this.setPaddingRight(a)},getPaddingTop:function(){return this.paddingTop},setPaddingTop:function(a){if(this.paddingTop!=a){this.paddingTop=a;this.invalidateMeasure()}},getPaddingBottom:function(){return this.paddingBottom},setPaddingBottom:function(a){if(this.paddingBottom!=a){this.paddingBottom=a;this.invalidateMeasure()}},getPaddingLeft:function(){return this.paddingLeft},setPaddingLeft:function(a){if(this.paddingLeft!=a){this.paddingLeft=a;this.invalidateMeasure()}},getPaddingRight:function(){return this.paddingRight},setPaddingRight:function(a){if(this.paddingRight!=a){this.paddingRight=a;this.invalidateMeasure()}},getUniform:function(){return this.uniform},setUniform:function(a){if(this.uniform!=a){this.uniform=a;this.invalidateMeasure()}},getSpacing:function(){return this.spacing},setSpacing:function(a){if(this.spacing!=a){this.spacing=a;this.invalidateMeasure()}},append:function(b,a){if(a==undefined){a=false}b.boxResizable=a;this.appendChild(b)},remove:function(a){this.removeChild(a)},getResizable:function(a){return a.boxResizable},setResizable:function(b,a){if(b.boxResizable!=a){b.boxResizable=a;this.invalidateMeasure()}},measureUniform:function(e,o,d){var b=0;var n=0;var m;var a;if(this.vertical){o-=this.spacing*(this.getChildren().length-1);m=e;a=o/this.getChildren().length}else{e-=this.spacing*(this.getChildren().length-1);m=e/this.getChildren().length;a=o}var h=0;for(var k=0;k<this.getChildren().length;k++){var g=this.getChildren()[k];if(!g.boxResizable){var p=g.measure(m,a);if(p.width>b){b=p.width}if(p.height>n){n=p.height}}else{h++}}var c=0;if(h==0){c=(this.vertical?n:b)*this.getChildren().length}else{var l=(this.vertical?o:e)/this.getChildren().length;if(c>l){l=c}var j=0;var f=true;do{j=0;f=true;c=0;for(var k=0;k<this.getChildren().length;k++){var g=this.getChildren()[k];if(g.boxResizable){var p;if(this.vertical){p=g.measure(e,l)}else{p=g.measure(l,o)}if((this.vertical?p.height:p.width)>l){f=false;l=this.vertical?p.height:p.width;break}else{if((this.vertical?p.width:p.height)>j){j=this.vertical?p.width:p.height}}}}}while(!f);if(this.vertical){if(j>b){b=j}}else{if(j>n){n=j}}c=l*this.getChildren().length}c+=this.spacing*(this.getChildren().length-1);if(this.vertical){return{width:b,height:c}}else{return{width:c,height:n}}},measureNonUniform:function(n,m,b){var k=0;var h=0;var d=n;var e=m;if(this.vertical){e-=this.spacing*(this.getChildren().length-1)}else{d-=this.spacing*(this.getChildren().length-1)}var c=this.vertical?e:d;var r=0;var a=0;var o=0;for(var p=0;p<this.getChildren().length;p++){var g=this.getChildren()[p];if(!g.boxResizable){var l=g.measure(d,e);if((this.vertical?l.width:l.height)>o){o=this.vertical?l.width:l.height}a+=this.vertical?l.height:l.width}else{g.boxStarDone=false;r++}}if(r>0){var j=c-a;var f=0;var q=true;var s=j/r;do{f=0;q=true;a=0;for(var p=0;p<this.getChildren().length;p++){var g=this.getChildren()[p];if(!g.boxResizable){if(this.vertical){g.measure(d,g.getMeasureHeight(),b)}else{g.measure(g.getMeasureWidth(),e,b)}a+=this.vertical?g.getMeasureHeight():g.getMeasureWidth()}else{if(!g.boxStarDone){var l;if(this.vertical){l=g.measure(d,s,b)}else{l=g.measure(s,e,b)}if((this.vertical?l.height:l.width)>s){g.boxStarDone=true;q=false;j-=this.vertical?l.height:l.width;r--;s=j/r;break}else{if((this.vertical?l.width:l.height)>f){f=this.vertical?l.width:l.height}a+=s}}else{if((this.vertical?g.getMeasureWidth():g.getMeasureHeight())>f){f=this.vertical?g.getMeasureWidth():g.getMeasureHeight()}a+=this.vertical?g.getMeasureHeight():g.getMeasureWidth()}}}}while(!q);if(f>o){o=f}}a+=this.spacing*(this.getChildren().length-1);this.star=s;if(this.vertical){return{width:o,height:a}}else{return{width:a,height:o}}},},{measureCore:function(d,i,c){var e=this.getPaddingLeft();var h=this.getPaddingRight();var g=this.getPaddingTop();var b=this.getPaddingBottom();var f=d-(e+h);var a=i-(g+b);var j;if(this.uniform){j=this.measureUniform(f,a,c)}else{j=this.measureNonUniform(f,a,c)}j.width+=e+h;j.height+=g+b;return j},arrangeCore:function(c,l,b){var e=this.paddingLeft;var k=this.paddingRight;var h=this.paddingTop;var a=this.paddingBottom;c-=e+k;l-=h+a;var f=this.vertical?h:e;var j=((this.vertical?l:c)-this.spacing*(this.getChildren().length-1))/this.getChildren().length;for(var g=0;g<this.getChildren().length;g++){var d=this.getChildren()[g];if(!this.uniform){j=this.vertical?d.getMeasureHeight():d.getMeasureWidth();if(d.boxResizable&&(j<this.star)){j=this.star}}if(g!=0){f+=this.spacing}if(this.vertical){d.arrange(e,f,c,j,b)}else{d.arrange(f,h,j,l,b)}f+=j}},});Ui.Box.extend("Ui.VBox",{constructor:function(a){this.setOrientation("vertical")},});Ui.Box.extend("Ui.HBox",{constructor:function(a){this.setOrientation("horizontal")},});Ui.Container.extend("Ui.Flow",{uniform:false,uniformWidth:undefined,uniformHeight:undefined,constructor:function(a){if(a.uniform!=undefined){this.setUniform(a.uniform)}},getUniform:function(){return this.uniform},setUniform:function(a){if(this.uniform!=a){this.uniform=a;this.invalidateMeasure()}},append:function(a){this.appendChild(a)},remove:function(a){this.removeChild(a)},measureChildrenNonUniform:function(c,j,b){var m={pos:0,y:0,width:0,height:0};var k=0;var f=0;var d=0;var h=0;var a=0;for(var g=0;g<this.getChildren().length;g++){var e=this.getChildren()[g];var l=e.measure(c,j,b);if((f!=0)&&(f+l.width>c)){m.width=f;m.height=h;f=0;d+=h;h=0;m={pos:++k,y:d,width:0,height:0}}e.flowLine=m;e.flowLineX=f;f+=l.width;if(l.height>h){h=l.height}if(f>a){a=f}}d+=h;m.width=f;m.height=h;return{width:a,height:d}},measureChildrenUniform:function(b,j,a){var g=0;var h=0;for(var e=0;e<this.getChildren().length;e++){var c=this.getChildren()[e];var k=c.measure(b,j,a);if(k.width>g){g=k.width}if(k.height>h){h=k.height}}var d=Math.max(Math.floor(b/g),1);var f=Math.ceil(this.getChildren().length/d);for(var e=0;e<this.getChildren().length;e++){this.getChildren()[e].measure(g,h,a)}this.uniformWidth=g;this.uniformHeight=h;return{width:g*d,height:f*h}},},{measureCore:function(b,a,c){if(this.uniform){return this.measureChildrenUniform(b,a,c)}else{return this.measureChildrenNonUniform(b,a,c)}},arrangeCore:function(d,b,e){if(this.uniform){var a=0;var g=0;for(var c=0;c<this.getChildren().length;c++){var f=this.getChildren()[c];if(a+this.uniformWidth>d){a=0;g+=this.uniformHeight}f.arrange(a,g,this.uniformWidth,this.uniformHeight,e);a+=this.uniformWidth}}else{for(var c=0;c<this.getChildren().length;c++){var f=this.getChildren()[c];f.arrange(f.flowLineX,f.flowLine.y,f.getMeasureWidth(),f.flowLine.height,e)}}},});Ui.Container.extend("Ui.Grid",{cols:undefined,rows:undefined,constructor:function(b){if(b.cols!=undefined){this.cols=[];var e=b.cols.split(",");for(var c=0;c<e.length;c++){var a=e[c];if(a=="auto"){this.cols.push({auto:true,star:false,absolute:false,actualWidth:0,offset:0,width:0})}else{if(a=="*"){this.cols.push({auto:false,star:true,absolute:false,actualWidth:0,offset:0,width:1})}else{if(a.match(/^[0-9]+\.?[0-9]*\*$/)){this.cols.push({auto:false,star:true,absolute:false,actualWidth:0,offset:0,width:new Number(a.slice(0,a.length-1))})}else{this.cols.push({auto:false,star:false,absolute:true,actualWidth:0,offset:0,width:new Number(a)})}}}}}else{this.cols=[{auto:true,star:false,absolute:false,actualWidth:0,offset:0,width:0}]}if(b.rows!=undefined){this.rows=[];var d=b.rows.split(",");for(var c=0;c<d.length;c++){var f=d[c];if(f=="auto"){this.rows.push({auto:true,star:false,absolute:false,actualHeight:0,offset:0,height:0})}else{if(f=="*"){this.rows.push({auto:false,star:true,absolute:false,actualHeight:0,offset:0,height:1})}else{if(f.match(/^[0-9]+\.?[0-9]*\*$/)){this.rows.push({auto:false,star:true,absolute:false,actualHeight:0,offset:0,height:new Number(f.slice(0,f.length-1))})}else{this.rows.push({auto:false,star:false,absolute:true,actualHeight:0,offset:0,height:new Number(f)})}}}}}else{this.rows=[{auto:true,star:false,absolute:false,actualHeight:0,offset:0,height:0}]}},attach:function(e,a,d,c,b){if(c==undefined){c=1}if(b==undefined){b=1}e.gridCol=a;e.gridRow=d;e.gridColSpan=c;e.gridRowSpan=b;this.appendChild(e)},detach:function(a){a.gridCol=undefined;a.gridRow=undefined;a.gridColSpan=undefined;a.gridRowSpan=undefined;this.removeChild(a)},getColMin:function(g){var c=this.cols[g];var h=0;for(var k=0;k<this.getChildren().length;k++){var b=this.getChildren()[k];var l=b.gridCol;var j=b.gridColSpan;if((j==1)&&(l==g)){if(b.getMeasureWidth()>h){h=b.getMeasureWidth()}}else{if((l<=g)&&(l+j>g)){var d=true;var a=false;var f=0;for(var e=l;e<g;e++){var m=this.cols[e];f+=m.actualWidth;if(m.star){a=true;break}}if(!a){for(var e=g+1;e<l+j;e++){var m=this.cols[e];if(m.star){a=true;break}if(m.auto){d=false;break}}}if(!a&&d){if((b.getMeasureWidth()-f)>h){h=b.getMeasureWidth()-f}}}}}return h},getRowMin:function(a){var m=this.rows[a];var h=0;for(var j=0;j<this.getChildren().length;j++){var c=this.getChildren()[j];var g=c.gridRow;var k=c.gridRowSpan;if((k==1)&&(g==a)){if(c.getMeasureHeight()>h){h=c.getMeasureHeight()}}else{if((g<=a)&&(g+k>a)){var d=true;var b=false;var f=0;for(var e=g;e<a;e++){var l=this.rows[e];f+=l.actualHeight;if(l.star){b=true;break}}if(!b){for(var e=a+1;e<g+k;e++){var l=this.rows[e];if(l.star){b=true;break}if(l.auto){d=false;break}}}if(!b&&d){if((c.getMeasureHeight()-f)>h){h=c.getMeasureHeight()-f}}}}}return h},},{measureCore:function(t,s,a){for(var u=0;u<this.getChildren().length;u++){var m=this.getChildren()[u];var h=(t*m.gridColSpan)/this.cols.length;var j=(s*m.gridRowSpan)/this.rows.length;m.measure(h,j,a)}var e=0;var D=0;var d=0;var E=0;var B=0;for(var k=0;k<this.cols.length;k++){var l=this.cols[k];l.offset=B;if(l.absolute){l.actualWidth+=l.width}else{if(l.star){l.actualWidth=0;e+=l.width}else{if(l.auto){l.actualWidth=this.getColMin(k)}}}B+=l.actualWidth}var C=0;if(e>0){C=(t-B)/e}B=0;for(var u=0;u<this.cols.length;u++){var l=this.cols[u];l.offset=B;if(l.star){l.actualWidth=C*l.width}B+=l.actualWidth}for(var u=0;u<this.getChildren().length;u++){var m=this.getChildren()[u];var l=m.gridCol;var o=m.gridColSpan;var z=this.cols[l].offset;var b=0;for(var q=l;q<l+o;q++){b+=this.cols[q].actualWidth}m.measure(b,s)}B=0;for(var k=0;k<this.cols.length;k++){var l=this.cols[k];l.offset=B;if(l.absolute){l.actualWidth=l.width}else{if(l.star){l.actualWidth=Math.max(this.getColMin(k),C*l.width);D+=l.actualWidth}else{if(l.auto){l.actualWidth=this.getColMin(k)}}}B+=l.actualWidth}for(var u=0;u<this.getChildren().length;u++){var m=this.getChildren()[u];var l=m.gridCol;var o=m.gridColSpan;var z=this.cols[l].offset;var b=0;for(var q=l;q<l+o;q++){b+=this.cols[q].actualWidth}m.measure(b,s)}var A=0;for(var w=0;w<this.rows.length;w++){var n=this.rows[w];n.offset=A;if(n.absolute){n.actualHeight=n.height}else{if(n.star){n.actualHeight=0;d+=n.height}else{if(n.auto){n.actualHeight=this.getRowMin(w)}}}A+=n.actualHeight}var r=0;if(d>0){r=(s-A)/d}A=0;for(var u=0;u<this.rows.length;u++){var n=this.rows[u];n.offset=A;if(n.star){n.actualHeight=r*n.height}A+=n.actualHeight}for(var u=0;u<this.getChildren().length;u++){var m=this.getChildren()[u];var l=m.gridCol;var o=m.gridColSpan;var z=this.cols[l].offset;var b=0;for(var q=l;q<l+o;q++){b+=this.cols[q].actualWidth}var n=m.gridRow;var f=m.gridRowSpan;var v=this.rows[n].offset;var c=0;for(var p=n;p<n+f;p++){c+=this.rows[p].actualHeight}m.measure(b,c)}A=0;for(var w=0;w<this.rows.length;w++){var n=this.rows[w];n.offset=A;if(n.absolute){n.actualHeight=n.height}else{if(n.star){var g=this.getRowMin(w);n.actualHeight=Math.max(g,r*n.height);E+=n.actualHeight}else{if(n.auto){n.actualHeight=this.getRowMin(w)}}}A+=n.actualHeight}return{width:B,height:A}},arrangeCore:function(b,n,a){for(var f=0;f<this.getChildren().length;f++){var c=this.getChildren()[f];var e=c.gridCol;var g=c.gridColSpan;var p=c.gridRow;var h=c.gridRowSpan;var m=this.cols[e].offset;var l=this.rows[p].offset;var o=0;var d=0;for(var k=e;k<e+g;k++){o+=this.cols[k].actualWidth}for(var j=p;j<p+h;j++){d+=this.rows[j].actualHeight}c.arrange(m,l,o,d)}},});Ui.Container.extend("Ui.Fixed",{constructor:function(a){this.addEvents("resize")},setPosition:function(b,a,c){if(a!=undefined){b.fixedX=a}if(c!=undefined){b.fixedY=c}this.invalidateArrange()},append:function(c,a,b){c.fixedX=a;c.fixedY=b;this.appendChild(c)},},{measureCore:function(c,a,d){for(var b=0;b<this.getChildren().length;b++){this.getChildren()[b].measure(c,a,d)}return{width:0,height:0}},arrangeCore:function(c,a,d){this.fireEvent("resize",this,c,a);for(var b=0;b<this.getChildren().length;b++){var e=this.getChildren()[b];e.arrange((e.fixedX==undefined)?0:e.fixedX,(e.fixedY==undefined)?0:e.fixedY,e.getMeasureWidth(),e.getMeasureHeight(),d)}},});Ui.Container.extend("Ui.Fold",{headerBox:undefined,header:undefined,contentBox:undefined,content:undefined,offset:0,orientation:"horizontal",isFolded:true,over:true,mode:"extend",clock:undefined,contentSize:0,constructor:function(a){if(a.over!=undefined){this.over=a.over}if(a.extend!=undefined){this.extend=a.extend}if(a.orientation!=undefined){this.setOrientation(a.orientation)}this.headerBox=new Ui.Pressable();this.appendChild(this.headerBox);this.connect(this.headerBox,"press",this.onHeaderPress);this.contentBox=new Ui.LBox();this.appendChild(this.contentBox);this.contentBox.hide();if(a.header!=undefined){this.setHeader(a.header)}if(a.content!=undefined){this.setContent(a.content)}this.addEvents("fold","unfold","orientationchange")},getIsFolded:function(){return this.isFolded},fold:function(){if(!this.isFolded){this.isFolded=true;this.startAnimation();this.fireEvent("fold",this)}},unfold:function(){if(this.isFolded){this.isFolded=false;this.startAnimation();this.fireEvent("unfold",this)}},getOver:function(){return this.over},setOver:function(a){if(this.over!=a){this.over=a;this.stopAnimation();this.invalidateMeasure()}},getMode:function(){return this.mode},setMode:function(a){if(this.mode!=a){this.mode=a;this.stopAnimation();this.invalidateMeasure()}},getHeader:function(){return this.header},setHeader:function(a){if(a!=this.header){if(this.header!=undefined){this.headerBox.removeChild(this.header)}this.header=a;if(this.header!=undefined){this.headerBox.appendChild(this.header)}}},getContent:function(){return this.content},setContent:function(a){if(this.content!=a){if(this.content!=undefined){this.contentBox.removeChild(this.content)}this.content=a;if(this.content!=undefined){this.contentBox.appendChild(this.content)}}},getOrientation:function(){return this.orientation},setOrientation:function(a){if(this.orientation!=a){this.orientation=a;this.fireEvent("orientationchange",this,a);this.invalidateMeasure()}},getOffset:function(){return this.offset},setOffset:function(a){this.offset=a;if(!this.over){this.invalidateMeasure()}else{if(this.orientation=="horizontal"){if(this.mode=="slide"){this.setTransform(Ui.Matrix.createTranslate(-this.offset*this.contentSize,0))}this.contentBox.setClipRectangle(0,0,Math.round(this.contentSize*this.offset),this.getLayoutHeight())}else{if(this.mode=="slide"){this.setTransform(Ui.Matrix.createTranslate(0,-this.offset*this.contentSize))}this.contentBox.setClipRectangle(0,0,this.getLayoutWidth(),Math.round(this.contentSize*this.offset))}}},onHeaderPress:function(){if(this.isFolded){this.unfold()}else{this.fold()}},startAnimation:function(){if(this.clock!=undefined){this.clock.stop()}if(!this.isFolded){this.contentBox.show()}this.clock=new Anim.Clock({duration:2,target:this,callback:this.onClockTick});this.clock.begin()},stopAnimation:function(){if(this.clock!=undefined){this.clock.stop();this.clock=undefined}},onClockTick:function(b,a){if(this.content==undefined){if(this.clock!=undefined){this.clock.stop();this.clock=undefined}return}var d=this.getOffset();if(d>1){this.setOffset(1)}else{var c;if(this.isFolded){c=0}else{c=1}this.setOffset(c-((c-d)*(1-a)))}if((a==1)&&this.isFolded){console.log("hide content");this.contentBox.hide()}},},{measureCore:function(c,a,d){var b=this.headerBox.measure(c,a,d);var e={width:0,height:0};if(this.orientation=="horizontal"){e=this.contentBox.measure(c-b.width,a,d);if(e.height>b.height){b.height=e.height}if(!this.over){b.width+=e.width*this.offset}this.contentSize=e.width}else{e=this.contentBox.measure(c,a-b.height,d);if(e.width>b.width){b.width=e.width}if(!this.over){b.height+=e.height*this.offset}this.contentSize=e.height}return b},arrangeCore:function(b,a,c){if(this.orientation=="horizontal"){this.headerBox.arrange(0,0,this.headerBox.getMeasureWidth(),a,c);this.contentBox.arrange(this.headerBox.getMeasureWidth(),0,this.contentBox.getMeasureWidth(),a,c);this.contentBox.setClipRectangle(0,0,Math.round(this.contentSize*this.offset),Math.round(a))}else{this.headerBox.arrange(0,0,b,this.headerBox.getMeasureHeight(),c);this.contentBox.arrange(0,this.headerBox.getMeasureHeight(),b,this.contentBox.getMeasureHeight(),c);this.contentBox.setClipRectangle(0,0,Math.round(b),Math.round(this.contentSize*this.offset))}},});Ui.Container.extend("Ui.Accordeon",{current:0,clock:undefined,headersSize:0,contentSize:0,orientation:"horizontal",constructor:function(a){if(a.orientation!=undefined){this.setOrientation(a.orientation)}this.setClipToBounds(true)},getOrientation:function(){return this.orientation},setOrientation:function(a){if(this.orientation!=a){this.orientation=a;for(var b=0;b<this.getChildren().length;b++){this.getChildren()[b].setOrientation(a)}this.invalidateMeasure()}},setCurrentPage:function(b){for(var a=0;a<this.getChildren().length;a++){if(this.getChildren()[a]==b){this.setCurrentPosition(a);return}}},setCurrentPosition:function(a){this.current=a;if(this.clock!=undefined){this.clock.stop()}this.clock=new Anim.Clock({duration:2,target:this,callback:this.onClockTick});this.clock.begin()},appendPage:function(a){this.appendChild(a);a.setOffset(1);a.setOrientation(this.orientation);this.connect(a,"select",this.onPageSelect);this.connect(a,"close",this.onPageClose);this.setCurrentPage(a)},removePage:function(b){var c=-1;for(var a=0;a<this.getChildren().length;a++){if(this.getChildren()[a]==b){c=a;break}}if(c!=-1){this.disconnect(b,"select",this.onPageSelect);this.disconnect(b,"close",this.onPageClose);this.removeChild(b);if((this.current==c)&&(this.current==0)){this.setCurrentPosition(0)}else{if(this.current>=c){this.setCurrentPosition(this.current-1)}else{this.setCurrentPosition(this.current)}}}},onClockTick:function(c,a){for(var b=0;b<this.getChildren().length;b++){var f=this.getChildren()[b];if(b==this.current){f.showContent()}var e=f.getOffset();if(e>1){f.setOffset(1)}else{var d;if(b<=this.current){d=0}else{d=1}f.setOffset(d-((d-e)*(1-a)))}if((a==1)&&(b!=this.current)){f.hideContent()}}},onPageSelect:function(a){this.setCurrentPage(a)},onPageClose:function(a){this.removePage(a)},measureHorizontal:function(b,j,a){var d=0;var g=0;var h=0;for(var e=0;e<this.getChildren().length;e++){var c=this.getChildren()[e];var k=c.measure(b,j,a);d+=c.getHeader().getMeasureWidth();if(c.getHeader().getMeasureHeight()>h){h=c.getHeader().getMeasureHeight()}}for(var e=0;e<this.getChildren().length;e++){var c=this.getChildren()[e];var k=c.measure((b-d)+c.getHeader().getMeasureWidth(),j,a);var f=c.getContent();if((f!=undefined)&&(f.getMeasureWidth()>g)){g=f.getMeasureWidth();if(f.getMeasureHeight()>h){h=f.getMeasureHeight()}}}this.headersSize=d;return{width:d+g,height:h}},measureVertical:function(c,j,b){var e=0;var h=0;var a=0;for(var f=0;f<this.getChildren().length;f++){var d=this.getChildren()[f];var k=d.measure(c,j,b);e+=d.getHeader().getMeasureHeight();if(d.getHeader().getMeasureWidth()>a){a=d.getHeader().getMeasureWidth()}}for(var f=0;f<this.getChildren().length;f++){var d=this.getChildren()[f];var k=d.measure(c,(j-e)+d.getHeader().getMeasureHeight(),b);var g=d.getContent();if((g!=undefined)&&(g.getMeasureHeight()>h)){h=g.getMeasureHeight();if(g.getMeasureWidth()>a){a=g.getMeasureWidth()}}}this.headersSize=e;return{width:a,height:e+h}},},{measureCore:function(b,a,c){if(this.orientation=="horizontal"){return this.measureHorizontal(b,a,c)}else{return this.measureVertical(b,a,c)}},arrangeCore:function(d,b,e){if(this.orientation=="horizontal"){var a=0;this.contentSize=d-this.headersSize;for(var c=0;c<this.getChildren().length;c++){var g=this.getChildren()[c];g.arrange(a,0,this.contentSize+g.getHeader().getMeasureWidth(),b,e);a+=g.getHeader().getMeasureWidth()}}else{var f=0;this.contentSize=b-this.headersSize;for(var c=0;c<this.getChildren().length;c++){var g=this.getChildren()[c];g.arrange(0,f,d,this.contentSize+g.getHeader().getMeasureHeight(),e);f+=g.getHeader().getMeasureHeight()}}},});Ui.Container.extend("Ui.AccordeonPage",{headerBox:undefined,header:undefined,content:undefined,offset:0,orientation:"horizontal",constructor:function(a){if(a.orientation!=undefined){this.setOrientation(a.orientation)}this.headerBox=new Ui.Pressable();this.appendChild(this.headerBox);this.connect(this.headerBox,"press",this.onHeaderPress);if(a.header!=undefined){this.setHeader(a.header)}if(a.content!=undefined){this.setContent(a.content)}this.addEvents("select","close","orientationchange")},close:function(){this.fireEvent("close",this)},showContent:function(){if(this.content!=undefined){this.content.show()}},hideContent:function(){if(this.content!=undefined){this.content.hide()}},getHeader:function(){return this.header},setHeader:function(a){if(a!=this.header){if(this.header!=undefined){this.headerBox.removeChild(this.header)}this.header=a;if(this.header!=undefined){this.headerBox.appendChild(this.header)}}},getContent:function(){return this.content},setContent:function(a){if(this.content!=a){if(this.content!=undefined){this.removeChild(this.content)}this.content=a;if(this.content!=undefined){this.appendChild(this.content,true)}}},getOrientation:function(){return this.orientation},setOrientation:function(a){if(this.orientation!=a){this.orientation=a;this.fireEvent("orientationchange",this,a);this.invalidateMeasure()}},getOffset:function(){return this.offset},setOffset:function(a){this.offset=a;if(this.orientation=="horizontal"){this.setTransform(Ui.Matrix.createTranslate(this.offset*(this.getLayoutWidth()-this.headerBox.getMeasureWidth()),0))}else{this.setTransform(Ui.Matrix.createTranslate(0,this.offset*(this.getLayoutHeight()-this.headerBox.getMeasureHeight())))}},onHeaderPress:function(){this.fireEvent("select",this)},},{measureCore:function(c,a,d){var b=this.headerBox.measure(c,a,d);var e={width:0,height:0};if(this.content!=undefined){if(this.orientation=="horizontal"){e=this.content.measure(c-b.width,a,d);if(e.height>b.height){b.height=e.height}b.width+=e.width}else{e=this.content.measure(c,a-b.height,d);if(e.width>b.width){b.width=e.width}b.height+=e.height}}return b},arrangeCore:function(b,a,c){if(this.orientation=="horizontal"){this.headerBox.arrange(0,0,this.headerBox.getMeasureWidth(),a,c);if(this.content!=undefined){this.content.arrange(this.headerBox.getMeasureWidth(),0,b-this.headerBox.getMeasureWidth(),a,c)}}else{this.headerBox.arrange(0,0,b,this.headerBox.getMeasureHeight(),c);if(this.content!=undefined){this.content.arrange(0,this.headerBox.getMeasureHeight(),b,a-this.headerBox.getMeasureHeight(),c)}}this.setOffset(this.offset)},});Ui.Element.extend("Ui.Spacer",{constructor:function(a){},});Ui.Element.extend("Ui.Rectangle",{fill:"black",rectDrawing:undefined,radiusTopLeft:0,radiusTopRight:0,radiusBottomLeft:0,radiusBottomRight:0,shadow:undefined,constructor:function(a){if(a.radius!=undefined){this.setRadius(a.radius)}if(a.radiusTopLeft!=undefined){this.setRadiusTopLeft(a.radiusTopLeft)}if(a.radiusTopRight!=undefined){this.setRadiusTopRight(a.radiusTopRight)}if(a.radiusBottomLeft!=undefined){this.setRadiusBottomLeft(a.radiusBottomLeft)}if(a.radiusBottomRight!=undefined){this.setRadiusBottomRight(a.radiusBottomRight)}if(a.fill!=undefined){this.setFill(a.fill)}else{this.setFill(this.fill)}if(a.shadow!=undefined){this.setShadow(a.shadow)}},setShadow:function(a){if(this.shadow!=a){this.shadow=a;this.invalidateRender()}},getBoxShadow:function(){return this.shadow},setRadius:function(a){this.setRadiusTopLeft(a);this.setRadiusTopRight(a);this.setRadiusBottomLeft(a);this.setRadiusBottomRight(a)},getRadiusTopLeft:function(){return this.radiusTopLeft},setRadiusTopLeft:function(a){if(this.radiusTopLeft!=a){this.radiusTopLeft=a;this.invalidateRender()}},getRadiusTopRight:function(){return this.radiusTopRight},setRadiusTopRight:function(a){if(this.radiusTopRight!=a){this.radiusTopRight=a;this.invalidateRender()}},getRadiusBottomLeft:function(){return this.radiusBottomLeft},setRadiusBottomLeft:function(a){if(this.radiusBottomLeft!=a){this.radiusBottomLeft=a;this.invalidateRender()}},getRadiusBottomRight:function(){return this.radiusBottomRight},setRadiusBottomRight:function(a){if(this.radiusBottomRight!=a){this.radiusBottomRight=a;this.invalidateRender()}},setFill:function(a){if(this.fill!=a){this.fill=a;this.invalidateRender()}},getFill:function(){return this.fill},},{render:function(){this.rectDrawing=document.createElementNS(htmlNS,"div");return this.rectDrawing},arrangeCore:function(b,a){this.rectDrawing.style.setProperty("width",b+"px",null);this.rectDrawing.style.setProperty("height",a+"px",null)},updateRenderCore:function(){if(Ui.Rectangle.supportBorderRadius){this.rectDrawing.style.setProperty("border-top-left-radius",this.getRadiusTopLeft()+"px",null);this.rectDrawing.style.setProperty("border-top-right-radius",this.getRadiusTopRight()+"px",null);this.rectDrawing.style.setProperty("border-bottom-left-radius",this.getRadiusBottomLeft()+"px",null);this.rectDrawing.style.setProperty("border-bottom-right-radius",this.getRadiusBottomRight()+"px",null)}else{if(Ui.Rectangle.supportMozBorderRadius){this.rectDrawing.style.setProperty("-moz-border-radius-topleft",this.getRadiusTopLeft()+"px",null);this.rectDrawing.style.setProperty("-moz-border-radius-topright",this.getRadiusTopRight()+"px",null);this.rectDrawing.style.setProperty("-moz-border-radius-bottomleft",this.getRadiusBottomLeft()+"px",null);this.rectDrawing.style.setProperty("-moz-border-radius-bottomright",this.getRadiusBottomRight()+"px",null)}else{if(Ui.Rectangle.supportWebkitBorderRadius){this.rectDrawing.style.setProperty("-webkit-border-top-left-radius",this.getRadiusTopLeft()+"px",null);this.rectDrawing.style.setProperty("-webkit-border-top-right-radius",this.getRadiusTopRight()+"px",null);this.rectDrawing.style.setProperty("-webkit-border-bottom-left-radius",this.getRadiusBottomLeft()+"px",null);this.rectDrawing.style.setProperty("-webkit-border-bottom-right-radius",this.getRadiusBottomRight()+"px",null)}}}var a="none";if(this.shadow!=undefined){a=this.shadow}if(Ui.Rectangle.supportBoxShadow){this.rectDrawing.style.setProperty("box-shadow",a,null)}else{if(Ui.Rectangle.supportMozBoxShadow){this.rectDrawing.style.setProperty("-moz-box-shadow",a,null)}else{if(Ui.Rectangle.supportWebkitBoxShadow){this.rectDrawing.style.setProperty("-webkit-box-shadow",a,null)}}}this.rectDrawing.style.setProperty("background",this.getFill(),null)},});Ui.Rectangle.supportBorderRadius=false;Ui.Rectangle.supportMozBorderRadius=false;Ui.Rectangle.supportWebkitBorderRadius=false;var test=document.createElementNS(htmlNS,"div");test.style.setProperty("border-top-left-radius","8px",null);var res=test.style.getPropertyValue("border-top-left-radius");if((res!=null)&&(res!=undefined)&&(res!="")){Ui.Rectangle.supportBorderRadius=true}else{test.style.setProperty("-moz-border-radius-topleft","8px",null);res=test.style.getPropertyValue("-moz-border-radius-topleft");if((res!=null)&&(res!=undefined)&&(res!="")){Ui.Rectangle.supportMozBorderRadius=true}else{test.style.setProperty("-webkit-border-top-left-radius","8px",null);res=test.style.getPropertyValue("-webkit-border-top-left-radius");if((res!=null)&&(res!=undefined)&&(res!="")){Ui.Rectangle.supportWebkitBorderRadius=true}}}Ui.Rectangle.supportBoxShadow=false;Ui.Rectangle.supportMozBoxShadow=false;Ui.Rectangle.supportWebkitBoxShadow=false;test.style.setProperty("box-shadow","0px 0px 4px black",null);var res=test.style.getPropertyValue("box-shadow");if((res!=null)&&(res!=undefined)&&(res!="")){Ui.Rectangle.supportBoxShadow=true}else{test.style.setProperty("-moz-box-shadow","0px 0px 4px black",null);res=test.style.getPropertyValue("-moz-box-shadow");if((res!=null)&&(res!=undefined)&&(res!="")){Ui.Rectangle.supportMozBoxShadow=true}else{test.style.setProperty("-webkit-box-shadow","0px 0px 4px black",null);res=test.style.getPropertyValue("-webkit-box-shadow");if((res!=null)&&(res!=undefined)&&(res!="")){Ui.Rectangle.supportWebkitBoxShadow=true}}}test=undefined;Ui.Element.extend("Ui.Label",{text:"",orientation:"horizontal",fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal",color:"black",constructor:function(a){if(a.text!=undefined){this.setText(a.text)}if(a.fontSize!=undefined){this.setFontSize(a.fontSize)}if(a.fontFamily!=undefined){this.setFontFamily(a.fontFamily)}if(a.fontWeight!=undefined){this.setFontWeight(a.fontWeight)}if(a.color!=undefined){this.setColor(a.color)}if(a.orientation!=undefined){this.setOrientation(a.orientation)}},getText:function(){return this.text},setText:function(a){if(this.text!=a){this.text=a;this.invalidateMeasure();this.invalidateRender()}},setFontSize:function(a){if(this.fontSize!=a){this.fontSize=a;this.invalidateRender();this.invalidateMeasure()}},getFontSize:function(){return this.fontSize},setFontFamily:function(a){if(this.fontFamily!=a){this.fontFamily=a;this.invalidateRender();this.invalidateMeasure()}},getFontFamily:function(){return this.fontFamily},setFontWeight:function(a){if(this.fontWeight!=a){this.fontWeight=a;this.invalidateRender();this.invalidateMeasure()}},getFontWeight:function(){return this.fontWeight},setColor:function(a){if(this.color!=a){this.color=a;this.invalidateRender()}},getColor:function(){return this.color},getOrientation:function(){return this.orientation},setOrientation:function(a){if(this.orientation!=a){this.orientation=a;this.invalidateMeasure();this.invalidateRender()}},},{verticalAlign:"center",horizontalAlign:"center",render:function(){this.labelDrawing=document.createElementNS(htmlNS,"div");this.labelDrawing.style.setProperty("white-space","nowrap",null);this.labelDrawing.style.setProperty("display","inline",null);this.labelDrawing.style.setProperty("position","absolute",null);this.labelDrawing.style.setProperty("left","0px",null);this.labelDrawing.style.setProperty("top","0px",null);if(navigator.isWebkit){this.labelDrawing.style.webkitUserSelect="none"}else{if(navigator.isGecko){this.labelDrawing.style.setProperty("-moz-user-select","none",null)}else{if(navigator.isIE){this.labelDrawing.onselectstart=function(a){a.preventDefault()}}else{if(navigator.isOpera){this.labelDrawing.onmousedown=function(a){a.preventDefault()}}}}}this.labelDrawing.style.pointerEvents="none";return this.labelDrawing},measureCore:function(b,a,c){if(this.orientation=="vertical"){return{width:this.labelDrawing.offsetHeight,height:this.labelDrawing.offsetWidth}}else{return{width:this.labelDrawing.offsetWidth,height:this.labelDrawing.offsetHeight}}},arrangeCore:function(c,a){var b;if(this.orientation=="vertical"){b=Ui.Matrix.createTranslate(this.labelDrawing.offsetHeight,0);b.rotate(90)}else{b=new Ui.Matrix()}if(navigator.isIE){this.drawing.style.msTransform=b.toString();this.drawing.style.msTransformOrigin="0% 0%"}else{if(navigator.isGecko){this.drawing.style.setProperty("-moz-transform","matrix("+b.svgMatrix.a.toFixed(4)+", "+b.svgMatrix.b.toFixed(4)+", "+b.svgMatrix.c.toFixed(4)+", "+b.svgMatrix.d.toFixed(4)+", "+b.svgMatrix.e.toFixed(0)+"px, "+b.svgMatrix.f.toFixed(0)+"px)",null);this.drawing.style.setProperty("-moz-transform-origin","0% 0%",null)}else{if(navigator.isWebkit){this.drawing.style.webkitTransform=b.toString();this.drawing.style.webkitTransformOrigin="0% 0%"}else{if(navigator.isOpera){this.drawing.style.setProperty("-o-transform",b.toString(),null);this.drawing.style.setProperty("-o-transform-origin","0% 0%",null)}}}}},updateRenderCore:function(){this.labelDrawing.style.setProperty("font-family",this.getFontFamily(),null);this.labelDrawing.style.setProperty("font-weight",this.getFontWeight(),null);this.labelDrawing.style.setProperty("font-size",this.getFontSize()+"px",null);this.labelDrawing.textContent=this.text;this.labelDrawing.style.setProperty("color",this.getColor(),null)},});Ui.SVGElement.extend("Ui.Text",{text:undefined,measureDrawing:undefined,textDrawing:undefined,line:undefined,word:undefined,flowRender:false,offsetX:0,offsetY:0,spaceWidth:undefined,maxWidth:undefined,lineHeight:undefined,fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal",color:"black",constructor:function(a){if(a.text!=undefined){this.setText(a.text)}if(a.fontSize!=undefined){this.setFontSize(a.fontSize)}if(a.fontFamily!=undefined){this.setFamilySize(a.fontFamily)}if(a.fontWeight!=undefined){this.setFontWeight(a.fontWeight)}if(a.color!=undefined){this.setColor(a.color)}},getText:function(){return this.text},setText:function(a){if(this.text!=a){this.text=a;this.invalidateMeasure();this.invalidateRender()}},setFontSize:function(a){if(this.fontSize!=a){this.fontSize=a;this.invalidateRender();this.invalidateMeasure()}},getFontSize:function(){return this.fontSize},setFontFamily:function(a){if(this.fontFamily!=a){this.fontFamily=a;this.invalidateRender();this.invalidateMeasure()}},getFontFamily:function(){return this.fontFamily},setFontWeight:function(a){if(this.fontWeight!=a){this.fontWeight=a;this.invalidateRender();this.invalidateMeasure()}},getFontWeight:function(){return this.fontWeight},setColor:function(a){if(this.color!=a){this.color=a;this.invalidateRender()}},getColor:function(){return this.color},addWord:function(c){var a=this.measureText(c);if(a>this.maxWidth){this.maxWidth=a}var b=this.offsetX+a;if(this.line!=""){b+=this.spaceWidth}if(b>this.maxWidth){this.flushLine(this.offsetX)}if(this.line!=""){this.line+=" ";this.offsetX+=this.spaceWidth}this.line+=c;this.offsetX+=a;c=""},newLine:function(){this.flushLine(this.offsetX)},flushLine:function(a){if(this.flowRender&&(this.line!="")){var b=document.createElementNS(svgNS,"tspan");b.setAttributeNS(null,"x",0);b.setAttributeNS(null,"y",this.offsetY);b.textContent=this.line;this.textDrawing.appendChild(b)}this.offsetX=0;this.offsetY+=this.lineHeight;this.line=""},measureText:function(d){this.measureDrawing.textContent=d;var a;if(navigator.isGecko){var c=this.measureDrawing.getBBox();a=c.width}else{try{a=this.measureDrawing.getComputedTextLength()}catch(b){var c=this.measureDrawing.getBBox();a=c.width}}return a},updateFlow:function(d,c){this.flowRender=c;this.maxWidth=d;this.lineHeight=this.getFontSize();this.offsetX=0;this.offsetY=this.lineHeight;this.line="";this.spaceWidth=undefined;var a=0;var e="";var b=0;this.spaceWidth=this.measureText("x");for(b=0;b<this.text.length;b++){if((this.text[b]==" ")||(this.text[b]=="\n")){if(e!=""){this.addWord(e);e=""}if(this.text[b]=="\n"){this.newLine()}}else{e+=this.text[b]}}if(e!=""){this.addWord(e)}if(this.line!=""){this.lineHeight*=0.33;this.newLine()}},},{renderSVG:function(){var a=document.createElementNS(svgNS,"g");this.measureDrawing=document.createElementNS(svgNS,"text");this.measureDrawing.setAttributeNS(null,"visibility","hidden");a.appendChild(this.measureDrawing);this.textDrawing=document.createElementNS(svgNS,"text");if(navigator.isWebkit){this.textDrawing.style.webkitUserSelect="none"}else{if(navigator.isGecko){this.textDrawing.style.setProperty("-moz-user-select","none",null)}else{if(navigator.isIE){this.textDrawing.onselectstart=function(b){b.preventDefault()}}else{if(navigator.isOpera){this.textDrawing.onmousedown=function(b){b.preventDefault()}}}}}this.textDrawing.style.pointerEvents="none";a.appendChild(this.textDrawing);return a},measureCore:function(b,a,c){if(this.getWidth()!=undefined){b=this.getWidth()}this.updateFlow(b,false);return{width:this.maxWidth,height:this.offsetY}},arrangeCore:function(b,a){while(this.textDrawing.hasChildNodes()){this.textDrawing.removeChild(this.textDrawing.firstChild)}this.updateFlow(b,true)},updateRenderCore:function(){this.textDrawing.setAttributeNS(null,"font-family",this.getFontFamily());this.textDrawing.setAttributeNS(null,"font-weight",this.getFontWeight());this.textDrawing.setAttributeNS(null,"font-size",this.getFontSize());this.textDrawing.setAttributeNS(null,"fill",this.getColor(),null);this.measureDrawing.setAttributeNS(null,"font-family",this.getFontFamily());this.measureDrawing.setAttributeNS(null,"font-weight",this.getFontWeight());this.measureDrawing.setAttributeNS(null,"font-size",this.getFontSize())},});Ui.Element.extend("Ui.Html",{htmlDrawing:undefined,constructor:function(a){if(a.html!=undefined){this.setHtml(a.html)}},getHtml:function(){return this.htmlDrawing.innerHTML},setHtml:function(a){this.htmlDrawing.innerHTML=a},},{render:function(){this.htmlDrawing=document.createElementNS(htmlNS,"div");this.htmlDrawing.style.setProperty("display","inline",null);if(navigator.isWebkit){this.htmlDrawing.style.webkitUserSelect="none"}else{if(navigator.isGecko){this.htmlDrawing.style.setProperty("-moz-user-select","none",null)}else{if(navigator.isIE){this.htmlDrawing.onselectstart=function(a){a.preventDefault()}}else{if(navigator.isOpera){this.htmlDrawing.onmousedown=function(a){a.preventDefault()}}}}}this.htmlDrawing.style.pointerEvents="none";return this.htmlDrawing},measureCore:function(b,a,c){if(this.measureTask==undefined){this.htmlDrawing.style.setProperty("width",b+"px",null);this.measureTask=new Core.DelayedTask({delay:0,scope:this,callback:this.invalidateMeasure})}else{this.measureTask=undefined}return{width:this.htmlDrawing.offsetWidth,height:this.htmlDrawing.offsetHeight}},arrangeCore:function(b,a){this.htmlDrawing.style.setProperty("width",b+"px",null)},});Ui.Element.extend("Ui.Image",{src:undefined,loaddone:false,naturalWidth:undefined,naturalHeight:undefined,constructor:function(a){if(a.src!=undefined){this.setSrc(a.src)}this.connect(this.imageDrawing,"load",this.onImageLoad);this.addEvents("ready")},getSrc:function(){return this.src},setSrc:function(a){this.loaddone=false;this.naturalWidth=undefined;this.naturalHeight=undefined;this.src=a;this.imageDrawing.setAttributeNS(null,"src",a)},getNaturalWidth:function(){return this.naturalWidth},getNaturalHeight:function(){return this.naturalHeight},getIsReady:function(){return this.loaddone},onImageLoad:function(a){this.loaddone=true;if((a.target.naturalWidth!=undefined)&&(a.target.naturalHeight!=undefined)){this.naturalWidth=a.target.naturalWidth;this.naturalHeight=a.target.naturalHeight}else{this.imageDrawing.style.removeProperty("width");this.imageDrawing.style.removeProperty("height");this.naturalWidth=a.target.width;this.naturalHeight=a.target.height}this.fireEvent("ready",this);this.invalidateMeasure()},},{render:function(){this.imageDrawing=document.createElementNS(htmlNS,"img");this.imageDrawing.style.setProperty("width","0px",null);this.imageDrawing.style.setProperty("height","0px",null);this.imageDrawing.setAttributeNS(null,"draggable",false);return this.imageDrawing},measureCore:function(d,a,e){if(!this.loaddone){return{width:0,height:0}}var c;if(this.getWidth()==undefined){if(this.getHeight()==undefined){c={width:this.naturalWidth,height:this.naturalHeight}}else{var b=this.getHeight()-(this.getMarginTop()+this.getMarginBottom());c={width:(this.naturalWidth*b)/this.naturalHeight,height:b}}}else{if(this.getHeight()==undefined){var f=this.getWidth()-(this.getMarginLeft()+this.getMarginRight());c={width:f,height:(this.naturalHeight*f)/this.naturalWidth}}else{c={width:0,height:0}}}return c},arrangeCore:function(b,a){this.imageDrawing.style.setProperty("width",b+"px",null);this.imageDrawing.style.setProperty("height",a+"px",null)},});Ui.Element.extend("Ui.Audio",{src:undefined,oggSrc:undefined,mp3Src:undefined,wavSrc:undefined,loaddone:false,audioDrawing:undefined,playing:false,paused:false,constructor:function(a){if((a.oggSrc!=undefined)||(a.mp3Src!=undefined)||(a.wavSrc!=undefined)){if((a.oggSrc!=undefined)&&(Ui.Audio.supportOgg)){this.setSrc(a.oggSrc)}else{if((a.mp3Src!=undefined)&&(Ui.Audio.supportMp3)){this.setSrc(a.mp3Src)}else{if((a.wavSrc!=undefined)&&(Ui.Audio.supportWav)){this.setSrc(a.wavSrc)}}}}else{if(a.src!=undefined){this.setSrc(a.src)}}if(a.volume!=undefined){this.setVolume(a.volume)}this.addEvents("ready","ended","timeupdate")},setSrc:function(a){this.loaddone=false;this.src=a;if(Ui.Audio.htmlAudio){this.audioDrawing.setAttributeNS(null,"src",a)}},play:function(){if(Ui.Audio.htmlAudio){try{this.audioDrawing.pause();this.audioDrawing.currentTime=0}catch(a){}this.audioDrawing.play()}this.playing=true;this.paused=false},pause:function(){if(!this.playing||this.paused){return}this.paused=true;if(Ui.Audio.htmlAudio){this.audioDrawing.pause()}},stop:function(){if(!this.playing){return}if(!this.paused){this.audioDrawing.pause()}this.onEnded()},resume:function(){if(!this.playing||!this.paused){return}this.paused=false;if(Ui.Audio.htmlAudio){this.audioDrawing.play()}},setVolume:function(a){if(Ui.Audio.htmlAudio){this.audioDrawing.volume=a}},getVolume:function(){if(Ui.Audio.htmlAudio){return this.audioDrawing.volume}return 1},getDuration:function(){return this.audioDrawing.duration},onReady:function(){this.fireEvent("ready")},onTimeupdate:function(){this.fireEvent("timeupdate",this.audioDrawing.currentTime)},onEnded:function(){this.playing=false;this.fireEvent("ended")},},{verticalAlign:"top",horizontalAlign:"left",render:function(){var a;if(Ui.Audio.htmlAudio){this.audioDrawing=document.createElementNS(htmlNS,"audio");this.audioDrawing.style.setProperty("display","none",null);this.connect(this.audioDrawing,"canplaythrough",this.onReady);this.connect(this.audioDrawing,"ended",this.onEnded);this.connect(this.audioDrawing,"timeupdate",this.onTimeupdate);this.audioDrawing.setAttributeNS(null,"preload","auto");this.audioDrawing.load();a=this.audioDrawing}return a},});Ui.Audio.htmlAudio=false;Ui.Audio.flashAudio=false;Ui.Audio.supportOgg=false;Ui.Audio.supportMp3=false;Ui.Audio.supportWav=false;Ui.Audio.audioTest=document.createElementNS(htmlNS,"audio");if(Ui.Audio.audioTest.play!=undefined){Ui.Audio.htmlAudio=true;Ui.Audio.supportWav=!!Ui.Audio.audioTest.canPlayType&&""!=Ui.Audio.audioTest.canPlayType("audio/wav");Ui.Audio.supportMp3=!!Ui.Audio.audioTest.canPlayType&&""!=Ui.Audio.audioTest.canPlayType("audio/mpeg");Ui.Audio.supportOgg=!!Ui.Audio.audioTest.canPlayType&&""!=Ui.Audio.audioTest.canPlayType('audio/ogg; codecs="vorbis"')}Ui.Audio.audioTest=undefined;Ui.Element.extend("Ui.Video",{src:undefined,oggSrc:undefined,mp3Src:undefined,webmSrc:undefined,loaddone:false,videoDrawing:undefined,playing:false,paused:false,constructor:function(a){if((a.oggSrc!=undefined)||(a.mp4Src!=undefined)||(a.webmSrc!=undefined)){if((a.oggSrc!=undefined)&&(Ui.Video.supportOgg)){this.setSrc(a.oggSrc)}else{if((a.mp4Src!=undefined)&&(Ui.Video.supportMp4)){this.setSrc(a.mp4Src)}else{if((a.webmSrc!=undefined)&&(Ui.Video.supportWebm)){this.setSrc(a.webmSrc)}}}}else{if(a.src!=undefined){this.setSrc(a.src)}}if(a.volume!=undefined){this.setVolume(a.volume)}this.addEvents("ready","ended","timeupdate")},setSrc:function(a){this.loaddone=false;this.src=a;if(Ui.Video.htmlVideo){this.videoDrawing.setAttributeNS(null,"src",a)}},play:function(){if(Ui.Video.htmlVideo){try{this.videoDrawing.pause();this.videoDrawing.currentTime=0}catch(a){}this.videoDrawing.play()}this.playing=true;this.paused=false},pause:function(){if(!this.playing||this.paused){return}this.paused=true;if(Ui.Video.htmlVideo){this.videoDrawing.pause()}},stop:function(){if(!this.playing){return}if(!this.paused){if(Ui.Video.htmlVideo){this.videoDrawing.pause();this.videoDrawing.currentTime=0}}this.onEnded()},resume:function(){if(!this.playing||!this.paused){return}this.paused=false;if(Ui.Video.htmlVideo){this.videoDrawing.play()}},setVolume:function(a){if(Ui.Video.htmlVideo){this.videoDrawing.volume=a}},getVolume:function(){if(Ui.Video.htmlVideo){return this.videoDrawing.volume}return 1},getDuration:function(){return this.videoDrawing.duration},onReady:function(){this.fireEvent("ready")},onTimeupdate:function(){this.fireEvent("timeupdate",this.videoDrawing.currentTime)},onEnded:function(){this.playing=false;this.fireEvent("ended")},},{render:function(){var a;if(Ui.Video.htmlVideo){this.videoDrawing=document.createElementNS(htmlNS,"video");this.connect(this.videoDrawing,"canplaythrough",this.onReady);this.connect(this.videoDrawing,"ended",this.onEnded);this.connect(this.videoDrawing,"timeupdate",this.onTimeupdate);this.videoDrawing.setAttributeNS(null,"preload","auto");this.videoDrawing.load();this.videoDrawing.style.setProperty("position","absolute",null);this.videoDrawing.style.setProperty("left","0px",null);this.videoDrawing.style.setProperty("top","0px",null);a=this.videoDrawing}return a},arrangeCore:function(b,a){if(Ui.Video.htmlVideo){this.videoDrawing.setAttributeNS(null,"width",b);this.videoDrawing.setAttributeNS(null,"height",a)}},});Ui.Video.htmlVideo=false;Ui.Video.flashVideo=false;Ui.Video.supportOgg=false;Ui.Video.supportMp4=false;Ui.Video.supportWebm=false;Ui.Video.videoTest=document.createElementNS(htmlNS,"video");if(Ui.Video.videoTest.play!=undefined){Ui.Video.htmlVideo=true;Ui.Video.supportMp4=!!Ui.Video.videoTest.canPlayType&&""!=Ui.Video.videoTest.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');Ui.Video.supportOgg=!!Ui.Video.videoTest.canPlayType&&""!=Ui.Video.videoTest.canPlayType('video/ogg; codecs="theora, vorbis"');Ui.Video.supportWebm=!!Ui.Video.videoTest.canPlayType&&""!=Ui.Video.videoTest.canPlayType('video/webm; codecs="vp8, vorbis"')}Ui.Video.videoTest=undefined;Ui.LBox.extend("Ui.Pressable",{isEnable:true,isDown:false,constructor:function(a){this.getDrawing().style.setProperty("cursor","pointer",null);this.setFocusable(true);this.setRole("button");this.addEvents("press","down","up");this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"touchstart",this.onTouchStart);this.connect(this.getDrawing(),"touchmove",this.onTouchMove);this.connect(this.getDrawing(),"touchend",this.onTouchEnd);this.connect(this,"keydown",this.onKeyDown)},onMouseDown:function(a){if((a.button!=0)||(!this.isEnable)){return}a.preventDefault();a.stopPropagation();this.mouseStartX=a.screenX;this.mouseStartY=a.screenY;this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true);this.onDown()},onMouseMove:function(d){var b=d.screenX-this.mouseStartX;var a=d.screenY-this.mouseStartY;var e=Math.sqrt(b*b+a*a);d.preventDefault();d.stopPropagation();if(e>10){this.onUp();this.disconnect(this.getDrawing(),"mousedown",this.onMouseDown);var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,d.target);d.target.dispatchEvent(c);this.connect(this.getDrawing(),"mousedown",this.onMouseDown)}},onMouseUp:function(a){if(!this.isDown){return}a.preventDefault();a.stopPropagation();if(a.button==0){this.onUp();this.fireEvent("press",this)}},onTouchStart:function(a){if(!this.isEnable){return}if(this.isDown){this.onUp();return}if(a.targetTouches.length!=1){return}a.preventDefault();a.stopPropagation();this.touchStartX=a.targetTouches[0].screenX;this.touchStartY=a.targetTouches[0].screenY;this.onDown()},onTouchMove:function(d){if(!this.isDown){return}var c=d.targetTouches[0].screenX-this.touchStartX;var a=d.targetTouches[0].screenY-this.touchStartY;var e=Math.sqrt(c*c+a*a);if(e>10){this.onUp();this.disconnect(this.getDrawing(),"touchstart",this.onTouchStart);var b=document.createEvent("TouchEvent");b.initTouchEvent("touchstart",true,true,window,0,0,0,0,0,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,d.touches,d.targetTouches,d.changedTouches,d.scale,d.rotation);d.target.dispatchEvent(b);this.connect(this.getDrawing(),"touchstart",this.onTouchStart)}d.preventDefault();d.stopPropagation()},onTouchEnd:function(a){if(!this.isDown){return}a.preventDefault();a.stopPropagation();this.onUp();this.fireEvent("press",this)},onKeyDown:function(a,b){if((b==13)&&this.isEnable){this.fireEvent("press",this)}},onDown:function(){this.isDown=true;this.focus();this.fireEvent("down",this)},onUp:function(){this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);this.isDown=false;this.fireEvent("up",this)},},{onDisable:function(){console.log(this+".onDisable");this.isEnable=false},onEnable:function(){console.log(this+".onEnable");this.isEnable=true},});Ui.LBox.extend("Ui.Selectable",{isDown:false,isSelected:false,lastTime:undefined,constructor:function(a){this.setFocusable(true);this.addEvents("select","unselect","activate");this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"touchstart",this.onTouchStart);this.connect(this.getDrawing(),"touchmove",this.onTouchMove);this.connect(this.getDrawing(),"touchend",this.onTouchEnd)},onMouseDown:function(a){if(a.button!=0){return}a.preventDefault();a.stopPropagation();this.mouseStartX=a.screenX;this.mouseStartY=a.screenY;this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true);this.isDown=true;if(!this.isSelected){this.isSelected=true;this.onSelect();this.fireEvent("select",this)}},onMouseMove:function(d){var b=d.screenX-this.mouseStartX;var a=d.screenY-this.mouseStartY;var e=Math.sqrt(b*b+a*a);if(e>10){this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);this.isDown=false;if(this.isSelected){this.isSelected=false;this.onUnSelect();this.fireEvent("unselect",this)}this.disconnect(this.getDrawing(),"mousedown",this.onMouseDown);var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,d.target);d.target.dispatchEvent(c);this.connect(this.getDrawing(),"mousedown",this.onMouseDown)}d.preventDefault();d.stopPropagation()},onMouseUp:function(b){if(!this.isDown){return}b.preventDefault();b.stopPropagation();if(b.button==0){this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);var a=(new Date().getTime())/1000;if((this.isSelected)&&(this.lastTime!=undefined)&&(a-this.lastTime<0.25)){this.fireEvent("activate",this)}this.lastTime=a}},onTouchStart:function(a){console.log("touchstart");if(this.isDown){return}if(a.targetTouches.length!=1){return}console.log("touchstart ok");a.preventDefault();a.stopPropagation();this.touchStartX=a.targetTouches[0].screenX;this.touchStartY=a.targetTouches[0].screenY;this.isDown=true;if(!this.isSelected){this.isSelected=true;this.onSelect();this.fireEvent("select",this)}},onTouchMove:function(d){if(!this.isDown){return}var c=d.targetTouches[0].screenX-this.touchStartX;var a=d.targetTouches[0].screenY-this.touchStartY;var e=Math.sqrt(c*c+a*a);if(e>10){this.isDown=false;if(this.isSelected){this.isSelected=false;this.onUnSelect();this.fireEvent("unselect",this)}this.disconnect(this.getDrawing(),"touchstart",this.onTouchStart);var b=document.createEvent("TouchEvent");b.initTouchEvent("touchstart",true,true,window,0,0,0,0,0,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,d.touches,d.targetTouches,d.changedTouches,d.scale,d.rotation);d.target.dispatchEvent(b);this.connect(this.getDrawing(),"touchstart",this.onTouchStart)}d.preventDefault();d.stopPropagation()},onTouchEnd:function(b){console.log("touchend");if(!this.isDown){return}b.preventDefault();b.stopPropagation();var a=(new Date().getTime())/1000;if((this.isSelected)&&(this.lastTime!=undefined)&&(a-this.lastTime<0.25)){this.fireEvent("activate",this)}this.lastTime=a},onSelect:function(){},onUnSelect:function(){},},{});Ui.LBox.extend("Ui.Movable",{moveHorizontal:true,moveVertical:true,mouseStart:undefined,contentBox:undefined,content:undefined,posX:0,posY:0,isMoving:false,hasMoved:false,measureSpeedTimer:undefined,speedX:0,speedY:0,speedComputed:false,lastPosX:undefined,lastPosY:undefined,lastTime:undefined,inertiaClock:undefined,inertia:false,touchId:undefined,touchStart:undefined,constructor:function(a){if(a.moveHorizontal!=undefined){this.setMoveHorizontal(a.moveHorizontal)}if(a.moveVertical!=undefined){this.setMoveVertical(a.moveVertical)}if(a.inertia!=undefined){this.setInertia(a.inertia)}this.contentBox=new Ui.LBox();this.appendChild(this.contentBox);this.contentBox.getDrawing().style.setProperty("cursor","move",null);this.addEvents("move");this.connect(this.contentBox.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.contentBox.getDrawing(),"touchstart",this.onTouchStart);this.connect(this.contentBox.getDrawing(),"touchmove",this.onTouchMove);this.connect(this.contentBox.getDrawing(),"touchend",this.onTouchEnd)},getInertia:function(){return this.inertia},setInertia:function(a){this.inertia=a},getMoveHorizontal:function(){return this.moveHorizontal},setMoveHorizontal:function(a){this.moveHorizontal=a},getMoveVertical:function(){return this.moveVertical},setMoveVertical:function(a){this.moveVertical=a},setContent:function(a){if(a!=this.content){if(this.content!=undefined){this.contentBox.removeChild(this.content)}this.content=a;if(this.content!=undefined){this.contentBox.appendChild(this.content)}}},setPosition:function(a,b){if(a!=undefined){this.posX=a}if(b!=undefined){this.posY=b}this.contentBox.setTransform(Ui.Matrix.createTranslate(this.posX,this.posY))},getPositionX:function(){return this.posX},getPositionY:function(){return this.posY},onMouseDown:function(a){if(a.button!=0){return}a.preventDefault();a.stopPropagation();this.connect(window,"mouseup",this.onMouseUp,true);this.connect(window,"mousemove",this.onMouseMove,true);this.mouseStart=this.pointFromPage({x:a.pageX,y:a.pageY});this.startPosX=this.posX;this.startPosY=this.posY;if(this.inertia){this.startComputeInertia()}},onMouseMove:function(d){d.preventDefault();d.stopPropagation();var b=this.pointFromPage({x:d.pageX,y:d.pageY});var c=b.x-this.mouseStart.x;if(!this.moveHorizontal){c=0}var a=b.y-this.mouseStart.y;if(!this.moveVertical){a=0}this.setPosition(this.startPosX+c,this.startPosY+a);this.fireEvent("move",this)},onMouseUp:function(a){a.preventDefault();a.stopPropagation();if(a.button!=0){return}this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);if(this.measureSpeedTimer!=undefined){this.stopComputeInertia();this.startInertia()}},onTouchStart:function(a){if(a.targetTouches.length!=1){return}if(this.isMoving){return}this.touchId=a.targetTouches[0].identifier;this.isMoving=true;a.preventDefault();a.stopPropagation();this.stopInertia();this.touchStart=this.pointFromPage({x:a.targetTouches[0].pageX,y:a.targetTouches[0].pageY});this.startPosX=this.posX;this.startPosY=this.posY;if(this.inertia){this.startComputeInertia()}},onTouchMove:function(d){if(!this.isMoving){return}if(d.targetTouches[0].identifier!=this.touchId){return}d.preventDefault();d.stopPropagation();var c=this.pointFromPage({x:d.targetTouches[0].pageX,y:d.targetTouches[0].pageY});var b=c.x-this.touchStart.x;if(!this.moveHorizontal){b=0}var a=c.y-this.touchStart.y;if(!this.moveVertical){a=0}posX=this.startPosX+b;posY=this.startPosY+a;this.setPosition(posX,posY);this.hasMoved=true;this.fireEvent("move",this)},onTouchEnd:function(a){if(!this.isMoving){return}a.preventDefault();a.stopPropagation();this.isMoving=false;if(this.measureSpeedTimer!=undefined){this.stopComputeInertia();this.startInertia()}},measureSpeed:function(){if(!this.hasMoved){return}var d=(new Date().getTime())/1000;var a=d-this.lastTime;if(a<0.025){return}var c=this.posX-this.lastPosX;var b=this.posY-this.lastPosY;this.speedX=c/a;this.speedY=b/a;this.lastTime=d;this.lastPosX=this.posX;this.lastPosY=this.posY;this.speedComputed=true},startComputeInertia:function(){if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort()}this.lastPosX=this.posX;this.lastPosY=this.posY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false;this.hasMoved=false;this.measureSpeedTimer=new Core.Timer({interval:0.025,scope:this,callback:this.measureSpeed})},stopComputeInertia:function(){if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort();this.measureSpeedTimer=undefined}if(!this.speedComputed){var d=(new Date().getTime())/1000;var a=d-this.lastTime;var c=this.posX-this.lastPosX;var b=this.posY-this.lastPosY;this.speedX=c/a;this.speedY=b/a}},startInertia:function(){if(this.inertiaClock==undefined){this.inertiaClock=new Anim.Clock({duration:"forever",target:this,callback:function(d,c,g){if(g==0){return}var b=this.posX;var a=this.posY;var f=this.posX+(this.speedX*g);var e=this.posY+(this.speedY*g);this.setPosition(f,e);this.fireEvent("move",this);if((this.posX==b)&&(this.posY==a)){this.stopInertia();return}this.speedX-=this.speedX*g*3;this.speedY-=this.speedY*g*3;if(Math.abs(this.speedX)<0.1){this.speedX=0}if(Math.abs(this.speedY)<0.1){this.speedY=0}if((this.speedX==0)&&(this.speedY==0)){this.stopInertia()}}});this.inertiaClock.begin()}},stopInertia:function(){if(this.inertiaClock!=undefined){this.inertiaClock.stop();this.inertiaClock=undefined}},},{});Ui.Container.extend("Ui.Scrollable",{viewWidth:0,viewHeight:0,horizontalBarWidth:0,verticalBarHeight:0,offsetX:0,offsetY:0,mouseButton:0,measureSpeedTimer:undefined,speedX:0,speedY:0,speedComputed:false,isMoving:false,hasMoved:false,mouseStart:undefined,touchStart:undefined,touchId:undefined,scrollHorizontal:true,scrollVertical:true,contentBox:undefined,content:undefined,scrollbarHorizontalBox:undefined,scrollbarHorizontal:undefined,scrollbarVerticalBox:undefined,scrollbarVertical:undefined,constructor:function(a){if(a.scrollHorizontal!=undefined){this.setScrollHorizontal(a.scrollHorizontal)}if(a.scrollVertical!=undefined){this.setScrollVertical(a.scrollVertical)}this.contentBox=new Ui.LBox();this.appendChild(this.contentBox);this.scrollbarHorizontalBox=new Ui.LBox();this.scrollbarHorizontalBox.getDrawing().style.setProperty("cursor","move",null);this.appendChild(this.scrollbarHorizontalBox);this.scrollbarVerticalBox=new Ui.LBox();this.scrollbarVerticalBox.getDrawing().style.setProperty("cursor","move",null);this.appendChild(this.scrollbarVerticalBox);this.connect(this.contentBox.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.contentBox.getDrawing(),"mousedown",this.onMouseDownCtrl,true);this.connect(this.contentBox.getDrawing(),"mousewheel",this.onMouseWheel);this.connect(this.contentBox.getDrawing(),"DOMMouseScroll",this.onMouseWheel);this.connect(this.contentBox.getDrawing(),"touchstart",this.onTouchStart);this.connect(this.contentBox.getDrawing(),"touchmove",this.onTouchMove);this.connect(this.contentBox.getDrawing(),"touchend",this.onTouchEnd);this.connect(this.scrollbarHorizontalBox.getDrawing(),"mousedown",this.onHorizontalMouseDown);this.connect(this.scrollbarVerticalBox.getDrawing(),"mousedown",this.onVerticalMouseDown)},setContent:function(a){if(this.content!=a){if(this.content!=undefined){this.contentBox.removeChild(this.content)}this.content=a;if(this.content!=undefined){this.contentBox.appendChild(this.content)}}},getScrollHorizontal:function(){return this.scrollHorizontal},setScrollHorizontal:function(a){if(a!=this.scrollHorizontal){this.scrollHorizontal=a;this.invalidateMeasure()}},getScrollVertical:function(){return this.scrollVertical},setScrollVertical:function(a){if(a!=this.scrollVertical){this.scrollVertical=a;this.invalidateMeasure()}},setScrollbarVertical:function(a){if(this.scrollbarVertical!=a){if(this.scrollbarVertical!=undefined){this.scrollbarVerticalBox.removeChild(this.scrollbarVertical)}this.scrollbarVertical=a;if(this.scrollbarVertical!=undefined){this.scrollbarVerticalBox.appendChild(this.scrollbarVertical)}}},setScrollbarHorizontal:function(a){if(this.scrollbarHorizontal!=a){if(this.scrollbarHorizontal!=undefined){this.scrollbarHorizontalBox.removeChild(this.scrollbarHorizontal)}this.scrollbarHorizontal=a;if(this.scrollbarHorizontal!=undefined){this.scrollbarHorizontalBox.appendChild(this.scrollbarHorizontal)}}},setOffsetX:function(a,b){this.setOffset(a,undefined,b)},setOffsetY:function(a,b){this.setOffset(undefined,a,b)},setOffset:function(a,c,b){if(b==undefined){b=false}if(a==undefined){a=this.offsetX}else{if(!b){a*=this.contentWidth-this.viewWidth}}if(c==undefined){c=this.offsetY}else{if(!b){c*=this.contentHeight-this.viewHeight}}if(a<0){a=0}else{if(a>this.contentWidth-this.viewWidth){a=this.contentWidth-this.viewWidth}}if(c<0){c=0}else{if(c>this.contentHeight-this.viewHeight){c=this.contentHeight-this.viewHeight}}if(!this.scrollVertical){c=0}if(!this.scrollHorizontal){a=0}this.offsetX=a;this.offsetY=c;this.updateOffset()},onMouseDownCtrl:function(a){if(a.ctrlKey){this.onMouseDown(a)}},onMouseDown:function(a){if((this.viewWidth>=this.contentWidth)&&(this.viewHeight>=this.contentHeight)){return}this.focus();this.mouseButton=a.button;a.preventDefault();a.stopPropagation();this.stopInertia();this.connect(window,"mouseup",this.onMouseUp,true);this.connect(window,"mousemove",this.onMouseMove,true);this.mouseStart=this.pointFromPage({x:a.pageX,y:a.pageY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.startComputeInertia()},onMouseMove:function(d){d.preventDefault();d.stopPropagation();this.hasMoved=true;var b=this.pointFromPage({x:d.pageX,y:d.pageY});var c=b.x-this.mouseStart.x;var a=b.y-this.mouseStart.y;offsetX=this.startOffsetX-c;offsetY=this.startOffsetY-a;this.setOffset(offsetX,offsetY,true)},onMouseUp:function(a){a.preventDefault();a.stopPropagation();if(a.button!=this.mouseButton){return}this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);this.stopComputeInertia();this.startInertia()},onMouseWheel:function(c){c.preventDefault();c.stopPropagation();var b=0;var a=0;if((c.wheelDeltaX!=undefined)&&(c.wheelDelaY!=undefined)){b=-c.wheelDeltaX/12;a=-c.wheelDeltaY/12}else{if(c.wheelDelta!=undefined){a=-c.wheelDelta/8}else{if(c.detail!=undefined){a=c.detail*10/3}}}this.setOffset(this.offsetX+b,this.offsetY+a,true)},onTouchStart:function(a){if((this.viewWidth>=this.contentWidth)&&(this.viewHeight>=this.contentHeight)){return}if(a.targetTouches.length!=1){return}if(this.isMoving){return}this.touchId=a.targetTouches[0].identifier;this.isMoving=true;a.preventDefault();a.stopPropagation();this.stopInertia();this.touchStart=this.pointFromPage({x:a.targetTouches[0].pageX,y:a.targetTouches[0].pageY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.startComputeInertia()},onTouchMove:function(d){if(!this.isMoving){return}if(d.targetTouches[0].identifier!=this.touchId){return}d.preventDefault();d.stopPropagation();var c=this.pointFromPage({x:d.targetTouches[0].pageX,y:d.targetTouches[0].pageY});var b=c.x-this.touchStart.x;var a=c.y-this.touchStart.y;offsetX=this.startOffsetX-b;offsetY=this.startOffsetY-a;this.setOffset(offsetX,offsetY,true);this.hasMoved=true},onTouchEnd:function(a){if(!this.isMoving){return}a.preventDefault();a.stopPropagation();this.isMoving=false;this.stopComputeInertia();this.startInertia()},onKeyDown:function(a,b){if(b==37){this.setOffset(this.offsetX-10,undefined,true)}else{if(b==39){this.setOffset(this.offsetX+10,undefined,true)}else{if(b==38){this.setOffset(undefined,this.offsetY-10,true)}else{if(b==40){this.setOffset(undefined,this.offsetY+10,true)}else{if(b==36){this.setOffset(0,0,true)}else{if(b==35){this.setOffset(1,1,false)}else{console.log("key: "+b)}}}}}}},measureSpeed:function(){if(!this.hasMoved){return}var d=(new Date().getTime())/1000;var c=d-this.lastTime;if(c<0.025){return}var b=this.offsetX-this.lastOffsetX;var a=this.offsetY-this.lastOffsetY;this.speedX=b/c;this.speedY=a/c;this.lastTime=d;this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.speedComputed=true},startComputeInertia:function(){if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort()}this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false;this.hasMoved=false;this.measureSpeedTimer=new Core.Timer({interval:0.025,scope:this,callback:this.measureSpeed})},stopComputeInertia:function(){if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort();this.measureSpeedTimer=undefined}if(!this.speedComputed){var d=(new Date().getTime())/1000;var c=d-this.lastTime;var b=this.offsetX-this.lastOffsetX;var a=this.offsetY-this.lastOffsetY;this.speedX=b/c;this.speedY=a/c}else{}},startInertia:function(){if(this.inertiaClock==undefined){this.inertiaClock=new Anim.Clock({duration:"forever",target:this,callback:function(c,b,g){if(g==0){return}var f=this.offsetX;var d=this.offsetY;var a=this.offsetX+(this.speedX*g);var e=this.offsetY+(this.speedY*g);this.setOffset(a,e,true);if((this.offsetX==f)&&(this.offsetY==d)){this.stopInertia();return}this.speedX-=this.speedX*g*3;this.speedY-=this.speedY*g*3;if(Math.abs(this.speedX)<0.1){this.speedX=0}if(Math.abs(this.speedY)<0.1){this.speedY=0}if((this.speedX==0)&&(this.speedY==0)){this.stopInertia()}}});this.inertiaClock.begin()}},stopInertia:function(){if(this.inertiaClock!=undefined){this.inertiaClock.stop();this.inertiaClock=undefined}},onVerticalMouseDown:function(a){if(a.button!=0){return}a.preventDefault();a.stopPropagation();this.stopInertia();this.connect(window,"mouseup",this.onVerticalMouseUp,true);this.connect(window,"mousemove",this.onVerticalMouseMove,true);this.mouseStart=this.pointFromPage({x:a.pageX,y:a.pageY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false;this.measureSpeedTimer=new Core.Timer({interval:0.025,scope:this,callback:this.measureSpeed})},onVerticalMouseMove:function(c){c.preventDefault();c.stopPropagation();var b=this.pointFromPage({x:c.pageX,y:c.pageY});var a=b.y-this.mouseStart.y;offsetY=this.startOffsetY+a*this.contentHeight/this.viewHeight;this.setOffset(this.startOffsetX,offsetY,true)},onVerticalMouseUp:function(e){e.preventDefault();e.stopPropagation();if(e.button!=0){return}if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort();this.measureSpeedTimer=undefined}this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);if(!this.speedComputed){var d=(new Date().getTime())/1000;var c=d-this.lastTime;var b=this.offsetX-this.lastOffsetX;var a=this.offsetY-this.lastOffsetY;this.speedX=b/c;this.speedY=a/c}this.startInertia()},onHorizontalMouseDown:function(a){if(a.button!=0){return}a.preventDefault();a.stopPropagation();this.stopInertia();this.connect(window,"mouseup",this.onHorizontalMouseUp,true);this.connect(window,"mousemove",this.onHorizontalMouseMove,true);this.mouseStart=this.pointFromPage({x:a.pageX,y:a.pageY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false;this.measureSpeedTimer=new Core.Timer({interval:0.025,scope:this,callback:this.measureSpeed})},onHorizontalMouseMove:function(c){c.preventDefault();c.stopPropagation();var a=this.pointFromPage({x:c.pageX,y:c.pageY});var b=a.x-this.mouseStart.x;offsetX=this.startOffsetX+b*this.contentWidth/this.viewWidth;this.setOffset(offsetX,this.startOffsetY,true)},onHorizontalMouseUp:function(e){e.preventDefault();e.stopPropagation();if(e.button!=0){return}if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort();this.measureSpeedTimer=undefined}this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);if(!this.speedComputed){var d=(new Date().getTime())/1000;var c=d-this.lastTime;var b=this.offsetX-this.lastOffsetX;var a=this.offsetY-this.lastOffsetY;this.speedX=b/c;this.speedY=a/c}this.startInertia()},updateOffset:function(){if(this.scrollbarHorizontalNeeded){var b=this.offsetX/(this.contentWidth-this.viewWidth);this.scrollbarHorizontalBox.setTransform(Ui.Matrix.createTranslate((this.viewWidth-this.scrollbarHorizontalWidth)*b,0))}if(this.scrollbarVerticalNeeded){var a=this.offsetY/(this.contentHeight-this.viewHeight);this.scrollbarVerticalBox.setTransform(Ui.Matrix.createTranslate(0,(this.viewHeight-this.scrollbarVerticalHeight)*a))}this.contentBox.setTransform(Ui.Matrix.createTranslate(-this.offsetX,-this.offsetY));this.contentBox.setClipRectangle(this.offsetX,this.offsetY,this.viewWidth,this.viewHeight)},},{measureCore:function(d,j,c){for(var f=0;f<this.getChildren().length;f++){var e=this.getChildren()[f];var k=e.measure(d,j,c)}var a=d;var g=j;this.scrollbarVerticalNeeded=false;this.scrollbarHorizontalNeeded=false;var b=this.scrollbarVerticalBox.getMeasureWidth()*2+this.scrollbarHorizontalBox.getMeasureWidth();var h=this.scrollbarHorizontalBox.getMeasureHeight()*2+this.scrollbarVerticalBox.getMeasureHeight();if((this.contentBox.getMeasureHeight()>j)&&this.scrollVertical){a=d-this.scrollbarVerticalBox.getMeasureWidth();this.scrollbarVerticalNeeded=true}if((this.contentBox.getMeasureWidth()>a)&&this.scrollHorizontal){g=j-this.scrollbarHorizontalBox.getMeasureHeight();this.scrollbarHorizontalNeeded=true;if((this.contentBox.getMeasureHeight()>g)&&this.scrollVertical){a=d-this.scrollbarVerticalBox.getMeasureWidth();this.scrollbarVerticalNeeded=true}}if(this.scrollbarHorizontalNeeded||this.scrollbarVerticalNeeded){this.scrollbarVerticalNeeded=false;this.scrollbarHorizontalNeeded=false;this.contentBox.measure(a,g,c);var a=d;var g=j;if(this.scrollVertical){if(this.contentBox.getMeasureHeight()>j){a=d-this.scrollbarVerticalBox.getMeasureWidth();this.scrollbarVerticalNeeded=true}}else{h=this.contentBox.getMeasureHeight()}if(this.scrollHorizontal){if(this.contentBox.getMeasureWidth()>a){g=j-this.scrollbarHorizontalBox.getMeasureHeight();this.scrollbarHorizontalNeeded=true;if((this.contentBox.getMeasureHeight()>g)&&this.scrollVertical){a=d-this.scrollbarVerticalBox.getMeasureWidth();this.scrollbarVerticalNeeded=true}}}else{b=this.contentBox.getMeasureWidth();if(this.scrollbarVerticalNeeded){b+=this.scrollbarVerticalBox.getMeasureWidth()}}if(!this.scrollVertical&&this.scrollbarHorizontalNeeded){h+=this.scrollbarHorizontalBox.getMeasureHeight()}return{width:b,height:h}}else{return{width:this.contentBox.getMeasureWidth(),height:this.contentBox.getMeasureHeight()}}},arrangeCore:function(b,a,c){if(this.scrollbarVerticalNeeded){this.scrollbarVerticalBox.show()}else{this.scrollbarVerticalBox.hide();this.offsetY=0}if(this.scrollbarHorizontalNeeded){this.scrollbarHorizontalBox.show()}else{this.scrollbarHorizontalBox.hide();this.offsetX=0}if(!this.scrollbarVerticalNeeded&&!this.scrollbarHorizontalNeeded){this.contentWidth=b;this.contentHeight=a;this.viewWidth=b;this.viewHeight=a}else{this.contentWidth=b;this.contentHeight=a;this.viewWidth=b;this.viewHeight=a;if(this.scrollbarVerticalNeeded){this.contentHeight=this.contentBox.getMeasureHeight();this.viewWidth-=this.scrollbarVerticalBox.getMeasureWidth();if(!this.scrollbarHorizontalNeeded){this.contentWidth-=this.scrollbarVerticalBox.getMeasureWidth()}}if(this.scrollbarHorizontalNeeded){this.contentWidth=this.contentBox.getMeasureWidth();this.viewHeight-=this.scrollbarHorizontalBox.getMeasureHeight()}else{if(!this.scrollbarVerticalNeeded){this.contentHeight-=this.scrollbarHorizontalBox.getMeasureHeight()}}if(this.scrollbarVerticalNeeded){this.scrollbarVerticalHeight=Math.max((this.viewHeight/this.contentHeight)*this.viewHeight,this.scrollbarVerticalBox.getMeasureHeight());this.scrollbarVerticalBox.arrange(b-this.scrollbarVerticalBox.getMeasureWidth(),0,this.scrollbarVerticalBox.getMeasureWidth(),this.scrollbarVerticalHeight)}if(this.scrollbarHorizontalNeeded){this.scrollbarHorizontalWidth=Math.max((this.viewWidth/this.contentWidth)*this.viewWidth,this.scrollbarHorizontalBox.getMeasureWidth());this.scrollbarHorizontalBox.arrange(0,a-this.scrollbarHorizontalBox.getMeasureHeight(),this.scrollbarHorizontalWidth,this.scrollbarHorizontalBox.getMeasureHeight())}}this.contentBox.arrange(0,0,this.contentWidth,this.contentHeight);this.updateOffset()},});Ui.LBox.extend("Ui.Draggable",{icon:undefined,downloadUrl:undefined,downloadMimetype:undefined,downloadFilename:undefined,allowedMode:"copyMove",mimetype:undefined,data:undefined,constructor:function(a){if(a.data!=undefined){this.setData(a.mimetype,a.data)}if(a.downloadUrl!=undefined){this.setDownloadUrl(a.downloadUrl,a.downloadMimetype,a.downloadFilename)}this.drawing.setAttributeNS(null,"draggable",true);this.connect(this.drawing,"dragstart",this.onDragStart,true);this.connect(this.drawing,"dragend",this.onDragEnd,true);this.addEvents("dragstart","dragend")},setData:function(a,b){if(a==undefined){this.mimetype="application/era-framework"}else{this.mimetype=a}this.data=b},setAllowedMode:function(a){this.allowedMode=a},setIcon:function(a){this.icon=a},setDownloadUrl:function(c,a,b){this.downloadUrl=c;if(b==undefined){}if(a==undefined){}this.downloadMimetype=a;this.downloadFilename=b},onDragStart:function(a){a.stopPropagation();a.dataTransfer.effectAllowed=this.allowedMode;if(this.downloadUrl!=undefined){try{a.dataTransfer.setData("DownloadURL",this.downloadMimetype+":"+this.downloadFilename+":"+this.downloadUrl)}catch(b){}}a.dataTransfer.setData("Text",this.mimetype+":"+this.data);if(this.icon!=undefined){if(a.dataTransfer.setDragImage!=undefined){a.dataTransfer.setDragImage(this.icon.drawing.childNodes[0],0,0)}}this.fireEvent("dragstart",this);return false},onDragEnd:function(a){a.stopPropagation();this.fireEvent("dragend",this,a.dataTransfer.dropEffect)},},{});Ui.LBox.extend("Ui.DropBox",{allowedMimetypes:undefined,allowFiles:false,allowText:false,constructor:function(a){this.allowedMimetypes=[];this.connect(this.drawing,"dragenter",this.onDragEnter);this.connect(this.drawing,"dragover",this.onDragOver);this.connect(this.drawing,"drop",this.onDrop);this.addEvents("drop","dropfiles")},addMimetype:function(a){this.allowedMimetypes.push(a);if(a.toLowerCase()=="files"){this.allowFiles=true}else{this.allowText=true}},onDragEnter:function(e){if(e.dataTransfer.types!=undefined){var a=false;var b=false;for(var c=0;c<e.dataTransfer.types.length;c++){var d=e.dataTransfer.types[c].toLowerCase();if((d=="text")||(d=="text/plain")){b=true}else{if(d.toLowerCase()=="files"){a=true}}}if(!(a&&this.allowFiles)&&!(b&&this.allowText)){return}}e.preventDefault();e.stopPropagation();return false},onDragOver:function(e){if(e.dataTransfer==undefined){return}if(e.dataTransfer.types!=undefined){var a=false;var b=false;for(var c=0;c<e.dataTransfer.types.length;c++){var d=e.dataTransfer.types[c].toLowerCase();if((d=="text")||(d=="text/plain")){b=true}else{if(d.toLowerCase()=="files"){a=true}}}if(!(a&&this.allowFiles)&&!(b&&this.allowText)){return}}var g="all";if(e.dataTransfer.effectAllowed!=undefined){g=e.dataTransfer.effectAllowed}var f="copy";if((g=="copy")||(g=="copyLink")||(g=="copyMove")||(g=="all")){f="copy"}else{if((g=="linkMove")||(g=="move")){f="move"}else{if(g=="link"){f="link"}}}e.dataTransfer.dropEffect=f;e.preventDefault();e.stopPropagation();return false},onDrop:function(b){b.preventDefault();b.stopPropagation();if((b.dataTransfer.files!=undefined)&&(b.dataTransfer.files.length>0)){this.fireEvent("dropfiles",this,b.dataTransfer.files)}else{var c=b.dataTransfer.getData("Text");if(c!=undefined){var d=c.indexOf(":");if(d!=-1){var a=c.substring(0,d);var c=c.substring(d+1);this.fireEvent("drop",this,a,c)}}}return false},},{});Ui.Element.extend("Ui.IFrame",{iframeDrawing:undefined,isReady:false,constructor:function(a){this.connect(this.iframeDrawing,"load",this.onIFrameLoad);if(a.src!=undefined){this.setSrc(a.src)}this.addEvents("ready")},getSrc:function(){return this.iframeDrawing.getAttributeNS(null,"src")},setSrc:function(a){this.iframeDrawing.setAttributeNS(null,"src",a)},getIFrame:function(){return this.iframeDrawing},onIFrameLoad:function(){if(!this.isReady){this.isReady=true;if(navigator.iPad){console.log("onIFrameLoad, setSize: "+this.getLayoutWidth()+" x "+this.getLayoutHeight());this.iframeDrawing.style.setProperty("width",this.getLayoutWidth()+"px",null);this.iframeDrawing.style.setProperty("height",this.getLayoutHeight()+"px",null)}this.fireEvent("ready",this)}},},{render:function(){this.iframeDrawing=document.createElementNS(htmlNS,"iframe");this.iframeDrawing.style.setProperty("border","0px",null);return this.iframeDrawing},arrangeCore:function(c,a){if(navigator.isChrome){var b=this.transformFromPage();this.iframeDrawing.style.setProperty("width",(c*b.getA())+"px",null);this.iframeDrawing.style.setProperty("height",(a*b.getD())+"px",null)}else{this.iframeDrawing.style.setProperty("width",c+"px",null);this.iframeDrawing.style.setProperty("height",a+"px",null)}},});Ui.Element.extend("Ui.Entry",{entryDrawing:undefined,fontSize:14,fontFamily:"Sans",fontWeight:"normal",color:"black",constructor:function(a){if(a.fontSize!=undefined){this.setFontSize(a.fontSize)}if(a.fontFamily!=undefined){this.setFontFamily(a.fontFamily)}if(a.fontWeight!=undefined){this.setFontWeight(a.fontWeight)}if(a.color!=undefined){this.setColor(a.color)}this.connect(this.entryDrawing,"focus",function(b){console.log("entry focus")});this.connect(this.entryDrawing,"blur",function(b){console.log("entry blur")})},setFontSize:function(a){if(this.fontSize!=a){this.fontSize=a;this.invalidateRender();this.invalidateMeasure()}},getFontSize:function(){return this.fontSize},setFontFamily:function(a){if(this.fontFamily!=a){this.fontFamily=a;this.invalidateRender();this.invalidateMeasure()}},getFontFamily:function(){return this.fontFamily},setFontWeight:function(a){if(this.fontWeight!=a){this.fontWeight=a;this.invalidateRender();this.invalidateMeasure()}},getFontWeight:function(){return this.fontWeight},setColor:function(a){if(this.color!=a){this.color=a;this.invalidateRender();this.invalidateMeasure()}},getColor:function(){return this.color},getValue:function(){return this.entryDrawing.value},setValue:function(a){this.entryDrawing.value=a},onMouseDown:function(a){},},{render:function(){this.entryDrawing=document.createElementNS(htmlNS,"input");this.entryDrawing.setAttributeNS(null,"type","text");this.entryDrawing.style.setProperty("border","0px",null);this.entryDrawing.style.setProperty("margin","0px",null);this.entryDrawing.style.setProperty("padding","0px",null);this.entryDrawing.style.setProperty("outline","none",null);this.entryDrawing.style.setProperty("background","none",null);if(navigator.isWebkit){this.entryDrawing.style.setProperty("-webkit-appearance","none",null)}this.updateRenderCore();return this.entryDrawing},measureCore:function(b,a,c){return{width:8,height:(this.fontSize*3/2)}},arrangeCore:function(b,a){this.entryDrawing.style.setProperty("width",b+"px",null);this.entryDrawing.style.setProperty("height",a+"px",null)},updateRenderCore:function(){this.entryDrawing.style.setProperty("font-size",this.getFontSize()+"px",null);this.entryDrawing.style.setProperty("font-family",this.getFontFamily(),null);this.entryDrawing.style.setProperty("font-weight",this.getFontWeight(),null);this.entryDrawing.style.setProperty("color",this.getColor(),null)},});Ui.Pressable.extend("Ui.Button",{background:undefined,contentBox:undefined,content:undefined,constructor:function(a){this.setPadding(3);this.background=new Ui.Rectangle({radius:8,fill:"lightblue"});this.append(this.background);this.contentBox=new Ui.LBox({paddingLeft:15,paddingRight:15,paddingTop:11,paddingBottom:11});this.append(this.contentBox);if(a.text!=undefined){this.content=new Ui.Label({text:a.text});this.contentBox.append(this.content)}this.connect(this,"down",this.onButtonDown);this.connect(this,"up",this.onButtonUp)},setContent:function(a){if(this.content!=a){if(this.content!=undefined){this.contentBox.remove(this.content)}this.content=a;if(this.content!=undefined){this.contentBox.append(this.content)}}},getBackgroundColor:function(){var a=this.getStyleProperty("backgroundColor");if(a==undefined){a="lightblue"}return a},onButtonDown:function(){this.background.setFill("#38acec")},onButtonUp:function(){this.background.setFill(this.getBackgroundColor())},},{onStyleChange:function(){console.log(this+".onStyleChange "+this.getStyleProperty("backgroundColor"));this.background.setFill(this.getStyleProperty("backgroundColor"))},onDisable:function(){Ui.Button.base.onDisable.call(this);this.content.setColor("red")},onEnable:function(){Ui.Button.base.onEnable.call(this);this.content.setColor("black")},});Ui.LBox.extend("Ui.ToolBar",{hbox:undefined,background:undefined,constructor:function(a){this.background=new Ui.Rectangle({fill:"#d9d9d9",margin:4,radius:8});Ui.ToolBar.base.append.call(this,this.background);this.hbox=new Ui.HBox({spacing:10,margin:8});Ui.ToolBar.base.append.call(this,this.hbox)},},{append:function(b,a){this.hbox.append(b,a)},remove:function(a){this.hbox.remove(a)},});Ui.Scrollable.extend("Ui.ScrollingArea",{constructor:function(a){this.setScrollbarHorizontal(new Ui.Rectangle({fill:"#009ee0",radius:4,width:8,height:8,margin:5}));this.setScrollbarVertical(new Ui.Rectangle({fill:"#009ee0",radius:4,width:8,height:8,margin:5}))},},{});Ui.LBox.extend("Ui.Slider",{isDown:false,value:0,background:undefined,button:undefined,constructor:function(a){if(a.value!=undefined){this.value=a.value}this.setFocusable(true);this.background=new Ui.Rectangle({width:100,height:16,verticalAlign:"center",margin:14,marginLeft:17,marginRight:17,radius:8});this.appendChild(this.background);this.foreground=new Ui.Rectangle({width:10,height:10,verticalAlign:"center",horizontalAlign:"left",margin:17,marginLeft:20,marginRight:20,radius:8,fill:"white"});this.appendChild(this.foreground);this.button=new Ui.Movable({moveVertical:false});this.connect(this.button,"move",this.onButtonMove);this.button.setContent(new Ui.Rectangle({width:40,height:40,verticalAlign:"center",horizontalAlign:"left",radius:20,margin:2,fill:"lightblue"}));this.appendChild(this.button);this.addEvents("change")},getValue:function(){return this.value},setValue:function(a){if(this.value!=a){this.value=a;this.updateValue();this.fireEvent("change",this)}},onButtonMove:function(a){var c=this.button.getPositionX();var b=this.getLayoutWidth()-this.button.getMeasureWidth();if(c<0){c=0}else{if(c>b){c=b}}this.setValue(c/b);this.value=c/b;this.updateValue();this.fireEvent("change",this)},updateValue:function(){var a=this.getLayoutWidth()-this.button.getMeasureWidth();this.button.setPosition(a*this.value,undefined);this.foreground.setWidth((this.getLayoutWidth()-40)*this.value)},},{arrangeCore:function(b,a,c){this.updateValue();Ui.Slider.base.arrangeCore.call(this,b,a,c)},});Ui.ScrollingArea.extend("Ui.IconList",{flow:undefined,constructor:function(a){this.flow=new Ui.Flow({uniform:true});this.setContent(this.flow)},append:function(a){this.flow.append(a)},remove:function(a){this.flow.remove(a)},clear:function(){while(this.flow.getChildren().length>0){this.flow.remove(this.flow.getChildren()[0])}},},{});Ui.Selectable.extend("Ui.IconListItem",{constructor:function(a){this.setPadding(10);this.setVerticalAlign("top");this.setHorizontalAlign("center")},},{});Ui.Container.extend("Ui.Locator",{path:undefined,backgrounds:undefined,foregrounds:undefined,spacing:2,constructor:function(a){if(a.path!=undefined){this.setPath(a.path)}this.addEvents("change")},setPath:function(g){this.path=g;while(this.getChildren().length>0){this.removeChild(this.getChildren()[0])}this.backgrounds=[];this.foregrounds=[];var d;if(g=="/"){var c=new Ui.Pressable();c.locatorPath="/";c.locatorPos=0;this.connect(c,"press",this.onPathPress);this.connect(c,"down",this.onPathDown);this.connect(c,"up",this.onPathUp);c.appendChild(new Ui.Rectangle({fill:"lightblue",radius:8}));this.backgrounds.push(c);this.appendChild(c);var a=new Ui.Pressable();a.locatorPath="/";a.locatorPos=0;this.connect(a,"press",this.onPathPress);this.connect(a,"down",this.onPathDown);this.connect(a,"up",this.onPathUp);a.appendChild(new Ui.LocatorHome({verticalAlign:"center",horizontalAlign:"center",width:25,height:25,margin:5}));this.foregrounds.push(a);this.appendChild(a)}else{var h=g.split("/");var f=[];for(var b=0;b<h.length;b++){if(h[b]!=""){f.push(h[b])}}h=f;var e="/";var c=new Ui.Pressable();c.locatorPath=e;c.locatorPos=0;this.connect(c,"press",this.onPathPress);this.connect(c,"down",this.onPathDown);this.connect(c,"up",this.onPathUp);c.appendChild(new Ui.LocatorRightArrow({fill:"lightblue",radius:8}));this.backgrounds.push(c);this.appendChild(c);var a=new Ui.Pressable();a.locatorPath=e;a.locatorPos=0;this.connect(a,"press",this.onPathPress);this.connect(a,"down",this.onPathDown);this.connect(a,"up",this.onPathUp);a.appendChild(new Ui.LocatorHome({verticalAlign:"center",horizontalAlign:"center",width:25,height:25,margin:5}));this.foregrounds.push(a);this.appendChild(a);for(var b=0;b<h.length;b++){e+=h[b];var c=new Ui.Pressable();c.locatorPath=e;c.locatorPos=b+1;this.connect(c,"press",this.onPathPress);this.connect(c,"down",this.onPathDown);this.connect(c,"up",this.onPathUp);if(b==h.length-1){c.appendChild(new Ui.LocatorLeftArrow({fill:"lightblue",radius:8}))}else{c.appendChild(new Ui.LocatorLeftRightArrow({fill:"lightblue",radius:8}))}this.backgrounds.push(c);this.appendChild(c);var a=new Ui.Pressable();a.locatorPos=b+1;this.connect(a,"press",this.onPathPress);this.connect(a,"down",this.onPathDown);this.connect(a,"up",this.onPathUp);a.locatorPath=e;a.appendChild(new Ui.Label({text:h[b],margin:8}));this.foregrounds.push(a);this.appendChild(a);e+="/"}}},getPath:function(){return this.path},onPathPress:function(a){this.fireEvent("change",this,a.locatorPath)},onPathDown:function(a){this.backgrounds[a.locatorPos].getChildren()[0].setFill("#38acec")},onPathUp:function(a){this.backgrounds[a.locatorPos].getChildren()[0].setFill("lightblue")},},{measureCore:function(d,a,f){if(this.foregrounds.length==0){return{width:0,height:0}}for(var b=0;b<this.getChildren().length;b++){this.getChildren()[b].measure(d,a,f)}if(this.foregrounds.length==1){return{width:this.foregrounds[0].getMeasureWidth(),height:this.foregrounds[0].getMeasureHeight()}}else{var c=0;var e=0;for(var b=0;b<this.foregrounds.length;b++){var g=this.foregrounds[b];if(g.getMeasureHeight()>e){e=g.getMeasureHeight()}c+=g.getMeasureWidth()}c+=(this.foregrounds.length-1)*(e/2+this.spacing);return{width:c,height:e}}},arrangeCore:function(f,b,g){if(this.foregrounds.length==1){this.foregrounds[0].arrange(0,0,f,b,g);this.backgrounds[0].arrange(0,0,f,b,g);return}x=0;for(var e=0;e<this.foregrounds.length;e++){var d=this.backgrounds[e];var c=this.foregrounds[e];var a=c.getMeasureWidth();c.arrange(x,0,a,b,g);if(e==0){d.arrange(x,0,a+b/2,b,g)}else{if(e==this.foregrounds.length-1){d.arrange(x-b/2,0,a+b/2,b,g)}else{d.arrange(x-b/2,0,a+b,b,g)}}x+=a+b/2+this.spacing}},});Ui.SVGElement.extend("Ui.LocatorRightArrow",{arrowDrawing:undefined,radius:8,fill:"black",constructor:function(a){if(a.radius!=undefined){this.setRadius(a.radius)}if(a.fill!=undefined){this.setFill(a.fill)}},setRadius:function(a){this.radius=a},setFill:function(a){this.fill=a;this.arrowDrawing.style.setProperty("fill",this.fill,null)},},{renderSVG:function(){this.arrowDrawing=document.createElementNS(svgNS,"path");this.arrowDrawing.style.setProperty("fill",this.fill,null);this.arrowDrawing.style.setProperty("fill-opacity","1",null);this.arrowDrawing.style.setProperty("stroke","none",null);return this.arrowDrawing},arrangeCore:function(b,a){var e=b-a/2;var d=a/2;var c=a-this.radius;this.arrowDrawing.setAttributeNS(null,"d","M"+this.radius+",0 L"+e+",0 L"+b+","+d+" L"+e+","+a+" L"+this.radius+","+a+" A"+this.radius+","+this.radius+" 0 0,1 0,"+c+" L0,"+this.radius+" A"+this.radius+","+this.radius+" 0 0,1 "+this.radius+",0 z")},});Ui.SVGElement.extend("Ui.LocatorLeftArrow",{arrowDrawing:undefined,radius:8,fill:"black",constructor:function(a){if(a.radius!=undefined){this.setRadius(a.radius)}if(a.fill!=undefined){this.setFill(a.fill)}},setRadius:function(a){this.radius=a},setFill:function(a){this.fill=a;this.arrowDrawing.style.setProperty("fill",this.fill,null)},},{renderSVG:function(){this.arrowDrawing=document.createElementNS(svgNS,"path");this.arrowDrawing.style.setProperty("fill",this.fill,null);this.arrowDrawing.style.setProperty("fill-opacity","1",null);this.arrowDrawing.style.setProperty("stroke","none",null);return this.arrowDrawing},arrangeCore:function(b,a){var e=b-this.radius;var d=a-this.radius;var c=a/2;this.arrowDrawing.setAttributeNS(null,"d","M0,0 L"+e+",0 A"+this.radius+","+this.radius+" 0 0,1 "+b+","+this.radius+" L"+b+","+d+" A"+this.radius+","+this.radius+" 0 0,1 "+e+","+a+" L0,"+a+" L"+c+","+c+" z")},});Ui.SVGElement.extend("Ui.LocatorLeftRightArrow",{arrowDrawing:undefined,radius:8,fill:"black",constructor:function(a){if(a.radius!=undefined){this.setRadius(a.radius)}if(a.fill!=undefined){this.setFill(a.fill)}},setRadius:function(a){this.radius=a},setFill:function(a){this.fill=a;this.arrowDrawing.style.setProperty("fill",this.fill,null)},},{renderSVG:function(){this.arrowDrawing=document.createElementNS(svgNS,"path");this.arrowDrawing.style.setProperty("fill",this.fill,null);this.arrowDrawing.style.setProperty("fill-opacity","1",null);this.arrowDrawing.style.setProperty("stroke","none",null);return this.arrowDrawing},arrangeCore:function(b,a){var d=b-a/2;var c=a/2;this.arrowDrawing.setAttributeNS(null,"d","M0,0 L"+d+",0 L"+b+","+c+" L"+d+","+a+" L0,"+a+" L"+c+","+c+" z")},});Ui.SVGElement.extend("Ui.LocatorHome",{homeDrawing:undefined,fill:"black",constructor:function(a){if(a.radius!=undefined){this.setRadius(a.radius)}if(a.fill!=undefined){this.setFill(a.fill)}},setFill:function(a){this.fill=a;this.homeDrawing.style.setProperty("fill",this.fill,null)},},{renderSVG:function(){this.homeDrawing=document.createElementNS(svgNS,"path");this.homeDrawing.style.setProperty("fill",this.fill,null);this.homeDrawing.style.setProperty("fill-opacity","1",null);this.homeDrawing.style.setProperty("stroke","none",null);this.homeDrawing.setAttributeNS(null,"d","M 25.78125 8.4375 C 25.324787 8.4375 24.892151 8.63045 24.53125 8.96875 C 24.53125 8.96875 6.032579 23.87715 5.6875 24.21875 C 4.081261 25.55365 4.524131 25.86215 4.96875 26.46875 C 7.1319435 26.472745 6.9387918 26.465628 8.875 26.46875 L 8.875 38.40625 C 8.875 40.46895 10.593558 42.1875 12.65625 42.1875 L 37.3125 42.1875 C 39.375192 42.1875 41.09375 40.46895 41.09375 38.40625 L 41.09375 26.5 C 42.834133 26.49218 44.96875 26.46875 44.96875 26.46875 C 45.304525 25.79985 45.215875 24.96585 44.65625 24.40625 L 39.96875 20.3125 C 40.040347 20.078087 40.09375 19.817094 40.09375 19.5625 L 40.09375 11.875 C 40.09375 10.4883 38.949133 9.34375 37.5625 9.34375 L 33.25 9.34375 C 31.863368 9.34375 30.71875 10.4883 30.71875 11.875 L 30.71875 12.1875 L 27.03125 8.96875 C 26.681485 8.61895 26.237713 8.4375 25.78125 8.4375 z M 33.71875 12.34375 L 37.09375 12.34375 L 37.09375 17.78125 L 33.71875 14.8125 L 33.71875 12.34375 z M 12.875 26.46875 C 23.518938 26.483067 32.947599 26.505366 37.09375 26.5 L 37.09375 38.1875 L 12.875 38.1875 L 12.875 26.46875 z");return this.homeDrawing},arrangeCore:function(b,a){var c=Math.min(b,a)/48;this.homeDrawing.setAttributeNS(null,"transform","scale( "+c.toFixed(4)+", "+c.toFixed(4)+" )")},});Ui.IFrame.extend("Ui.Program",{arguments:undefined,isReady:false,constructor:function(b){this.connect(window,"message",this.onMessage,false);if(b.location==undefined){throw ("location config parameter is NEEDED")}var a=b.location;if(b.arguments!=undefined){a+="?base64="+encodeURIComponent(b.arguments.serialize().toBase64())}this.setSrc(a);this.addEvents("message")},sendMessage:function(a){this.getIFrame().contentWindow.postMessage(a.serialize(),"*")},onMessage:function(a){if(this.getIFrame().contentWindow===a.source){a.preventDefault();a.stopPropagation();var b=JSON.parse(a.data);this.fireEvent("message",this,b)}},});Ui.LBox.extend("Ui.App",{defs:undefined,styles:undefined,updateTask:undefined,style:"../era/style/default/style.css",styleloaded:false,loaded:false,focusElement:undefined,hasFocus:false,arguments:undefined,autoscale:false,ready:false,renderList:undefined,windowWidth:0,windowHeight:0,windowScale:1,constructor:function(e){Ui.App.current=this;if(e.autoscale!=undefined){this.setAutoScale(e.autoscale)}this.getDrawing().style.setProperty("position","fixed",null);document.documentElement.style.padding="0px";document.documentElement.style.margin="0px";document.documentElement.style.border="0px solid black";document.documentElement.style.overflow="hidden";document.documentElement.style.width="100%";document.documentElement.style.height="100%";this.svgRoot=document.createElementNS(svgNS,"svg");this.setTransformOrigin(0,0);this.connect(window,"load",this.onWindowLoad);this.connect(window,"resize",this.onWindowResize);this.addEvents("resize","ready","parentmessage");this.connect(window,"dragenter",function(i){i.preventDefault();return false});this.connect(window,"dragover",function(i){i.dataTransfer.dropEffect="none";i.preventDefault();return false});this.connect(window,"drop",function(i){i.preventDefault();return false});this.connect(window,"contextmenu",function(i){i.preventDefault()});this.connect(window,"message",this.onMessage);if((window.location.search!=undefined)&&(window.location.search!="")){var h=undefined;var b={};var d=window.location.search.substring(1).split("&");for(var f=0;f<d.length;f++){var g=d[f].split("=");if(g.length==2){var j=decodeURIComponent(g[0]);var c=decodeURIComponent(g[1]);if(j=="base64"){h=JSON.parse(c.fromBase64())}else{b[j]=c}}}if(h!=undefined){this.arguments=h;for(var a in b){this.arguments[a]=b[a]}}else{this.arguments=b}}else{this.arguments={}}},onWindowLoad:function(){if(navigator.iPad||navigator.iPhone){var a=document.createElementNS(htmlNS,"meta");a.name="apple-mobile-web-app-capable";a.content="yes";document.getElementsByTagName("head")[0].appendChild(a);a=document.createElementNS(htmlNS,"meta");a.name="apple-mobile-web-app-status-bar-style";a.content="black";document.getElementsByTagName("head")[0].appendChild(a);a=document.createElementNS(htmlNS,"meta");a.name="viewport";a.content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=no";document.getElementsByTagName("head")[0].appendChild(a);this.connect(this.getDrawing(),"touchstart",function(b){b.preventDefault()},true);this.connect(this.getDrawing(),"touchmove",function(b){b.preventDefault()},true);this.connect(this.getDrawing(),"touchend",function(b){b.preventDefault()},true)}this.loaded=true;this.onReady()},onWindowResize:function(){this.fireEvent("resize",this);this.invalidateMeasure()},onWindowKeyPress:function(a){a.preventDefault();Ui.Keyboard.current.shiftKey=a.shiftKey;Ui.Keyboard.current.altKey=a.altKey;Ui.Keyboard.current.ctrlKey=a.ctrlKey;Ui.Keyboard.current.altGraphKey=a.altGraphKey;Ui.Keyboard.current.metaKey=a.metaKey;if(navigator.isOpera){if((a.which==0)||(a.which==8)||(a.which==9)){return}keychar=String.fromCharCode(a.which)}else{if(a.charCode==0){return}keychar=String.fromCharCode(a.charCode)}if(Ui.Keyboard.current.elementCapture!=undefined){Ui.Keyboard.current.elementCapture.fireEvent("keypress",Ui.Keyboard.current,keychar)}else{if(this.focusElement!=undefined){this.focusElement.fireEvent("keypress",Ui.Keyboard.current,keychar)}}},onWindowKeyDown:function(b){Ui.Keyboard.current.shiftKey=b.shiftKey;Ui.Keyboard.current.altKey=b.altKey;Ui.Keyboard.current.ctrlKey=b.ctrlKey;Ui.Keyboard.current.altGraphKey=b.altGraphKey;Ui.Keyboard.current.metaKey=b.metaKey;if(Ui.Keyboard.current.elementCapture!=undefined){b.preventDefault();Ui.Keyboard.current.elementCapture.fireEvent("keydown",Ui.Keyboard.current,b.which);return}if(b.which==9){b.preventDefault();var a;if(this.focusElement!=undefined){if(b.shiftKey){a=this.findPreviousFocusable()}else{a=this.findNextFocusable()}}else{a=this.findFirstFocusable()}if(a!=undefined){a.focus()}else{window.dump()}}else{if(b.which==8){b.preventDefault()}if(this.focusElement!=undefined){this.focusElement.fireEvent("keydown",Ui.Keyboard.current,b.which)}}},update:function(){var d=this.renderList;while(d!=undefined){d.updateRender();d=d.renderNext}this.renderList=undefined;var a=window.innerWidth;var c=window.innerHeight;var b;if(this.autoscale){if((this.windowWidth!=a)||(this.windowHeight!=c)){var b=this.measure(a,c);if(b.width<a){b.width=a}if(b.height<c){b.height=c}this.windowScale=1;if((b.width>a)||(b.height>c)){this.windowScale=Math.max(b.width/a,b.height/c)}b=this.measure(a*this.windowScale,c*this.windowScale);this.setTransform(Ui.Matrix.createScale(1/this.windowScale))}else{b=this.measure(a*this.windowScale,c*this.windowScale);if((b.width>a*this.windowScale)||(b.height>c*this.windowScale)){if(b.width<a){b.width=a}if(b.height<c){b.height=c}this.windowScale=1;if((b.width>a)||(b.height>c)){this.windowScale=Math.max(b.width/a,b.height/c)}b=this.measure(a*this.windowScale,c*this.windowScale);this.setTransform(Ui.Matrix.createScale(1/scale))}}}else{this.windowScale=1;b=this.measure(a,c)}this.windowWidth=a;this.windowHeight=c;this.arrange(0,0,Math.max(this.windowWidth*this.windowScale,b.width),Math.max(this.windowHeight*this.windowScale,b.height));d=this.renderList;while(d!=undefined){d.updateRender();d=d.renderNext}this.renderList=undefined;this.updateTask=undefined},getArguments:function(){return this.arguments},getAutoScale:function(){return this.autoscale},setAutoScale:function(a){if(this.autoscale!=a){this.autoscale=a;if(!this.autoscale){this.setTransform(undefined)}this.invalidateMeasure()}},onReady:function(){if(this.loaded){this.ready=true;if(document.body==undefined){this.htmlRoot=document.createElementNS(htmlNS,"body");document.body=this.htmlRoot}document.body.style.padding="0px";document.body.style.margin="0px";document.body.style.border="0px solid black";document.body.style.overflow="hidden";document.body.style.width="100%";document.body.style.height="100%";document.body.appendChild(this.getDrawing());this.update();this.setIsLoaded(true);this.fireEvent("ready")}},onMessage:function(a){if(parent===a.source){a.preventDefault();a.stopPropagation();var b=JSON.parse(a.data);this.fireEvent("parentmessage",b)}},sendMessageToParent:function(a){parent.postMessage(a.serialize(),"*")},findNextFocusable:function(){var a={element:this,seen:false,res:undefined};this.findFocusable(a);return a.res},findFirstFocusable:function(){var a={element:this,seen:true,res:undefined};this.findFocusable(a);return a.res},findPreviousFocusable:function(){var a={element:this,seen:false,res:undefined,previous:undefined};this.findFocusable(a);if(a.seen){return a.previous}else{return undefined}},findFocusable:function(c){var b=c.element;if(b.isSubclass("Ui.Container")){for(var a=0;a<b.children.length;a++){var d=b.children[a];if(d.getFocusable()){if(c.seen){c.res=d;return}if(d==this.focusElement){c.seen=true}else{c.previous=d}}c.element=d;this.findFocusable(c);if(c.res!=undefined){return}}}},askFocus:function(a){if(this.focusElement!=a){this.removeFocus(this.focusElement);this.focusElement=a;this.focusElement.addClass("focus");this.focusElement.fireEvent("focus")}},removeFocus:function(a){if((this.focusElement!=undefined)&&(this.focusElement==a)){this.focusElement.removeClass("focus");this.focusElement.fireEvent("blur");this.focusElement=undefined}},onWindowMouseDown:function(a){console.log("onWindowMouseDown");if(this.focusElement!=undefined){this.removeFocus(this.focusElement)}},onWindowFocus:function(a){console.log("onWindowFocus");if(!this.hasFocus){this.hasFocus=true;var b=this.findFirstFocusable();if(b!=undefined){b.focus()}}},onWindowBlur:function(a){if(this.hasFocus){this.hasFocus=false;if(this.focusElement!=undefined){this.focusElement.blur()}}},enqueueRender:function(a){a.renderNext=this.renderList;this.renderList=a;if((this.updateTask==undefined)&&this.ready){this.updateTask=new Core.DelayedTask({delay:0,scope:this,callback:this.update})}},enqueueMeasure:function(a){},},{invalidateMeasure:function(){if(this.measureValid){this.invalidateArrange();this.measureValid=false;if((this.updateTask==undefined)&&this.ready){this.updateTask=new Core.DelayedTask({delay:0,scope:this,callback:this.update})}}},invalidateArrange:function(){if(this.arrangeValid){this.arrangeValid=false;if((this.updateTask==undefined)&&this.ready){this.updateTask=new Core.DelayedTask({delay:0,scope:this,callback:this.update})}}},});Ui.App.current=undefined;