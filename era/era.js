var DEBUG=!1;navigator.isGecko=null!==navigator.userAgent.match(/Gecko\//i);navigator.isWebkit=null!==navigator.userAgent.match(/WebKit\//i);navigator.isIE=null!==navigator.userAgent.match(/MSIE/i)||null!==navigator.userAgent.match(/Trident/i);navigator.isIE7=null!==navigator.userAgent.match(/MSIE 7\./i);navigator.isIE8=null!==navigator.userAgent.match(/MSIE 8\./i);navigator.isIE10=null!==navigator.userAgent.match(/MSIE 10\./i);navigator.isIE11=navigator.isIE&&null!==navigator.userAgent.match(/rv:11\./i);
navigator.isOpera=void 0===navigator.userAgent||null!==navigator.userAgent.match(/Opera\//i);navigator.isChrome=null!==navigator.userAgent.match(/ Chrome\//);navigator.isSafari=null!==navigator.userAgent.match(/ Safari\//);navigator.isFirefox=null!==navigator.userAgent.match(/ Firefox\//);navigator.isFirefox3=null!==navigator.userAgent.match(/ Firefox\/3\./);navigator.isFirefox3_5=null!==navigator.userAgent.match(/ Firefox\/3\.5\./);navigator.isFirefox3_6=null!==navigator.userAgent.match(/ Firefox\/3\.6\./);
navigator.iPad=null!==navigator.userAgent.match(/iPad/i);navigator.iPhone=null!==navigator.userAgent.match(/iPhone/i);navigator.iOs=navigator.iPad||navigator.iPhone;navigator.Android=null!==navigator.userAgent.match(/Android/i);var svgNS="http://www.w3.org/2000/svg",htmlNS="http://www.w3.org/1999/xhtml";
(function(){var a;navigator.supportSVG=!1;try{a=document.createElementNS(svgNS,"g"),"ownerSVGElement"in a&&(navigator.supportSVG=!0)}catch(b){}a=document.createElement("canvas");navigator.supportCanvas="getContext"in a;navigator.supportRgba=!0;navigator.supportRgb=!0;a=document.createElement("div");try{a.style.background="rgba(0, 0, 0, 0.5)"}catch(c){navigator.supportRgba=!1}try{a.style.background="rgb(0, 0, 0)"}catch(d){navigator.supportRgb=!1}})();Core={Util:{}};Core.Util.idGenerator=0;
Core.Util.generateId=function(){return++Core.Util.idGenerator};Core.Util.baseDirectory=function(a){var b;b=void 0!==document.scripts?document.scripts:document.getElementsByTagName("script");for(var c=0;c<b.length;c++){var d=b[c].src.search(a);if(-1!=d)return b[c].src.substring(0,d)}};Core.Util.include=function(a){document.write("<script type='text/javascript' src='"+a+"'>\x3c/script>")};
Core.Util.clone=function(a){if(void 0!==a){if(null===a||"object"!==typeof a)return null;var b={},c;for(c in a)b[c]=a[c];return b}};Core.Util.encodeURIQuery=function(a){var b="";if(void 0!==a&&null!==a)for(var c in a){var d=a[c];"number"!==typeof d&&"string"!==typeof d&&"boolean"!==typeof d&&"object"!==typeof d||(""!==b&&(b+="&"),b+=encodeURIComponent(c)+"=",b="object"===typeof d?b+encodeURIComponent(JSON.stringify(d)):b+encodeURIComponent(d))}return b};
String.prototype.utf8Encode=function(){for(var a="",b=0;b<this.length;b++){var c=this.charCodeAt(b);128>c?a+=String.fromCharCode(c):(128<=c&&2048>c?a+=String.fromCharCode(c>>6|192):(a+=String.fromCharCode(c>>12|224),a+=String.fromCharCode(c>>6&63|128)),a+=String.fromCharCode(c&63|128))}return a};
String.prototype.utf8Decode=function(){for(var a="",b=0,c;b<this.length;)c=this.charCodeAt(b++),a=128>c?a+String.fromCharCode(c):192<=c&&224>c?a+String.fromCharCode((c&31)<<6|this.charCodeAt(b++)&63):a+String.fromCharCode((c&15)<<12|(this.charCodeAt(b++)&63)<<6|this.charCodeAt(b++)&63);return a};
String.prototype.toBase64=function(){for(var a,b,c,d,e=this.utf8Encode(),f="",g=0;g+2<e.length;)a=e.charCodeAt(g++)&255,b=e.charCodeAt(g++)&255,c=e.charCodeAt(g++)&255,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>2),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((a&3)<<4|b>>4),b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((b&15)<<2|c>>6),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c&
63),f+=d+a+b+c;g+1<e.length?(a=e.charCodeAt(g++)&255,b=e.charCodeAt(g++)&255,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>2),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((a&3)<<4|b>>4),b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((b&15)<<2),f+=d+a+b+"="):g<e.length&&(a=e.charCodeAt(g++)&255,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>2),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((a&
3)<<4),f+=d+a+"==");return f};
String.prototype.fromBase64=function(){for(var a,b,c,d,e,f="",g=0;g<this.length;)a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(this.charAt(g++)),b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(this.charAt(g++)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(this.charAt(g++)),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(this.charAt(g++)),a=a<<2|b>>4,b=(b&15)<<4|d>>2,c=(d&3)<<
6|e,f+=String.fromCharCode(a),64!==d&&(f+=String.fromCharCode(b),64!==e&&(f+=String.fromCharCode(c)));return f.utf8Decode()};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
String.prototype.toNoDiacritics=function(){for(var a=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",
letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},
{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},
{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},
{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",
letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},
{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},
{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},
{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},
{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},
{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},
{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},
{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},
{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}],b=this,c=0;c<a.length;c++)b=b.replace(a[c].letters,a[c].base);return b};
Function.prototype.bind||(Function.prototype.bind=function(a){var b=this,c;c=1<arguments.length?arguments.slice(1,arguments.length-1):[];return function(){return b.apply(a,c.concat(arguments))}});
navigator.isIE&&navigator.supportSVG&&(SVGTextContentElement.prototype.__getStartPositionOfChar=SVGTextContentElement.prototype.getStartPositionOfChar,SVGTextContentElement.prototype.getStartPositionOfChar=function(a){return this.__getStartPositionOfChar(a).matrixTransform(this.getScreenCTM().inverse())},SVGTextContentElement.prototype.__getEndPositionOfChar=SVGTextContentElement.prototype.getEndPositionOfChar,SVGTextContentElement.prototype.getEndPositionOfChar=function(a){return this.__getEndPositionOfChar(a).matrixTransform(this.getScreenCTM().inverse())},
SVGTextContentElement.prototype.__getCharNumAtPosition=SVGTextContentElement.prototype.getCharNumAtPosition,SVGTextContentElement.prototype.getCharNumAtPosition=function(a){return this.getCharNumAtPositionHelper(a.x,0,this.getNumberOfChars()-1)},SVGTextContentElement.prototype.getCharNumAtPositionHelper=function(a,b,c){startX=this.getStartPositionOfChar(b).x;endX=this.getEndPositionOfChar(c).x;if(a<startX||a>endX)return-1;if(b==c)return b;var d=Math.floor((b+c)/2);b=this.getCharNumAtPositionHelper(a,
b,d);return-1!=b?b:this.getCharNumAtPositionHelper(a,d+1,c)});void 0===Object.create&&(Object.create=function(a){var b,c={};for(b in a)"constructor"!==b&&(c[b]=a[b]);return c});Core.Object=function(){};Core.Object.prototype.classType="Core.Object";Core.Object.prototype.toString=function(){return"[object "+this.classType+"]"};Core.Object.prototype.dump=function(a){void 0!==a&&(a=RegExp(a,"i"));console.log(this+":");for(var b in this)try{var c=!0;void 0!==a&&(c=a.test(b));c&&console.log(b+" => "+this[b])}catch(d){}};
Core.Object.dump=function(a,b){void 0!==b&&(b=RegExp(b,"i"));console.log(a+":");for(var c in a)try{var d=!0;void 0!==b&&(d=b.test(c));d&&console.log(c+" => "+a[c])}catch(e){}};Core.Object.diff=function(a,b){var c={},d=!0,e;for(e in b)e in a&&b[e]!==a[e]&&(c[e]=b[e],d=!1);return d?void 0:c};Core.Object.prototype.serialize=function(){return JSON.stringify(this)};
Core.Object.prototype.constructorHelper=function(a,b){void 0===b&&(b=this);void 0===b||null===b||(void 0===a&&(a={}),void 0!==b.__baseclass__&&this.constructorHelper.call(this,a,b.__baseclass__),void 0!==b.__constructor&&b.__constructor.call(this,a))};
Function.prototype.extend=function(a,b,c,d){for(var e,f=a.split("."),g="",l=window,k=0;k<f.length-1;k++)""!==g&&(g+="."),g+=f[k],void 0===l[f[k]]&&(l[f[k]]={}),l=l[f[k]];f=eval("( "+a+" = function(config) { this.constructorHelper.call(this, config); this.autoConfig(config); } )");f.prototype=Object.create(this.prototype);f.prototype.constructor=f;f.prototype.__baseclass__=this.prototype;f.base=this.prototype;for(e in f.base.constructor)"function"===typeof f.base.constructor[e]&&(f[e]=f.base.constructor[e]);
if(void 0!==d)for(e in d)f[e]=d[e];if(void 0!==b){for(e in b)if("constructor"===e)f.prototype.__constructor=b[e];else{if("object"===typeof b[e]&&null!==b[e])throw"object are not allowed in classDefine ("+e+"). Create object in the constructor";if(e in f.prototype)throw"Try to override "+e+" on class "+a+". Use classOverride you want to do it";f.prototype[e]=b[e]}b.constructor===Object.prototype.constructor&&(f.prototype.__constructor=void 0);navigator.isIE&&b.constructor!==Object.prototype.constructor&&
(f.prototype.__constructor=b.constructor)}else f.prototype.__constructor=void 0;if(void 0!==c)for(e in c){if("object"===typeof c[e]&&null!==c[e])throw"object are not allowed in classOverride ("+e+"). Create object in the constructor";f.prototype[e]=c[e]}f.prototype.classType=a;void 0!==d&&"constructor"in d&&d.constructor.call(f);return f};
Function.prototype.hasInstance=function(a){if("object"!==typeof a||null===a||a.constructorHelper!==Core.Object.prototype.constructorHelper)return!1;for(;void 0!==a;){if(a.classType===this.prototype.classType)return!0;a=a.__baseclass__}return!1};Core.Object.prototype.isSubclassOf=function(a){for(var b=this;void 0!==b;){if(b.classType===a)return!0;b=b.__baseclass__}return!1};
Core.Object.prototype.addEvents=function(){void 0===this.events&&(this.events=[]);for(var a=0;a<arguments.length;a++)this.events[arguments[a]]=[]};Core.Object.prototype.hasEvent=function(a){return void 0!==this.events&&a in this.events};
Core.Object.prototype.fireEvent=function(a){var b,c=[];for(b=1;b<arguments.length;b++)c[b-1]=arguments[b];var d=!1,e=this.events[a];if(void 0!==e){e=e.slice();for(b=0;b<e.length&&!d;b++)!0===e[b].capture&&(d=e[b].method.apply(e[b].scope,c),void 0===d&&(d=!1));for(b=0;b<e.length&&!d;b++)!0!==e[b].capture&&(d=e[b].method.apply(e[b].scope,c),void 0===d&&(d=!1))}else if(DEBUG)throw"Event '"+a+"' not found on "+this;return d};
Core.Object.prototype.connect=function(a,b,c,d){var e;void 0===d&&(d=!1);if(DEBUG&&"function"!==typeof c)throw"Invalid method to connect on event '"+b+"'";if("addEventListener"in a)e=function(){return e.callback.apply(e.scope,arguments)},e.scope=this,e.callback=c,e.eventName=b,e.capture=d,a.addEventListener(b,e,d),void 0===a.events&&(a.events=[]),a.events.push(e);else if(c={scope:this,method:c,capture:d},d=a.events[b],void 0!==d)d.push(c);else if(DEBUG)throw"Event '"+b+"' not found on "+a;};
Core.Object.prototype.getEventHandlers=function(a){a=this.events[a];return void 0!==a?a.slice():[]};
Core.Object.prototype.disconnect=function(a,b,c){var d,e;if("removeEventListener"in a)for(e=0;void 0!==a.events&&e<a.events.length;e++)d=a.events[e],d.scope===this&&d.eventName===b&&!(void 0!==c&&d.callback!==c)&&(a.removeEventListener(d.eventName,d,d.capture),a.events.splice(e,1),e--);else for(e=0;void 0!==a.events&&e<a.events[b].length;e++)d=a.events[b][e],d.scope==this&&!(void 0!==c&&d.method!==c)&&(a.events[b].splice(e,1),e--)};
Core.Object.prototype.autoConfig=function(a){if(void 0!==a){var b,c;for(c in a)if(b="set"+c.charAt(0).toUpperCase()+c.substr(1),b in this&&"function"==typeof this[b])this[b].call(this,a[c]),delete a[c];else if(-1!=c.indexOf(".")){b=c.split(".");for(var d=window,e=0;e<b.length-1;e++)d=d[b[e]];b=b[b.length-1];b="set"+b.charAt(0).toUpperCase()+b.substr(1);if(b in d&&typeof("function"==d[b]))d[b].call(d,this,a[c]),delete a[c];else if(DEBUG)throw"Attached property '"+c+"' not found";}else if(DEBUG&&"type"!==
c)throw"Property '"+c+"' not found on "+this.classType;}};
Core.Object.create=function(a){if(void 0!==a){if("string"==typeof a){if("parse"in this)return this.parse(a);throw"static parse need to be defined in class "+this.prototype.classType+" to create from a string";}if(Core.Object.hasInstance(a))return a;var b=a.type;if(DEBUG&&"type"in a&&void 0===b)throw"Cannot create object of type undefined";if(void 0===b)b=this;else if(DEBUG)for(var c=b;void 0!==c&&c!==this;){if(void 0===c.base)throw"Expecting class "+this.prototype.classType+" got "+b.prototype.classType;
c=c.base.constructor}return new b(a)}};Core.Object.extend("Core.Uri",{scheme:void 0,user:void 0,password:void 0,host:void 0,port:void 0,path:void 0,query:void 0,fragment:void 0,constructor:function(a){var b=!0,c;c="baseURI"in document?document.baseURI:document.location.href;var d;"uri"in a?(d=a.uri,delete a.uri):d=c;a=d.match(/^([^:\/]+):\/\/([^\/]+)(\/.*)$/);null===a&&(b=!1,a=c.match(/^([^:\/]+):\/\/([^\/]+)(\/.*)$/));this.scheme=a[1];c=a[2];var e=a[3];a=c.match(/^(.+):(.+)@(.*)$/);null!==a&&(this.user=a[1],this.password=a[2],c=a[3]);
a=c.match(/^(.+):(.+)$/);null!==a?(c=a[1],this.port=a[2]):this.port="https"==this.scheme?443:80;this.host=c;b?this.path=e:0===d.indexOf("/")?this.path=Core.Uri.cleanPath(d):this.path=Core.Uri.mergePath(e,d)},getScheme:function(){return this.scheme},getUser:function(){return this.user},getPassword:function(){return this.password},getHost:function(){return this.host},getPort:function(){return this.port},getPath:function(){return this.path},getQuery:function(){return this.query},getFragment:function(){return this.fragment}},
{toString:function(){var a=this.scheme+"://";void 0!==this.user&&void 0!==this.password&&(a+=this.user+":"+this.password+"@");a+=this.host;void 0!==this.port&&(a+=":"+this.port);return a+=this.path}},{cleanPath:function(a){for(;a.match(/\/([^\/]*)\/\.\.\//);)a=a.replace(/\/([^\/]*)\/\.\.\//,"/");for(;a.match(/\/\//,"/");)a=a.replace(/\/\//,"/");for(;a.match(/\/\.\//);)a=a.replace(/\/\.\//,"/");return a},mergePath:function(a,b){var c=a.match(/^(.*)\//)[0];return Core.Uri.cleanPath(c+b)}});Core.Object.extend("Core.DoubleLinkedList",{root:void 0,length:0,constructor:function(a){},getLength:function(){return this.length},getFirstNode:function(){return void 0===this.root?void 0:this.root},getLastNode:function(){return void 0===this.root?void 0:this.root.previous},appendNode:function(a){void 0===this.root?(a.previous=a,this.root=a.next=a):(a.previous=this.root.previous,a.next=this.root,this.root.previous.next=a,this.root.previous=a);this.length++;return a},prependNode:function(a){void 0===
this.root?(a.previous=a,a.next=a):(a.previous=this.root.previous,a.next=this.root,this.root.previous.next=a,this.root.previous=a);this.root=a;this.length++;return a},removeNode:function(a){this.root===a?a.next===a?this.root=void 0:(a.next.previous=a.previous,this.root=a.previous.next=a.next):(a.next.previous=a.previous,a.previous.next=a.next);a.next=void 0;a.previous=void 0;this.length--},findNode:function(a){if(void 0!==this.root)for(var b=this.root;b.next!==this.root;){if(b.data===a)return b;b=
b.next}},getFirst:function(){var a=this.getFirstNode();return void 0===a?void 0:a.data},getLast:function(){var a=this.getLastNode();return void 0===a?void 0:a.data},append:function(a){return this.appendNode({data:a})},prepend:function(a){return this.prependNode({data:a})},remove:function(a){a=this.findNode(a);void 0!==a&&this.removeNode(a)},clear:function(){this.root=void 0}},{},{moveNext:function(a){if(void 0!==a)return a.next},isLast:function(a){return void 0===a?!0:a.next===this.root}});Core.Object.extend("Core.DelayedTask",{delay:1,scope:void 0,callback:void 0,arguments:void 0,isDone:!1,handle:void 0,constructor:function(a){"delay"in a&&(this.delay=a.delay,delete a.delay);"scope"in a&&(this.scope=a.scope,delete a.scope);"arguments"in a?(this.arguments=a.arguments,delete a.arguments):this.arguments=[];if("callback"in a)this.callback=a.callback,delete a.callback;else throw"callback MUST be given for a DelayedTask";this.handle=setTimeout(this.onTimeout.bind(this),1E3*this.delay)},
onTimeout:function(){this.handle=void 0;this.isDone=!0;this.callback.apply(this.scope,[this])},abort:function(){void 0!==this.handle&&(clearTimeout(this.handle),this.handle=void 0)}});Core.Object.extend("Core.Timer",{interval:1,arguments:void 0,constructor:function(a){this.addEvents("timeupdate");"interval"in a&&(this.interval=a.interval,delete a.interval);"arguments"in a?(this.arguments=a.arguments,delete a.arguments):this.arguments=[];this.wrapper=function(){var a=(new Date).getTime()/1E3,c=arguments.callee.timer;c.fireEvent("timeupdate",c,c.arguments);a=(new Date).getTime()/1E3-a;0>a&&(a=0);a=1E3*c.interval-a;0>a&&(a=0);void 0!==c.handle&&(c.handle=setTimeout(c.wrapper,a))};
this.wrapper.timer=this;this.handle=setTimeout(this.wrapper,0)},abort:function(){void 0!==this.handle&&(clearTimeout(this.handle),this.handle=void 0)}});Core.Object.extend("Core.HttpRequest",{url:void 0,method:"GET",binary:!1,request:void 0,arguments:void 0,content:void 0,headers:void 0,constructor:function(a){this.addEvents("error","done");this.request=new XMLHttpRequest;a=function(){var a=arguments.callee.httprequest;4==a.request.readyState&&(200<=a.request.status&&300>a.request.status?a.fireEvent("done",a):a.fireEvent("error",a,a.request.status),a.request.onreadystatechange=null,a.request=void 0)};a.httprequest=this;this.request.onreadystatechange=
a},setUrl:function(a){this.url=a},setBinary:function(a){this.binary=a},setMethod:function(a){this.method=a},setRequestHeader:function(a,b){void 0===this.headers&&(this.headers={});this.headers[a]=b},setArguments:function(a){this.arguments=a},addArgument:function(a,b){void 0===this.arguments&&(this.arguments={});this.arguments[a]=b},setContent:function(a){this.content=a},abort:function(){this.request.abort()},send:function(){if(void 0===this.url)throw"url MUST be given for an HttpRequest";var a,b=
"";void 0!==this.arguments&&(b=Core.Util.encodeURIQuery(this.arguments));var c=this.url;if(("GET"===this.method||"DELETE"===this.method||void 0!==this.content)&&""!==b)c=-1===this.url.indexOf("?")?c+("?"+b):c+("&"+b);this.request.open(this.method,c,!0);this.binary&&this.request.overrideMimeType("text/plain; charset=x-user-defined");this.request.setRequestHeader("X-Requested-With","XMLHttpRequest");if(void 0!==Core.HttpRequest.requestHeaders)for(a in Core.HttpRequest.requestHeaders)this.request.setRequestHeader(a,
Core.HttpRequest.requestHeaders[a]);if(void 0!==this.headers)for(a in this.headers)this.request.setRequestHeader(a,this.headers[a]);void 0!==this.content?((void 0===this.headers||void 0===this.headers["Content-Type"])&&this.request.setRequestHeader("Content-Type","text/plain; charset=utf-8"),this.request.send(this.content)):""!==b&&("POST"===this.method||"PUT"===this.method)?((void 0===this.headers||void 0===this.headers["Content-Type"])&&this.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),
this.request.send(b)):this.request.send()},getResponseHeader:function(a){return this.request.getResponseHeader(a)},getResponseText:function(){return this.request.responseText},getResponseBase64:function(){return this.request.responseText.toBase64()},getResponseJSON:function(){var a;try{a=JSON.parse(this.getResponseText())}catch(b){a=void 0}return a},getResponseXML:function(){var a=new DOMParser;try{return a.parseFromString(this.getResponseText(),"text/xml")}catch(b){}},getStatus:function(){return this.request.status}},
{},{requestHeaders:void 0,setRequestHeader:function(a,b){void 0===Core.HttpRequest.requestHeaders&&(Core.HttpRequest.requestHeaders={});Core.HttpRequest.requestHeaders[a]=b}});Core.Object.extend("Core.Socket",{host:void 0,service:"/",port:80,mode:void 0,secure:!1,websocket:void 0,websocketdelay:void 0,emuopenrequest:void 0,emupollrequest:void 0,emusendrequest:void 0,emuid:void 0,emumessages:void 0,lastPosition:0,readSize:!0,size:0,data:"",isClosed:!1,closeSent:!1,sep:"?",lastPoll:void 0,delayPollTask:void 0,pollInterval:2.5,constructor:function(a){this.addEvents("error","message","close","open");"host"in a?(this.host=a.host,delete a.host):this.host=document.location.hostname;
"secure"in a?(this.secure=a.secure,delete a.secure):this.secure="https:"===document.location.protocol;"port"in a?(this.port=a.port,delete a.port):this.port=void 0!==document.location.port&&""!==document.location.port?document.location.port:this.secure?443:80;"service"in a&&(this.service=a.service,delete a.service,-1==this.service.indexOf("?")?this.sep="?":this.sep="&");"mode"in a?(this.mode=a.mode,delete a.mode):this.mode=Core.Socket.supportWebSocket?"websocket":"poll";"websocket"==this.mode?(this.websocket=
new WebSocket((this.secure?"wss":"ws")+"://"+this.host+":"+this.port+this.service),this.websocketdelay=new Core.DelayedTask({scope:this,callback:this.onWebSocketOpenTimeout,delay:30}),this.connect(this.websocket,"open",this.onWebSocketOpen),this.connect(this.websocket,"error",this.onWebSocketError),this.connect(this.websocket,"message",this.onWebSocketMessage),this.connect(this.websocket,"close",this.onWebSocketClose)):(this.emumessages=[],this.emuopenrequest=new Core.HttpRequest({url:(this.secure?
"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket=poll&command=open"}),this.connect(this.emuopenrequest,"done",this.onEmuSocketOpenDone),this.connect(this.emuopenrequest,"error",this.onEmuSocketOpenError),this.emuopenrequest.send())},send:function(a){void 0!==this.websocket?this.websocket.send(a):void 0===this.emusendrequest?(a=(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket="+this.mode+"&command=send&id="+this.emuid+"&messages="+
encodeURIComponent(a.toBase64()),this.emusendrequest=new Core.HttpRequest({url:a}),this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone),this.connect(this.emusendrequest,"error",this.onEmuSocketSendError),this.emusendrequest.send(),void 0!==this.delayPollTask&&(this.delayPollTask.abort(),this.delayPollTask=new Core.DelayedTask({delay:0.1,scope:this,callback:this.delayPollDone}))):this.emumessages.push(a.toBase64())},close:function(){void 0!==this.delayPollTask&&(this.delayPollTask.abort(),
this.delayPollTask=void 0);void 0!==this.websocket?(this.isClosed=!0,this.websocket.close()):this.isClosed||(this.isClosed=!0,void 0!==this.emuopenrequest?(this.emuopenrequest.abort(),this.emuopenrequest=void 0):void 0!==this.emuid&&void 0===this.emusendrequest&&(this.closeSent=!0,this.emusendrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket="+this.mode+"&command=close&id="+this.emuid}),this.connect(this.emusendrequest,"done",
this.onEmuSocketSendDone),this.connect(this.emusendrequest,"error",this.onEmuSocketSendError),this.emusendrequest.send()))},onWebSocketOpenTimeout:function(){this.websocketdelay=void 0;this.disconnect(this.websocket,"open",this.onWebSocketOpen);this.disconnect(this.websocket,"error",this.onWebSocketError);this.disconnect(this.websocket,"message",this.onWebSocketMessage);this.disconnect(this.websocket,"close",this.onWebSocketClose);this.websocket.close();this.websocket=void 0;this.mode="poll";this.emumessages=
[];this.emuopenrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket=poll&command=open"});this.connect(this.emuopenrequest,"done",this.onEmuSocketOpenDone);this.connect(this.emuopenrequest,"error",this.onEmuSocketOpenError);this.emuopenrequest.send()},onWebSocketOpen:function(){void 0!==this.websocketdelay&&(this.websocketdelay.abort(),this.websocketdelay=void 0);this.fireEvent("open",this)},onWebSocketError:function(){void 0!==
this.websocketdelay&&(this.websocketdelay.abort(),this.websocketdelay=void 0);this.fireEvent("error",this)},onWebSocketMessage:function(a){"PING"===a.data?this.websocket.send("PONG"):this.fireEvent("message",this,a.data)},onWebSocketClose:function(a){void 0!==this.websocketdelay&&(this.websocketdelay.abort(),this.websocketdelay=void 0);this.fireEvent("close",this)},emuSocketDataAvailable:function(a){void 0===this.emuid?(this.emuid=a,this.fireEvent("open",this)):"keepalive"!==a&&this.fireEvent("message",
this,a.fromBase64())},emuSocketUpdate:function(a){for(var b=0;b<a.length;b++){var c=a[b];this.readSize?":"===c?(this.readSize=!1,this.size=parseInt("0x"+this.data),this.data=""):this.data+=c:(this.data+=c,this.data.length>=this.size+2&&(this.emuSocketDataAvailable(this.data.substring(0,this.data.length-2)),this.readSize=!0,this.data=""))}},onEmuSocketSendDone:function(){this.emusendrequest.getResponseJSON();if(0<this.emumessages.length){for(var a="",b=0;b<this.emumessages.length;b++)""!==a&&(a+=";"),
a+=this.emumessages[b];this.emusendrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket="+this.mode+"&command=send&id="+this.emuid+"&messages="+encodeURIComponent(a)});this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone);this.connect(this.emusendrequest,"error",this.onEmuSocketSendError);this.emusendrequest.send();this.emumessages=[]}else this.isClosed&&!this.closeSent?(this.emusendrequest=new Core.HttpRequest({url:(this.secure?
"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket="+this.mode+"&command=close&id="+this.emuid}),this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone),this.connect(this.emusendrequest,"error",this.onEmuSocketSendError),this.emusendrequest.send()):this.emusendrequest=void 0},onEmuSocketSendError:function(){this.emusendrequest=void 0},onEmuSocketOpenDone:function(){this.lastPoll=new Date;var a=this.emuopenrequest.getResponseJSON();this.emuopenrequest=void 0;void 0===
a?(this.fireEvent("error",this),this.fireEvent("close",this)):(this.emuid=a.id,"keepAliveInterval"in a&&(this.pollInterval=Math.min(a.keepAliveInterval,2.5)),"open"!=a.status?(this.fireEvent("error",this),this.fireEvent("close",this)):(this.fireEvent("open",this),this.emupollrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket=poll&command=poll&id="+this.emuid}),this.connect(this.emupollrequest,"done",this.onEmuSocketPollDone),
this.connect(this.emupollrequest,"error",this.onEmuSocketPollError),this.emupollrequest.send()))},onEmuSocketOpenError:function(a,b){this.emuopenrequest=void 0;this.fireEvent("error",this);this.fireEvent("close",this)},onEmuSocketPollDone:function(){var a=this.emupollrequest.getResponseJSON();this.emupollrequest=void 0;if(void 0===a)this.close(),this.fireEvent("close",this);else{if(void 0!==a.messages)for(var b=0;b<a.messages.length;b++){var c=a.messages[b].fromBase64();this.fireEvent("message",this,
c)}"open"!==a.status?(this.close(),this.fireEvent("close",this)):(a=new Date,b=Math.max(0,a.getTime()-this.lastPoll.getTime()),this.lastPoll=a,b>=1E3*this.pollInterval?this.sendPoll():this.delayPollTask=new Core.DelayedTask({delay:this.pollInterval,scope:this,callback:this.delayPollDone}))}},onEmuSocketPollError:function(){this.emupollrequest=void 0;this.fireEvent("error",this);this.close()},delayPollDone:function(){this.delayPollTask=void 0;void 0===this.emupollrequest&&this.sendPoll()},sendPoll:function(){this.lastPoll=
new Date;this.emupollrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket=poll&command=poll&id="+this.emuid});this.connect(this.emupollrequest,"done",this.onEmuSocketPollDone);this.connect(this.emupollrequest,"error",this.onEmuSocketPollError);this.emupollrequest.send()}});Core.Socket.supportWebSocket="WebSocket"in window;Core.Object.extend("Core.File",{iframe:void 0,form:void 0,fileInput:void 0,fileApi:void 0,constructor:function(a){void 0!==a.form&&(this.form=a.form,delete a.form);void 0!==a.iframe&&(this.iframe=a.iframe,delete a.iframe);void 0!==a.fileInput&&(this.fileInput=a.fileInput,delete a.fileInput);void 0!==a.fileApi&&(this.fileApi=a.fileApi,delete a.fileApi)},getFileName:function(){return void 0!==this.fileApi?void 0!==this.fileApi.fileName?this.fileApi.fileName:this.fileApi.name:void 0!==this.fileInput.fileName?
this.fileInput.fileName:this.fileInput.name},getRelativePath:function(){var a;void 0!==this.fileApi&&("relativePath"in this.fileApi?a=this.fileApi.relativePath:"webkitRelativePath"in this.fileApi?a=this.fileApi.webkitRelativePath:"mozRelativePath"in this.fileApi&&(a=this.fileApi.mozRelativePath));""===a&&(a=void 0);return a},getMimetype:function(){var a=Core.File.getMimetypeFromName(this.getFileName());"application/octet-stream"===a&&(void 0!==this.fileApi&&"type"in this.fileApi)&&(a=this.fileApi.type);
return a}},{},{types:{"3dm":"x-world/x-3dmf","3dmf":"x-world/x-3dmf",a:"application/octet-stream",aab:"application/x-authorware-bin",aac:"aaudio/aac",aam:"application/x-authorware-map",aas:"application/x-authorware-seg",abc:"text/vnd.abc",acgi:"text/html",afl:"video/animaflex",ai:"application/postscript",aif:"audio/aiff",aifc:"audio/aiff",aiff:"audio/aiff",aim:"application/x-aim",aip:"text/x-audiosoft-intra",ani:"application/x-navi-animation",aos:"application/x-nokia-9000-communicator-add-on-software",
aps:"application/mime",arc:"application/octet-stream",arj:"application/arj",art:"image/x-jg",asf:"video/x-ms-asf",asm:"text/x-asm",asp:"text/asp",asx:"video/x-ms-asf",au:"audio/basic",avi:"video/avi",avs:"video/avs-video",bcpio:"application/x-bcpio",bin:"application/octet-stream",bm:"image/bmp",bmp:"image/bmp",boo:"application/book",book:"application/book",boz:"application/x-bzip2",bsh:"application/x-bsh",bz:"application/x-bzip",bz2:"application/x-bzip2",c:"text/plain","c++":"text/plain",cat:"application/vnd.ms-pki.seccat",
cc:"text/plain",ccad:"application/clariscad",cco:"application/x-cocoa",cdf:"application/cdf",cer:"application/pkix-cert",cha:"application/x-chat",chat:"application/x-chat","class":"application/java",com:"application/octet-stream",conf:"text/plain",cpio:"application/x-cpio",cpp:"text/x-c",cpt:"application/x-cpt",crl:"application/pkcs-crl",crt:"application/pkix-cert",csh:"application/x-csh",css:"text/css",cxx:"text/plain",dcr:"application/x-director",deepv:"application/x-deepv",def:"text/plain",der:"application/x-x509-ca-cert",
dif:"video/x-dv",dir:"application/x-director",dl:"video/dl",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",dp:"application/commonground",drw:"application/drafting",dump:"application/octet-stream",dv:"video/x-dv",dvi:"application/x-dvi",dwf:"model/vnd.dwf",dwg:"image/vnd.dwg",dxf:"image/vnd.dwg",dxr:"application/x-director",el:"text/x-script.elisp",
elc:"application/x-elc",env:"application/x-envoy",eot:"application/vnd.ms-fontobject",eps:"application/postscript",es:"application/x-esrehber",etx:"text/x-setext",evy:"application/envoy",exe:"application/octet-stream",f:"text/plain",f77:"text/x-fortran",f90:"text/plain",fdf:"application/vnd.fdf",fif:"image/fif",fli:"video/fli",flo:"image/florian",flx:"text/vnd.fmi.flexstor",fmf:"video/x-atomic3d-feature","for":"text/x-fortran",fpx:"image/vnd.fpx",frl:"application/freeloader",funk:"audio/make",g:"text/plain",
g3:"image/g3fax",gif:"image/gif",gl:"video/gl",gsd:"audio/x-gsm",gsm:"audio/x-gsm",gsp:"application/x-gsp",gss:"application/x-gss",gtar:"application/x-gtar",gz:"application/x-gzip",gzip:"application/x-gzip",h:"text/plain",hdf:"application/x-hdf",help:"application/x-helpfile",hgl:"application/vnd.hp-hpgl",hh:"text/plain",hlb:"text/x-script",hlp:"application/hlp",hpg:"application/vnd.hp-hpgl",hpgl:"application/vnd.hp-hpgl",hqx:"application/binhex",hta:"application/hta",htc:"text/x-component",htm:"text/html",
html:"text/html",htmls:"text/html",htt:"text/webviewhtml",htx:"text/html",ice:"x-conference/x-cooltalk",ico:"image/x-icon",idc:"text/plain",ief:"image/ief",iefs:"image/ief",iges:"application/iges",igs:"application/iges",ima:"application/x-ima",imap:"application/x-httpd-imap",inf:"application/inf",ins:"application/x-internett-signup",ip:"application/x-ip2",isu:"video/x-isvideo",it:"audio/it",iv:"application/x-inventor",ivr:"i-world/i-vrml",ivy:"application/x-livescreen",jam:"audio/x-jam",jav:"text/plain",
java:"text/plain",jcm:"application/x-java-commerce",jfif:"image/jpeg","jfif-tbnl":"image/jpeg",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",jps:"image/x-jps",js:"application/javascript",jut:"image/jutvision",kar:"audio/midi",ksh:"application/x-ksh",la:"audio/nspaudio",lam:"audio/x-liveaudio",latex:"application/x-latex",lha:"application/octet-stream",lhx:"application/octet-stream",list:"text/plain",lma:"audio/nspaudio",log:"text/plain",lsp:"application/x-lisp",lst:"text/plain",lsx:"text/x-la-asf",
ltx:"application/x-latex",lzh:"application/octet-stream",lzx:"application/octet-stream",m:"text/plain",m1v:"video/mpeg",m2a:"audio/mpeg",m2v:"video/mpeg",m3u:"audio/x-mpequrl",m4a:"audio/mp4",m4v:"video/mp4",man:"application/x-troff-man",map:"application/x-navimap",mar:"text/plain",mbd:"application/mbedlet",mc$:"application/x-magic-cap-package-1.0",mcd:"application/mcad",mcf:"text/mcf",mcp:"application/netmc",me:"application/x-troff-me",mht:"message/rfc822",mhtml:"message/rfc822",mid:"audio/midi",
midi:"audio/midi",mif:"application/x-mif",mime:"message/rfc822",mjf:"audio/x-vnd.audioexplosion.mjuicemediafile",mjpg:"video/x-motion-jpeg",mm:"application/base64",mme:"application/base64",mod:"audio/mod",moov:"video/quicktime",mov:"video/quicktime",movie:"video/x-sgi-movie",mp2:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mpa:"audio/mpeg",mpc:"application/x-project",mpe:"video/mpeg",mpeg:"video/mpeg",mpg:"video/mpeg",mpga:"audio/mpeg",mpp:"application/vnd.ms-project",mpt:"application/vnd.ms-project",
mpv:"application/vnd.ms-project",mpx:"application/vnd.ms-project",mrc:"application/marc",ms:"application/x-troff-ms",mv:"video/x-sgi-movie",my:"audio/make",mzz:"application/x-vnd.audioexplosion.mzz",nap:"image/naplps",naplps:"image/naplps",nc:"application/x-netcdf",ncm:"application/vnd.nokia.configuration-message",nif:"image/x-niff",niff:"image/x-niff",nix:"application/x-mix-transfer",nsc:"application/x-conference",nvd:"application/x-navidoc",o:"application/octet-stream",oda:"application/oda",odb:"application/vnd.oasis.opendocument.database",
odc:"application/vnd.oasis.opendocument.chart",odf:"application/vnd.oasis.opendocument.formula",odg:"application/vnd.oasis.opendocument.graphics",odi:"application/vnd.oasis.opendocument.image",odm:"application/vnd.oasis.opendocument.text-master",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"audio/ogg",omc:"application/x-omc",omcd:"application/x-omcdatamaker",omcr:"application/x-omcregerator",
otg:"application/vnd.oasis.opendocument.graphics-template",otp:"application/vnd.oasis.opendocument.presentation-template",ots:"application/vnd.oasis.opendocument.spreadsheet-template",ott:"application/vnd.oasis.opendocument.text-template",p:"text/x-pascal",p10:"application/pkcs10",p12:"application/pkcs-12",p7a:"application/x-pkcs7-signature",p7c:"application/pkcs7-mime",p7m:"application/pkcs7-mime",p7r:"application/x-pkcs7-certreqresp",p7s:"application/pkcs7-signature",part:"application/pro_eng",
pas:"text/pascal",pbm:"image/x-portable-bitmap",pcl:"application/vnd.hp-pcl",ct:"image/x-pict",pcx:"image/x-pcx",pdb:"chemical/x-pdb",pdf:"application/pdf",pfunk:"audio/make",pgm:"image/x-portable-greymap",pic:"image/pict",pict:"image/pict",kg:"application/x-newton-compatible-pkg",pko:"application/vnd.ms-pki.pko",pl:"text/plain",plx:"application/x-pixclscript",pm:"image/x-xpixmap",pm4:"application/x-pagemaker",pm5:"application/x-pagemaker",png:"image/png",pnm:"application/x-portable-anymap",pot:"application/vnd.ms-powerpoint",
ov:"model/x-pov",ppa:"application/vnd.ms-powerpoint",ppm:"image/x-portable-pixmap",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ppz:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",pre:"application/x-freelance",prt:"application/pro_eng",ps:"application/postscript",
psd:"application/octet-stream",pvu:"paleovu/x-pv",pwz:"application/vnd.ms-powerpoint",py:"text/x-script.phyton",pyc:"applicaiton/x-bytecode.python",qcp:"audio/vnd.qcelp",qd3:"x-world/x-3dmf",qd3d:"x-world/x-3dmf",qif:"image/x-quicktime",qt:"video/quicktime",qtc:"video/x-qtc",qti:"image/x-quicktime",qtif:"image/x-quicktime",ra:"audio/x-pn-realaudio",ram:"audio/x-pn-realaudio",ras:"application/x-cmu-raster",rast:"image/cmu-raster",rexx:"text/x-script.rexx",rf:"image/vnd.rn-realflash",rgb:"image/x-rgb",
rm:"application/vnd.rn-realmedia",rmi:"audio/mid",rmm:"audio/x-pn-realaudio",rmp:"audio/x-pn-realaudio",rng:"application/ringing-tones",rnx:"application/vnd.rn-realplayer",roff:"application/x-troff",rp:"image/vnd.rn-realpix",rpm:"audio/x-pn-realaudio-plugin",rt:"text/richtext",rtf:"text/richtext",rtx:"text/richtext",rv:"video/vnd.rn-realvideo",s:"text/x-asm",s3m:"audio/s3m",saveme:"application/octet-stream",sbk:"application/x-tbook",scm:"application/x-lotusscreencam",sdml:"text/plain",sdp:"application/sdp",
sdr:"application/sounder",sea:"application/sea",set:"application/set",sgm:"text/sgml",sgml:"text/sgml",sh:"application/x-sh",shar:"application/x-shar",shtml:"text/html",sid:"audio/x-psid",sit:"application/x-sit",skd:"application/x-koan",skm:"application/x-koan",skp:"application/x-koan",skt:"application/x-koan",sl:"application/x-seelogo",smi:"application/smil",smil:"application/smil",snd:"audio/basic",sol:"application/solids",spc:"text/x-speech",spl:"application/futuresplash",spr:"application/x-sprite",
sprite:"application/x-sprite",src:"application/x-wais-source",ssi:"text/x-server-parsed-html",ssm:"application/streamingmedia",sst:"application/vnd.ms-pki.certstore",step:"application/step",stl:"application/sla",stp:"application/step",sv4cpio:"application/x-sv4cpio",sv4crc:"application/x-sv4crc",svf:"image/vnd.dwg",svg:"image/svg+xml",svr:"application/x-world",swf:"application/x-shockwave-flash",sxw:"application/vnd.sun.xml.writer",t:"application/x-troff",talk:"text/x-speech",tar:"application/x-tar",
tbk:"application/toolbook",tcl:"application/x-tcl",tcsh:"text/x-script.tcsh",tex:"application/x-tex",texi:"application/x-texinfo",texinfo:"application/x-texinfo",text:"text/plain",tgz:"application/x-compressed",tif:"image/tiff",tiff:"image/tiff",tr:"application/x-troff",tsi:"audio/tsp-audio",tsp:"application/dsptype",tsv:"text/tab-separated-values",ttf:"font/ttf",turbot:"image/florian",txt:"text/plain",uil:"text/x-uil",uni:"text/uri-list",unis:"text/uri-list",unv:"application/i-deas",uri:"text/uri-list",
uris:"text/uri-list",ustar:"application/x-ustar",uu:"application/octet-stream",uue:"text/x-uuencode",vcd:"application/x-cdlink",vcs:"text/x-vcalendar",vda:"application/vda",vdo:"video/vdo",vew:"application/groupwise",viv:"video/vivo",vivo:"video/vivo",vmd:"application/vocaltec-media-desc",vmf:"application/vocaltec-media-file",voc:"audio/voc",vos:"video/vosaic",vox:"audio/voxware",vqe:"audio/x-twinvq-plugin",vqf:"audio/x-twinvq",vql:"audio/x-twinvq-plugin",vrml:"application/x-vrml",vrt:"x-world/x-vrt",
vsd:"application/x-visio",vst:"application/x-visio",vsw:"application/x-visio",w60:"application/wordperfect6.0",w61:"application/wordperfect6.1",w6w:"application/msword",wav:"audio/wav",wb1:"application/x-qpro",wbmp:"image/vnd.wap.wbmp",web:"application/vnd.xara",weba:"audio/webm",webm:"video/webm",webp:"image/webp",wiz:"application/msword",wk1:"application/x-123",wmf:"windows/metafile",wml:"text/vnd.wap.wml",wmlc:"application/vnd.wap.wmlc",wmls:"text/vnd.wap.wmlscript",wmlsc:"application/vnd.wap.wmlscriptc",
woff:"application/font-woff",word:"application/msword",wp:"application/wordperfect",wp5:"application/wordperfect",wp6:"application/wordperfect",wpd:"application/wordperfect",wq1:"application/x-lotus",wri:"application/mswrite",wrl:"application/x-world",wrz:"x-world/x-vrml",wsc:"text/scriplet",wsrc:"application/x-wais-source",wtk:"application/x-wintalk",xbm:"image/x-xbitmap",xdr:"video/x-amt-demorun",xgz:"xgl/drawing",xif:"image/vnd.xiff",xl:"application/excel",xla:"application/vnd.ms-excel",xlb:"application/vnd.ms-excel",
xlc:"application/vnd.ms-excel",xld:"application/vnd.ms-excel",xlk:"application/vnd.ms-excel",xll:"application/vnd.ms-excel",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlt:"application/vnd.ms-excel",xlv:"application/vnd.ms-excel",xlw:"application/vnd.ms-excel",xm:"audio/xm",xml:"application/xml",xmz:"xgl/movie",xpix:"application/x-vnd.ls-xpix",xpm:"image/xpm","x-png":"image/png",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",
xsr:"video/x-amt-showrun",xwd:"image/x-xwd",xyz:"chemical/x-pdb",z:"application/x-compressed",zip:"application/zip",zoo:"application/octet-stream",zsh:"text/x-script.zsh"},getMimetypeFromName:function(a){var b=a.lastIndexOf(".");if(-1===b)return"application/octet-stream";a=a.substring(b+1).toLowerCase();a=Core.File.types[a];return void 0===a?"application/octet-stream":a}});Core.Object.extend("Core.FilePostUploader",{file:void 0,service:void 0,reader:void 0,request:void 0,binaryString:!1,responseText:void 0,fileReader:void 0,boundary:void 0,method:"POST",fields:void 0,isCompleted:!1,loadedOctets:void 0,totalOctets:void 0,constructor:function(a){this.addEvents("progress","complete","error");this.fields={}},setMethod:function(a){this.method=a},getFile:function(){return this.file},setFile:function(a){this.file=a},setService:function(a){this.service=a},setField:function(a,
b){this.fields[a]=b},setDestination:function(a){this.setField("destination",a)},send:function(){var a;if(void 0!==this.file.fileApi)if(navigator.supportFormData){var b=new FormData;void 0===this.destination&&(this.destination=this.file.getFileName());for(a in this.fields)b.append(a,this.fields[a]);b.append("file",this.file.fileApi);this.request=new XMLHttpRequest;"upload"in this.request&&this.connect(this.request.upload,"progress",this.onUpdateProgress);this.request.open(this.method,this.service);
this.request.send(b);a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onStateChange;this.request.onreadystatechange=a}else{this.fileReader=new FileReader;this.request=new XMLHttpRequest;"upload"in this.request&&this.connect(this.request.upload,"progress",this.onUpdateProgress);this.request.open(this.method,this.service);this.boundary="----";for(a=0;16>a;a++)this.boundary+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"[Math.floor(62*
Math.random())];this.boundary+="----";this.request.setRequestHeader("Content-Type","multipart/form-data, boundary="+this.boundary);this.request.setRequestHeader("Content-Length",this.file.fileApi.size);a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onStateChange;this.request.onreadystatechange=a;a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onFileReaderLoad;this.fileReader.onload=
a;a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onFileReaderError;this.fileReader.onerror=a;this.fileReader.readAsBinaryString(this.file.fileApi)}else{this.file.form.action=this.service;for(a in this.fields)b=document.createElement("input"),b.type="hidden",b.setAttribute("name",a),destDrawing.setAttribute("value",this.fields[a]),this.file.form.insertBefore(b,this.file.form.firstChild);this.connect(this.file.iframe,"load",this.onIFrameLoad);
a=0;for(b=!1;!b&&5>a;)try{this.file.form.submit(),b=!0}catch(c){a++}}},abort:function(){void 0!==this.request&&(this.request.abort(),this.request=void 0)},getResponseText:function(){return this.responseText},getResponseJSON:function(){var a;try{a=JSON.parse(this.getResponseText())}catch(b){a=void 0}return a},onStateChange:function(a){4==this.request.readyState&&(this.isCompleted=!0,200==this.request.status?(this.responseText=this.request.responseText,this.fireEvent("complete",this)):(this.responseText=
this.request.responseText,this.fireEvent("error",this,this.request.status)),this.request=void 0)},getIsCompleted:function(){return this.isCompleted},getTotal:function(){return this.totalOctets},getLoaded:function(){return this.loadedOctets},onUpdateProgress:function(a){this.loadedOctets=a.loaded;this.totalOctets=a.total;this.fireEvent("progress",this,a.loaded,a.total)},onFileReaderError:function(a){this.request.abort();this.request=void 0;this.fireEvent("error",this);this.fileReader=void 0},onFileReaderLoad:function(a){var b=
"--"+this.boundary+"\r\n",b=b+("Content-Disposition: form-data; name='file'; filename='"+this.file.fileApi.name+"'\r\n"),b=b+("Content-Type: "+this.file.fileApi.type+"\r\n\r\n"),b=b+(a.target.result+"\r\n"),b=b+("--"+this.boundary+"--");this.request.sendAsBinary(b);this.fileReader=void 0},onIFrameLoad:function(a){this.responseText=a.target.contentWindow.document.body.innerText;document.body.removeChild(this.file.iframe);this.fireEvent("complete",this)}});"getUserMedia"in navigator||(navigator.getUserMedia="webkitGetUserMedia"in navigator?navigator.webkitGetUserMedia.bind(navigator):"mozGetUserMedia"in navigator?navigator.mozGetUserMedia.bind(navigator):void 0);navigator.supportUserMedia=void 0!==navigator.getUserMedia;"mozRTCPeerConnection"in window?RTCPeerConnection=mozRTCPeerConnection:"webkitRTCPeerConnection"in window&&(RTCPeerConnection=webkitRTCPeerConnection);"mozRTCSessionDescription"in window?RTCSessionDescription=mozRTCSessionDescription:"webkitRTCSessionDescription"in window&&(RTCSessionDescription=webkitRTCSessionDescription);"mozRTCIceCandidate"in window?RTCIceCandidate=mozRTCIceCandidate:"webkitRTCIceCandidate"in window&&(RTCIceCandidate=webkitRTCIceCandidate);
navigator.supportWebRTC="RTCPeerConnection"in window&&void 0!==RTCPeerConnection;Core.Object.extend("Core.RemoteDebug",{host:void 0,port:void 0,socket:void 0,socketAlive:!1,retryTask:void 0,nativeConsole:void 0,buffer:void 0,constructor:function(a){Core.RemoteDebug.current=this;this.host=a.host;delete a.host;this.port=a.port;delete a.port;this.buffer=[];this.nativeConsole=window.console;window.console={log:Core.RemoteDebug.onConsoleLog,error:Core.RemoteDebug.onConsoleError,warn:Core.RemoteDebug.onConsoleWarn};window.onerror=Core.RemoteDebug.onError;this.startSocket()},startSocket:function(){this.socket=
new Core.Socket({service:"/",host:this.host,port:this.port});this.connect(this.socket,"open",this.onSocketOpen);this.connect(this.socket,"message",this.onSocketMessage);this.connect(this.socket,"error",this.onSocketError);this.connect(this.socket,"close",this.onSocketClose)},onSocketOpen:function(){for(this.socketAlive=!0;0<this.buffer.length;)this.socket.send(this.buffer.shift())},onSocketMessage:function(a,b){eval(b)},onSocketError:function(){this.socketAlive=!1;this.socket.close()},onSocketClose:function(){this.socketAlive=
!1;this.disconnect(this.socket,"error",this.oSocketError);this.disconnect(this.socket,"close",this.onSocketClose);this.socket=void 0;this.retryTask=new Core.DelayedTask({delay:5,scope:this,callback:this.startSocket})},onConsoleLog:function(a){this.socketAlive?this.socket.send(JSON.stringify({type:"log",message:a})):this.buffer.push(JSON.stringify({type:"log",message:a}))},onConsoleError:function(a){this.socketAlive?this.socket.send(JSON.stringify({type:"error",message:a})):this.buffer.push(JSON.stringify({type:"error",
message:a}))},onConsoleWarn:function(a){this.socketAlive?this.socket.send(JSON.stringify({type:"warn",message:a})):this.buffer.push(JSON.stringify({type:"warn",message:a}))},onError:function(a,b,c){this.socketAlive?this.socket.send(JSON.stringify({type:"warn",message:a,url:b,line:c})):this.buffer.push(JSON.stringify({type:"warn",message:a,url:b,line:c}))}},{},{current:void 0,onConsoleLog:function(a){Core.RemoteDebug.current.onConsoleLog.call(Core.RemoteDebug.current,a)},onConsoleError:function(a){Core.RemoteDebug.current.onConsoleError.call(Core.RemoteDebug.current,
a)},onConsoleWarn:function(a){Core.RemoteDebug.current.onConsoleWarn.call(Core.RemoteDebug.current,a)},onError:function(a,b,c){Core.RemoteDebug.current.onError.call(Core.RemoteDebug.current,a,b,c)}});Core.Object.extend("Anim.TimeManager",{clocks:void 0,timer:void 0,start:0,constructor:function(a){this.clocks=[];this.start=(new Date).getTime();this.addEvents("tick")},add:function(a){for(var b=!1,c=0;!b&&c<this.clocks.length;c++)b=this.clocks[c]===a;b||(this.clocks.push(a),1===this.clocks.length&&(this.timer=new Core.Timer({interval:1/60}),this.connect(this.timer,"timeupdate",this.onTick)))},remove:function(a){for(var b=0;b<this.clocks.length&&this.clocks[b]!=a;)b++;b<this.clocks.length&&this.clocks.splice(b,
1);0===this.clocks.length&&(this.timer.abort(),this.timer=void 0)},onTick:function(){for(var a=(new Date).getTime()-this.start,a=a/1E3,b=0;b<this.clocks.length;b++)this.clocks[b].update(a);this.fireEvent("tick")}});Anim.TimeManager.current=new Anim.TimeManager;Core.Object.extend("Anim.AnimationManager",{clocks:void 0,start:0,onTickBind:void 0,constructor:function(a){this.addEvents("tick");this.clocks=[];this.start=(new Date).getTime();this.onTickBind=this.onTick.bind(this)},add:function(a){for(var b=!1,c=0;!b&&c<this.clocks.length;c++)b=this.clocks[c]===a;b||(this.clocks.push(a),1==this.clocks.length&&requestAnimationFrame(this.onTickBind))},remove:function(a){for(var b=0;b<this.clocks.length&&this.clocks[b]!=a;)b++;b<this.clocks.length&&this.clocks.splice(b,
1)},forceTick:function(){if(0<this.clocks.length)this.onTickBind()},onTick:function(){(new Date).getTime();for(var a=(new Date).getTime()-this.start,a=a/1E3,b=0;b<this.clocks.length;b++)this.clocks[b].update(a);this.fireEvent("tick");0<this.clocks.length&&requestAnimationFrame(this.onTickBind)}});
"requestAnimationFrame"in window||(window.requestAnimationFrame="webkitRequestAnimationFrame"in window?window.webkitRequestAnimationFrame:"mozRequestAnimationFrame"in window?window.mozRequestAnimationFrame:"msRequestAnimationFrame"in window?window.msRequestAnimationFrame:function(a){setTimeout(a,1/60)});Anim.AnimationManager.current=new Anim.AnimationManager;Core.Object.extend("Anim.EasingFunction",{mode:"in",constructor:function(a){},setMode:function(a){this.mode=a},getMode:function(){return this.mode},ease:function(a){return"in"==this.mode?this.easeInCore(a):"out"==this.mode?1-this.easeInCore(1-a):0.5>=a?this.easeInCore(2*a)/2:0.5+(1-this.easeInCore(2-2*a))/2},easeInCore:function(a){return a}},{},{eases:{},register:function(a,b){this.eases[a]=b},parse:function(a){return new this.eases[a]}});Anim.EasingFunction.extend("Anim.LinearEase",{constructor:function(a){}},{easeInCore:function(a){return a}},{constructor:function(){Anim.EasingFunction.register("linear",this)}});Anim.EasingFunction.extend("Anim.PowerEase",{power:2,constructor:function(a){this.autoConfig(a,"power")},setPower:function(a){this.power=a},getPower:function(){return this.power}},{easeInCore:function(a){return Math.pow(a,this.power)}},{constructor:function(){Anim.EasingFunction.register("power",this)}});Anim.EasingFunction.extend("Anim.ElasticEase",{oscillations:3,springiness:3,constructor:function(a){},setOscillations:function(a){this.oscillations=a},getOscillations:function(){return this.oscillations},setSpringiness:function(a){this.springiness=a},getSpringiness:function(){return this.springiness}},{easeInCore:function(a){return Math.sin(a*(2*this.oscillations+0.5)*Math.PI)*Math.pow(a,this.springiness)}},{constructor:function(){Anim.EasingFunction.register("elastic",this)}});Anim.EasingFunction.extend("Anim.BounceEase",{bounces:3,bounciness:2,constructor:function(a){},setBounces:function(a){this.bounces=a},getBounces:function(){return this.Bounces},setBounciness:function(a){this.bounciness=a},getBounciness:function(){return this.bounciness}},{easeInCore:function(a){a=Math.exp(1/this.bounciness*Math.log(a));var b=Math.floor(a*(this.bounces+0.5));return Math.sin((a*(this.bounces+0.5)-b)*Math.PI)/Math.exp(this.bounces-b)}},{constructor:function(){Anim.EasingFunction.register("bounce",
this)}});Core.Object.extend("Anim.Clock",{animation:!0,parent:void 0,time:void 0,iteration:void 0,progress:void 0,isActive:!1,globalTime:0,startTime:0,lastTick:0,beginTime:0,isPaused:!1,speed:1,duration:"forever",pendingState:"none",autoReverse:!1,repeat:1,target:void 0,ease:void 0,constructor:function(a){this.addEvents("complete","timeupdate")},setAnimation:function(a){this.animation=a},setRepeat:function(a){this.repeat=a},setSpeed:function(a){this.speed=a},setAutoReverse:function(a){this.autoReverse=a},
setBeginTime:function(a){this.beginTime=a},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},setTarget:function(a){this.target=a},setDuration:function(a){this.duration="automatic"==a?"forever":a},setParent:function(a){this.parent=a},getParent:function(){return this.parent},getGlobalTime:function(){return this.globalTime+(this.lastTick-this.startTime)*this.speed},getIsActive:function(){return this.isActive||"active"===this.pendingState},getTime:function(){return this.time},getIteration:function(){return this.iteration},
getProgress:function(){return this.progress},begin:function(){this.getIsActive()||(void 0===this.parent?this.animation?Anim.AnimationManager.current.add(this):Anim.TimeManager.current.add(this):void 0===this.scope&&(this.scope=this.parent.scope),this.pendingState="active",void 0!==this.target&&void 0!==this.target.setAnimClock&&this.target.setAnimClock(this))},pause:function(){this.pendingState="paused"},resume:function(){this.pendingState="resumed"},stop:function(){this.pendingState="stopped"},onComplete:function(){void 0===
this.parent&&(this.animation?Anim.AnimationManager.current.remove(this):Anim.TimeManager.current.remove(this));this.fireEvent("complete")},onTimeUpdate:function(a){var b=this.getProgress();void 0!==this.ease&&(b=this.ease.ease(b));this.fireEvent("timeupdate",this,b,a)},update:function(a){var b;do if(b=this.pendingState,this.pendingState="none","none"===b){if(this.isActive&&!this.isPaused){b=a-this.lastTick;this.lastTick=a;var c=this.getGlobalTime(),c=c-this.beginTime;if(0<=c)if("forever"!==this.duration&&
"automatic"!==this.duration){var d=c/this.duration,e=Math.floor(d+1),c=c%this.duration;this.autoReverse&&(0===(e&1)&&(c=this.duration-c),d/=2,e=Math.floor(d+1));"forever"==this.repeat?(this.iteration=e,this.time=c,this.progress=c/this.duration,this.onTimeUpdate(b)):d>=this.repeat?(this.pendingState="stopped",this.iteration=this.repeat,this.time=this.duration,this.progress=this.autoReverse?0:1,this.onTimeUpdate(0)):(this.iteration=e,this.time=c,this.progress=c/this.duration,this.onTimeUpdate(b))}else this.time=
c,this.progress=0,this.iteration=void 0,this.onTimeUpdate(b)}}else"active"==b?this.isActive||(this.isActive=!0,this.globalTime=0,this.lastTick=this.startTime=a,0<this.beginTime?this.iteration=this.progress=this.time=void 0:(this.progress=this.time=0,this.iteration=1,this.onTimeUpdate(0))):"paused"==b?!this.isPaused&&this.isActive&&(this.isPaused=!0,this.globalTime=this.getGlobalTime(),this.lastTick=this.startTime=0):"resumed"==b?this.isPaused&&this.isActive&&(this.isPaused=!1,this.lastTick=this.startTime=
a):"stopped"==b&&this.isActive&&(this.iteration=this.time=this.progress=void 0,this.isActive=!1);while("none"!=this.pendingState);if(void 0===this.parent&&!this.isActive)this.onComplete()}});Anim.Clock.extend("Anim.ClockGroup",{children:void 0,constructor:function(a){this.children=[]},appendChild:function(a){a.setParent(this);this.children.push(a)},setContent:function(a){this.children=[];if(void 0!==a&&"object"===typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.appendChild(Anim.Clock.create(a[b]));else this.appendChild(Anim.Clock.create(a))}},{begin:function(){Anim.ClockGroup.base.begin.call(this);for(var a=0;a<this.children.length;a++)this.children[a].begin()},pause:function(){Anim.ClockGroup.base.pause.call(this);
for(var a=0;a<this.children.length;a++)this.children[a].pause()},resume:function(){Anim.ClockGroup.base.resume.call(this);for(var a=0;a<this.children.length;a++)this.children[a].resume()},stop:function(){Anim.ClockGroup.base.stop.call(this);for(var a=0;a<this.children.length;a++)this.children[a].stop()},onCompleted:function(){Anim.ClockGroup.base.onCompleted.call(this);for(var a=0;a<this.children.length;a++)this.children[a].onCompleted()},update:function(a){do{Anim.ClockGroup.base.update.call(this,
a);for(var b=!0,c=0;c<this.children.length;c++){var d=this.children[c];d.update(this.getGlobalTime());d.getIsActive()&&(b=!1)}this.getIsActive()&&b&&(this.pendingState="stopped")}while("none"!=this.pendingState)}});Core.Object.extend("Ui.Matrix",{a:1,b:0,c:0,d:1,e:0,f:0,constructor:function(a){},isTranslateOnly:function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d},isIdentity:function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},translate:function(a,b){return this.multiply(Ui.Matrix.createTranslate(a,b))},rotate:function(a){return this.multiply(Ui.Matrix.createRotate(a))},scale:function(a,b){void 0===b&&(b=a);return this.multiply(Ui.Matrix.createScale(a,b))},multiply:function(a){return Ui.Matrix.createMatrix(a.a*
this.a+a.b*this.c,a.a*this.b+a.b*this.d,a.c*this.a+a.d*this.c,a.c*this.b+a.d*this.d,a.e*this.a+a.f*this.c+this.e,a.e*this.b+a.f*this.d+this.f)},getDeterminant:function(){return this.a*this.d-this.b*this.c},inverse:function(){var a=this.getDeterminant();if(0===a)throw"Matrix not invertible";a=1/a;return new Ui.Matrix.createMatrix(this.d*a,-this.b*a,-this.c*a,this.a*a,(this.c*this.f-this.e*this.d)*a,(this.e*this.b-this.a*this.f)*a)},setMatrix:function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.d=
d;this.e=e;this.f=f},getA:function(){return this.a},getB:function(){return this.b},getC:function(){return this.c},getD:function(){return this.d},getE:function(){return this.e},getF:function(){return this.f},clone:function(){return Ui.Matrix.createMatrix(this.a,this.b,this.c,this.d,this.e,this.f)}},{toString:function(){return"matrix("+this.a.toFixed(4)+","+this.b.toFixed(4)+","+this.c.toFixed(4)+","+this.d.toFixed(4)+","+this.e.toFixed(4)+","+this.f.toFixed(4)+")"}},{createMatrix:function(a,b,c,d,
e,f){var g=new Ui.Matrix;g.setMatrix(a,b,c,d,e,f);return g},createTranslate:function(a,b){return Ui.Matrix.createMatrix(1,0,0,1,a,b)},createScaleAt:function(a,b,c,d){return Ui.Matrix.createMatrix(a,0,0,b,c-a*c,d-b*d)},createScale:function(a,b){void 0===b&&(b=a);return Ui.Matrix.createScaleAt(a,b,0,0)},createRotateAt:function(a,b,c){a=a%360*Math.PI/180;var d=Math.sin(a);a=Math.cos(a);return Ui.Matrix.createMatrix(a,d,-d,a,b*(1-a)+c*d,c*(1-a)-b*d)},createRotate:function(a){return Ui.Matrix.createRotateAt(a,
0,0)},parse:function(a){var b;if("string"===typeof a){var c;if(null!==(c=a.match(/^matrix\((-?\d+\.?\d*),(-?\d+\.?\d*),(-?\d+\.?\d*),(-?\d+\.?\d*),(-?\d+\.?\d*),(-?\d+\.?\d*)\)$/))){var d=parseFloat(c[1]),e=parseFloat(c[2]),f=parseFloat(c[3]),g=parseFloat(c[4]),l=parseFloat(c[5]);c=parseFloat(c[6]);b=new Ui.Matrix;b.setMatrix(d,e,f,g,l,c)}}if(void 0===b)throw"Unknown matrix format ("+a+")";return b}});Core.Object.extend("Ui.Point",{x:0,y:0,constructor:function(a){},matrixTransform:function(a){var b=this.x*a.b+this.y*a.d+a.f;this.x=this.x*a.a+this.y*a.c+a.e;this.y=b;return this},multiply:function(a){var b=this;"number"===typeof a?b=new Ui.Point({x:this.x*a,y:this.y*a}):Ui.Matrix.hasInstance(a)&&(b=new Ui.Point({x:this.x*a.a+this.y*a.c+a.e,y:this.x*a.b+this.y*a.d+a.f}));return b},divide:function(a){var b=this;"number"===typeof a?b=new Ui.Point({x:this.x/a,y:this.y/a}):Ui.Matrix.hasInstance(a)&&(a=
a.inverse(),b=new Ui.Point({x:this.x*a.a+this.y*a.c+a.e,y:this.x*a.b+this.y*a.d+a.f}));return b},add:function(a){var b=this;"number"===typeof a?b=new Ui.Point({x:this.x+a,y:this.y+a}):Ui.Point.hasInstance(a)&&(b=new Ui.Point({x:this.x+a.x,y:this.y+a.y}));return b},substract:function(a){var b=this;"number"===typeof a?b=new Ui.Point({x:this.x-a,y:this.y-a}):Ui.Point.hasInstance(a)&&(b=new Ui.Point({x:this.x-a.x,y:this.y-a.y}));return b},setPoint:function(a){this.x=a.x;this.y=a.y},getX:function(){return this.x},
setX:function(a){this.x=a},getY:function(){return this.y},setY:function(a){this.y=a},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},clone:function(){return new Ui.Point({x:this.x,y:this.y})}},{toString:function(){return"point("+this.x.toFixed(4)+", "+this.y.toFixed(4)+")"}});Core.Object.extend("Ui.Color",{r:0,g:0,b:0,a:1,constructor:function(a){if(void 0!==a.r&&void 0!==a.g&&void 0!==a.b)this.r=Math.min(Math.max(a.r,0),1),this.g=Math.min(Math.max(a.g,0),1),this.b=Math.min(Math.max(a.b,0),1),delete a.r,delete a.g,delete a.b;else if(void 0!==a.h&&void 0!==a.s&&void 0!==a.l)this.initFromHsl(void 0!==a.h?a.h:0,void 0!==a.s?a.s:0,void 0!==a.l?a.l:0),delete a.h,delete a.s,delete a.l;else if(void 0!==a.y&&void 0!==a.u&&void 0!==a.v){var b=Math.max(void 0!==a.y?a.y:0,0);this.initFromYuv(b,
void 0!==a.u?a.u:0,void 0!==a.v?a.v:0);delete a.y;delete a.u;delete a.v}void 0!==a.a&&(this.a=Math.min(Math.max(a.a,0),1),delete a.a);isNaN(this.r)&&(this.r=0);isNaN(this.g)&&(this.g=0);isNaN(this.b)&&(this.b=0);isNaN(this.a)&&(this.a=1)},addA:function(a){return new Ui.Color({r:this.r,g:this.g,b:this.b,a:Math.max(0,Math.min(1,this.a+a))})},addY:function(a){var b=this.getYuva();b.y+=a;return new Ui.Color(b)},addH:function(a){var b=this.getHsla();hsl.h+=a;return new Ui.Color(b)},addS:function(a){var b=
this.getHsla();b.s+=a;return new Ui.Color(b)},addL:function(a){var b=this.getHsla();b.l+=a;return new Ui.Color(b)},getCssRgba:function(){return"rgba("+Math.round(255*this.r)+","+Math.round(255*this.g)+","+Math.round(255*this.b)+","+this.a+")"},getCssRgb:function(){return"rgb("+Math.round(255*this.r)+","+Math.round(255*this.g)+","+Math.round(255*this.b)+")"},getCssHtml:function(){var a="#",b=Math.round(255*this.r).toString(16);1==b.length&&(b="0"+b);a+=b;b=Math.round(255*this.g).toString(16);1==b.length&&
(b="0"+b);a+=b;b=Math.round(255*this.b).toString(16);1==b.length&&(b="0"+b);return a+b},getRgba:function(){return{r:this.r,g:this.g,b:this.b,a:this.a}},getRgb:function(){return this.getRgba()},getHsla:function(){var a=this.r,b=this.g,c=this.b,d=Math.min(a,Math.min(b,c)),e=Math.max(a,Math.max(b,c)),d=e-d;if(!(0!==d&&0!==e))return{h:0,s:0,l:e,a:this.a};a=60*(a===e?(b-c)/d:b===e?2+(c-a)/d:4+(a-b)/d);0>a&&(a+=360);return{h:a,s:d/e,l:e,a:this.a}},getHsl:function(){return this.getHsla()},getYuva:function(){var a=
0.299*this.r+0.587*this.g+0.114*this.b;return{y:a,u:0.492*(this.b-a),v:0.877*(this.r-a),a:this.a}},getYuv:function(){return this.getYuva()},initFromHsl:function(a,b,c){if(0>=b)this.b=this.g=this.r=c;else{a/=60;var d=Math.floor(a),e=a-d;a=c*(1-b);var f=c*(1-b*e);b=c*(1-b*(1-e));0===d?(this.r=c,this.g=b,this.b=a):1==d?(this.r=f,this.g=c,this.b=a):2==d?(this.r=a,this.g=c,this.b=b):3==d?(this.r=a,this.g=f,this.b=c):4==d?(this.r=b,this.g=a,this.b=c):(this.r=c,this.g=a,this.b=f)}},initFromYuv:function(a,
b,c){this.r=Math.max(0,Math.min(a+1.13983*c,1));this.g=Math.max(0,Math.min(a-0.39465*b-0.5806*c,1));this.b=Math.max(0,Math.min(a+2.03211*b,1))}},{toString:function(){return"color("+this.r.toFixed(4)+", "+this.g.toFixed(4)+", "+this.b.toFixed(4)+", "+this.a.toFixed(4)+")"}},{knownColor:{white:"#ffffff",black:"#000000",red:"#ff0000",green:"#008000",blue:"#0000ff",lightblue:"#add8e6",lightgreen:"#90ee90",orange:"#ffa500",purple:"#800080",lightgray:"#d3d3d3",darkgray:"#a9a9a9",pink:"#ffc0cb",brown:"#a52a2a"},
parse:function(a){var b,c,d;if("string"==typeof a){a in Ui.Color.knownColor&&(a=Ui.Color.knownColor[a]);if(null!==(d=a.match(/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+\.?\d*)\s*\)\s*$/)))return b=parseInt(d[1])/255,c=parseInt(d[2])/255,a=parseInt(d[3])/255,d=parseFloat(d[4]),new Ui.Color({r:b,g:c,b:a,a:d});if(null!==(d=a.match(/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/)))return b=parseInt(d[1])/255,c=parseInt(d[2])/255,a=parseInt(d[3])/255,new Ui.Color({r:b,g:c,b:a});if(0===
a.indexOf("#")){if(7==a.length)return b=parseInt(a.substr(1,2),16)/255,c=parseInt(a.substr(3,2),16)/255,a=parseInt(a.substr(5,2),16)/255,new Ui.Color({r:b,g:c,b:a});if(4==a.length)return b=parseInt(a.substr(1,1),16)/15,c=parseInt(a.substr(2,1),16)/15,a=parseInt(a.substr(3,1),16)/15,new Ui.Color({r:b,g:c,b:a})}}throw"Unknown color format ("+a+")";}});Core.Object.extend("Ui.LinearGradient",{orientation:"vertical",stops:void 0,image:void 0,constructor:function(a){"stops"in a?(this.stops=a.stops,delete a.stops):this.stops=[{offset:0,color:new Ui.Color({r:1,g:1,b:1,a:1})},{offset:1,color:new Ui.Color({r:0,g:0,b:0,a:1})}];void 0!==a.orientation&&(this.orientation=a.orientation,delete a.orientation);for(a=0;a<this.stops.length;a++)this.stops[a].color=Ui.Color.create(this.stops[a].color)},getBackgroundImage:function(){var a,b,c;if(void 0!==this.image)return this.image;
if(navigator.isWebkit){this.image="-webkit-gradient(linear, 0% 0%, ";this.image="vertical"==this.orientation?this.image+"0% 100%":this.image+"100% 0%";for(a=0;a<this.stops.length;a++)b=this.stops[a],this.image+=", color-stop("+b.offset+", "+b.color.getCssRgba()+")";this.image+=")"}else if(navigator.isGecko){this.image="-moz-linear-gradient(";this.image="vertical"==this.orientation?this.image+"-90deg":this.image+"0deg";for(a=0;a<this.stops.length;a++)b=this.stops[a],this.image+=", "+b.color.getCssRgba()+
" "+Math.round(100*b.offset)+"%";this.image+=")"}else if(navigator.supportCanvas){var d=document.createElement("canvas"),e=d.getContext("2d");if("vertical"==this.orientation){d.setAttribute("width",1,null);d.setAttribute("height",100,null);c=e.createLinearGradient(0,0,0,100);for(a=0;a<this.stops.length;a++)b=this.stops[a],c.addColorStop(b.offset,b.color.getCssRgba());e.fillStyle=c;e.fillRect(0,0,1,100)}else{d.setAttribute("width",100,null);d.setAttribute("height",1,null);c=e.createLinearGradient(0,
0,100,0);for(a=0;a<this.stops.length;a++)b=this.stops[a],c.addColorStop(b.offset,b.color.getCssRgba());e.fillStyle=c;e.fillRect(0,0,100,1)}this.image="url("+d.toDataURL()+")"}else this.image="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAACCAYAAACddGYaAAAAAXNSR0IArs4c6QAAAAZiS0dEAO8AUQBRItXOlAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9gJDxcIBl8Z3A0AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAC0lEQVQI12NgwAUAABoAASRETuUAAAAASUVORK5CYII%3D)";return this.image},getSVGGradient:function(){var a=
document.createElementNS(svgNS,"linearGradient");a.setAttributeNS(null,"gradientUnits","objectBoundingBox");a.setAttributeNS(null,"x1",0);a.setAttributeNS(null,"y1",0);"vertical"==this.orientation?(a.setAttributeNS(null,"x2",0),a.setAttributeNS(null,"y2",1)):(a.setAttributeNS(null,"x2",1),a.setAttributeNS(null,"y2",0));for(var b=0;b<this.stops.length;b++){var c=this.stops[b],d=document.createElementNS(svgNS,"stop");d.setAttributeNS(null,"offset",c.offset);d.style.stopColor=c.color.getCssHtml();d.style.stopOpacity=
c.color.getRgba().a;a.appendChild(d)}return a},getCanvasGradient:function(a,b,c){a="vertical"==this.orientation?a.createLinearGradient(0,0,0,c):a.createLinearGradient(0,0,b,0);for(b=0;b<this.stops.length;b++)c=this.stops[b],a.addColorStop(c.offset,c.color.getCssRgba());return a}});Core.Object.extend("Ui.Event",{type:void 0,bubbles:!0,cancelable:!0,target:void 0,cancelBubble:!1,stop:!1,constructor:function(a){},stopPropagation:function(){this.cancelBubble=!0},stopImmediatePropagation:function(){this.stop=!0},getIsPropagationStopped:function(){return this.stop||this.cancelBubble},setType:function(a){this.type=a},setBubbles:function(a){this.bubbles=a},dispatchEvent:function(a){var b;this.target=a;if(this.bubbles){var c=[];for(b=this.target;void 0!==b&&null!==b;)c.push(b),b=b.parent;
for(a=c.length-1;0<=a&&!this.cancelBubble&&!this.stop;a--){b=c[a];var d=b.getEventHandlers(this.type);for(b=0;b<d.length&&!this.stop;b++){var e=d[b];e.capture&&e.method.apply(e.scope,[this])}}for(a=0;a<c.length&&!this.cancelBubble&&!this.stop;a++){b=c[a];d=b.getEventHandlers(this.type);for(b=0;b<d.length&&!this.stop;b++)e=d[b],e.capture||e.method.apply(e.scope,[this])}}else{d=this.target.getEventHandlers(this.type);for(b=0;b<d.length&&!this.stop;b++)e=d[b],e.capture&&e.method.apply(e.scope,[this]);
for(b=0;b<d.length&&!this.stop;b++)e=d[b],e.capture||e.method.apply(e.scope,[this])}}});Ui.Event.extend("Ui.PointerEvent",{pointer:void 0,clientX:0,clientY:0,pointerType:"mouse",constructor:function(a){this.pointer=a.pointer;delete a.pointer;this.clientX=this.pointer.getX();this.clientY=this.pointer.getY();this.pointerType=this.pointer.getType()}});
Core.Object.extend("Ui.PointerWatcher",{element:void 0,pointer:void 0,constructor:function(a){this.addEvents("down","move","up","cancel");this.element=a.element;delete a.element;this.pointer=a.pointer;delete a.pointer},getAbsoluteDelta:function(){var a=this.pointer.getInitialX(),b=this.pointer.getInitialY(),c=this.pointer.getX(),d=this.pointer.getY();return{x:c-a,y:d-b}},getDelta:function(){var a={x:this.pointer.getInitialX(),y:this.pointer.getInitialY()},b={x:this.pointer.getX(),y:this.pointer.getY()},
a=this.element.pointFromWindow(a),b=this.element.pointFromWindow(b);return{x:b.x-a.x,y:b.y-a.y}},getPosition:function(){var a={x:this.pointer.getX(),y:this.pointer.getY()};return this.element.pointFromWindow(a)},getIsInside:function(){var a=this.getPosition();return 0<=a.x&&a.x<=this.element.getLayoutWidth()&&0<=a.y&&a.y<=this.element.getLayoutHeight()?!0:!1},getDirection:function(){var a=this.getDelta();return Math.abs(a.x)>Math.abs(a.y)?0>a.x?"left":"right":0>a.y?"top":"bottom"},getSpeed:function(){if(void 0===
this.pointer||2>this.pointer.history.length)return{x:0,y:0};var a=this.pointer.history.length,b=(new Date).getTime()/1E3,c=this.pointer.x,d=this.pointer.y;do var e=this.pointer.history[--a];while(0<a&&0.08>b-e.time);a=b-e.time;return{x:(c-e.x)/a,y:(d-e.y)/a}},getIsCaptured:function(){return void 0!==this.pointer&&this.pointer.captureWatcher===this},capture:function(){this.pointer.capture(this)},release:function(){this.pointer.release(this)},cancel:function(){void 0!==this.pointer&&(this.fireEvent("cancel",
this),this.pointer.unwatch(this),this.pointer=void 0)},down:function(){void 0!==this.pointer&&this.fireEvent("down",this)},move:function(){void 0!==this.pointer&&this.fireEvent("move",this)},up:function(){void 0!==this.pointer&&this.fireEvent("up",this)}},{unwatch:function(){void 0!==this.pointer&&this.pointer.unwatch(this)}});
Core.Object.extend("Ui.Pointer",{id:void 0,x:0,y:0,initialX:0,initialY:0,altKey:!1,ctrlKey:!1,shiftKey:!1,type:void 0,start:void 0,cumulMove:0,chainLevel:0,watchers:void 0,captureWatcher:void 0,history:void 0,buttons:0,constructor:function(a){this.addEvents("ptrmove","ptrup","ptrcancel");this.type=a.type;delete a.type;this.id=a.id;delete a.id;this.start=(new Date).getTime()/1E3;this.watchers=[];this.history=[]},capture:function(a){for(var b=this.watchers.slice(),c=0;c<b.length;c++)b[c]!==a&&b[c].cancel();
this.captureWatcher=a},release:function(a){this.captureWatcher=void 0},getType:function(){return this.type},getIsDown:function(){return 0!==this.buttons},getIsCaptured:function(){return void 0!==this.captureWatcher},getX:function(){return this.x},getY:function(){return this.y},getInitialX:function(){return this.initialX},getInitialY:function(){return this.initialY},setInitialPosition:function(a,b){this.initialX=a;this.initialY=b},getButtons:function(){return this.buttons},setButtons:function(a){this.buttons=
a},getChainLevel:function(){return this.chainLevel},getAltKey:function(){return this.altKey},setAltKey:function(a){this.altKey=a},getCtrlKey:function(){return this.ctrlKey},setCtrlKey:function(a){this.ctrlKey=a},getShiftKey:function(){return this.shiftKey},setShiftKey:function(a){this.shiftKey=a},setControls:function(a,b,c){this.altKey=a;this.ctrlKey=b;this.shiftKey=c},move:function(a,b){void 0===a&&(a=this.x);void 0===b&&(b=this.y);if(this.x!==a||this.y!==b){var c=this.x-a,d=this.y-b;this.cumulMove+=
Math.sqrt(c*c+d*d);this.x=a;this.y=b;c=(new Date).getTime()/1E3;for(this.history.push({time:c,x:this.x,y:this.y});2<this.history.length&&c-this.history[0].time>Ui.Pointer.HISTORY_TIMELAPS;)this.history.shift()}c=this.watchers.slice();for(d=0;d<c.length;d++)c[d].move();void 0===this.captureWatcher&&(c=Ui.App.current.elementFromPoint(this.x,this.y),void 0!==c&&(d=new Ui.PointerEvent({type:"ptrmove",pointer:this}),this.fireEvent("ptrmove",d),d.dispatchEvent(c)))},getIsHold:function(){return(new Date).getTime()/
1E3-this.start>=Ui.Pointer.HOLD_DELAY},getDelta:function(){var a=this.x-this.initialX,b=this.y-this.initialY;return Math.sqrt(a*a+b*b)},getCumulMove:function(){return this.cumulMove},getIsMove:function(){return this.cumulMove>=Ui.Pointer.MOVE_DELTA},down:function(a,b,c){this.start=(new Date).getTime()/1E3;this.initialX=this.x=a;this.initialY=this.y=b;this.history=[];this.history.push({time:this.start,x:this.initialX,y:this.initialY});this.buttons=c;this.cumulMove=0;a=this.watchers.slice();for(b=0;b<
a.length;b++)a[b].down();a=Ui.App.current.elementFromPoint(this.x,this.y);void 0!==a&&(new Ui.PointerEvent({type:"ptrdown",pointer:this})).dispatchEvent(a)},up:function(){for(var a=this.watchers.slice(),b=0;b<a.length;b++)a[b].up();this.watchers=[];this.buttons=0;void 0===this.captureWatcher&&(a=Ui.App.current.elementFromPoint(this.x,this.y),void 0!==a&&(b=new Ui.PointerEvent({type:"ptrup",pointer:this}),this.fireEvent("ptrup",b),b.dispatchEvent(a)));this.captureWatcher=void 0}},{watch:function(a){a=
new Ui.PointerWatcher({element:a,pointer:this});this.watchers.push(a);return a},unwatch:function(a){for(var b=0;b<this.watchers.length;b++)if(this.watchers[b]===a){this.watchers.splice(b,1);break}}},{HOLD_DELAY:0.75,MOVE_DELTA:15,HISTORY_TIMELAPS:0.5});
Core.Object.extend("Ui.PointerManager",{touches:void 0,lastUpdate:void 0,lastTouchX:-1,lastTouchY:-1,lastDownTouchX:-1,lastDownTouchY:-1,mouse:void 0,app:void 0,constructor:function(a){this.app=a.app;delete a.app;this.pointers={};window.PointerEvent?(this.connect(window,"pointerdown",this.onPointerDown),this.connect(window,"pointermove",this.onPointerMove),this.connect(window,"pointerup",this.onPointerUp),this.connect(window,"pointercancel",this.onPointerCancel)):(this.mouse=new Ui.Pointer({type:"mouse",
id:0}),this.connect(window,"mousedown",this.onMouseDown),this.connect(window,"mousemove",this.onMouseMove),this.connect(window,"mouseup",this.onMouseUp),this.connect(document,"selectstart",this.onSelectStart),this.connect(window,"keydown",function(a){if(16===a.which||17===a.which||18===a.which)this.mouse.setControls(a.altKey,a.ctrlKey,a.shiftKey),this.mouse.move()}),this.connect(window,"keyup",function(a){if(16===a.which||17===a.which||18===a.which)this.mouse.setControls(a.altKey,a.ctrlKey,a.shiftKey),
this.mouse.move()}),this.connect(document,"contextmenu",function(a){void 0!==this.mouse&&(this.mouse.capture(void 0),this.mouse.up())}),this.connect(document.body,"touchstart",this.updateTouches,!0),this.connect(document.body,"touchmove",this.updateTouches,!0),this.connect(document.body,"touchend",this.updateTouches,!0),this.connect(document.body,"touchcancel",this.updateTouches,!0))},onSelectStart:function(a){if(this.mouse.getIsCaptured())a.preventDefault();else{for(var b=!1,c=a.target;null!==c&&
void 0!==c;){if(!0===c.selectable){b=!0;break}c=c.parentNode}b?void 0!==this.mouse&&this.mouse.capture(void 0):a.preventDefault()}},onMouseDown:function(a){var b=(new Date).getTime()/1E3-this.lastUpdate,c=this.lastTouchX-a.clientX,d=this.lastTouchY-a.clientY,c=Math.sqrt(c*c+d*d),d=this.lastDownTouchX-a.clientX,e=this.lastDownTouchY-a.clientY,d=Math.sqrt(d*d+e*e);1>b||10>b&&(20>c||20>d)||(b=0,0===a.button?b|=1:1===a.button?b|=2:2===a.button&&(b|=4),this.mouse.setControls(a.altKey,a.ctrlKey,a.shiftKey),
c=this.mouse.getButtons(),0===c?this.mouse.down(a.clientX,a.clientY,b):this.mouse.setButtons(c|b))},onMouseMove:function(a){this.mouse.setControls(a.altKey,a.ctrlKey,a.shiftKey);var b=(new Date).getTime()/1E3-this.lastUpdate,c=this.lastTouchX-a.clientX,d=this.lastTouchY-a.clientY,c=Math.sqrt(c*c+d*d),d=this.lastDownTouchX-a.clientX,e=this.lastDownTouchY-a.clientY,d=Math.sqrt(d*d+e*e);1>b||10>b&&(20>c||20>d)||this.mouse.move(a.clientX,a.clientY)},onMouseUp:function(a){this.mouse.setControls(a.altKey,
a.ctrlKey,a.shiftKey);var b=(new Date).getTime()/1E3-this.lastUpdate,c=this.lastTouchX-a.clientX,d=this.lastTouchY-a.clientY,c=Math.sqrt(c*c+d*d),d=this.lastDownTouchX-a.clientX,e=this.lastDownTouchY-a.clientY,d=Math.sqrt(d*d+e*e);1>b||10>b&&(20>c||20>d)||(this.mouse.move(a.clientX,a.clientY),this.mouse.up())},onWindowLoad:function(){try{if(void 0===document.body){var a=document.createElement("body");document.body=a}}catch(b){}},onPointerDown:function(a){console.log("onPointerDown type: "+a.pointerType);
var b=new Ui.Pointer({type:"pen"===a.pointerType?"pen":"mouse"===a.pointerType?"mouse":"touch",id:a.pointerId});this.pointers[a.pointerId]=b;b.setControls(a.altKey,a.ctrlKey,a.shiftKey);b.down(a.clientX,a.clientY,1)},onPointerMove:function(a){if(void 0===this.pointers[a.pointerId]){var b=new Ui.Pointer({type:"pen"===a.pointerType?"pen":"mouse"===a.pointerType?"mouse":"touch",id:a.pointerId});this.pointers[a.pointerId]=b}this.pointers[a.pointerId].setControls(a.altKey,a.ctrlKey,a.shiftKey);this.pointers[a.pointerId].move(a.clientX,
a.clientY)},onPointerUp:function(a){void 0!==this.pointers[a.pointerId]&&(this.pointers[a.pointerId].setControls(a.altKey,a.ctrlKey,a.shiftKey),this.pointers[a.pointerId].up(),delete this.pointers[a.pointerId])},onPointerCancel:function(a){},updateTouches:function(a){this.lastUpdate=(new Date).getTime()/1E3;for(var b in this.pointers){for(var c=!1,d=0;d<a.touches.length&&!c;d++)b==a.touches[d].identifier&&(c=!0,this.pointers[b].setControls(a.altKey,a.ctrlKey,a.shiftKey),this.pointers[b].move(a.touches[d].clientX,
a.touches[d].clientY));c||(this.pointers[b].setControls(a.altKey,a.ctrlKey,a.shiftKey),this.pointers[b].up(),delete this.pointers[b])}for(d=0;d<a.touches.length;d++)this.lastTouchX=a.touches[d].clientX,this.lastTouchY=a.touches[d].clientY,void 0==this.pointers[a.touches[d].identifier]&&(b=new Ui.Pointer({type:"touch",id:a.touches[d].identifier}),this.pointers[a.touches[d].identifier]=b,b.setControls(a.altKey,a.ctrlKey,a.shiftKey),b.down(a.touches[d].clientX,a.touches[d].clientY,1));if("touchstart"===
a.type)for(d=0;d<a.changedTouches.length;d++)this.lastDownTouchX=a.changedTouches[d].clientX,this.lastDownTouchY=a.changedTouches[d].clientY;"touchmove"===a.type&&a.preventDefault()}});Ui.Event.extend("Ui.WheelEvent",{deltaX:0,deltaY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,constructor:function(a){this.setType("wheel")},setClientX:function(a){this.clientX=a},setClientY:function(a){this.clientY=a},setDeltaX:function(a){this.deltaX=a},setDeltaY:function(a){this.deltaY=a},setCtrlKey:function(a){this.ctrlKey=a},setAltKey:function(a){this.altKey=a},setShiftKey:function(a){this.shiftKey=a},setMetaKey:function(a){this.metaKey=a}});
Core.Object.extend("Ui.WheelManager",{captureElement:void 0,app:void 0,constructor:function(a){this.app=a.app;delete a.app;this.connect(this.app.getDrawing(),"mousewheel",this.onMouseWheel);this.connect(this.app.getDrawing(),"DOMMouseScroll",this.onMouseWheel)},onMouseWheel:function(a){var b=0,c=0;void 0!=a.wheelDeltaX&&void 0!=a.wheelDeltaY?(b=-a.wheelDeltaX/5,c=-a.wheelDeltaY/5):void 0!=a.wheelDelta?c=-a.wheelDelta/2:void 0!=a.detail&&(c=20*a.detail);var d=Ui.App.current.elementFromPoint(a.clientX,
a.clientY);void 0!==d&&((new Ui.WheelEvent({clientX:a.clientX,clientY:a.clientY,deltaX:b,deltaY:c,ctrlKey:a.ctrlKey,altKey:a.altKey,shiftKey:a.shiftKey,metaKey:a.metaKey})).dispatchEvent(d),a.preventDefault())}});Core.Object.extend("Ui.Element",{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0,parent:void 0,width:void 0,height:void 0,maxWidth:void 0,maxHeight:void 0,drawing:void 0,collapse:!1,measureValid:!1,measureConstraintPixelRatio:1,measureConstraintWidth:0,measureConstraintHeight:0,measureWidth:0,measureHeight:0,arrangeValid:!1,arrangeX:0,arrangeY:0,arrangeWidth:0,arrangeHeight:0,arrangePixelRatio:1,drawValid:!0,drawNext:void 0,layoutValid:!0,layoutNext:void 0,layoutX:0,layoutY:0,layoutWidth:0,
layoutHeight:0,isLoaded:!1,verticalAlign:"stretch",horizontalAlign:"stretch",clipToBounds:!1,clipX:void 0,clipY:void 0,clipWidth:void 0,clipHeight:void 0,visible:void 0,parentVisible:void 0,eventsHidden:!1,focusable:!1,hasFocus:!1,isMouseFocus:!1,isMouseDownFocus:!1,selectable:!1,transform:void 0,transformOriginX:0.5,transformOriginY:0.5,transformOriginAbsolute:!1,animClock:void 0,opacity:1,parentOpacity:1,disabled:void 0,parentDisabled:void 0,style:void 0,parentStyle:void 0,mergeStyle:void 0,constructor:function(a){this.drawing=
this.renderDrawing(a);DEBUG&&this.drawing.setAttribute("class",this.classType);this.drawing.style.position="absolute";this.drawing.style.left="0px";this.drawing.style.top="0px";this.drawing.style.width="0px";this.drawing.style.height="0px";this.drawing.style.visibility="hidden";this.drawing.style.outline="none";this.drawing.style.transformOrigin="0 0";navigator.isIE?this.drawing.style.msTransformOrigin="0 0":navigator.isGecko?this.drawing.style.MozTransformOrigin="0 0":navigator.isWebkit?this.drawing.style.webkitTransformOrigin=
"0 0":navigator.isOpera&&(this.drawing.style.OTransformOrigin="0 0");this.connect(this.drawing,"focus",this.onFocus);this.connect(this.drawing,"blur",this.onBlur);this.setSelectable(!1);this.addEvents("focus","blur","load","unload","enable","disable","visible","hidden","ptrdown","ptrmove","ptrup","ptrcancel","wheel","dragover")},setDisabled:function(a){a?this.disable():this.enable()},getDrawing:function(){return this.drawing},getSelectable:function(){return this.selectable},setSelectable:function(a){this.selectable=
a;this.getDrawing().selectable=a;Ui.Element.setSelectable(this.getDrawing(),a)},getLayoutX:function(){return this.layoutX},getLayoutY:function(){return this.layoutY},getLayoutWidth:function(){return this.layoutWidth},getLayoutHeight:function(){return this.layoutHeight},setId:function(a){this.drawing.setAttribute("id",a)},getId:function(){return this.drawing.getAttribute("id")},setFocusable:function(a){this.focusable!==a&&((this.focusable=a)&&!this.getIsDisabled()?(this.drawing.tabIndex=0,this.connect(this.getDrawing(),
"mousedown",this.onMouseDownFocus,!0)):(this.disconnect(this.getDrawing(),"mousedown",this.onMouseDownFocus,!0),a=this.drawing.getAttributeNode("tabIndex"),null!==a&&void 0!==a&&this.drawing.removeAttributeNode(a)))},onMouseDownFocus:function(a){this.isMouseDownFocus=!0;this.connect(window,"mouseup",this.onMouseUpFocus,!0)},onMouseUpFocus:function(a){this.isMouseDownFocus=!1;this.disconnect(window,"mouseup",this.onMouseUpFocus,!0)},getFocusable:function(){return this.focusable},getIsMouseFocus:function(){return this.isMouseFocus},
setRole:function(a){"setAttributeNS"in this.drawing&&(void 0===a?this.drawing.hasAttributeNS("http://www.w3.org/2005/07/aaa","role")&&this.drawing.removeAttributeNS("http://www.w3.org/2005/07/aaa","role"):this.drawing.setAttributeNS("http://www.w3.org/2005/07/aaa","role",a))},measure:function(a,b){if(this.isLoaded){if(this.collapse)return this.measureValid=!0,{width:0,height:0};if(this.measureValid&&this.measureConstraintWidth===a&&this.measureConstraintHeight===b&&this.measureConstraintPixelRatio==
(window.devicePixelRatio||1))return{width:this.measureWidth,height:this.measureHeight};this.measureConstraintPixelRatio=window.devicePixelRatio||1;this.measureConstraintWidth=a;this.measureConstraintHeight=b;var c=this.getMarginLeft(),d=this.getMarginRight(),e=this.getMarginTop(),f=this.getMarginBottom(),g=Math.max(a-(c+d),0),l=Math.max(b-(e+f),0);void 0!==this.maxWidth&&(g=Math.min(g,this.maxWidth));void 0!==this.maxHeight&&(l=Math.min(l,this.maxHeight));"stretch"!==this.horizontalAlign&&(g=0);"stretch"!==
this.verticalAlign&&(l=0);void 0!==this.width&&(g=Math.max(this.width,g));void 0!==this.height&&(l=Math.max(this.height,l));g=this.measureCore(g,l);this.measureWidth=void 0!==this.width&&g.width<this.width?this.width+c+d:Math.ceil(g.width)+c+d;this.measureHeight=void 0!==this.height&&g.height<this.height?this.height+e+f:Math.ceil(g.height)+e+f;this.measureValid=!0;return{width:this.measureWidth,height:this.measureHeight}}},measureCore:function(a,b){return{width:0,height:0}},invalidateMeasure:function(){if(this.measureValid&&
(this.measureValid=!1,void 0!==this.parent&&this.parent.measureValid))this.parent.onChildInvalidateMeasure(this,"change");this.invalidateArrange()},invalidateLayout:function(){this.layoutValid&&(this.arrangeValid=this.measureValid=this.layoutValid=!1,Ui.App.current.enqueueLayout(this))},onChildInvalidateMeasure:function(a,b){this.invalidateMeasure()},updateLayout:function(){this.layoutCore();this.layoutValid=!0},layoutCore:function(){this.measure(this.layoutWidth,this.layoutHeight);this.arrange(this.layoutX,
this.layoutY,this.layoutWidth,this.layoutHeight)},arrange:function(a,b,c,d){if(this.isLoaded&&!this.collapse){isNaN(a)&&(a=0);isNaN(b)&&(b=0);isNaN(c)&&(c=0);isNaN(d)&&(d=0);a=Math.round(a);b=Math.round(b);c=Math.round(c);d=Math.round(d);if(!this.arrangeValid||this.arrangeX!=a||this.arrangeY!=b||this.arrangeWidth!=c||this.arrangeHeight!=d||this.arrangePixelRatio!=(window.devicePixelRatio||1)){this.arrangeX=a;this.arrangeY=b;this.arrangeWidth=c;this.arrangeHeight=d;this.arrangePixelRatio=window.devicePixelRatio||
1;"top"==this.verticalAlign?d=this.measureHeight:"bottom"==this.verticalAlign?(b+=d-this.measureHeight,d=this.measureHeight):"center"==this.verticalAlign&&(b+=(d-this.measureHeight)/2,d=this.measureHeight);"left"==this.horizontalAlign?c=this.measureWidth:"right"==this.horizontalAlign?(a+=c-this.measureWidth,c=this.measureWidth):"center"==this.horizontalAlign&&(a+=(c-this.measureWidth)/2,c=this.measureWidth);var e=this.getMarginLeft(),f=this.getMarginRight(),g=this.getMarginTop(),l=this.getMarginBottom();
d-=g+l;this.layoutX=a+e;this.layoutY=b+g;this.layoutWidth=Math.max(c-(e+f),0);this.layoutHeight=Math.max(d,0);this.drawing.style.left=Math.round(this.layoutX)+"px";this.drawing.style.top=Math.round(this.layoutY)+"px";void 0!==this.transform&&this.updateTransform();this.eventsHidden?(this.drawing.style.width="0px",this.drawing.style.height="0px"):(this.drawing.style.width=Math.round(this.layoutWidth)+"px",this.drawing.style.height=Math.round(this.layoutHeight)+"px");this.drawing.style.visibility="inherit";
this.arrangeCore(this.layoutWidth,this.layoutHeight)}this.arrangeValid=!0}},arrangeCore:function(a,b){},invalidateArrange:function(){if(this.arrangeValid&&(this.arrangeValid=!1,void 0!==this.parent))this.parent.onChildInvalidateArrange(this)},onChildInvalidateArrange:function(a){this.invalidateArrange()},draw:function(){this.drawCore();this.drawValid=!0},drawCore:function(){},invalidateDraw:function(){void 0!==Ui.App.current&&this.drawValid&&(this.drawValid=!1,Ui.App.current.enqueueDraw(this))},renderDrawing:function(){return document.createElement("div")},
getWidth:function(){return this.width},setWidth:function(a){this.width!==a&&(this.width=a,this.invalidateMeasure())},getHeight:function(){return this.height},setHeight:function(a){this.height!==a&&(this.height=a,this.invalidateMeasure())},getMaxWidth:function(){return this.maxWidth},setMaxWidth:function(a){this.maxWidth!==a&&(this.maxWidth=a,this.layoutWidth>this.maxWidth&&this.invalidateMeasure())},getMaxHeight:function(){return this.maxHeight},setMaxHeight:function(a){this.maxWidth!==a&&(this.maxHeight=
a,this.layoutHeight>this.maxHeight&&this.invalidateMeasure())},getVerticalAlign:function(){return this.verticalAlign},setVerticalAlign:function(a){this.verticalAlign!==a&&(this.verticalAlign=a,this.invalidateArrange())},getHorizontalAlign:function(){return this.horizontalAlign},setHorizontalAlign:function(a){this.horizontalAlign!==a&&(this.horizontalAlign=a,this.invalidateArrange())},getClipToBounds:function(){return this.clipToBounds},setClipToBounds:function(a){this.clipToBounds!==a&&((this.clipToBounds=
a)?this.drawing.style.overflow="hidden":this.drawing.style.removeProperty("overflow"))},setClipRectangle:function(a,b,c,d){this.clipX=a;this.clipY=b;this.clipWidth=c;this.clipHeight=d;this.updateClipRectangle()},updateClipRectangle:function(){if(void 0!==this.clipX){var a=Math.round(this.clipX),b=Math.round(this.clipY),c=Math.round(this.clipWidth),d=Math.round(this.clipHeight);this.drawing.style.clip="rect("+b+"px "+(a+c)+"px "+(b+d)+"px "+a+"px)"}else"removeProperty"in this.drawing.style?this.drawing.style.removeProperty("clip"):
"removeAttribute"in this.drawing.style&&this.drawing.style.removeAttribute("clip")},setMargin:function(a){this.setMarginTop(a);this.setMarginBottom(a);this.setMarginLeft(a);this.setMarginRight(a)},getMarginTop:function(){return this.marginTop},setMarginTop:function(a){a!==this.marginTop&&(this.marginTop=a,this.invalidateMeasure())},getMarginBottom:function(){return this.marginBottom},setMarginBottom:function(a){a!==this.marginBottom&&(this.marginBottom=a,this.invalidateMeasure())},getMarginLeft:function(){return this.marginLeft},
setMarginLeft:function(a){a!==this.marginLeft&&(this.marginLeft=a,this.invalidateMeasure())},getMarginRight:function(){return this.marginRight},setMarginRight:function(a){a!==this.marginRight&&(this.marginRight=a,this.invalidateMeasure())},getOpacity:function(){return this.opacity},setOpacity:function(a){this.opacity!==a&&(this.opacity=a,this.drawing.style.opacity=this.opacity)},focus:function(){if(this.focusable)try{this.drawing.focus()}catch(a){}},blur:function(){try{this.drawing.blur()}catch(a){}},
setTransform:function(a){this.transform!==a&&(this.transform=a,this.updateTransform())},setTransformOrigin:function(a,b,c){if(this.transformOriginX!==a||this.transformOriginY!==b||this.transformOriginAbsolute!==c)this.transformOriginX=a,this.transformOriginY=b,this.transformOriginAbsolute=void 0===c?!1:c,this.updateTransform()},getInverseLayoutTransform:function(){var a=Ui.Matrix.createTranslate(this.layoutX,this.layoutY);if(void 0!==this.transform)var b=this.transformOriginX*this.layoutWidth,c=this.transformOriginY*
this.layoutHeight,a=a.translate(-b,-c).multiply(this.transform).translate(b,c);return a},getLayoutTransform:function(){var a=new Ui.Matrix;if(void 0!==this.transform)var a=this.transformOriginX*this.layoutWidth,b=this.transformOriginY*this.layoutHeight,a=Ui.Matrix.createTranslate(-a,-b).multiply(this.transform).translate(a,b).inverse();return a.translate(-this.layoutX,-this.layoutY)},transformToWindow:function(){return Ui.Element.transformToWindow2(this)},transformFromWindow:function(){return Ui.Element.transformFromWindow2(this)},
transformToElement:function(a){var b=this.transformToWindow();a=a.transformFromWindow();return b.multiply(a)},pointToWindow:function(a){return(new Ui.Point({point:a})).multiply(this.transformToWindow())},pointFromWindow:function(a){return(new Ui.Point({point:a})).multiply(this.transformFromWindow())},pointFromElement:function(a,b){return this.pointFromWindow(a.pointToWindow(b))},getIsInside:function(a,b){var c=(new Ui.Point({x:a,y:b})).multiply(this.getLayoutTransform());return 0<=c.x&&c.x<=this.layoutWidth&&
0<=c.y&&c.y<=this.layoutHeight?!0:!1},setEventsHidden:function(a){this.eventsHidden=a;this.invalidateArrange()},getEventsHidden:function(){return this.eventsHidden},elementFromPoint:function(a,b){if(!this.eventsHidden&&this.getIsVisible()&&this.getIsInside(a,b))return this},getIsLoaded:function(){return this.isLoaded},getMeasureWidth:function(){return this.collapse?0:this.measureWidth},getMeasureHeight:function(){return this.collapse?0:this.measureHeight},getIsCollapsed:function(){return this.collapse},
hide:function(a){if(void 0===this.visible||this.visible){var b=this.getIsVisible();this.visible=!1;this.drawing.style.display="none";this.collapse=!0===a;if(b)this.onInternalHidden();this.collapse&&this.invalidateMeasure()}},show:function(){if(void 0===this.visible||!this.visible){var a=this.getIsVisible();this.visible=!0;this.drawing.style.display="block";if(this.getIsVisible()&&!a)this.onInternalVisible();this.collapse&&(this.collapse=!1,this.invalidateMeasure())}},getIsVisible:function(){return!0===
this.parentVisible&&!1!==this.visible},setParentVisible:function(a){var b=this.getIsVisible();this.parentVisible=a;if(b!=this.getIsVisible())if(this.getIsVisible())this.onInternalVisible();else this.onInternalHidden()},onInternalHidden:function(){this.onHidden();this.fireEvent("hidden",this)},onHidden:function(){},onInternalVisible:function(){this.onVisible();this.fireEvent("visible",this)},checkVisible:function(){if(void 0!==this.getDrawing()){for(var a=!1,b=this.getDrawing();void 0!==b;){if("none"===
b.style.display){a=!1;break}if(b==document.body){a=!0;break}b=b.parentNode}this.getIsVisible()!==a&&console.log("checkVisible expect: "+this.getIsVisible()+", got: "+a+" (on "+this+")")}},onVisible:function(){},disable:function(){if(void 0===this.disabled||!this.disabled){var a=this.getIsDisabled();this.disabled=!0;if(!a)this.onInternalDisable()}},enable:function(){if(void 0===this.disabled||this.disabled){var a=this.getIsDisabled();this.disabled=!1;if(a&&!this.getIsDisabled())this.onInternalEnable()}},
setEnable:function(a){a?this.enable():this.disable()},getIsDisabled:function(){return void 0!==this.disabled&&!0===this.disabled||void 0!==this.parentDisabled&&!0===this.parentDisabled?!0:!1},setParentDisabled:function(a){var b=this.getIsDisabled();this.parentDisabled=a;if(b!==this.getIsDisabled())if(this.getIsDisabled())this.onInternalDisable();else this.onInternalEnable()},onInternalDisable:function(){this.focusable&&(this.drawing.tabIndex=-1,this.hasFocus&&this.blur());this.onDisable();this.fireEvent("disable",
this)},onDisable:function(){},onInternalEnable:function(){this.focusable&&(this.drawing.tabIndex=0);this.onEnable();this.fireEvent("enable",this)},onEnable:function(){},containSubStyle:function(a){for(var b in a)if(-1!==b.indexOf(".")&&"object"===typeof a[b])return!0;return!1},fusionStyle:function(a,b){for(var c in b)if(!(-1===c.indexOf(".")||"object"!==typeof b[c]))if(void 0!==a[c]){var d=a[c];a[c]={};for(var e in d)a[c][e]=d[e];for(e in b[c])a[c][e]=b[c][e]}else a[c]=b[c]},mergeStyles:function(){var a,
b;this.mergeStyle=void 0;if(void 0!==this.parentStyle){a=this;for(b=!1;void 0!==a;){if(void 0!==this.parentStyle[a.classType]&&this.containSubStyle(this.parentStyle[a.classType])){void 0===this.mergeStyle&&(this.mergeStyle=Core.Util.clone(this.parentStyle));this.fusionStyle(this.mergeStyle,this.parentStyle[a.classType]);b=!0;break}a=a.__baseclass__}b||(this.mergeStyle=this.parentStyle)}if(void 0!==this.style)if(void 0!==this.mergeStyle){this.mergeStyle=Core.Util.clone(this.mergeStyle);this.fusionStyle(this.mergeStyle,
this.style);for(a=this;void 0!==a;){if(void 0!==this.style[a.classType]&&this.containSubStyle(this.style[a.classType])){this.fusionStyle(this.mergeStyle,this.style[a.classType]);break}a=a.__baseclass__}}else{a=this;for(b=!1;void 0!==a;){if(void 0!==this.style[a.classType]&&this.containSubStyle(this.style[a.classType])){void 0===this.mergeStyle&&(this.mergeStyle=Core.Util.clone(this.style));this.fusionStyle(this.mergeStyle,this.style[a.classType]);b=!0;break}a=a.__baseclass__}b||(this.mergeStyle=this.style)}},
getIsChildOf:function(a){for(var b=this;void 0!==b&&null!==b;){if(b===a)return!0;b=b.getParent()}return!1},getParent:function(){return this.parent},getParentByClass:function(a){for(var b=this.getParent();void 0!==b;){if(a.hasInstance(b))return b;b=b.getParent()}},setParentStyle:function(a){this.parentStyle!==a&&(this.parentStyle=a);this.mergeStyles();this.onInternalStyleChange()},setStyle:function(a){this.style=a;this.mergeStyles();this.onInternalStyleChange()},setStyleProperty:function(a,b){void 0===
this.style&&(this.style={});void 0===this.style[this.classType]&&(this.style[this.classType]={});this.style[this.classType][a]=b},getStyleProperty:function(a){var b;if(void 0!==this.mergeStyle)for(b=this;void 0!==b;){if(void 0!==this.mergeStyle[b.classType]&&void 0!==this.mergeStyle[b.classType][a])return this.mergeStyle[b.classType][a];b=b.__baseclass__}for(b=this;void 0!==b;){if(void 0!==b.constructor.style&&a in b.constructor.style)return b.constructor.style[a];b=b.__baseclass__}},onInternalStyleChange:function(){if(this.isLoaded)this.onStyleChange()},
onStyleChange:function(){},getHasFocus:function(){return this.hasFocus},scrollIntoView:function(){this.onScrollIntoView(this)},onScrollIntoView:function(a){if(void 0!==this.parent)this.parent.onScrollIntoView(a)},onFocus:function(a){this.focusable&&!this.getIsDisabled()&&(a.preventDefault(),a.stopPropagation(),this.hasFocus=!0,this.isMouseFocus=this.isMouseDownFocus,this.scrollIntoView(),this.fireEvent("focus",this))},onBlur:function(a){this.focusable&&(a.preventDefault(),a.stopPropagation(),this.hasFocus=
this.isMouseFocus=!1,this.fireEvent("blur",this))},setIsLoaded:function(a){if(this.isLoaded!==a)if(this.isLoaded=a)this.onLoad();else this.onUnload()},updateTransform:function(){if(void 0!==this.transform){var a=this.transform,b=this.transformOriginX,c=this.transformOriginY;this.transformOriginAbsolute||(b*=this.layoutWidth,c*=this.layoutHeight);if(0!==b||0!==c)a=Ui.Matrix.createTranslate(b,c).multiply(this.transform).translate(-b,-c);this.drawing.style.transform=a.toString();navigator.isIE?this.drawing.style.msTransform=
a.toString():navigator.isGecko?this.drawing.style.MozTransform="matrix("+a.getA().toFixed(4)+", "+a.getB().toFixed(4)+", "+a.getC().toFixed(4)+", "+a.getD().toFixed(4)+", "+a.getE().toFixed(4)+"px, "+a.getF().toFixed(4)+"px)":navigator.isWebkit?this.drawing.style.webkitTransform=a.toString()+" translate3d(0,0,0)":navigator.isOpera&&(this.drawing.style.OTransform=a.toString())}else"removeProperty"in this.drawing.style&&this.drawing.style.removeProperty("transform"),navigator.isIE&&"removeProperty"in
this.drawing.style?this.drawing.style.removeProperty("-ms-transform"):navigator.isGecko?this.drawing.style.removeProperty("-moz-transform"):navigator.isWebkit?this.drawing.style.removeProperty("-webkit-transform"):navigator.isOpera&&this.drawing.style.removeProperty("-o-transform")},setAnimClock:function(a){void 0!==this.animClock&&this.animClock.stop();this.animClock=a;void 0!==a&&this.connect(a,"complete",this.onAnimClockComplete)},onAnimClockComplete:function(){this.animClock=void 0},onLoad:function(){void 0!==
this.parent&&(this.setParentStyle(this.parent.mergeStyle),this.setParentDisabled(this.parent.getIsDisabled()),this.setParentVisible(this.parent.getIsVisible()));this.fireEvent("load",this)},onUnload:function(){void 0!==this.animClock&&(this.animClock.stop(),this.animClock=void 0);this.fireEvent("unload",this)}},{},{transformToWindow2:function(a){for(var b=new Ui.Matrix;void 0!==a;)b=a.getInverseLayoutTransform().multiply(b),a=a.parent;return b},transformFromWindow2:function(a){return Ui.Element.transformToWindow2(a).inverse()},
elementFromPoint:function(a,b){return Ui.App.current.elementFromPoint(a,b)},getIsDrawingChildOf:function(a,b){for(var c=a;void 0!==c&&null!==c;){if(c===b)return!0;c=c.offsetParent}return!1},transformToWindow:function(a,b){var c,d,e,f,g,l,k,h,n,m,p,q;void 0===b&&(b=window);if(navigator.isWebkit){p=new Ui.Matrix;for(m=a;void 0!==m&&null!==m;)q=b.getComputedStyle(m,null).getPropertyValue("-webkit-transform"),"none"!=q&&(n=b.getComputedStyle(m,null).getPropertyValue("-webkit-transform-origin"),h=k=0,
"0px 0px"!==n&&""!==n&&(h=n.split(" "),k=parseFloat(h[0].replace(/px$/,"")),h=parseFloat(h[1].replace(/px$/,""))),c=new WebKitCSSMatrix(q),c=Ui.Matrix.createMatrix(c.a,c.b,c.c,c.d,c.e,c.f),p=p.translate(-k,-h).multiply(c).translate(k,h)),p=p.translate(m.offsetLeft,m.offsetTop).translate(-m.scrollLeft,-m.scrollTop),m=m.offsetParent}else if(navigator.isGecko){p=new Ui.Matrix;for(m=a;void 0!==m&&null!==m;)q=b.getComputedStyle(m,null).getPropertyValue("-moz-transform"),"none"!==q&&(k=q.split(" "),c=parseFloat(k[0].slice(7,
k[0].length-1)),d=parseFloat(k[1].slice(0,k[1].length-1)),e=parseFloat(k[2].slice(0,k[2].length-1)),f=parseFloat(k[3].slice(0,k[3].length-1)),g=parseFloat(k[4].slice(0,k[4].length-1)),l=parseFloat(k[5].slice(0,k[5].length-1)),n=b.getComputedStyle(m,null).getPropertyValue("-moz-transform-origin"),h=k=0,"0px 0px"!=n&&(h=n.split(" "),k=parseFloat(h[0].replace(/px$/,"")),h=parseFloat(h[1].replace(/px$/,""))),c=Ui.Matrix.createMatrix(c,d,e,f,g,l),p=p.translate(-k,-h).multiply(c).translate(k,h)),p=p.translate(m.offsetLeft,
m.offsetTop).translate(-m.scrollLeft,-m.scrollTop),m=m.offsetParent}else if(navigator.isOpera){p=new Ui.Matrix;for(m=a;void 0!==m&&null!==m;)q=b.getComputedStyle(m,null).getPropertyValue("-o-transform"),"none"!=q&&"matrix(1, 0, 0, 1, 0, 0)"!=q&&(k=q.split(" "),c=parseFloat(k[0].slice(7,k[0].length-1)),d=parseFloat(k[1].slice(0,k[1].length-1)),e=parseFloat(k[2].slice(0,k[2].length-1)),f=parseFloat(k[3].slice(0,k[3].length-1)),g=parseFloat(k[4].slice(0,k[4].length-1)),l=parseFloat(k[5].slice(0,k[5].length-
1)),n=b.getComputedStyle(m,null).getPropertyValue("-o-transform-origin"),h=k=0,"0px 0px"!=n&&(h=n.split(" "),k=parseFloat(h[0].replace(/px$/,"")),h=parseFloat(h[1].replace(/px$/,""))),p=p.translate(-k,-h).multiply(Ui.Matrix.createMatrix(c,d,e,f,g,l)).translate(k,h)),p=p.translate(m.offsetLeft,m.offsetTop).translate(-m.scrollLeft,-m.scrollTop),m=m.offsetParent}else if(navigator.isIE){p=new Ui.Matrix;for(m=a;void 0!==m&&null!==m&&m!==window;){try{q=b.getComputedStyle(m,null).getPropertyValue("-ms-transform")}catch(r){q=
"none"}"none"!==q&&"matrix(1, 0, 0, 1, 0, 0)"!=q&&(k=q.split(" "),c=parseFloat(k[0].slice(7,k[0].length-1)),d=parseFloat(k[1].slice(0,k[1].length-1)),e=parseFloat(k[2].slice(0,k[2].length-1)),f=parseFloat(k[3].slice(0,k[3].length-1)),g=parseFloat(k[4].slice(0,k[4].length-1)),l=parseFloat(k[5].slice(0,k[5].length-1)),n=b.getComputedStyle(m,null).getPropertyValue("-ms-transform-origin"),h=k=0,"0px 0px"!=n&&(h=n.split(" "),k=parseFloat(h[0].replace(/px$/,"")),h=parseFloat(h[1].replace(/px$/,""))),p=
p.translate(-k,-h).multiply(Ui.Matrix.createMatrix(c,d,e,f,g,l)).translate(k,h));p=p.translate(m.offsetLeft,m.offsetTop).translate(-m.scrollLeft,-m.scrollTop);m=m.offsetParent}}else if(navigator.supportSVG)m=document.createElementNS(svgNS,"svg"),void 0===a.firstChild?a.appendChild(m):a.insertBefore(m,a.firstChild),p=m.getScreenCTM(),a.removeChild(m),p=Ui.Matrix.createMatrix(p.a,p.b,p.c,p.d,p.e,p.f);else{p=new Ui.Matrix;for(m=a;void 0!==m&&null!==m&&m!==window;)p=p.translate(m.offsetLeft,m.offsetTop).translate(-m.scrollLeft,
-m.scrollTop),m=m.offsetParent}return p},transformFromWindow:function(a,b){return Ui.Element.transformToWindow(a,b).inverse()},pointToWindow:function(a,b,c){return(new Ui.Point({point:b})).multiply(Ui.Element.transformToWindow(a,c))},pointFromWindow:function(a,b,c){return(new Ui.Point({point:b})).multiply(Ui.Element.transformFromWindow(a,c))},setSelectable:function(a,b){(a.selectable=b)?(a.style.cursor="text",a.style.userSelect="text",navigator.isWebkit?a.style.webkitUserSelect="text":navigator.isGecko?
a.style.MozUserSelect="text":navigator.isIE&&(a.style.msUserSelect="element")):(a.style.cursor="inherit",a.style.userSelect="none",navigator.isWebkit?a.style.webkitUserSelect="none":navigator.isGecko?a.style.MozUserSelect="none":navigator.isIE&&(a.style.msUserSelect="none"))}});navigator.supportOpacity=!navigator.isIE7&&!navigator.isIE8;Ui.Element.extend("Ui.Container",{children:void 0,containerDrawing:void 0,constructor:function(a){this.children=[];void 0===this.containerDrawing&&(this.containerDrawing=this.getDrawing())},getContainerDrawing:function(){return this.containerDrawing},setContainerDrawing:function(a){this.containerDrawing=a},appendChild:function(a){a.parent=this;this.children.push(a);this.containerDrawing.appendChild(a.getDrawing());a.setIsLoaded(this.isLoaded);a.setParentVisible(this.getIsVisible());a.setParentDisabled(this.getIsDisabled());
this.onChildInvalidateMeasure(a,"add")},prependChild:function(a){a.parent=this;this.children.unshift(a);void 0!==this.containerDrawing.firstChild?this.containerDrawing.insertBefore(a.getDrawing(),this.containerDrawing.firstChild):this.containerDrawing.appendChild(a.getDrawing());a.setIsLoaded(this.isLoaded);a.setParentVisible(this.getIsVisible());a.setParentDisabled(this.getIsDisabled());this.onChildInvalidateMeasure(a,"add")},removeChild:function(a){a.parent=void 0;this.containerDrawing.removeChild(a.getDrawing());
for(var b=0;b<this.children.length&&this.children[b]!==a;)b++;b<this.children.length&&this.children.splice(b,1);a.setIsLoaded(!1);a.setParentVisible(!1);this.onChildInvalidateMeasure(a,"remove")},insertChildAt:function(a,b){b=Math.max(0,Math.min(b,this.children.length));a.parent=this;this.children.splice(b,0,a);void 0!==this.containerDrawing.firstChild&&b<this.children.length-1?this.containerDrawing.insertBefore(a.getDrawing(),this.containerDrawing.childNodes[b]):this.containerDrawing.appendChild(a.getDrawing());
a.setIsLoaded(this.isLoaded);a.setParentVisible(this.getIsVisible());a.setParentDisabled(this.getIsDisabled());this.onChildInvalidateMeasure(a,"add")},insertChildBefore:function(a,b){this.insertChildAt(a,this.getChildPosition(b))},moveChildAt:function(a,b){0>b&&(b=this.children.length+b);0>b&&(b=0);b>=this.children.length&&(b=this.children.length);for(var c=0;c<this.children.length&&this.children[c]!==a;)c++;c<this.children.length&&(this.children.splice(c,1),this.children.splice(b,0,a),this.containerDrawing.removeChild(a.getDrawing()),
void 0!==this.containerDrawing.firstChild&&b<this.containerDrawing.childNodes.length?this.containerDrawing.insertBefore(a.getDrawing(),this.containerDrawing.childNodes[b]):this.containerDrawing.appendChild(a.getDrawing()));this.onChildInvalidateMeasure(a,"move")},getChildren:function(){return this.children},getFirstChild:function(){if(0<this.children.length)return this.children[0]},getLastChild:function(){if(0<this.children.length)return this.children[this.children.length-1]},getChildPosition:function(a){for(var b=
0;b<this.children.length;b++)if(this.children[b]===a)return b;return-1},hasChild:function(a){return-1!==this.getChildPosition(a)},clear:function(){for(;void 0!==this.getFirstChild();)this.removeChild(this.getFirstChild())}},{get:function(a){if(this.name==a)return this;for(var b=0;b<this.children.length;b++){var c=this.children[b].get(a);if(void 0!==c)return c}},elementFromPoint:function(a,b){if(this.getIsVisible()){var c=(new Ui.Point({x:a,y:b})).multiply(this.getLayoutTransform()),d=0<=c.x&&c.x<=
this.layoutWidth&&0<=c.y&&c.y<=this.layoutHeight;if(!this.getClipToBounds()||d){if(void 0!==this.children)for(var e=this.children.length-1;0<=e;e--){var f=this.children[e].elementFromPoint(c.x,c.y);if(void 0!==f)return f}if(!this.getEventsHidden()&&d)return this}}},setIsLoaded:function(a){if(this.isLoaded!=a){if(this.isLoaded=a)this.onLoad();else this.onUnload();for(var b=0;b<this.children.length;b++)this.children[b].setIsLoaded(a)}},onInternalStyleChange:function(){if(this.isLoaded&&(this.onStyleChange(),
void 0!==this.children))for(var a=0;a<this.children.length;a++)this.children[a].setParentStyle(this.mergeStyle)},onInternalDisable:function(){Ui.Container.base.onInternalDisable.call(this);for(var a=0;a<this.children.length;a++)this.children[a].setParentDisabled(!0)},onInternalEnable:function(){Ui.Container.base.onInternalEnable.call(this);for(var a=0;a<this.children.length;a++)this.children[a].setParentDisabled(!1)},onInternalVisible:function(){Ui.Container.base.onInternalVisible.call(this);for(var a=
0;a<this.children.length;a++)this.children[a].setParentVisible(!0)},onInternalHidden:function(){Ui.Container.base.onInternalHidden.call(this);for(var a=0;a<this.children.length;a++)this.children[a].setParentVisible(!1)}});Core.Object.extend("Ui.SvgParser",{path:void 0,pos:0,cmd:void 0,current:void 0,value:!1,end:!1,constructor:function(a){this.path=a.path;delete a.path},isEnd:function(){return this.end},next:function(){this.end=this.pos>=this.path.length;if(!this.end){for(;this.pos<this.path.length&&(" "==this.path[this.pos]||","==this.path[this.pos]||";"==this.path[this.pos]);)this.pos++;var a=!1,b=!1;this.current="";var c=this.path[this.pos];if("e"!==c&&"a"<=c&&"z">=c||"A"<=c&&"Z">=c)this.cmd=this.current=this.path[this.pos++],
this.value=!1;else{for(;this.pos<this.path.length&&("0"<=this.path[this.pos]&&"9">=this.path[this.pos]||"-"===this.path[this.pos]&&(0==this.current.length||"e"===this.current[this.current.length-1])||!b&&"e"===this.path[this.pos]||!a&&"."===this.path[this.pos]);)"."===this.path[this.pos]&&(a=!0),"e"===this.path[this.pos]&&(b=!0),this.current+=this.path[this.pos++];this.value=!0;"."===this.current[0]&&(this.current="0"+this.current);"-"===this.current[0]&&"."===this.current[1]&&(this.current="-0"+
this.current.substring(1));this.current=parseFloat(this.current);if(isNaN(this.current))throw"bad number";}}},setCmd:function(a){this.cmd=a},getCmd:function(){return this.cmd},getCurrent:function(){return this.current},isCmd:function(){return!this.value},isValue:function(){return this.value}});Ui.Element.extend("Ui.SVGElement",{renderSVG:function(a){}},{renderDrawing:function(){var a=document.createElementNS(svgNS,"svg");a.setAttribute("focusable",!1);var b=this.renderSVG(a);void 0!==b&&a.appendChild(b);return a}});Ui.Container.extend("Ui.CanvasElement",{canvasEngine:"svg",context:void 0,svgDrawing:void 0,dpiRatio:1,constructor:function(a){this.setSelectable(!1)},update:function(){if("canvas"===this.canvasEngine)this.context.clearRect(0,0,Math.ceil(this.getLayoutWidth()*this.dpiRatio),Math.ceil(this.getLayoutHeight()*this.dpiRatio)),this.context.save(),1!==this.dpiRatio&&this.context.scale(this.dpiRatio,this.dpiRatio),this.updateCanvas(this.context),this.context.restore();else{void 0!==this.svgDrawing&&this.getDrawing().removeChild(this.svgDrawing);
var a=document.createElementNS(svgNS,"svg");a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.width=this.getLayoutWidth()+"px";a.style.height=this.getLayoutHeight()+"px";a.setAttribute("focusable",!1);a.setAttribute("draggable",!1);a.setAttribute("pointer-events","none");var b=new Core.SVG2DContext({document:a});this.updateCanvas(b);this.svgDrawing=a;this.svgDrawing.appendChild(b.getSVG());this.getDrawing().appendChild(this.svgDrawing)}},getContext:function(){return this.context},
updateCanvas:function(a){}},{renderDrawing:function(a){"canvasEngine"in a&&(this.canvasEngine=a.canvasEngine,delete a.canvasEngine);"canvas"===this.canvasEngine&&!navigator.supportCanvas&&(this.canvasEngine="svg");"svg"===this.canvasEngine&&!navigator.supportSVG&&(this.canvasEngine="canvas");var b;"canvas"===this.canvasEngine?(a=document.createElement("canvas"),this.context=a.getContext("2d")):(a=document.createElement("div"),b=document.createElement("div"),b.style.width="0px",b.style.height="0px",
b.style.visibility="hidden",a.appendChild(b),this.setContainerDrawing(b),navigator.supportCanvas&&(a.toDataURL=this.svgToDataURL.bind(this)));return a},svgToDataURL:function(){var a=document.createElement("canvas"),b=a.getContext("2d");a.setAttribute("width",Math.ceil(this.getLayoutWidth()),null);a.setAttribute("height",Math.ceil(this.getLayoutHeight()),null);this.updateCanvas(b);return a.toDataURL.apply(a,arguments)},arrangeCore:function(a,b){var c=window.devicePixelRatio||1,d=1;void 0!==this.context&&
(d=this.context.webkitBackingStorePixelRatio||this.context.mozBackingStorePixelRatio||this.context.msBackingStorePixelRatio||this.context.oBackingStorePixelRatio||this.context.backingStorePixelRatio||1);this.dpiRatio=c/d;this.getDrawing().setAttribute("width",Math.ceil(a*this.dpiRatio),null);this.getDrawing().setAttribute("height",Math.ceil(b*this.dpiRatio),null);this.getIsVisible()&&this.getIsLoaded()&&this.update()},drawCore:function(){0!==this.getLayoutWidth()&&0!==this.getLayoutHeight()&&this.update()},
onInternalVisible:function(){Ui.CanvasElement.base.onInternalVisible.call(this);this.invalidateDraw()}});
Core.Object.extend("Core.SVG2DPath",{d:void 0,x:0,y:0,constructor:function(a){this.d=""},moveTo:function(a,b){this.d+=" M "+a+" "+b;this.x=a;this.y=b},lineTo:function(a,b){this.d+=" L "+a+" "+b;this.x=a;this.y=b},quadraticCurveTo:function(a,b,c,d){this.d+=" Q "+a+" "+b+" "+c+" "+d;this.x=c;this.y=d},bezierCurveTo:function(a,b,c,d,e,f){this.d+=" C "+a+" "+b+" "+c+" "+d+" "+e+" "+f;this.x=e;this.y=f},arcTo:function(a,b,c,d,e,f,g){a=(this.x-a)*(d-b)-(this.y-b)*(c-a);void 0===g&&(g=f,f=e);this.d+=" A "+
e+" "+f+" "+g*Math.PI/180+" 0 "+(0>a?1:0)+" "+c+" "+d;this.x=c;this.y=d},closePath:function(){this.d+=" Z"},rect:function(a,b,c,d){this.moveTo(a,b);this.lineTo(a+c,b);this.lineTo(a+c,b+d);this.lineTo(a,b+d)},arc:function(a,b,c,d,e,f){this.ellipse(a,b,c,c,0,d,e,f)},ellipse:function(a,b,c,d,e,f,g,l){if(0===e&&0===f&&g===2*Math.PI)this.moveTo(a,b+d),this.arcTo(a+c,b+d,a+c,b,c,d,Math.PI/2),this.arcTo(a+c,b-d,a,b-d,c,d,Math.PI/2),this.arcTo(a-c,b-d,a-c,b,c,d,Math.PI/2),this.arcTo(a-c,b+d,a,b+d,c,d,Math.PI/
2);else{e=a+Math.cos(f)*c;var k=b+Math.sin(f)*d;a+=Math.cos(g)*c;b+=Math.sin(g)*d;this.moveTo(e,k);e=(g-f+2*Math.PI)%(2*Math.PI)>Math.PI;l&&(e=!e);this.d+=" A "+c+" "+d+" "+(g-f)*Math.PI/180+" "+(e?1:0)+" "+(!l?1:0)+" "+a+" "+b;this.x=a;this.y=b}},roundRect:function(a,b,c,d,e,f,g,l,k){!0===k?(this.moveTo(a+e,b),0<e&&this.arcTo(a,b,a,b+e,e,e,Math.PI/4),this.lineTo(a,b+d-l),0<l&&this.arcTo(a,b+d,a+l,b+d,l,l,Math.PI/4),this.lineTo(a+c-g,b+d),0<g&&this.arcTo(a+c,b+d,a+c,b+d-g,g,g,Math.PI/4),this.lineTo(a+
c,b+f),0<f&&this.arcTo(a+c,b,a+c-f,b,f,f,Math.PI/4)):(this.moveTo(a,b+e),0<e&&this.arcTo(a,b,a+e,b,e,e,Math.PI/4),this.lineTo(a+c-f,b),0<f&&this.arcTo(a+c,b,a+c,b+f,f,f,Math.PI/4),this.lineTo(a+c,b+d-g),0<g&&this.arcTo(a+c,b+d,a+c-g,b+d,g,g,Math.PI/4),this.lineTo(a+l,b+d),0<l&&this.arcTo(a,b+d,a,b+d-l,l,l,Math.PI/4))},getSVG:function(){var a=document.createElementNS(svgNS,"path");a.setAttribute("d",this.d);return a}});
Core.Object.extend("Core.SVGGradient",{gradient:void 0,id:void 0,constructor:function(a){this.gradient=document.createElementNS(svgNS,"linearGradient");this.gradient.setAttributeNS(null,"gradientUnits","userSpaceOnUse");this.gradient.setAttributeNS(null,"x1",a.x0);this.gradient.setAttributeNS(null,"y1",a.y0);this.gradient.setAttributeNS(null,"x2",a.x1);this.gradient.setAttributeNS(null,"y2",a.y1);delete a.x0;delete a.y0;delete a.x1;delete a.y1;this.id="_grad"+ ++Core.SVGGradient.counter;this.gradient.setAttributeNS(null,
"id",this.id)},getId:function(){return this.id},addColorStop:function(a,b){var c=document.createElementNS(svgNS,"stop");c.setAttributeNS(null,"offset",a);c.style.stopColor=b;b=Ui.Color.create(b);c.style.stopOpacity=b.getRgba().a;this.gradient.appendChild(c)},getSVG:function(){return this.gradient}},{},{counter:0});
Core.Object.extend("Core.SVG2DContext",{fillStyle:"black",strokeStyle:"black",lineWidth:1,lineDash:void 0,globalAlpha:1,currentTransform:void 0,font:"default 10px sans-serif",textAlign:"start",textBaseLine:"alphabetic",direction:"inherit",clipId:void 0,document:void 0,currentPath:void 0,g:void 0,defs:void 0,states:void 0,constructor:function(a){this.document=a.document;delete a.document;this.g=document.createElementNS(svgNS,"g");this.currentTransform=this.document.createSVGMatrix();this.states=[];
this.lineDash=[];this.defs=document.createElementNS(svgNS,"defs");this.g.appendChild(this.defs)},beginPath:function(){this.currentPath=new Core.SVG2DPath},moveTo:function(a,b){this.currentPath.moveTo(a,b)},lineTo:function(a,b){this.currentPath.lineTo(a,b)},quadraticCurveTo:function(a,b,c,d){this.currentPath.quadraticCurveTo(a,b,c,d)},bezierCurveTo:function(a,b,c,d,e,f){this.currentPath.bezierCurveTo(a,b,c,d,e,f)},rect:function(a,b,c,d){this.currentPath.rect(a,b,c,d)},arc:function(a,b,c,d,e,f){this.currentPath.arc(a,
b,c,d,e,f)},ellipse:function(a,b,c,d,e,f,g,l){this.currentPath.ellipse(a,b,c,d,e,f,g,l)},roundRect:function(a,b,c,d,e,f,g,l,k){this.currentPath.roundRect(a,b,c,d,e,f,g,l,k)},closePath:function(){this.currentPath.closePath()},fill:function(){var a=this.currentPath.getSVG();if(Core.SVGGradient.hasInstance(this.fillStyle)){var b=this.fillStyle.getId();this.defs.appendChild(this.fillStyle.getSVG());a.style.fill="url(#"+b+")"}else a.style.fill=this.fillStyle;void 0!==this.clipId&&a.setAttributeNS(null,
"clip-path","url(#"+this.clipId+")");a.style.opacity=this.globalAlpha;a.transform.baseVal.initialize(this.document.createSVGTransformFromMatrix(this.currentTransform));this.g.appendChild(a)},stroke:function(){var a=this.currentPath.getSVG();a.style.stroke=this.strokeStyle;a.style.fill="none";a.style.opacity=this.globalAlpha;a.style.strokeWidth=this.lineWidth;void 0!==this.clipId&&a.setAttributeNS(null,"clip-path","url(#"+this.clipId+")");0!==this.lineDash.length&&a.setAttributeNS(null,"stroke-dasharray",
this.lineDash.join(","));a.setAttributeNS(null,"pointer-events","none");a.transform.baseVal.initialize(this.document.createSVGTransformFromMatrix(this.currentTransform));this.g.appendChild(a)},clip:function(){var a=document.createElementNS(svgNS,"clipPath");this.clipId="_clip"+ ++Core.SVG2DContext.counter;a.setAttributeNS(null,"id",this.clipId);a.appendChild(this.currentPath.getSVG());this.defs.appendChild(a)},resetClip:function(){this.clipId=void 0},getLineDash:function(){return this.lineDash},setLineDash:function(a){this.lineDash=
a},drawImage:function(a,b,c,d,e,f,g,l,k){var h,n=a.naturalWidth,m=a.naturalHeight;void 0===d?(f=b,g=c,c=b=0,d=n,e=m,l=n,k=m):void 0===f&&(f=b,g=c,l=d,k=e,c=b=0,d=n,e=m);if(0===b&&0===c&&d===n&&e==m)h=document.createElementNS(svgNS,"image"),void 0!==this.clipId&&h.setAttributeNS(null,"clip-path","url(#"+this.clipId+")"),h.style.opacity=this.globalAlpha,h.setAttributeNS(null,"pointer-events","none"),h.href.baseVal=a.src,h.setAttributeNS(null,"x",f),h.setAttributeNS(null,"y",g),h.setAttributeNS(null,
"width",l),h.setAttributeNS(null,"height",k),h.transform.baseVal.initialize(this.document.createSVGTransformFromMatrix(this.currentTransform)),this.g.appendChild(h);else{var p=document.createElementNS(svgNS,"pattern"),q="_pat"+ ++Core.SVG2DContext.counter;p.setAttributeNS(null,"id",q);p.setAttributeNS(null,"patternUnits","userSpaceOnUse");p.setAttributeNS(null,"x",f);p.setAttributeNS(null,"y",g);p.setAttributeNS(null,"width",l);p.setAttributeNS(null,"height",k);h=document.createElementNS(svgNS,"image");
h.href.baseVal=a.src;h.setAttributeNS(null,"x",-b*l/d);h.setAttributeNS(null,"y",-c*k/e);h.setAttributeNS(null,"width",n*l/d);h.setAttributeNS(null,"height",m*k/e);p.appendChild(h);this.defs.appendChild(p);a=document.createElementNS(svgNS,"path");a.setAttributeNS(null,"pointer-events","none");a.setAttributeNS(null,"d","M "+f+" "+g+" L "+(f+l)+" "+g+" L "+(f+l)+" "+(g+k)+" L "+f+" "+(g+k)+" Z");a.style.fill="url(#"+q+")";void 0!==this.clipId&&a.setAttributeNS(null,"clip-path","url(#"+this.clipId+")");
a.style.opacity=this.globalAlpha;a.transform.baseVal.initialize(this.document.createSVGTransformFromMatrix(this.currentTransform));this.g.appendChild(a)}},fillText:function(a,b,c,d){d=document.createElementNS(svgNS,"text");a=document.createTextNode(a);d.appendChild(a);d.style.fill=this.fillStyle;d.style.opacity=this.globalAlpha;d.setAttributeNS(null,"pointer-events","none");d.transform.baseVal.initialize(this.document.createSVGTransformFromMatrix(this.currentTransform));"center"==this.textAlign?d.style.textAnchor=
"middle":"end"==this.textAlign?d.style.textAnchor="end":"right"==this.textAlign&&(d.style.textAnchor="end");a=this.parseFont(this.font);d.style.fontFamily=a.family;d.style.fontWeight=a.weight;d.style.fontSize=a.size;d.style.fontStyle=a.style;navigator.isWebkit?"top"===this.textBaseline?d.style.alignmentBaseline="text-before-edge":"hanging"===this.textBaseline?d.style.alignmentBaseline="text-before-edge":"middle"===this.textBaseline?d.style.alignmentBaseline="central":"alphabetic"===this.textBaseline?
d.style.alignmentBaseline="alphabetic":"ideographic"===this.textBaseline?d.style.alignmentBaseline="ideographic":"bottom"===this.textBaseline&&(d.style.alignmentBaseline="text-after-edge"):(a=parseInt(a.size),"top"===this.textBaseline?c+=0.8*a:"hanging"===this.textBaseline?c+=0.8*a:"middle"===this.textBaseline?c+=0.8*a/2:"bottom"===this.textBaseline&&(c+=-0.2*a));d.setAttributeNS(null,"x",b);d.setAttributeNS(null,"y",c);this.g.appendChild(d)},strokeText:function(a,b,c,d){},save:function(){this.states.push({fillStyle:this.fillStyle,
strokeStyle:this.strokeStyle,lineWidth:this.lineWidth,lineDash:this.lineDash,globalAlpha:this.globalAlpha,matrix:{a:this.currentTransform.a,b:this.currentTransform.b,c:this.currentTransform.c,d:this.currentTransform.d,e:this.currentTransform.e,f:this.currentTransform.f},font:this.font,textAlign:this.textAlign,textBaseLine:this.textBaseLine,direction:this.direction,clipId:this.clipId})},restore:function(){if(0<this.states.length){var a=this.states.pop();this.fillStyle=a.fillStyle;this.strokeStyle=
a.strokeStyle;this.lineWidth=a.lineWidth;this.lineDash=a.lineDash;this.globalAlpha=a.globalAlpha;this.currentTransform=this.document.createSVGMatrix();this.currentTransform.a=a.matrix.a;this.currentTransform.b=a.matrix.b;this.currentTransform.c=a.matrix.c;this.currentTransform.d=a.matrix.d;this.currentTransform.e=a.matrix.e;this.currentTransform.f=a.matrix.f;this.font=a.font;this.textAlign=a.textAlign;this.textBaseLine=a.textBaseLine;this.direction=a.direction;this.clipId=a.clipId}},scale:function(a,
b){this.currentTransform=this.currentTransform.scaleNonUniform(a,void 0===b?a:b)},rotate:function(a){this.currentTransform=this.currentTransform.rotate(180*a/Math.PI)},translate:function(a,b){this.currentTransform=this.currentTransform.translate(a,b)},transform:function(a,b,c,d,e,f){var g=this.document.createSVGMatrix();g.a=a;g.b=b;g.c=c;g.d=d;g.e=e;g.f=f;this.currentTransform=this.currentTransform.multiply(g)},setTransform:function(a,b,c,d,e,f){this.currentTransform.a=a;this.currentTransform.b=b;
this.currentTransform.c=c;this.currentTransform.d=d;this.currentTransform.e=e;this.currentTransform.f=f},resetTransform:function(){this.currentTransform=this.document.createSVGMatrix()},clearRect:function(a,b,c,d){},fillRect:function(a,b,c,d){this.beginPath();this.currentPath.rect(a,b,c,d);this.closePath();this.fill()},strokeRect:function(a,b,c,d){this.beginPath();this.currentPath.rect(a,b,c,d);this.closePath();this.stroke()},createLinearGradient:function(a,b,c,d){return new Core.SVGGradient({x0:a,
y0:b,x1:c,y1:d})},measureText:function(a){var b=this.parseFont(this.font);return Ui.Label.measureText(a,b.size,b.family,b.weight)},svgPath:function(a){var b=0,c=0,d,e,f,g,l=0,k=0,h=new Ui.SvgParser({path:a});h.next();for(this.beginPath();!h.isEnd();)if(d=h.getCmd(),h.isCmd()&&h.next(),"m"===d)h.setCmd("l"),b+=h.getCurrent(),h.next(),c+=h.getCurrent(),h.next(),l=b,k=c,this.moveTo(b,c);else if("M"===d)h.setCmd("L"),b=h.getCurrent(),h.next(),c=h.getCurrent(),h.next(),l=b,k=c,this.moveTo(b,c);else if("l"===
d)b+=h.getCurrent(),h.next(),c+=h.getCurrent(),h.next(),this.lineTo(b,c);else if("L"===d)b=h.getCurrent(),h.next(),c=h.getCurrent(),h.next(),this.lineTo(b,c);else if("v"===d)c+=h.getCurrent(),h.next(),this.lineTo(b,c);else if("V"===d)c=h.getCurrent(),h.next(),this.lineTo(b,c);else if("h"===d)b+=h.getCurrent(),h.next(),this.lineTo(b,c);else if("H"===d)b=h.getCurrent(),h.next(),this.lineTo(b,c);else if("c"===d)d=b+h.getCurrent(),h.next(),e=c+h.getCurrent(),h.next(),f=b+h.getCurrent(),h.next(),g=c+h.getCurrent(),
h.next(),b+=h.getCurrent(),h.next(),c+=h.getCurrent(),h.next(),this.bezierCurveTo(d,e,f,g,b,c);else if("C"===d)d=h.getCurrent(),h.next(),e=h.getCurrent(),h.next(),f=h.getCurrent(),h.next(),g=h.getCurrent(),h.next(),b=h.getCurrent(),h.next(),c=h.getCurrent(),h.next(),this.bezierCurveTo(d,e,f,g,b,c);else if("s"===d)d=b+h.getCurrent(),h.next(),e=c+h.getCurrent(),h.next(),f=d,g=e,b+=h.getCurrent(),h.next(),c+=h.getCurrent(),h.next(),this.bezierCurveTo(d,e,f,g,b,c),this.lineTo(b,c);else if("S"===d)d=h.getCurrent(),
h.next(),e=h.getCurrent(),h.next(),f=d,g=e,b=h.getCurrent(),h.next(),c=h.getCurrent(),h.next(),this.bezierCurveTo(d,e,f,g,b,c);else if("q"===d)d=b+h.getCurrent(),h.next(),e=c+h.getCurrent(),h.next(),f=b+h.getCurrent(),h.next(),g=c+h.getCurrent(),h.next(),this.quadraticCurveTo(d,e,f,g),b=f,c=g;else if("Q"===d)d=h.getCurrent(),h.next(),e=h.getCurrent(),h.next(),f=h.getCurrent(),h.next(),g=h.getCurrent(),h.next(),this.quadraticCurveTo(d,e,f,g),b=f,c=g;else if("z"===d||"Z"===d)b=l,c=k,this.closePath();
else throw"Invalid SVG path cmd: "+d+" ("+a+")";},parseFont:function(a){a=a.split(" ");if(1===a.length)return{style:"default",weight:"normal",size:16,family:a[0]};if(2===a.length)return{style:"default",weight:"normal",size:parseInt(a[0]),family:a[1]};if(3===a.length)return{style:"default",weight:a[0],size:parseInt(a[1]),family:a[2]};if(4===a.length)return{style:a[0],weight:a[1],size:parseInt(a[2]),family:a[3]}},roundRectFilledShadow:function(a,b,c,d,e,f,g,l,k,h,n){this.save();for(var m=n.getRgba(),
p=0;p<h;p++)k?1==h?n=1:(n=(p+1)/h,n*=n):n=(p+1)/(h+1),n=new Ui.Color({r:m.r,g:m.g,b:m.b,a:m.a*n}),this.fillStyle=n.getCssRgba(),k?(this.beginPath(),this.roundRect(a,b,c,d,e,f,g,l),this.roundRect(a+h-p,b+h-p,c-2*(h-p),d-2*(h-p),e,f,g,l,!0)):(this.beginPath(),this.roundRect(a+p,b+p,c-2*p,d-2*p,e,f,g,l)),this.closePath(),this.fill();this.restore()},getSVG:function(){return this.g}},{},{counter:0});
navigator.supportCanvas&&(CanvasRenderingContext2D.prototype.roundRect=Core.SVG2DPath.prototype.roundRect,CanvasRenderingContext2D.prototype.svgPath=Core.SVG2DContext.prototype.svgPath,CanvasRenderingContext2D.prototype.roundRectFilledShadow=Core.SVG2DContext.prototype.roundRectFilledShadow);Ui.CanvasElement.extend("Ui.Shape",{fill:void 0,path:void 0,scale:1,constructor:function(a){},setScale:function(a){this.scale!=a&&(this.scale=a,this.invalidateDraw())},getFill:function(){return void 0===this.fill?Ui.Color.create(this.getStyleProperty("color")):this.fill},setFill:function(a){this.fill!==a&&("string"===typeof a&&(a=Ui.Color.create(a)),this.fill=a,this.invalidateDraw())},setPath:function(a){this.path!=a&&(this.path=a,this.invalidateDraw())}},{onStyleChange:function(){this.invalidateDraw()},
updateCanvas:function(a){if(void 0!==this.path){1!=this.scale&&a.scale(this.scale,this.scale);a.svgPath(this.path);var b=this.getFill();Ui.Color.hasInstance(b)?a.fillStyle=b.getCssRgba():Ui.LinearGradient.hasInstance(b)&&(a.fillStyle=b.getCanvasGradient(a,this.getLayoutWidth(),this.getLayoutHeight()));a.fill()}}},{style:{color:"#444444"}});Ui.Container.extend("Ui.LBox",{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,constructor:function(a){},setContent:function(a){if(!(1===this.getChildren().length&&a===this.getFirstChild())){for(;void 0!==this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!==a&&"object"===typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.append(a[b]);else this.append(a)}},setPadding:function(a){this.setPaddingTop(a);this.setPaddingBottom(a);this.setPaddingLeft(a);this.setPaddingRight(a)},
getPaddingTop:function(){return this.paddingTop},setPaddingTop:function(a){this.paddingTop!=a&&(this.paddingTop=a,this.invalidateMeasure())},getPaddingBottom:function(){return this.paddingBottom},setPaddingBottom:function(a){this.paddingBottom!=a&&(this.paddingBottom=a,this.invalidateMeasure())},getPaddingLeft:function(){return this.paddingLeft},setPaddingLeft:function(a){this.paddingLeft!=a&&(this.paddingLeft=a,this.invalidateMeasure())},getPaddingRight:function(){return this.paddingRight},setPaddingRight:function(a){this.paddingRight!=
a&&(this.paddingRight=a,this.invalidateMeasure())},append:function(a){this.appendChild(a)},prepend:function(a){this.prependChild(a)},insertBefore:function(a,b){this.insertChildBefore(a,b)},remove:function(a){this.removeChild(a)}},{measureCore:function(a,b){for(var c=this.getPaddingLeft(),d=this.getPaddingRight(),e=this.getPaddingTop(),f=this.getPaddingBottom(),g=Math.max(a-(c+d),0),l=Math.max(b-(e+f),0),k=0,h=0,n=0;n<this.getChildren().length;n++){var m=this.getChildren()[n].measure(g,l);m.width>
k&&(k=m.width);m.height>h&&(h=m.height)}return{width:k+(c+d),height:h+(e+f)}},arrangeCore:function(a,b){var c=this.getPaddingLeft(),d=this.getPaddingRight(),e=this.getPaddingTop(),f=this.getPaddingBottom();a-=c+d;b-=e+f;for(d=0;d<this.getChildren().length;d++)this.getChildren()[d].arrange(c,e,a,b)}});
Ui.LBox.extend("Ui.LPBox",{},{append:function(a,b){void 0===b&&(b=1);a["Ui.LPBox.layer"]=b;for(var c=0;c<this.getChildren().length&&this.getChildren()[c]["Ui.LPBox.layer"]<=b;c++);this.insertChildAt(a,c)},prepend:function(a,b){void 0===b&&(b=1);a["Ui.LPBox.layer"]=b;for(var c=0;c<this.getChildren().length&&this.getChildren()[c]["Ui.LPBox.layer"]<b;c++);c=Math.max(0,c);this.insertChildAt(a,c)}});Ui.Container.extend("Ui.Box",{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,uniform:!1,spacing:0,star:0,vertical:!0,constructor:function(a){},setContent:function(a){for(;void 0!==this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!==a&&"object"===typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.append(a[b]);else this.append(a)},getOrientation:function(){return this.vertical?"vertical":"horizontal"},setOrientation:function(a){var b=!0;"vertical"!==a&&
(b=!1);this.vertical!==b&&(this.vertical=b,this.invalidateMeasure())},setPadding:function(a){this.setPaddingTop(a);this.setPaddingBottom(a);this.setPaddingLeft(a);this.setPaddingRight(a)},getPaddingTop:function(){return this.paddingTop},setPaddingTop:function(a){this.paddingTop!=a&&(this.paddingTop=a,this.invalidateMeasure())},getPaddingBottom:function(){return this.paddingBottom},setPaddingBottom:function(a){this.paddingBottom!=a&&(this.paddingBottom=a,this.invalidateMeasure())},getPaddingLeft:function(){return this.paddingLeft},
setPaddingLeft:function(a){this.paddingLeft!=a&&(this.paddingLeft=a,this.invalidateMeasure())},getPaddingRight:function(){return this.paddingRight},setPaddingRight:function(a){this.paddingRight!=a&&(this.paddingRight=a,this.invalidateMeasure())},getUniform:function(){return this.uniform},setUniform:function(a){this.uniform!=a&&(this.uniform=a,this.invalidateMeasure())},getSpacing:function(){return this.spacing},setSpacing:function(a){this.spacing!=a&&(this.spacing=a,this.invalidateMeasure())},append:function(a,
b){void 0!==b&&Ui.Box.setResizable(a,!0===b);this.appendChild(a)},prepend:function(a,b){void 0!==b&&Ui.Box.setResizable(a,!0===b);this.prependChild(a)},insertAt:function(a,b,c){void 0!==c&&Ui.Box.setResizable(a,!0===c);this.insertChildAt(a,b)},moveAt:function(a,b){this.moveChildAt(a,b)},remove:function(a){this.removeChild(a)},measureUniform:function(a,b){for(var c=this.vertical?b:a,d=this.vertical?a:b,c=c-this.spacing*(this.getChildren().length-1),e=c/this.getChildren().length,f=0,g=0,c=0,l=!0;l;){for(var k=
0;k<this.getChildren().length;k++){var h=this.getChildren()[k];Ui.Box.getResizable(h)&&f++;h=this.vertical?h.measure(d,e):h.measure(e,d);if((this.vertical?h.width:h.height)>c)c=this.vertical?h.width:h.height;if((this.vertical?h.height:h.width)>g)g=this.vertical?h.height:h.width}c>d||g>e?(g>e&&(e=g),d=c,f=g=c=0):l=!1}this.uniformSize=g;d=this.uniformSize*this.getChildren().length;d+=this.spacing*(this.getChildren().length-1);return this.vertical?{width:c,height:d}:{width:d,height:c}},measureNonUniformVertical:function(a,
b){var c,d,e,f=a,g;g=b-this.spacing*(this.getChildren().length-1);for(var l,k,h,n=!0,m=0;n;){for(c=h=k=l=0;c<this.getChildren().length;c++)d=this.getChildren()[c],Ui.Box.getResizable(d)?(d.boxStarDone=!1,l++):(e=d.measure(f,0),e.width>k&&(k=e.width),h+=e.height);var p=0;if(0<l){var q=g-h,r=!0,m=q/l;do{p=0;r=!0;for(c=0;c<this.getChildren().length;c++)if(d=this.getChildren()[c],Ui.Box.getResizable(d)&&!d.boxStarDone)if(e=d.measure(f,m),e.width>k&&(k=e.width),e.height>m){d.boxStarDone=!0;r=!1;q-=e.height;
h+=e.height;l--;m=q/l;break}else p+=e.height}while(!r)}k>f?f=k:n=!1}h+=this.spacing*(this.getChildren().length-1);0<l?(h+=p,this.star=m):this.star=0;return{width:k,height:h}},measureNonUniformHorizontal:function(a,b){var c,d,e,f,g=b;f=a-this.spacing*(this.getChildren().length-1);for(var l,k,h,n=!0,m=0;n;){for(c=h=k=l=0;c<this.getChildren().length;c++)d=this.getChildren()[c],Ui.Box.getResizable(d)?(d.boxStarDone=!1,l++):(e=d.measure(0,g),e.height>h&&(h=e.height),k+=e.width);var p=0;if(0<l){var q=f-
k,r=!0,m=q/l;do{p=0;r=!0;for(c=0;c<this.getChildren().length;c++)if(d=this.getChildren()[c],Ui.Box.getResizable(d)&&!d.boxStarDone)if(e=d.measure(m,g),e.height>h&&(h=e.height),e.width>m){d.boxStarDone=!0;r=!1;q-=e.width;k+=e.width;l--;m=q/l;break}else p+=e.width}while(!r)}h>g?g=h:n=!1}k+=this.spacing*(this.getChildren().length-1);0<l?(k+=p,this.star=m):this.star=0;return{width:k,height:h}}},{measureCore:function(a,b){var c=this.getPaddingLeft(),d=this.getPaddingRight(),e=this.getPaddingTop(),f=this.getPaddingBottom(),
g=Math.max(0,a-(c+d)),l=Math.max(0,b-(e+f)),g=this.uniform?this.measureUniform(g,l):this.vertical?this.measureNonUniformVertical(g,l):this.measureNonUniformHorizontal(g,l);g.width+=c+d;g.height+=e+f;return g},arrangeCore:function(a,b){var c=this.paddingLeft,d=this.paddingTop,e=this.paddingBottom;a-=c+this.paddingRight;b-=d+e;for(var e=this.vertical?d:c,f=0,g=0,l=0,k=this.getChildren().length,h=0,n=0;n<k;n++){var m=this.getChildren()[n],p=this.vertical?m.getMeasureHeight():m.getMeasureWidth();Ui.Box.getResizable(m)?
(h++,f++,m.boxStarDone=!1):(0<p&&h++,g+=p);p>l&&(l=p)}var g=g+Math.max(0,h-1)*this.spacing,q=0,r=0;if(0<f)if(this.uniform)r=((this.vertical?b:a)-this.spacing*(h-1))/h;else{l=(this.vertical?b:a)-g;h=!0;q=l/f;do{resizableMinSize=0;h=!0;for(n=0;n<k;n++)if(m=this.getChildren()[n],Ui.Box.getResizable(m)&&(p=this.vertical?m.getMeasureHeight():m.getMeasureWidth(),!m.boxStarDone&&p>q)){m.boxStarDone=!0;h=!1;l-=p;g+=p;f--;q=l/f;break}}while(!h)}else this.uniform&&(r=l);f=!0;for(n=0;n<k;n++)m=this.getChildren()[n],
p=this.vertical?m.getMeasureHeight():m.getMeasureWidth(),this.uniform?(f?f=!1:e+=this.spacing,this.vertical?m.arrange(c,e,a,r):m.arrange(e,d,r,b),e+=r):Ui.Box.getResizable(m)&&(this.vertical?m.getMeasureHeight():m.getMeasureWidth())<this.star?(f?f=!1:e+=this.spacing,this.vertical?m.arrange(c,e,a,q):m.arrange(e,d,q,b),e+=q):0<p&&(f?f=!1:e+=this.spacing,this.vertical?(m.arrange(c,e,a,m.getMeasureHeight()),e+=m.getMeasureHeight()):(m.arrange(e,d,m.getMeasureWidth(),b),e+=m.getMeasureWidth()))}},{getResizable:function(a){return a["Ui.Box.resizable"]?
!0:!1},setResizable:function(a,b){Ui.Box.getResizable(a)!==b&&(a["Ui.Box.resizable"]=b,a.invalidateMeasure())}});Ui.Box.extend("Ui.VBox",{constructor:function(a){this.setOrientation("vertical")}});Ui.Box.extend("Ui.HBox",{constructor:function(a){this.setOrientation("horizontal")}});Ui.Container.extend("Ui.Flow",{uniform:!1,uniformWidth:void 0,uniformHeight:void 0,itemAlign:"left",spacing:0,constructor:function(a){},setContent:function(a){for(;void 0!==this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!==a&&"object"==typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.appendChild(a[b]);else this.appendChild(a)},getSpacing:function(){return this.spacing},setSpacing:function(a){this.spacing!=a&&(this.spacing=a,this.invalidateMeasure(),this.invalidateArrange())},
getItemAlign:function(){return this.itemAlign},setItemAlign:function(a){a!=this.itemAlign&&(this.itemAlign=a,this.invalidateMeasure(),this.invalidateArrange())},getUniform:function(){return this.uniform},setUniform:function(a){this.uniform!=a&&(this.uniform=a,this.invalidateMeasure())},append:function(a){this.appendChild(a)},prepend:function(a){this.prependChild(a)},insertAt:function(a,b){this.insertChildAt(a,b)},moveAt:function(a,b){this.moveChildAt(a,b)},remove:function(a){this.removeChild(a)},
measureChildrenNonUniform:function(a,b){for(var c={pos:0,y:0,width:0,height:0},d=0,e=0,f=0,g=0,l=0,k=0;k<this.getChildren().length;k++){var h=this.getChildren()[k],n=h.measure(a,b),m=0===d;if(!m&&d+n.width+(!m?this.spacing:0)>a)c.width=d,c.height=g,d=0,e+=g+this.spacing,g=0,m=!0,f++,c={pos:f,y:e,width:0,height:0};h.flowLine=c;m||(d+=this.spacing);h.flowLineX=d;d+=n.width;n.height>g&&(g=n.height);d>l&&(l=d)}c.width=d;c.height=g;return{width:l,height:e+g}},measureChildrenUniform:function(a,b){var c,
d,e=0,f=0;for(c=0;c<this.getChildren().length;c++)d=this.getChildren()[c],d=d.measure(a,b),d.width>e&&(e=d.width),d.height>f&&(f=d.height);d=Math.max(Math.floor((a+this.spacing)/(e+this.spacing)),1);var g=Math.ceil(this.getChildren().length/d);for(c=0;c<this.getChildren().length;c++)this.getChildren()[c].measure(e,f);this.uniformWidth=e;this.uniformHeight=f;return{width:e*d+(d-1)*this.spacing,height:g*f+(g-1)*this.spacing}}},{measureCore:function(a,b){return 0===this.getChildren().length?{width:0,
height:0}:this.uniform?this.measureChildrenUniform(a,b):this.measureChildrenNonUniform(a,b)},arrangeCore:function(a,b){var c,d,e,f;if(this.uniform)if("left"===this.itemAlign)for(e=d=c=0;e<this.getChildren().length;e++)f=this.getChildren()[e],c+this.uniformWidth>a&&(c=0,d+=this.uniformHeight+this.spacing),f.arrange(c,d,this.uniformWidth,this.uniformHeight),c+=this.uniformWidth+this.spacing;else{if("right"===this.itemAlign){var g=Math.max(Math.floor((a+this.spacing)/(this.uniformWidth+this.spacing)),
1),l=g*this.uniformWidth+(g-1)*this.spacing;c=this.getChildren().length<g?a-(this.getChildren().length*(this.uniformWidth+this.spacing)-this.spacing):a-l;for(e=d=0;e<this.getChildren().length;e++)f=this.getChildren()[e],c+this.uniformWidth>a&&(c=this.getChildren().length-e<g?a-((this.getChildren().length-e)*(this.uniformWidth+this.spacing)-this.spacing):a-l,d+=this.uniformHeight+this.spacing),f.arrange(c,d,this.uniformWidth,this.uniformHeight),c+=this.uniformWidth+this.spacing}}else for(e=0;e<this.getChildren().length;e++)f=
this.getChildren()[e],"left"==this.itemAlign?f.arrange(f.flowLineX,f.flowLine.y,f.getMeasureWidth(),f.flowLine.height):f.arrange(f.flowLineX+(a-f.flowLine.width),f.flowLine.y,f.getMeasureWidth(),f.flowLine.height)}});Core.Object.extend("Ui.SFlowState",{x:0,y:0,width:0,height:0,xpos:0,ypos:0,zones:void 0,currentZone:void 0,boxes:void 0,lineHeight:0,drawCount:0,drawCmd:void 0,drawWidth:0,drawSpaceWidth:0,render:!1,centerstatus:!1,spacing:0,align:"left",stretchMaxRatio:1.7,uniform:!1,uniformWidth:void 0,uniformHeight:void 0,firstLine:!0,lastLine:!1,stretchUniformWidth:void 0,constructor:function(a){this.width=a.width;delete a.width;this.render=a.render;delete a.render;"spacing"in a&&(this.spacing=a.spacing,delete a.spacing);
"align"in a&&(this.align=a.align,delete a.align);"uniform"in a&&(this.uniform=a.uniform,delete a.uniform);"uniformWidth"in a&&(this.stretchUniformWidth=this.uniformWidth=a.uniformWidth,delete a.uniformWidth);"uniformHeight"in a&&(this.uniformHeight=a.uniformHeight,delete a.uniformHeight);"stretchMaxRatio"in a&&(this.stretchMaxRatio=a.stretchMaxRatio,delete a.stretchMaxRatio);this.zones=[{xstart:0,xend:this.width}];this.currentZone=0;this.boxes=[];this.drawCmd=[]},getSize:function(){this.lastLine=
!0;this.flush();return{width:this.width,height:this.ypos}},append:function(a){var b,c;b=Ui.SFlow.getFlush(a);"flush"===b?this.flush():"flushleft"===b?this.flushLeft():"flushright"===b?this.flushRight():"newline"===b&&this.nextLine();b=Ui.SFlow.getFloat(a);if("none"===b){var d;this.uniform?(a.measure(this.uniformWidth,this.uniformHeight),d={width:this.uniformWidth,height:this.uniformHeight}):d=a.measure(this.width,0);for(;;)if(b=this.zones[this.currentZone],c=!1,b.xstart===this.xpos&&(c=!0),this.xpos+
d.width+(c?0:this.spacing)<=b.xend||c&&b.xend===this.width&&d.width>=this.width){this.pushDraw({width:d.width,height:d.height,spaceWidth:c?0:this.spacing,el:a});c||(this.xpos+=this.spacing);this.xpos+=d.width;d.height>this.lineHeight&&(this.lineHeight=d.height);break}else this.nextZone()}else if("left"===b)for(d=a.measure(this.width,0);;)if(b=this.zones[this.currentZone],c=!1,0===this.xpos&&(c=!0),c&&d.width<=b.xend-this.xpos){this.render&&a.arrange(this.xpos,this.ypos,d.width,d.height);this.insertBox({x:this.xpos,
y:this.ypos,width:d.width,height:d.height});break}else this.nextZone();else if("right"===b)for(d=a.measure(this.width,0);;)if(b=this.zones[this.currentZone],c=!1,this.width==b.xend&&(c=!0),c&&d.width<=b.xend-this.xpos){this.render&&a.arrange(b.xend-d.width,this.ypos,d.width,d.height);this.insertBox({x:b.xend-d.width,y:this.ypos,width:d.width,height:d.height});break}else this.nextZone();else if(DEBUG)throw"Invalid Ui.SFlow float policy ("+b+")";},flushDraw:function(){if(this.render&&0<this.drawCmd.length){var a=
this.zones[this.currentZone],b=a.xstart,c=0,d=0;"right"===this.align?b+=a.xend-a.xstart-(this.drawWidth+this.drawSpaceWidth):"center"===this.align?b+=Math.floor((a.xend-a.xstart-(this.drawWidth+this.drawSpaceWidth))/2):"stretch"===this.align&&(c=Math.floor((a.xend-a.xstart-(this.drawWidth+this.drawSpaceWidth))/this.drawCmd.length));for(a=0;a<this.drawCmd.length;a++){var e=this.drawCmd[a],d=e.width+c>e.width*this.stretchMaxRatio?e.width*this.stretchMaxRatio:e.width+c;this.uniform&&"stretch"===this.align&&
(this.lastLine&&!this.firstLine?d=Math.max(e.width,this.stretchUniformWidth):this.stretchUniformWidth=d);e.el.arrange(b+e.spaceWidth,this.ypos,d,this.lineHeight);b+=d+e.spaceWidth}}this.drawCmd=[];this.drawSpaceWidth=this.drawCount=this.drawWidth=0},pushDraw:function(a){this.drawCmd.push(a);this.drawCount++;this.drawWidth+=a.width;this.drawSpaceWidth+=a.spaceWidth},insertBox:function(a){this.boxes.push(a);this.calculZone()},calculZone:function(){var a;this.zones=[{xstart:0,xend:this.width}];for(var b=
0;b<this.boxes.length;b++){var c=this.boxes[b];if(!(this.ypos+this.lineHeight<c.y||this.ypos>=c.y+c.height)){for(var d=[],e=0;e<this.zones.length;e++)a=this.zones[e],c.x<=a.xstart&&c.x+c.width<a.xend?d.push({xstart:c.x+c.width,xend:a.xend}):c.x<a.xend&&c.x+c.width>=a.xend?d.push({xstart:a.xstart,xend:c.x}):c.x>a.xstart&&c.x+c.width<a.xend?(d.push({xstart:a.xstart,xend:c.x}),d.push({xstart:c.x+c.width,xend:a.xend})):c.x<=a.xstart&&c.x+c.width>=a.xend||d.push({xstart:a.xstart,xend:a.xend});this.zones=
d}}for(this.currentZone=0;this.currentZone<this.zones.length&&!(a=this.zones[this.currentZone],this.xpos>=a.xstart&&this.xpos<=a.xend);this.currentZone++);if(this.currentZone>=this.zones.length){this.currentZone=-1;for(this.currentZone=0;this.currentZone<this.zones.length;this.currentZone++)if(a=this.zones[this.currentZone],a.xstart>=this.xpos){this.xpos=a.xstart;break}this.currentZone>=this.zones.length&&(this.xpos=0,this.nextLine())}},flush:function(){for(0!==this.drawCount&&this.nextLine();;){var a=
this.zones[this.currentZone];if(0===a.xstart&&a.xend===this.width)break;else this.nextZone()}},flushLeft:function(){for(0!==this.drawCount&&this.nextLine();0!==this.zones[this.currentZone].xstart;)this.nextZone()},flushRight:function(){for(0!==this.drawCount&&this.nextLine();this.zones[this.currentZone].xend!==this.width;)this.nextZone()},nextLine:function(){this.flushDraw();do if(0<this.lineHeight)this.ypos+=this.lineHeight+this.spacing,this.lineHeight=0,this.calculZone();else if(0<this.boxes.length){for(var a=
Number.MAX_VALUE,b=0;b<this.boxes.length;b++){var c=this.boxes[b];this.ypos<c.y+c.height&&a>c.y+c.height&&(a=c.y+c.height)}a!==Number.MAX_VALUE&&(this.ypos=a+this.spacing);this.calculZone()}while(0===this.zones.length);this.currentZone=0;this.xpos=this.zones[0].xstart;this.firstLine=!1},nextZone:function(){this.flushDraw();this.currentZone>=this.zones.length-1?this.nextLine():(this.currentZone++,this.xpos=this.zones[this.currentZone].xstart)}});
Ui.Container.extend("Ui.SFlow",{uniform:!1,uniformRatio:void 0,uniformWidth:void 0,uniformHeight:void 0,itemAlign:"left",stretchMaxRatio:1.3,spacing:0,constructor:function(a){},setContent:function(a){for(;void 0!==this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!==a&&"object"===typeof a)if(a.constructor===Array)for(var b=0;b<a.length;b++)this.appendChild(a[b]);else this.appendChild(a)},getSpacing:function(){return this.spacing},setSpacing:function(a){this.spacing!=a&&(this.spacing=
a,this.invalidateMeasure(),this.invalidateArrange())},getItemAlign:function(){return this.itemAlign},setItemAlign:function(a){a!=this.itemAlign&&(this.itemAlign=a,this.invalidateMeasure(),this.invalidateArrange())},getUniform:function(){return this.uniform},setUniform:function(a){this.uniform!=a&&(this.uniform=a,this.invalidateMeasure())},getUniformRatio:function(){return this.uniformRatio},setUniformRatio:function(a){this.uniformRatio!=a&&(this.uniformRatio=a,this.invalidateMeasure())},getStretchMaxRatio:function(){return this.stretchMaxRatio},
setStretchMaxRatio:function(a){this.stretchMaxRatio!=a&&(this.stretchMaxRatio=a,this.invalidateMeasure())},append:function(a,b,c){this.appendChild(a);void 0!==b&&Ui.SFlow.setFloat(a,b);void 0!==c&&Ui.SFlow.setFlush(a,c)},prepend:function(a,b,c){this.prependChild(a);void 0!==b&&Ui.SFlow.setFloat(a,b);void 0!==c&&Ui.SFlow.setFlush(a,c)},insertAt:function(a,b,c,d){this.insertChildAt(a,b);void 0!==c&&Ui.SFlow.setFloat(a,c);void 0!==d&&Ui.SFlow.setFlush(a,d)},moveAt:function(a,b){this.moveChildAt(a,b)},
remove:function(a){this.removeChild(a)}},{measureCore:function(a,b){if(0===this.getChildren().length)return{width:0,height:0};if(this.uniform){for(var c=this.uniformHeight=this.uniformWidth=0;c<this.getChildren().length;c++){var d=this.getChildren()[c],d=d.measure(a,b);d.width>this.uniformWidth&&(this.uniformWidth=d.width);d.height>this.uniformHeight&&(this.uniformHeight=d.height)}void 0!==this.uniformRatio&&(this.uniformRatio<this.uniformWidth/this.uniformHeight?(c=this.uniformWidth,d=c/this.uniformRatio):
(d=this.uniformHeight,c=d*this.uniformRatio),this.uniformWidth=c,this.uniformHeight=d)}for(var e=new Ui.SFlowState({width:a,render:!1,spacing:this.spacing,align:this.itemAlign,uniform:this.uniform,uniformWidth:this.uniformWidth,uniformHeight:this.uniformHeight,stretchMaxRatio:this.stretchMaxRatio}),c=0;c<this.getChildren().length;c++)d=this.getChildren()[c],e.append(d);return e.getSize()},arrangeCore:function(a,b){for(var c=new Ui.SFlowState({width:a,render:!0,spacing:this.spacing,align:this.itemAlign,
uniform:this.uniform,uniformWidth:this.uniformWidth,uniformHeight:this.uniformHeight,stretchMaxRatio:this.stretchMaxRatio}),d=0;d<this.getChildren().length;d++){var e=this.getChildren()[d];c.append(e)}c.getSize()}},{getFloat:function(a){return a["Ui.SFlow.float"]?a["Ui.SFlow.float"]:"none"},setFloat:function(a,b){Ui.SFlow.getFloat(a)!==b&&(a["Ui.SFlow.float"]=b,a.invalidateMeasure())},getFlush:function(a){return a["Ui.SFlow.flush"]?a["Ui.SFlow.flush"]:"none"},setFlush:function(a,b){Ui.SFlow.getFloat(a)!==
b&&(a["Ui.SFlow.flush"]=b,a.invalidateMeasure())}});Ui.Container.extend("Ui.Grid",{cols:void 0,rows:void 0,constructor:function(a){this.cols=[{auto:!0,star:!1,absolute:!1,actualWidth:0,offset:0,width:0}];this.rows=[{auto:!0,star:!1,absolute:!1,actualHeight:0,offset:0,height:0}]},setCols:function(a){this.cols=[];a=a.split(",");for(var b=0;b<a.length;b++){var c=a[b];if("auto"==c)this.cols.push({auto:!0,star:!1,absolute:!1,actualWidth:0,offset:0,width:0});else if("*"==c)this.cols.push({auto:!1,star:!0,absolute:!1,actualWidth:0,offset:0,width:1});else if(c.match(/^[0-9]+\.?[0-9]*\*$/))this.cols.push({auto:!1,
star:!0,absolute:!1,actualWidth:0,offset:0,width:parseInt(c.slice(0,c.length-1))});else if(c.match(/^[0-9]+$/))this.cols.push({auto:!1,star:!1,absolute:!0,actualWidth:0,offset:0,width:parseInt(c)});else if(DEBUG)throw'Ui.Grid column definition "'+c+'" not supported';}this.invalidateMeasure()},setRows:function(a){this.rows=[];a=a.split(",");for(var b=0;b<a.length;b++){var c=a[b];if("auto"==c)this.rows.push({auto:!0,star:!1,absolute:!1,actualHeight:0,offset:0,height:0});else if("*"==c)this.rows.push({auto:!1,
star:!0,absolute:!1,actualHeight:0,offset:0,height:1});else if(c.match(/^[0-9]+\.?[0-9]*\*$/))this.rows.push({auto:!1,star:!0,absolute:!1,actualHeight:0,offset:0,height:parseInt(c.slice(0,c.length-1))});else if(c.match(/^[0-9]+$/))this.rows.push({auto:!1,star:!1,absolute:!0,actualHeight:0,offset:0,height:parseInt(c)});else if(DEBUG)throw'Ui.Grid row definition "'+c+'" not supported';}},setContent:function(a){for(;void 0!==this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!==a&&
"object"===typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.appendChild(a[b]);else this.appendChild(a)},attach:function(a,b,c,d,e){void 0===d&&(d=1);void 0===e&&(e=1);Ui.Grid.setCol(a,b);Ui.Grid.setRow(a,c);Ui.Grid.setColSpan(a,d);Ui.Grid.setRowSpan(a,e);this.appendChild(a)},detach:function(a){this.removeChild(a)},getColMin:function(a){var b,c,d,e=0;for(b=0;b<this.getChildren().length;b++){var f=this.getChildren()[b],g=Ui.Grid.getCol(f),l=Ui.Grid.getColSpan(f);if(1==l&&g==a)f.getMeasureWidth()>
e&&(e=f.getMeasureWidth());else if(g<=a&&g+l>a){var k=!0,h=!1,n=0;for(c=g;c<a;c++)if(d=this.cols[c],n+=d.actualWidth,d.star){h=!0;break}if(!h)for(c=a+1;c<g+l;c++){d=this.cols[c];if(d.star){h=!0;break}if(d.auto){k=!1;break}}!h&&k&&f.getMeasureWidth()-n>e&&(e=f.getMeasureWidth()-n)}}return e},getRowMin:function(a){var b,c,d,e=0;for(b=0;b<this.getChildren().length;b++){var f=this.getChildren()[b],g=Ui.Grid.getRow(f),l=Ui.Grid.getRowSpan(f);if(1==l&&g==a)f.getMeasureHeight()>e&&(e=f.getMeasureHeight());
else if(g<=a&&g+l>a){var k=!0,h=!1,n=0;for(c=g;c<a;c++)if(d=this.rows[c],n+=d.actualHeight,d.star){h=!0;break}if(!h)for(c=a+1;c<g+l;c++){d=this.rows[c];if(d.star){h=!0;break}if(d.auto){k=!1;break}}!h&&k&&f.getMeasureHeight()-n>e&&(e=f.getMeasureHeight()-n)}}return e}},{measureCore:function(a,b){var c,d,e,f,g,l;for(c=0;c<this.getChildren().length;c++){d=this.getChildren()[c];var k=a*Ui.Grid.getColSpan(d)/this.cols.length,h=b*Ui.Grid.getRowSpan(d)/this.rows.length;d.measure(k,h)}var n=d=0;for(c=k=0;c<
this.cols.length;c++)e=this.cols[c],e.offset=k,e.absolute?e.actualWidth+=e.width:e.star?(e.actualWidth=0,d+=e.width):e.auto&&(e.actualWidth=this.getColMin(c)),k+=e.actualWidth;h=0;0<d&&(h=(a-k)/d);for(c=k=0;c<this.cols.length;c++)e=this.cols[c],e.offset=k,e.star&&(e.actualWidth=h*e.width),k+=e.actualWidth;for(c=0;c<this.getChildren().length;c++){d=this.getChildren()[c];e=Ui.Grid.getCol(d);f=Ui.Grid.getColSpan(d);g=0;for(l=e;l<e+f;l++)g+=this.cols[l].actualWidth;d.measure(g,b)}for(c=k=0;c<this.cols.length;c++)e=
this.cols[c],e.offset=k,e.absolute?e.actualWidth=e.width:e.star?e.actualWidth=Math.max(this.getColMin(c),h*e.width):e.auto&&(e.actualWidth=this.getColMin(c)),k+=e.actualWidth;for(c=0;c<this.getChildren().length;c++){d=this.getChildren()[c];e=Ui.Grid.getCol(d);f=Ui.Grid.getColSpan(d);g=0;for(l=e;l<e+f;l++)g+=this.cols[l].actualWidth;d.measure(g,b)}for(c=d=0;c<this.rows.length;c++)e=this.rows[c],e.offset=d,e.absolute?e.actualHeight=e.height:e.star?(e.actualHeight=0,n+=e.height):e.auto&&(e.actualHeight=
this.getRowMin(c)),d+=e.actualHeight;h=0;0<n&&(h=(b-d)/n);for(c=d=0;c<this.rows.length;c++)e=this.rows[c],e.offset=d,e.star&&(e.actualHeight=h*e.height),d+=e.actualHeight;for(c=0;c<this.getChildren().length;c++){d=this.getChildren()[c];e=Ui.Grid.getCol(d);f=Ui.Grid.getColSpan(d);g=0;for(l=e;l<e+f;l++)g+=this.cols[l].actualWidth;e=Ui.Grid.getRow(d);n=Ui.Grid.getRowSpan(d);f=0;for(l=e;l<e+n;l++)f+=this.rows[l].actualHeight;d.measure(g,f)}for(c=d=0;c<this.rows.length;c++)e=this.rows[c],e.offset=d,e.absolute?
e.actualHeight=e.height:e.star?(n=this.getRowMin(c),e.actualHeight=Math.max(n,h*e.height)):e.auto&&(e.actualHeight=this.getRowMin(c)),d+=e.actualHeight;return{width:k,height:d}},arrangeCore:function(a,b){for(var c=0;c<this.getChildren().length;c++){for(var d=this.getChildren()[c],e=Ui.Grid.getCol(d),f=Ui.Grid.getColSpan(d),g=Ui.Grid.getRow(d),l=Ui.Grid.getRowSpan(d),k=this.cols[e].offset,h=this.rows[g].offset,n=0,m=0,p=e;p<e+f;p++)n+=this.cols[p].actualWidth;for(e=g;e<g+l;e++)m+=this.rows[e].actualHeight;
d.arrange(k,h,n,m)}}},{getCol:function(a){return void 0!==a["Ui.Grid.col"]?a["Ui.Grid.col"]:0},setCol:function(a,b){Ui.Grid.getCol(a)!=b&&(a["Ui.Grid.col"]=b,a.invalidateMeasure())},getRow:function(a){return void 0!==a["Ui.Grid.row"]?a["Ui.Grid.row"]:0},setRow:function(a,b){Ui.Grid.getRow(a)!==b&&(a["Ui.Grid.row"]=b,a.invalidateMeasure())},getColSpan:function(a){return void 0!==a["Ui.Grid.colSpan"]?a["Ui.Grid.colSpan"]:1},setColSpan:function(a,b){Ui.Grid.getColSpan(a)!==b&&(a["Ui.Grid.colSpan"]=b,
a.invalidateMeasure())},getRowSpan:function(a){return void 0!==a["Ui.Grid.rowSpan"]?a["Ui.Grid.rowSpan"]:1},setRowSpan:function(a,b){Ui.Grid.getRowSpan(a)!==b&&(a["Ui.Grid.rowSpan"]=b,a.invalidateMeasure())}});Ui.Container.extend("Ui.Fixed",{constructor:function(a){this.addEvents("resize")},setPosition:function(a,b,c){void 0!==b&&(a["Ui.Fixed.x"]=b);void 0!==c&&(a["Ui.Fixed.y"]=c);this.updateItemTransform(a)},setRelativePosition:function(a,b,c,d){void 0!==b&&(a["Ui.Fixed.relativeX"]=b);void 0!==c&&(a["Ui.Fixed.relativeY"]=c);a["Ui.Fixed.relativeAbsolute"]=!0===d;this.updateItemTransform(a)},append:function(a,b,c){a["Ui.Fixed.x"]=b;a["Ui.Fixed.y"]=c;this.appendChild(a)},remove:function(a){delete a["Ui.Fixed.x"];
delete a["Ui.Fixed.y"];delete a["Ui.Fixed.relativeX"];delete a["Ui.Fixed.relativeY"];delete a["Ui.Fixed.relativeAbsolute"];this.removeChild(a)},updateItemTransform:function(a){var b=0;void 0!==a["Ui.Fixed.x"]&&(b=a["Ui.Fixed.x"]);void 0!==a["Ui.Fixed.relativeX"]&&(b-=a["Ui.Fixed.relativeX"]*(!0===a["Ui.Fixed.relativeAbsolute"]?1:a.getMeasureWidth()));var c=0;void 0!==a["Ui.Fixed.y"]&&(c=a["Ui.Fixed.y"]);void 0!==a["Ui.Fixed.relativeY"]&&(c-=a["Ui.Fixed.relativeY"]*(!0===a["Ui.Fixed.relativeAbsolute"]?
1:a.getMeasureHeight()));a.setTransform(Ui.Matrix.createTranslate(b,c))}},{measureCore:function(a,b){for(var c=0;c<this.getChildren().length;c++)this.getChildren()[c].measure(a,b);return{width:0,height:0}},arrangeCore:function(a,b){this.fireEvent("resize",this,a,b);for(var c=0;c<this.getChildren().length;c++){var d=this.getChildren()[c];d.arrange(0,0,d.getMeasureWidth(),d.getMeasureHeight());this.updateItemTransform(d)}},onChildInvalidateMeasure:function(a,b){"remove"!==b&&(a.measure(this.getLayoutWidth(),
this.getLayoutHeight()),a.arrange(0,0,a.getMeasureWidth(),a.getMeasureHeight()),this.updateItemTransform(a))},onChildInvalidateArrange:function(a){a.arrange(0,0,a.getMeasureWidth(),a.getMeasureHeight());this.updateItemTransform(a)}});Ui.Container.extend("Ui.Fold",{headerBox:void 0,header:void 0,contentBox:void 0,content:void 0,background:void 0,offset:0,position:"bottom",isFolded:!0,over:!0,mode:"extend",clock:void 0,contentSize:0,animDuration:2,constructor:function(a){this.addEvents("fold","unfold","positionchange");this.headerBox=new Ui.LBox;this.appendChild(this.headerBox);this.contentBox=new Ui.LBox;this.appendChild(this.contentBox);this.contentBox.hide()},getIsFolded:function(){return this.isFolded},setIsFolded:function(a){this.isFolded!=
a&&((this.isFolded=a)?(this.setOffset(0),this.contentBox.hide(),this.fireEvent("fold",this)):(this.setOffset(1),this.contentBox.show(),this.fireEvent("unfold",this)))},fold:function(){this.isFolded||(this.isFolded=!0,this.startAnimation(),this.fireEvent("fold",this))},unfold:function(){this.isFolded&&(this.isFolded=!1,this.startAnimation(),this.fireEvent("unfold",this))},getOver:function(){return this.over},setOver:function(a){this.over!=a&&(this.over=a,this.stopAnimation(),this.setTransform(Ui.Matrix.createTranslate(0,
0)),this.invalidateMeasure())},getMode:function(){return this.mode},setMode:function(a){this.mode!=a&&(this.mode=a,this.stopAnimation(),this.invalidateMeasure())},getHeader:function(){return this.header},setHeader:function(a){a!==this.header&&(this.header=a,this.headerBox.setContent(this.header))},getContent:function(){return this.content},setContent:function(a){this.content!==a&&(this.content=a,this.contentBox.setContent(this.content))},getBackground:function(){return this.background},setBackground:function(a){this.background!==
a&&(void 0!==this.background&&this.removeChild(this.background),this.background=a,void 0!==this.background&&this.prependChild(this.background))},getPosition:function(){return this.position},setPosition:function(a){this.position!=a&&(this.position=a,this.fireEvent("positionchange",this,a),this.invalidateMeasure())},getOffset:function(){return this.offset},setOffset:function(a){this.offset!==a&&(this.offset=a,this.over?"right"===this.position?("slide"===this.mode?this.setTransform(Ui.Matrix.createTranslate(-this.offset*
this.contentSize,0)):this.setTransform(Ui.Matrix.createTranslate(0,0)),this.contentBox.setClipRectangle(0,0,Math.round(this.contentSize*this.offset),this.getLayoutHeight()),void 0!==this.background&&this.background.arrange(0,0,Math.round(this.headerBox.getMeasureWidth()+this.contentSize*this.offset),Math.round(this.getLayoutHeight()))):"left"===this.position?("slide"===this.mode?this.setTransform(Ui.Matrix.createTranslate(-this.contentSize+this.offset*this.contentSize,0)):this.setTransform(Ui.Matrix.createTranslate(-this.contentSize,
0)),this.contentBox.setClipRectangle(Math.round(this.contentSize*(1-this.offset)),0,this.contentSize,this.getLayoutHeight()),void 0!==this.background&&this.background.arrange(Math.round(this.contentSize*(1-this.offset)),0,Math.round(this.headerBox.getMeasureWidth()+this.contentSize*this.offset),Math.round(this.getLayoutHeight()))):"top"===this.position?("slide"===this.mode?this.setTransform(Ui.Matrix.createTranslate(0,-this.contentSize+this.offset*this.contentSize)):this.setTransform(Ui.Matrix.createTranslate(0,
-this.contentSize)),this.contentBox.setClipRectangle(0,Math.round(this.contentSize*(1-this.offset)),this.getLayoutWidth(),Math.round(this.contentSize*this.offset)),void 0!==this.background&&this.background.arrange(0,Math.round(this.contentSize*(1-this.offset)),this.getLayoutWidth(),Math.round(this.headerBox.getMeasureHeight()+this.contentSize*this.offset))):("slide"===this.mode?this.setTransform(Ui.Matrix.createTranslate(0,-this.offset*this.contentSize)):this.setTransform(Ui.Matrix.createTranslate(0,
0)),this.contentBox.setClipRectangle(0,0,this.getLayoutWidth(),Math.round(this.contentSize*this.offset)),void 0!==this.background&&this.background.arrange(0,0,this.getLayoutWidth(),Math.round(this.headerBox.getMeasureHeight()+this.contentSize*this.offset))):this.invalidateMeasure())},invert:function(){this.isFolded?this.unfold():this.fold()},setAnimDuration:function(a){this.animDuration=a},startAnimation:function(){void 0!==this.clock&&this.clock.stop();this.isFolded||this.contentBox.show();this.clock=
new Anim.Clock({duration:this.animDuration,target:this});this.connect(this.clock,"timeupdate",this.onClockTick);this.clock.begin()},stopAnimation:function(){void 0!==this.clock&&(this.clock.stop(),this.clock=void 0)},onClockTick:function(a,b){if(void 0===this.content)void 0!==this.clock&&(this.clock.stop(),this.clock=void 0);else{var c=this.getOffset();if(1<c)this.setOffset(1);else{var d;d=this.isFolded?0:1;this.setOffset(d-(d-c)*(1-b))}1==b&&this.isFolded&&this.contentBox.hide()}}},{measureCore:function(a,
b){void 0!==this.background&&this.background.measure(a,b);var c=this.headerBox.measure(a,b),d={width:0,height:0};"left"==this.position||"right"==this.position?(d=this.contentBox.measure(a-c.width,b),d.height>c.height&&(c.height=d.height),this.over||(c.width+=d.width*this.offset),this.contentSize=d.width):(d=this.contentBox.measure(a,b-c.height),d.width>c.width&&(c.width=d.width),this.over||(c.height+=d.height*this.offset),this.contentSize=d.height);return c},arrangeCore:function(a,b){"left"==this.position?
(this.over||this.setTransform(Ui.Matrix.createTranslate(-this.contentSize+this.offset*this.contentSize,0)),this.contentBox.arrange(0,0,this.contentBox.getMeasureWidth(),b),this.headerBox.arrange(this.contentBox.getMeasureWidth(),0,this.headerBox.getMeasureWidth(),b),void 0!==this.background&&this.background.arrange(Math.round(this.contentSize*(1-this.offset)),0,Math.round(this.headerBox.getMeasureWidth()+this.contentSize*this.offset),Math.round(b)),this.contentBox.setClipRectangle(Math.round(this.contentSize*
(1-this.offset)),0,Math.round(this.contentSize*this.offset),Math.round(b))):"right"==this.position?(this.headerBox.arrange(0,0,this.headerBox.getMeasureWidth(),b),this.contentBox.arrange(this.headerBox.getMeasureWidth(),0,this.contentBox.getMeasureWidth(),b),void 0!==this.background&&this.background.arrange(0,0,Math.round(this.headerBox.getMeasureWidth()+this.contentSize*this.offset),Math.round(b)),this.contentBox.setClipRectangle(0,0,Math.round(this.contentSize*this.offset),Math.round(b))):"top"==
this.position?(this.over||this.setTransform(Ui.Matrix.createTranslate(0,-this.contentSize+this.offset*this.contentSize)),this.contentBox.arrange(0,0,a,this.contentBox.getMeasureHeight()),this.headerBox.arrange(0,this.contentBox.getMeasureHeight(),a,this.headerBox.getMeasureHeight()),void 0!==this.background&&this.background.arrange(0,Math.round(this.contentSize*(1-this.offset)),a,Math.round(this.headerBox.getMeasureHeight()+this.contentSize*this.offset)),this.contentBox.setClipRectangle(0,Math.round(this.contentSize*
(1-this.offset)),Math.round(a),Math.round(this.contentSize*this.offset))):(this.headerBox.arrange(0,0,a,this.headerBox.getMeasureHeight()),this.contentBox.arrange(0,this.headerBox.getMeasureHeight(),a,this.contentBox.getMeasureHeight()),void 0!==this.background&&this.background.arrange(0,0,a,Math.round(this.headerBox.getMeasureHeight()+this.contentSize*this.offset)),this.contentBox.setClipRectangle(0,0,Math.round(a),Math.round(this.contentSize*this.offset)));this.setOffset(this.offset)}});Ui.Container.extend("Ui.Accordeonable",{current:-1,currentPage:void 0,clock:void 0,headersSize:0,contentSize:0,orientation:"horizontal",constructor:function(a){this.addEvents("change");this.setClipToBounds(!0)},getOrientation:function(){return this.orientation},setOrientation:function(a){if(this.orientation!=a){this.orientation=a;for(var b=0;b<this.getChildren().length;b++)this.getChildren()[b].setOrientation(a);this.invalidateMeasure()}},getPages:function(){return this.getChildren()},getCurrentPage:function(){return this.currentPage},
setCurrentPage:function(a){for(var b=0;b<this.getChildren().length;b++)if(this.getChildren()[b]==a){this.setCurrentPosition(b);break}},getCurrentPosition:function(){return this.current},setCurrentPosition:function(a){0===this.getChildren().length?(void 0!==this.currentPage&&this.currentPage.unselect(),this.currentPage=void 0,this.current=-1):(this.current=a,a=this.getChildren()[this.current],a!==this.currentPage&&(void 0!==this.currentPage&&this.currentPage.unselect(),this.currentPage=a,this.fireEvent("change",
this,this.currentPage,this.current),this.disconnect(this.currentPage,"select",this.onPageSelect),this.currentPage.select(),this.connect(this.currentPage,"select",this.onPageSelect)),void 0!==this.clock&&this.clock.stop(),this.clock=new Anim.Clock({duration:2,target:this}),this.connect(this.clock,"timeupdate",this.onClockTick),this.clock.begin())},appendPage:function(a){a=Ui.AccordeonPage.create(a);this.appendChild(a);a.setOffset(1);a.setOrientation(this.orientation);this.connect(a,"select",this.onPageSelect);
this.connect(a,"close",this.onPageClose);a.select()},removePage:function(a){for(var b=-1,c=0;c<this.getChildren().length;c++)if(this.getChildren()[c]==a){b=c;break}-1!==b&&(this.disconnect(a,"select",this.onPageSelect),this.disconnect(a,"close",this.onPageClose),this.removeChild(a),this.current===b&&0===this.current?this.setCurrentPosition(0):this.current>=b?this.setCurrentPosition(this.current-1):this.setCurrentPosition(this.current))},onClockTick:function(a,b){for(var c=0;c<this.getChildren().length;c++){var d=
this.getChildren()[c];c==this.current&&d.showContent();var e=d.getOffset();if(1<e)d.setOffset(1);else{var f;f=c<=this.current?0:1;d.setOffset(f-(f-e)*(1-b))}1==b&&c!=this.current&&d.hideContent()}},onPageSelect:function(a){this.setCurrentPage(a)},onPageClose:function(a){this.removePage(a)},measureHorizontal:function(a,b){var c,d,e=0,f=0,g=0;for(c=0;c<this.getChildren().length;c++)d=this.getChildren()[c],d.measure(a,b),e+=d.getHeader().getMeasureWidth(),d.getHeader().getMeasureHeight()>g&&(g=d.getHeader().getMeasureHeight());
for(c=0;c<this.getChildren().length;c++)d=this.getChildren()[c],d.measure(a-e+d.getHeader().getMeasureWidth(),b),d=d.getContent(),void 0!==d&&d.getMeasureWidth()>f&&(f=d.getMeasureWidth(),d.getMeasureHeight()>g&&(g=d.getMeasureHeight()));this.headersSize=e;return{width:e+f,height:g}},measureVertical:function(a,b){var c,d,e=0,f=0,g=0;for(c=0;c<this.getChildren().length;c++)d=this.getChildren()[c],d.measure(a,b),e+=d.getHeader().getMeasureHeight(),d.getHeader().getMeasureWidth()>g&&(g=d.getHeader().getMeasureWidth());
for(c=0;c<this.getChildren().length;c++)d=this.getChildren()[c],d.measure(a,b-e+d.getHeader().getMeasureHeight()),d=d.getContent(),void 0!==d&&d.getMeasureHeight()>f&&(f=d.getMeasureHeight(),d.getMeasureWidth()>g&&(g=d.getMeasureWidth()));this.headersSize=e;return{width:g,height:e+f}}},{measureCore:function(a,b){return"horizontal"==this.orientation?this.measureHorizontal(a,b):this.measureVertical(a,b)},arrangeCore:function(a,b){var c,d,e;if("horizontal"==this.orientation){e=0;this.contentSize=a-this.headersSize;
for(c=0;c<this.getChildren().length;c++)d=this.getChildren()[c],d.arrange(e,0,this.contentSize+d.getHeader().getMeasureWidth(),b),e+=d.getHeader().getMeasureWidth()}else{e=0;this.contentSize=b-this.headersSize;for(c=0;c<this.getChildren().length;c++)d=this.getChildren()[c],d.arrange(0,e,a,this.contentSize+d.getHeader().getMeasureHeight()),e+=d.getHeader().getMeasureHeight()}}});
Ui.Container.extend("Ui.AccordeonPage",{headerBox:void 0,header:void 0,content:void 0,offset:0,orientation:"horizontal",isSelected:!1,constructor:function(a){this.addEvents("select","unselect","close","orientationchange");this.headerBox=new Ui.Pressable;this.appendChild(this.headerBox);this.connect(this.headerBox,"press",this.onHeaderPress)},close:function(){this.fireEvent("close",this)},select:function(){this.isSelected||(this.isSelected=!0,this.fireEvent("select",this))},getIsSelected:function(){return this.isSelected},
getHeader:function(){return this.header},setHeader:function(a){a!==this.header&&(void 0!==this.header&&this.headerBox.removeChild(this.header),this.header=a,void 0!==this.header&&this.headerBox.appendChild(this.header))},getContent:function(){return this.content},setContent:function(a){this.content!==a&&(void 0!==this.content&&this.removeChild(this.content),this.content=a,void 0!==this.content&&this.appendChild(this.content,!0))},getOrientation:function(){return this.orientation},setOrientation:function(a){this.orientation!=
a&&(this.orientation=a,this.fireEvent("orientationchange",this,a),this.invalidateMeasure())},unselect:function(){this.isSelected&&(this.isSelected=!1,this.fireEvent("unselect",this))},showContent:function(){void 0!==this.content&&this.content.show()},hideContent:function(){void 0!==this.content&&this.content.hide()},getOffset:function(){return this.offset},setOffset:function(a){this.offset=a;"horizontal"==this.orientation?this.setTransform(Ui.Matrix.createTranslate(this.offset*(this.getLayoutWidth()-
this.headerBox.getMeasureWidth()),0)):this.setTransform(Ui.Matrix.createTranslate(0,this.offset*(this.getLayoutHeight()-this.headerBox.getMeasureHeight())))},onHeaderPress:function(){this.select()}},{measureCore:function(a,b){var c=this.headerBox.measure(a,b),d={width:0,height:0};void 0!==this.content&&("horizontal"==this.orientation?(d=this.content.measure(a-c.width,b),d.height>c.height&&(c.height=d.height),c.width+=d.width):(d=this.content.measure(a,b-c.height),d.width>c.width&&(c.width=d.width),
c.height+=d.height));return c},arrangeCore:function(a,b){"horizontal"==this.orientation?(this.headerBox.arrange(0,0,this.headerBox.getMeasureWidth(),b),void 0!==this.content&&this.content.arrange(this.headerBox.getMeasureWidth(),0,a-this.headerBox.getMeasureWidth(),b)):(this.headerBox.arrange(0,0,a,this.headerBox.getMeasureHeight()),void 0!==this.content&&this.content.arrange(0,this.headerBox.getMeasureHeight(),a,b-this.headerBox.getMeasureHeight()));this.setOffset(this.offset)}});Ui.Container.extend("Ui.ScaleBox",{fixedWidth:400,fixedHeight:300,constructor:function(a){},setFixedSize:function(a,b){var c=!1;void 0!==a&&this.fixedWidth!==a&&(this.fixedWidth=a,c=!0);void 0!==b&&this.fixedHeight!==b&&(this.fixedHeight=b,c=!0);c&&this.invalidateMeasure()},setFixedWidth:function(a){this.setFixedSize(a)},setFixedHeight:function(a){this.setFixedSize(void 0,a)},append:function(a){a.setTransformOrigin(0,0);this.appendChild(a)},remove:function(a){this.removeChild(a);a.setTransformOrigin(0.5,
0.5)},setContent:function(a){this.clear();this.append(a)}},{measureCore:function(a,b){var c=this.fixedWidth/this.fixedHeight,d,e;c>a/b?(d=a,e=d/c):(e=b,d=e*c);for(c=0;c<this.getChildren().length;c++)this.getChildren()[c].measure(this.fixedWidth,this.fixedHeight);return{width:d,height:e}},arrangeCore:function(a,b){var c=this.fixedWidth/this.fixedHeight,d,e;c>a/b?(d=a,e=0,c=(b-d/c)/2):(d=b*c,c=0,e=(a-d)/2);d/=this.fixedWidth;for(var f=0;f<this.getChildren().length;f++){var g=this.getChildren()[f];g.arrange(e,
c,this.fixedWidth,this.fixedHeight);g.setTransform(Ui.Matrix.createScale(d,d))}}});Ui.Element.extend("Ui.Spacer",{constructor:function(a){}});Ui.CanvasElement.extend("Ui.Rectangle",{fill:void 0,radiusTopLeft:0,radiusTopRight:0,radiusBottomLeft:0,radiusBottomRight:0,constructor:function(a){this.fill=new Ui.Color({r:0,g:0,b:0})},getFill:function(){return this.fill},setFill:function(a){this.fill!==a&&("string"===typeof a&&(a=Ui.Color.create(a)),this.fill=a,this.invalidateDraw())},setRadius:function(a){this.setRadiusTopLeft(a);this.setRadiusTopRight(a);this.setRadiusBottomLeft(a);this.setRadiusBottomRight(a)},getRadiusTopLeft:function(){return this.radiusTopLeft},
setRadiusTopLeft:function(a){this.radiusTopLeft!=a&&(this.radiusTopLeft=a,this.invalidateDraw())},getRadiusTopRight:function(){return this.radiusTopRight},setRadiusTopRight:function(a){this.radiusTopRight!=a&&(this.radiusTopRight=a,this.invalidateDraw())},getRadiusBottomLeft:function(){return this.radiusBottomLeft},setRadiusBottomLeft:function(a){this.radiusBottomLeft!=a&&(this.radiusBottomLeft=a,this.invalidateDraw())},getRadiusBottomRight:function(){return this.radiusBottomRight},setRadiusBottomRight:function(a){this.radiusBottomRight!=
a&&(this.radiusBottomRight=a,this.invalidateDraw())}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=this.radiusTopLeft,e=this.radiusTopRight;d+e>b&&(d=b/2,e=b/2);var f=this.radiusBottomLeft,g=this.radiusBottomRight;f+g>b&&(f=b/2,g=b/2);d+f>c&&(d=c/2,f=c/2);e+g>c&&(e=c/2,g=c/2);a.beginPath();a.roundRect(0,0,b,c,d,e,g,f);a.closePath();Ui.Color.hasInstance(this.fill)?a.fillStyle=this.fill.getCssRgba():Ui.LinearGradient.hasInstance(this.fill)&&(a.fillStyle=this.fill.getCanvasGradient(a,
b,c));a.fill()}});Ui.CanvasElement.extend("Ui.Frame",{fill:void 0,radiusTopLeft:0,radiusTopRight:0,radiusBottomLeft:0,radiusBottomRight:0,frameWidth:10,constructor:function(a){this.fill=new Ui.Color({r:0,g:0,b:0})},getFrameWidth:function(){return this.frameWidth},setFrameWidth:function(a){a!=this.frameWidth&&(this.frameWidth=a,this.invalidateDraw())},getFill:function(){return this.fill},setFill:function(a){this.fill!=a&&("string"===typeof a&&(a=Ui.Color.create(a)),this.fill=a,this.invalidateDraw())},setRadius:function(a){this.setRadiusTopLeft(a);
this.setRadiusTopRight(a);this.setRadiusBottomLeft(a);this.setRadiusBottomRight(a)},getRadiusTopLeft:function(){return this.radiusTopLeft},setRadiusTopLeft:function(a){this.radiusTopLeft!=a&&(this.radiusTopLeft=a,this.invalidateDraw())},getRadiusTopRight:function(){return this.radiusTopRight},setRadiusTopRight:function(a){this.radiusTopRight!=a&&(this.radiusTopRight=a,this.invalidateDraw())},getRadiusBottomLeft:function(){return this.radiusBottomLeft},setRadiusBottomLeft:function(a){this.radiusBottomLeft!=
a&&(this.radiusBottomLeft=a,this.invalidateDraw())},getRadiusBottomRight:function(){return this.radiusBottomRight},setRadiusBottomRight:function(a){this.radiusBottomRight!=a&&(this.radiusBottomRight=a,this.invalidateDraw())}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=this.radiusTopLeft,e=this.radiusTopRight;d+e>b&&(d=b/2,e=b/2);var f=this.radiusBottomLeft,g=this.radiusBottomRight;f+g>b&&(f=b/2,g=b/2);d+f>c&&(d=c/2,f=c/2);e+g>c&&(e=c/2,g=c/2);a.beginPath();a.roundRect(0,
0,b,c,d,e,g,f);a.roundRect(this.frameWidth,this.frameWidth,b-2*this.frameWidth,c-2*this.frameWidth,Math.max(0,d-this.frameWidth),Math.max(0,e-this.frameWidth),Math.max(0,g-this.frameWidth),Math.max(0,f-this.frameWidth),!0);a.closePath();Ui.Color.hasInstance(this.fill)?a.fillStyle=this.fill.getCssRgba():Ui.LinearGradient.hasInstance(this.fill)&&(a.fillStyle=this.fill.getCanvasGradient(a,b,c));a.fill()}});Ui.CanvasElement.extend("Ui.Shadow",{radiusTopLeft:0,radiusTopRight:0,radiusBottomLeft:0,radiusBottomRight:0,shadowWidth:0,inner:!1,color:void 0,constructor:function(a){this.color=Ui.Color.create("black");this.setShadowWidth(4)},getColor:function(){return this.color},setColor:function(a){this.color!=a&&(this.color=Ui.Color.create(a),this.invalidateDraw())},getInner:function(){return this.inner},setInner:function(a){this.inner!=a&&(this.inner=a,this.invalidateDraw())},setShadowWidth:function(a){this.shadowWidth!=
a&&(this.shadowWidth=a,this.invalidateDraw())},getShadowWidth:function(){return this.shadowWidth},setRadius:function(a){this.radiusBottomRight=this.radiusBottomLeft=this.radiusTopRight=this.radiusTopLeft=a;this.invalidateDraw()},getRadiusTopLeft:function(){return this.radiusTopLeft},setRadiusTopLeft:function(a){this.radiusTopLeft!=a&&(this.radiusTopLeft=a,this.invalidateDraw())},getRadiusTopRight:function(){return this.radiusTopRight},setRadiusTopRight:function(a){this.radiusTopRight!=a&&(this.radiusTopRight=
a,this.invalidateDraw())},getRadiusBottomLeft:function(){return this.radiusBottomLeft},setRadiusBottomLeft:function(a){this.radiusBottomLeft!=a&&(this.radiusBottomLeft=a,this.invalidateDraw())},getRadiusBottomRight:function(){return this.radiusBottomRight},setRadiusBottomRight:function(a){this.radiusBottomRight!=a&&(this.radiusBottomRight=a,this.invalidateDraw())}},{updateCanvas:function(a){for(var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=0;d<this.shadowWidth;d++){var e=this.color.getRgba(),
f;this.inner?1==this.shadowWidth?f=1:(f=(d+1)/this.shadowWidth,f*=f):f=(d+1)/(this.shadowWidth+1);e=new Ui.Color({r:e.r,g:e.g,b:e.b,a:e.a*f});a.fillStyle=e.getCssRgba();this.inner?(a.beginPath(),a.roundRect(0,0,b,c,this.radiusTopLeft,this.radiusTopRight,this.radiusBottomRight,this.radiusBottomLeft),a.roundRect(this.shadowWidth-d,this.shadowWidth-d,b-2*(this.shadowWidth-d),c-2*(this.shadowWidth-d),this.radiusTopLeft,this.radiusTopRight,this.radiusBottomRight,this.radiusBottomLeft,!0)):(a.beginPath(),
a.roundRect(d,d,b-2*d,c-2*d,this.radiusTopLeft,this.radiusTopRight,this.radiusBottomRight,this.radiusBottomLeft));a.closePath();a.fill()}}});Ui.Shape.extend("Ui.Icon",{constructor:function(a){},setIcon:function(a){this.setPath(Ui.Icon.icons[a])}},{arrangeCore:function(a,b){Ui.Icon.base.arrangeCore.call(this,a,b);var c=Math.min(a,b)/48;this.setScale(c)}},{icons:{},constructor:function(){this.register("check","M18 32.3L9.7 24l-2.8 2.8L18 38 42 14l-2.8-2.8z");this.register("home","m24 6-20 18 6 0 0 16 10 0 0-12 8 0 0 12 10 0 0-16 6 0z");this.register("search","M16.6 2.8C9.3 2.8 3.3 8.7 3.3 16 3.3 23.3 9.3 29.3 16.6 29.3 19.2 29.3 21.7 28.5 23.8 27.1L26.5 29.8C26 31.2 26.4 32.9 27.5 34L37 43.5C38.5 45.1 41.1 45.1 42.6 43.5L44.3 41.8C45.9 40.3 45.9 37.8 44.3 36.2L34.8 26.7C33.7 25.6 32.3 25.3 30.9 25.7L28 22.7C29.2 20.8 29.8 18.5 29.8 16 29.8 8.7 23.9 2.8 16.6 2.8zM16.6 6.8C21.7 6.8 25.8 10.9 25.8 16 25.8 21.2 21.7 25.3 16.6 25.3 11.4 25.3 7.3 21.2 7.3 16 7.3 10.9 11.4 6.8 16.6 6.8z");
this.register("close","M38 12.82L35.18 10 24 21.18 12.82 10 10 12.82 21.18 24 10 35.18 12.82 38 24 26.82 35.18 38 38 35.18 26.82 24z");this.register("backarrow","M40 22H15.86l11.18-11.18L24 8l-16 16 16 16 2.82-2.82L15.66 26H40v-4z");this.register("arrowleft","m30 4 5 5-15 15 15 15-5 5-20-20z");this.register("arrowright","m18 4-5 5 15 15-15 15 5 5 20-20z");this.register("arrowtop","m44 31-5 5-15-15-15 15-5-5 20-20z");this.register("arrowbottom","m4 16 5-5 15 15 15-15 5 5-20 20z");this.register("refresh",
"M24 8C15.2 8 8 15.2 8 24 8 32.8 15.2 40 24 40 31.5 40 37.7 34.9 39.5 28l-4.2 0C33.7 32.7 29.2 36 24 36 17.4 36 12 30.6 12 24c0-6.6 5.4-12 12-12 3.3 0 6.3 1.4 8.4 3.6L26 22 40 22 40 8 35.3 12.7C32.4 9.8 28.4 8 24 8Z");this.register("deny","M24.4 4.6C13.8 4.6 5.3 13.1 5.3 23.6 5.3 34.2 13.8 42.7 24.4 42.7 34.9 42.7 43.4 34.2 43.4 23.6 43.4 13.1 34.9 4.6 24.4 4.6zM12.9 20.5L36.4 20.5 36.4 27.8 12.9 27.8 12.9 20.5z");this.register("warning","M2 42h44L24 4 2 42zm24-6h-4v-4h4v4zm0-8h-4v-8h4v8z");this.register("trash",
"m12 38 c0 2 1.8 4 4 4l16 0c2.2 0 4-1.8 4-4L36 14 11.6 14ZM38 8 31 8 29 6 19 6 17 8 10 8 10 12 38 12Z");this.register("new","M38 6H10c-2.22 0-4 1.8-4 4v28c0 2.2 2.78 4 4 4h28c2.2 0 4-1.8 4-4V10c0-2.2-1.8-4-4-4zm-4 20h-8v8h-4v-8H14v-4h8V14h4v8h8v4z");this.register("star","M24 34.54L36.36 42l-3.28-14.06L44 18.48l-14.38-1.22L24 4 18.38 17.26 4 18.48l10.92 9.46L11.64 42z");this.register("exit","M20.18 31.18L23 34l10-10-10-10-2.82 2.82L25.34 22H6v4h19.34l-5.16 5.18zM38 6H10c-2.22 0-4 1.8-4 4v4h4V10h28v28H10v-8H6v8c0 2.2 1.78 4 4 4h28c2.2 0 4-1.8 4-4V10c0-2.2-1.8-4-4-4z");
this.register("loading","M24 2.5C22.1 2.5 20.5 4.1 20.5 6 20.5 7.9 22.1 9.5 24 9.5 25.9 9.5 27.5 7.9 27.5 6 27.5 4.1 25.9 2.5 24 2.5zM11.3 7.8C10.4 7.8 9.5 8.1 8.8 8.8 7.5 10.2 7.5 12.4 8.8 13.8 10.2 15.1 12.4 15.1 13.8 13.8 15.1 12.4 15.1 10.2 13.8 8.8 13.1 8.1 12.2 7.8 11.3 7.8zM36.7 7.8C35.8 7.8 34.9 8.1 34.3 8.8 32.9 10.2 32.9 12.4 34.3 13.8 35.6 15.1 37.8 15.1 39.2 13.8 40.5 12.4 40.5 10.2 39.2 8.8 38.5 8.1 37.6 7.8 36.7 7.8zM6 20.5C4.1 20.5 2.5 22.1 2.5 24 2.5 25.9 4.1 27.5 6 27.5 7.9 27.5 9.5 25.9 9.5 24 9.5 22.1 7.9 20.5 6 20.5zM42 20.5C40.1 20.5 38.5 22.1 38.5 24 38.5 25.9 40.1 27.5 42 27.5 43.9 27.5 45.5 25.9 45.5 24 45.5 22.1 43.9 20.5 42 20.5zM11.3 33.3C10.4 33.3 9.5 33.6 8.8 34.3 7.5 35.6 7.5 37.8 8.8 39.2 10.2 40.5 12.4 40.5 13.8 39.2 15.1 37.8 15.1 35.6 13.8 34.3 13.1 33.6 12.2 33.3 11.3 33.3zM36.7 33.3C35.8 33.3 34.9 33.6 34.3 34.3 32.9 35.6 32.9 37.8 34.3 39.2 35.6 40.5 37.8 40.5 39.2 39.2 40.5 37.8 40.5 35.6 39.2 34.3 38.5 33.6 37.6 33.3 36.7 33.3zM24 38.5C22.1 38.5 20.5 40.1 20.5 42 20.5 43.9 22.1 45.5 24 45.5 25.9 45.5 27.5 43.9 27.5 42 27.5 40.1 25.9 38.5 24 38.5z");
this.register("edit","M6 34.5V42h7.5L35.62 19.88l-7.5-7.5L6 35.5zM41.42 14.08c.78-.78.78-2.04 0-2.82l-4.68-4.68c-.78-.78-2.04-.78-2.82 0l-3.66 3.66 7.5 7.5 3.66-3.66z");this.register("upload","M18 32h12v-12h8l-14-14-14 14h8zm-8 18h28v4H10z");this.register("lock","M24 2C18.5 2 14 6.5 14 12l0 4-2 0c-2.2 0-4 1.8-4 4l0 20c0 2.2 1.8 4 4 4l24 0c2.2 0 4-1.8 4-4 0-10.5 0-11.2 0-20 0-2.2-1.8-4-4-4l-2 0 0-4C34 6.5 29.5 2 24 2Zm0 3.8C27.4 5.8 30.2 8.6 30.2 12l0 4-12.4 0 0-4C17.8 8.6 20.6 5.8 24 5.8ZM24 26c2.2 0 4 1.8 4 4 0 2.2-1.8 4-4 4-2.2 0-4-1.8-4-4 0-2.2 1.8-4 4-4z");
this.register("savecloud","M38.7 20.08C37.34 13.18 31.28 8 24 8 18.22 8 13.2 11.28 10.7 16.08 2.68 16.72 0 21.82 0 28c0 6.62 5.28 12 12 12h26c5.52 0 10-4.48 10-10 0-5.28-4.1-9.56-9.3-9.92zM28 26v8h-8v-8H14l10-10 10 10h-6z");this.register("calendar","M34 24h-10v10h10v-10zM32 2v4H16V2H12v4H10c-2.22 0-3.98 1.8-3.98 4L6 38c0 2.2 1.78 4 4 4h28c2.2 0 2-1.8 4-4V10c0-2.2-1.8-4-4-4h-2V2h-4zm6 36H10V16h28v22z");this.register("phone","M13.2 21.6c2.9 5.7 7.5 10.3 13.2 13.2l4.4-4.4c.5-.5 1.3-.7 2-.5 2.2 .7 4.7 1.1 7.1 1.1 1.1 0 2 .9 2 2V40c0 1.1-.9 2-2 2-18.8 0-34-15.2-34-34 0-1.1 .9-2 2-2h7c1.1 0 2 .9 2 2 0 2.5 .4 4.9 1.1 7.1 .2 .7 .1 1.5-.5 2l-4.4 4.4z");
this.register("mail","M40 8H8c-2.2 0-4 1.8-4 4L4 36c0 2.2 1.8 4 4 4h32c2.2 0 4-1.8 4-4V12c0-2.2-1.8-4-4-4zm0 8l-16 10-16-10V12l16 10 16-10v4z");this.register("plus","M38 26h-12v12h-4v-12H10v-4h12V10h4v12h12v4z");this.register("eye","M24.2 10.4C11.7 10.4 2 23.6 1.6 24.2L.9 25.1 1.6 26.1C2 26.7 11.7 39.9 24.2 39.9 36.6 39.9 46.3 26.7 46.7 26.1L47.4 25.1 46.7 24.2C46.3 23.6 36.6 10.4 24.2 10.4zM24.2 13.7C33.1 13.7 40.9 22.2 43.3 25.1 41 28 33.1 36.6 24.2 36.6 15.2 36.6 7.4 28 5 25.1 7.4 22.2 15.2 13.7 24.2 13.7zM24.8 15.2C19.4 15.2 15 19.6 15 24.9 15 30.3 19.4 34.7 24.8 34.7 30.2 34.7 34.6 30.3 34.6 24.9 34.6 23.1 34.1 21.5 33.3 20 33.1 22.1 31.4 23.8 29.3 23.8 27 23.8 25.3 22 25.3 19.8 25.3 17.9 26.7 16.3 28.5 15.9 27.4 15.5 26.1 15.2 24.8 15.2z");
this.register("map","M41 6l-.3 .1L30 10.2 18 6 6.7 9.8c-.4 .1-.7 .5-.7 1V41c0 .6 .4 1 1 1l.3-.1L18 37.8l12 4.2 11.3-3.8c.4-.1 .7-.5 .7-1V7c0-.6-.4-1-1-1zM30 38l-12-4.2V10l12 4.2V38z");this.register("sortarrow","m4 32 40 0-20-20z");this.register("dragcopy","M24 .2C10.8 .2 .2 10.8 .2 24 .2 37.2 10.8 47.8 24 47.8 37.2 47.8 47.8 37.2 47.8 24 47.8 10.8 37.2 .2 24 .2zm-4.5 5.9 8.9 0 0 13.5 13.5 0 0 8.9-13.5 0 0 13.5-8.9 0 0-13.6-13.5 .1 0-8.9 13.5 0z");this.register("dragmove","M24 .2C10.8 .2 .2 10.8 .2 24 .2 37.2 10.8 47.8 24 47.8 37.2 47.8 47.8 37.2 47.8 24 47.8 10.8 37.2 .2 24 .2zM26.6 8.6L42 24 26.6 39.4 21.4 34.3 26.6 29.2 6 29.2 6 18.8 26.6 18.8 21.4 13.8 26.6 8.6z");
this.register("draglink","M24 .2C10.8 .2 .2 10.8 .2 24 .2 37.2 10.8 47.8 24 47.8 37.2 47.8 47.8 37.2 47.8 24 47.8 10.8 37.2 .2 24 .2zM34.9 13.9C40.7 13.9 44.3 18.3 44.3 23.9 44.3 29.6 40.8 34.1 34.8 34.1 30.2 34.1 26.9 31.1 24 27.8 21 31.1 18.1 34.1 13.3 34.1 7.4 34.1 3.7 29.7 3.7 24 3.7 18.4 7.2 13.9 13.1 13.9 17.9 13.9 21.1 17.2 24 20.6 26.9 17.2 30.1 13.9 34.9 13.9zM34.8 19.3C31.9 19.3 29.1 22.1 27.2 24.1 29.2 26.3 31.8 28.7 34.9 28.7 37.7 28.7 39.3 26.7 39.3 24.1 39.3 21.4 37.6 19.3 34.8 19.3zM13.1 19.3C10.4 19.3 8.8 21.6 8.8 24.1 8.8 26.8 10.5 28.7 13.2 28.7 16.1 28.7 19 26.1 20.8 24.1 18.9 22.2 15.9 19.3 13.1 19.3z");
this.register("dragchoose","M24 .2C10.8 .2 .2 10.8 .2 24 .2 37.2 10.8 47.8 24 47.8 37.2 47.8 47.8 37.2 47.8 24 47.8 10.8 37.2 .2 24 .2zM23.6 3.3L25.9 3.3C33.1 3.3 37.8 8 37.8 14.7 37.8 22.1 33.3 24 29.7 25.6 27.7 26.6 26 27.4 26 29.8 26 31.4 26.4 32.3 26.4 32.8 26.4 33.2 26.2 33.3 25.8 33.3L19.7 33.3C19.3 33.3 19.1 33.1 19 32.8 18.8 31.6 18.6 30.2 18.6 28.9 18.6 23 22.8 21.3 26.3 19.5 28.5 18.4 30.4 17.3 30.4 14.7 30.4 12.1 28.4 10.1 25.9 10.1L23.6 10.1C21.8 10.1 20.2 11.1 19 13.8 18.9 14.2 18.7 14.3 18.5 14.3 18.2 14.3 18 14.1 17.8 14L12.6 11.3C12.4 11.2 12.2 11.1 12.2 10.9 12.2 10.5 12.9 9.5 13.4 8.5 15.4 5.5 18.3 3.3 23.6 3.3zM23.4 36.4C25.7 36.4 27.7 38.4 27.7 40.7 27.7 43 25.7 44.9 23.4 44.9 21.1 44.9 19.1 43 19.1 40.7 19.1 38.4 21.1 36.4 23.4 36.4z");
this.register("dragrun","M24 2.4C12.1 2.4 2.4 12.1 2.4 24 2.4 36 12.1 45.6 24 45.6 36 45.6 45.6 36 45.6 24 45.6 12.1 36 2.4 24 2.4zM23.9 7.8C24 7.8 24 7.8 24 7.8 27 7.8 29.8 8.6 32.2 10L30.4 13.1C32.3 14.2 33.8 15.7 34.9 17.6L38 15.8C39.4 18.2 40.3 21 40.3 24 40.3 24 40.3 24 40.3 24.1L36.7 24C36.7 26.3 36.1 28.4 35 30.3L38.1 32.1C36.7 34.6 34.6 36.7 32.1 38.1L30.3 35C28.4 36.1 26.3 36.7 24 36.7L24.1 40.3C24 40.3 24 40.3 24 40.3 21 40.3 18.2 39.4 15.8 38L17.6 34.9C15.7 33.8 14.2 32.3 13.1 30.4L10 32.2C8.6 29.8 7.8 27 7.8 24 7.8 24 7.8 24 7.8 23.9L11.3 24C11.3 21.7 12 19.6 13 17.7L9.9 15.9C11.3 13.4 13.4 11.3 15.9 9.9L17.7 13C19.6 12 21.7 11.3 24 11.3L23.9 7.8zM24 18.8C21.1 18.8 18.8 21.1 18.8 24 18.8 26.9 21.1 29.2 24 29.2 26.9 29.2 29.2 26.9 29.2 24 29.2 21.1 26.9 18.8 24 18.8z");
this.register("dragplay","M24 .2C10.8 .2 .2 10.8 .2 24 .2 37.2 10.8 47.8 24 47.8 37.2 47.8 47.8 37.2 47.8 24 47.8 10.8 37.2 .2 24 .2zM13.8 7.8L42.2 24 13.8 40.3 13.8 7.8z")},getPath:function(a){return Ui.Icon.icons[a]},getNames:function(){var a=[],b;for(b in Ui.Icon.icons)a.push(b);return a},register:function(a,b){if(void 0!==Ui.Icon.icons[a])throw"Icon '"+a+"' is already registered. To change it, use override";Ui.Icon.icons[a]=b},override:function(a,b){Ui.Icon.icons[a]=b},parse:function(a){return new Ui.Icon({icon:a})},
drawIcon:function(a,b,c,d){a.save();c/=48;a.scale(c,c);a.svgPath(Ui.Icon.getPath(b));a.fillStyle=d;a.fill();a.restore()},drawIconAndBadge:function(a,b,c,d,e,f,g,l){a.save();c/=48;f/=c;a.font="bold "+0.75*f+"px sans-serif";var k=a.measureText(e).width,h=Math.max(f,1.25*k);a.scale(c,c);a.save();a.beginPath();a.rect(0,0,48,48);a.roundRect(1,43-f,h+4,f+4,f/2,f/2,f/2,f/2,!0);a.closePath();a.clip();a.svgPath(Ui.Icon.getPath(b));a.fillStyle=d;a.fill();a.restore();a.fillStyle=g;a.beginPath();a.roundRect(3,
45-f,h,f,f/2,f/2,f/2,f/2);a.closePath();a.fill();a.textBaseline="middle";a.fillStyle=l;a.fillText(e,3+(h-k)/2,48-(3+f/2));a.restore()}});Ui.CanvasElement.extend("Ui.DualIcon",{icon:void 0,fill:void 0,stroke:void 0,strokeWidth:void 0,constructor:function(a){this.icon=a.icon;delete a.icon},getFill:function(){return void 0===this.fill?Ui.Color.create(this.getStyleProperty("fill")):this.fill},setFill:function(a){this.fill=Ui.Color.create(a);this.invalidateDraw()},getStroke:function(){return void 0===this.stroke?Ui.Color.create(this.getStyleProperty("stroke")):this.stroke},setStroke:function(a){this.stroke=Ui.Color.create(a);this.invalidateDraw()},
getStrokeWidth:function(){return void 0===this.strokeWidth?this.getStyleProperty("strokeWidth"):this.strokeWidth},setStrokeWidth:function(a){this.strokeWidth=a;this.invalidateDraw()}},{updateCanvas:function(a){var b=this.getStrokeWidth();a.save();var c=Math.min(this.getLayoutWidth(),this.getLayoutHeight())/48;a.scale(c,c);a.translate(b,b);c=(48-2*b)/48;a.scale(c,c);a.svgPath(Ui.Icon.getPath(this.icon));a.strokeStyle=this.getStroke().getCssRgba();a.lineWidth=2*b;a.stroke();a.fillStyle=this.getFill().getCssRgba();
a.fill();a.restore()}},{style:{fill:"#ffffff",stroke:"#000000",strokeWidth:2}});Ui.CanvasElement.extend("Ui.ButtonGraphic",{text:void 0,icon:void 0,iconSize:24,orientation:"horizontal",fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal",borderWidth:1,measuredTextWidth:0,textWidth:0,spacing:3,radius:3,showText:!0,showIcon:!0,badge:void 0,badgeColor:void 0,badgeTextColor:void 0,background:void 0,backgroundBorder:void 0,foreground:void 0,constructor:function(a){this.setBadgeColor("red");this.setBadgeTextColor("white");this.setBackground("rgba(250,250,250,1)");this.setBackgroundBorder("rgba(200,200,200,1)");
this.setForeground("rgba(140,140,140,1)")},getText:function(){return this.text},setText:function(a){this.text!==a&&(this.text=a,this.invalidateMeasure(),this.invalidateDraw())},getIcon:function(){return this.icon},setIcon:function(a){this.icon!==a&&(this.icon=a,this.invalidateMeasure(),this.invalidateDraw())},getBadge:function(){return this.badge},setBadge:function(a){this.badge!==a&&(this.badge=a,this.invalidateDraw())},getOrientation:function(){return"vertical"===this.orientation?"vertical":"horizontal"},
setOrientation:function(a){this.orientation!==a&&(this.orientation=a,this.invalidateMeasure())},getIsDown:function(){return this.isDown},setIsDown:function(a){this.isDown!=a&&(this.isDown=a,this.invalidateDraw())},getIsActive:function(){return this.isActive},setIsActive:function(a){this.isActive!=a&&(this.isActive=a,this.invalidateDraw())},setHasFocus:function(a){this.buttonHasFocus!==a&&(this.buttonHasFocus=a,this.invalidateDraw())},setSpacing:function(a){this.spacing!==a&&(this.spacing=a,this.invalidateMeasure())},
setIconSize:function(a){this.iconSize!==a&&(this.iconSize=a,this.invalidateMeasure())},setFontFamily:function(a){this.fontFamily!==a&&(this.fontFamily=a,this.invalidateMeasure())},setFontSize:function(a){this.fontSize!==a&&(this.fontSize=a,this.invalidateMeasure())},setFontWeight:function(a){this.fontWeight!==a&&(this.fontWeight=a,this.invalidateMeasure())},setBorderWidth:function(a){this.borderWidth!==a&&(this.borderWidth=a,this.invalidateMeasure())},setRadius:function(a){this.radius!==a&&(this.radius=
a,this.invalidateDraw())},setShowText:function(a){this.showText!==a&&(this.showText=a,this.invalidateMeasure())},setShowIcon:function(a){this.showIcon!==a&&(this.showIcon=a,this.invalidateMeasure())},setTextWidth:function(a){this.textWidth!==a&&(this.textWidth=a,this.invalidateMeasure())},setBadgeColor:function(a){this.badgeColor=Ui.Color.create(a);this.invalidateDraw()},setBadgeTextColor:function(a){this.badgeTextColor=Ui.Color.create(a);this.invalidateDraw()},setBackgroundBorder:function(a){this.backgroundBorder=
Ui.Color.create(a);this.invalidateDraw()},setForeground:function(a){this.foreground=Ui.Color.create(a);this.invalidateDraw()}},{setBackground:function(a){this.background=Ui.Color.create(a);this.invalidateDraw()},updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=Math.min(this.radius,Math.min(b,c)/2);this.getIsDisabled()&&(a.globalAlpha=0.4);a.fillStyle=this.background.getCssRgba();a.beginPath();a.roundRect(0,0,b,c,d,d,d,d);a.closePath();a.fill();0<this.borderWidth&&(a.strokeStyle=
this.backgroundBorder.getCssRgba(),a.lineWidth=this.borderWidth,a.beginPath(),a.roundRect(this.borderWidth/2,this.borderWidth/2,b-this.borderWidth,c-this.borderWidth,d,d,d,d),a.closePath(),a.stroke());this.showIcon&&void 0!==this.icon&&(void 0===this.text||!this.showText)?(Ui.Icon.getPath(this.icon),a.save(),a.translate((b-this.iconSize)/2,(c-this.iconSize)/2),void 0!==this.badge?Ui.Icon.drawIconAndBadge(a,this.icon,this.iconSize,this.foreground.getCssRgba(),this.badge,this.iconSize/3,this.badgeColor.getCssRgba(),
this.badgeTextColor.getCssRgba()):Ui.Icon.drawIcon(a,this.icon,this.iconSize,this.foreground.getCssRgba()),a.restore()):this.showText&&(void 0===this.icon||!this.showIcon)&&void 0!==this.text?(a.font="normal "+this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,a.textBaseline="middle",a.fillStyle=this.foreground.getCssRgba(),a.fillText(this.text,(b-this.measuredTextWidth)/2,c/2+2)):this.showIcon&&(void 0!==this.icon&&void 0!==this.text&&this.showText)&&("vertical"===this.orientation?(Ui.Icon.getPath(this.icon),
a.save(),a.translate((b-this.iconSize)/2,(c-this.fontSize-this.iconSize-this.spacing)/2),void 0!==this.badge?Ui.Icon.drawIconAndBadge(a,this.icon,this.iconSize,this.foreground.getCssRgba(),this.badge,this.iconSize/3,this.badgeColor.getCssRgba(),this.badgeTextColor.getCssRgba()):Ui.Icon.drawIcon(a,this.icon,this.iconSize,this.foreground.getCssRgba()),a.restore(),a.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,a.textBaseline="top",a.fillStyle=this.foreground.getCssRgba(),a.fillText(this.text,
(b-this.measuredTextWidth)/2,c-this.fontSize-4-this.spacing-1)):(Ui.Icon.getPath(this.icon),a.save(),a.translate(this.spacing+4,(c-this.iconSize)/2-1),void 0!==this.badge?Ui.Icon.drawIconAndBadge(a,this.icon,this.iconSize,this.foreground.getCssRgba(),this.badge,this.iconSize/3,this.badgeColor.getCssRgba(),this.badgeTextColor.getCssRgba()):Ui.Icon.drawIcon(a,this.icon,this.iconSize,this.foreground.getCssRgba()),a.restore(),a.font="normal "+this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,a.textBaseline=
"middle",a.fillStyle=this.foreground.getCssRgba(),a.fillText(this.text,3*this.spacing+this.iconSize,c/2+1)));!this.showText&&void 0!==this.text?this.getDrawing().title=this.text:this.getDrawing().title=""},measureCore:function(a,b){void 0!==this.text&&(this.measuredTextWidth=Ui.Label.measureText(this.text,this.fontSize,this.fontFamily,this.fontWeight).width);var c={width:10,height:10};this.showIcon&&void 0!==this.icon&&(void 0===this.text||!this.showText)?c={width:this.iconSize+2*this.spacing+6,height:this.iconSize+
2*this.spacing+6}:this.showText&&(void 0===this.icon||!this.showIcon)&&void 0!==this.text?c={width:Math.max(this.measuredTextWidth,this.textWidth)+2*this.spacing+6,height:this.fontSize+2*this.spacing+6}:this.showIcon&&(void 0!==this.icon&&this.showText&&void 0!==this.text)&&(c="vertical"===this.orientation?{width:Math.max(Math.max(this.measuredTextWidth,this.textWidth),this.iconSize)+2*this.spacing+6,height:this.iconSize+this.fontSize+3*this.spacing+6}:{width:Math.max(this.measuredTextWidth,this.textWidth)+
this.iconSize+4*this.spacing+6,height:Math.max(this.iconSize,this.fontSize)+2*this.spacing+6});return c},onDisable:function(){this.invalidateDraw()},onEnable:function(){this.invalidateDraw()}});Ui.DualIcon.extend("Ui.DragEffectIcon",{},{},{style:{fill:"#357186",stroke:"#ffffff",strokeWidth:5}});
Ui.Event.extend("Ui.DragEvent",{clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,dataTransfer:void 0,effectAllowed:void 0,constructor:function(a){},setClientX:function(a){this.clientX=a},setClientY:function(a){this.clientY=a},setDeltaX:function(a){this.deltaX=a},setDeltaY:function(a){this.deltaY=a},setCtrlKey:function(a){this.ctrlKey=a},setAltKey:function(a){this.altKey=a},setShiftKey:function(a){this.shiftKey=a},setMetaKey:function(a){this.metaKey=a},setDataTransfer:function(a){this.dataTransfer=
a},preventDefault:function(){},getEffectAllowed:function(){return this.effectAllowed},setEffectAllowed:function(a){this.effectAllowed=a}});
Core.Object.extend("Ui.DragNativeData",{dataTransfer:void 0,constructor:function(a){this.dataTransfer=a.dataTransfer;delete a.dataTransfer},getTypes:function(){return this.dataTransfer.dataTransfer.types},hasTypes:function(){for(var a=this.getTypes(),b=0;b<a.length;b++)for(var c=0;c<arguments.length;c++)if(a[b].toLowerCase()===arguments[c].toLowerCase())return!0;return!1},hasType:function(a){return this.hasTypes(a)},hasFiles:function(){return this.hasType("files")},getFiles:function(){for(var a=[],
b=0;b<this.dataTransfer.dataTransfer.files.length;b++)a.push(new Core.File({fileApi:this.dataTransfer.dataTransfer.files[b]}));return a},getData:function(a){return this.dataTransfer.dataTransfer.getData(a)}});
Core.Object.extend("Ui.DragWatcher",{effectAllowed:void 0,dataTransfer:void 0,element:void 0,x:0,y:0,constructor:function(a){this.addEvents("drop","leave","move");this.dataTransfer=a.dataTransfer;delete a.dataTransfer;this.element=a.element;delete a.element},getPosition:function(){return new Ui.Point({x:this.x,y:this.y})},getElement:function(){return this.element},getDataTransfer:function(){return this.dataTransfer},getEffectAllowed:function(){return this.effectAllowed},setEffectAllowed:function(a){this.effectAllowed=
a},move:function(a,b){this.x=a;this.y=b;this.fireEvent("move",this,a,b)},leave:function(){this.fireEvent("leave",this)},drop:function(a){this.fireEvent("drop",this,a,this.x,this.y)},release:function(){this.dataTransfer.releaseDragWatcher(this)}});
Core.Object.extend("Ui.DragDataTransfer",{draggable:void 0,image:void 0,imageEffect:void 0,catcher:void 0,startX:0,startY:0,dropX:0,dropY:0,x:0,y:0,startImagePoint:void 0,overElement:void 0,hasStarted:!1,dragDelta:void 0,effectAllowed:void 0,watcher:void 0,pointer:void 0,pointerId:0,dropEffect:void 0,dropEffectIcon:void 0,data:void 0,type:void 0,timer:void 0,dropFailsTimer:void 0,delayed:!1,dragWatcher:void 0,constructor:function(a){this.addEvents("start","end");this.dropEffect=[];this.effectAllowed=
[];this.draggable=a.draggable;delete a.draggable;this.startX=a.x;delete a.x;this.startY=a.y;delete a.y;this.type=a.type;delete a.type;this.delayed=a.delayed;delete a.delayed;"pointerId"in a&&(this.pointerId=a.pointerId,delete a.pointerId);this.pointer=a.pointer;delete a.pointer;this.watcher=this.pointer.watch(Ui.App.current);this.dragDelta=this.draggable.pointFromWindow({x:this.startX,y:this.startY});this.data={};this.connect(this.watcher,"move",this.onPointerMove);this.connect(this.watcher,"up",
this.onPointerUp);this.connect(this.watcher,"cancel",this.onPointerCancel);this.delayed&&(this.timer=new Core.DelayedTask({scope:this,delay:0.5,callback:this.onTimer}))},setData:function(a){this.data=a},getData:function(){return this.data},hasData:function(){return void 0!==this.data},getPosition:function(){return new Ui.Point({x:this.x,y:this.y})},getDragDelta:function(){return this.dragDelta},generateImage:function(a){var b,c,d;if("tagName"in a&&"IMG"==a.tagName.toUpperCase())b=a.cloneNode(!1),
b.oncontextmenu=function(a){a.preventDefault()};else if("tagName"in a&&"CANVAS"==a.tagName.toUpperCase()){b=document.createElement("img");b.oncontextmenu=function(a){a.preventDefault()};for(c in a.style)b.style[c]=a.style[c];b.setAttribute("src",a.toDataURL("image/png"))}else if(!navigator.isFirefox&&void 0!==a.toDataURL){b=document.createElement("img");b.oncontextmenu=function(a){a.preventDefault()};for(c in a.style)b.style[c]=a.style[c];b.setAttribute("src",a.toDataURL("image/png"))}else{b=a.cloneNode(!1);
"style"in b&&(b.style.webkitUserSelect="none",b.style.webkitUserCallout="none");for(d=0;d<a.childNodes.length;d++)c=a.childNodes[d],b.appendChild(this.generateImage(c))}"setAttribute"in b&&b.setAttribute("draggable",!1);b.onselectstart=function(a){a.preventDefault();return!1};return b},onTimer:function(){this.timer=void 0;this.fireEvent("start",this);if(this.hasData()){this.hasStarted=!0;this.image=this.generateImage(this.draggable.getDrawing());this.image.style.touchAction="none";this.image.style.zIndex=
1E5;this.image.style.position="absolute";"removeProperty"in this.image.style&&this.image.style.removeProperty("transform");navigator.isIE&&"removeProperty"in this.image.style?this.image.style.removeProperty("-ms-transform"):navigator.isGecko?this.image.style.removeProperty("-moz-transform"):navigator.isWebkit?this.image.style.removeProperty("-webkit-transform"):navigator.isOpera&&this.image.style.removeProperty("-o-transform");navigator.supportOpacity&&(this.image.style.opacity=1,this.image.firstChild.style.opacity=
0.8);var a=this.delayed?-10:0;this.startImagePoint=this.draggable.pointToWindow({x:0,y:0});this.image.style.left=this.startImagePoint.x+a+"px";this.image.style.top=this.startImagePoint.y+a+"px";"mouse"===this.watcher.pointer.getType()&&(this.catcher=document.createElement("div"),this.catcher.style.position="absolute",this.catcher.style.left="0px",this.catcher.style.right="0px",this.catcher.style.top="0px",this.catcher.style.bottom="0px",this.catcher.zIndex=1E3,document.body.appendChild(this.catcher));
document.body.appendChild(this.image);this.watcher.capture()}else this.watcher.cancel()},capture:function(a,b){if(void 0!==this.dragWatcher&&this.dragWatcher.getElement()===a)throw"Drag already captured by the given element";void 0!==this.dragWatcher&&this.dragWatcher.leave();return this.dragWatcher=new Ui.DragWatcher({dataTransfer:this,element:a,effectAllowed:b})},releaseDragWatcher:function(a){this.dragWatcher===a&&(this.dragWatcher.leave(),this.dragWatcher=void 0)},onPointerMove:function(a){var b,
c,d;if(a.getIsCaptured()){var e=a.pointer.getX(),f=a.pointer.getY();this.x=e;this.y=f;document.body.removeChild(this.image);void 0!==this.catcher&&document.body.removeChild(this.catcher);var g=Ui.App.current.elementFromPoint(e,f);void 0!==this.catcher&&document.body.appendChild(this.catcher);document.body.appendChild(this.image);b=e-this.startX;c=f-this.startY;d=this.delayed?-10:0;this.image.style.left=this.startImagePoint.x+b+d+"px";this.image.style.top=this.startImagePoint.y+c+d+"px";if(void 0!==
g&&null!==g){c=this.dropEffectIcon;b=new Ui.DragEvent({type:"dragover",clientX:e,clientY:f,dataTransfer:this});var l=[];b.dispatchEvent(g);void 0!==this.dragWatcher&&(l=this.dragWatcher.getEffectAllowed());void 0!==this.dragWatcher&&!g.getIsChildOf(this.dragWatcher.getElement())&&(this.dragWatcher.leave(),this.dragWatcher=void 0);void 0!==this.dragWatcher&&this.dragWatcher.move(e,f);this.dropEffect=Ui.DragDataTransfer.getMatchingDropEffect(this.effectAllowed,l,a.pointer.getType(),a.pointer.getCtrlKey(),
a.pointer.getAltKey(),a.pointer.getShiftKey());this.dropEffectIcon=1<this.dropEffect.length?"dragchoose":0<this.dropEffect.length?this.dropEffect[0].dragicon:void 0;this.dropEffectIcon!==c&&(void 0!==this.imageEffect&&(this.imageEffect.setIsLoaded(!1),this.image.removeChild(this.imageEffect.getDrawing()),this.imageEffect=void 0),void 0!==this.dropEffectIcon&&(this.imageEffect=new Ui.DragEffectIcon({icon:this.dropEffectIcon}),this.imageEffect.parent=Ui.App.current,this.imageEffect.setIsLoaded(!0),
this.imageEffect.setParentVisible(!0),this.imageEffect.setParentDisabled(!1),this.imageEffect.measure(32,32),this.imageEffect.arrange(-48+(this.startX-this.startImagePoint.x-d),-48+(this.startY-this.startImagePoint.y-d),32,32),this.image.appendChild(this.imageEffect.getDrawing())));this.overElement=g}else this.overElement=void 0}else a.pointer.getIsMove()&&a.cancel()},onPointerUp:function(a){if(a.getIsCaptured()){if(void 0!==this.dragWatcher)if(this.removeImage(),this.dragWatcher.leave(),1===this.dropEffect.length)this.dragWatcher.drop(this.dropEffect[0].action);
else{if(1<this.dropEffect.length){var b=new Ui.Popup;a=new Ui.VBox;b.setContent(a);for(var c=0;c<this.dropEffect.length;c++){var d=new Ui.Button({text:this.dropEffect[c].text});d["Ui.DragEvent.dropEffect"]=this.dropEffect[c];this.connect(d,"press",function(a){this.dragWatcher.drop(a["Ui.DragEvent.dropEffect"].action);b.close()});a.append(d)}b.open(this.x,this.y)}}else this.dropX=a.pointer.getX(),this.dropY=a.pointer.getY(),this.dropFailsTimer=new Anim.Clock({duration:0.25,ease:new Anim.PowerEase({mode:"out"})}),
this.connect(this.dropFailsTimer,"timeupdate",this.onDropFailsTimerUpdate),this.dropFailsTimer.begin();this.fireEvent("end",this)}else a.cancel()},onPointerCancel:function(a){void 0!==this.timer&&(this.timer.abort(),this.timer=void 0)},removeImage:function(){document.body.removeChild(this.image);void 0!==this.catcher&&(document.body.removeChild(this.catcher),this.catcher=void 0)},onDropFailsTimerUpdate:function(a,b){if(1<=b)this.removeImage();else{var c=(this.dropY-this.startY)*(1-b);this.image.style.left=
this.startImagePoint.x+(this.dropX-this.startX)*(1-b)+"px";this.image.style.top=this.startImagePoint.y+c+"px"}}},{},{getMergedEffectAllowed:function(a,b){if(void 0===a||"all"===a)return b;for(var c=[],d=0;d<a.length;d++)for(var e=0;e<b.length;e++)a[d]===b[e].action&&c.push(b[e]);return c},getMatchingDropEffect:function(a,b,c,d,e,f){a=effectAllowed=Ui.DragDataTransfer.getMergedEffectAllowed(a,b);if(1<effectAllowed.length&&"mouse"===c&&!e)if(d){for(c=0;c<effectAllowed.length;c++)!0===effectAllowed[c].secondary&&
(a=[effectAllowed[c]]);a===effectAllowed&&1<effectAllowed.length&&(a=[effectAllowed[1]])}else{for(c=0;c<effectAllowed.length;c++)!0===effectAllowed[c].primary&&(a=[effectAllowed[c]]);a===effectAllowed&&(a=[effectAllowed[0]])}return a}});
Core.Object.extend("Ui.DragNativeDataTransfer",{dataTransfer:void 0,dragWatcher:void 0,nativeData:void 0,dropEffect:"none",position:void 0,constructor:function(a){this.nativeData=new Ui.DragNativeData({dataTransfer:this})},getPosition:function(){return this.position},setPosition:function(a){this.position=a},getData:function(){return this.nativeData},setDataTransfer:function(a){this.dataTransfer=a},capture:function(a,b){if(void 0!==this.dragWatcher&&this.dragWatcher.getElement()===a)throw"Drag already captured by the given element";
void 0!==this.dragWatcher&&this.dragWatcher.leave();return this.dragWatcher=new Ui.DragWatcher({dataTransfer:this,element:a,effectAllowed:b})},releaseDragWatcher:function(a){this.dragWatcher===a&&(this.dragWatcher.leave(),this.dragWatcher=void 0)}});
Core.Object.extend("Ui.DragNativeManager",{app:void 0,dataTransfer:void 0,dragWatcher:void 0,nativeTarget:void 0,constructor:function(a){this.app=a.app;delete a.app;this.dataTransfer=new Ui.DragNativeDataTransfer;this.connect(this.app.getDrawing(),"dragover",this.onDragOver);this.connect(this.app.getDrawing(),"dragenter",this.onDragEnter);this.connect(this.app.getDrawing(),"dragleave",this.onDragLeave);this.connect(this.app.getDrawing(),"drop",this.onDrop)},onDragOver:function(a){this.dataTransfer.setDataTransfer(a.dataTransfer);
this.dataTransfer.setPosition(new Ui.Point({x:a.clientX,y:a.clientY}));var b=this.app.elementFromPoint(a.clientX,a.clientY);void 0!==b&&((new Ui.DragEvent({type:"dragover",clientX:a.clientX,clientY:a.clientY,dataTransfer:this.dataTransfer})).dispatchEvent(b),void 0!==this.dataTransfer.dragWatcher&&!b.getIsChildOf(this.dataTransfer.dragWatcher.getElement())&&(this.dataTransfer.dragWatcher.leave(),this.dataTransfer.dragWatcher=void 0));void 0!==this.dataTransfer.dragWatcher?(b=Ui.DragDataTransfer.getMergedEffectAllowed(this.nativeToCustom(a.dataTransfer.effectAllowed),
this.dataTransfer.dragWatcher.effectAllowed),this.dataTransfer.dragWatcher.move(a.clientX,a.clientY),a.dataTransfer.dropEffect=this.customToNative(b)):a.dataTransfer.dropEffect="none";a.stopImmediatePropagation();a.preventDefault();return!1},onDragEnter:function(a){this.nativeTarget=a.target},onDragLeave:function(a){this.nativeTarget===a.target&&(this.nativeTarget=void 0,void 0!==this.dataTransfer.dragWatcher&&(this.dataTransfer.dragWatcher.leave(),this.dataTransfer.dragWatcher=void 0))},onDrop:function(a){this.dataTransfer.setDataTransfer(a.dataTransfer);
if(void 0!==this.dataTransfer.dragWatcher){this.dataTransfer.dragWatcher.leave();var b=Ui.DragDataTransfer.getMergedEffectAllowed(this.nativeToCustom(a.dataTransfer.effectAllowed),this.dataTransfer.dragWatcher.effectAllowed);a.dataTransfer.dropEffect=this.customToNative(b);0<b.length&&this.dataTransfer.dragWatcher.drop(b[0].action);this.dataTransfer.dragWatcher=void 0}a.stopImmediatePropagation();a.preventDefault()},nativeToCustom:function(a){if("copy"===a)return["copy"];if("link"===a)return["link"];
if("move"===a)return["move"];if("copyLink"===a)return["copy","link"];if("copyMove"===a)return["move","copy"];if("linkMove"===a)return["move","link"];if("all"===a)return["move","copy","link"]},customToNative:function(a){for(var b=!1,c=!1,d=!1,e=0;e<a.length;e++)"link"===a[e].action?b=!0:"move"===a[e].action?d=!0:"copy"===a[e].action&&(c=!0);return b&&c&&d?"all":b&&c?"copyLink":b&&d?"linkMove":d&&c?"copyMove":b?"link":d?"move":c?"copy":"none"}});Ui.Element.extend("Ui.Html",{htmlDrawing:void 0,bindedOnImageLoad:void 0,fontSize:void 0,fontFamily:void 0,fontWeight:void 0,color:void 0,textAlign:void 0,interLine:void 0,wordWrap:void 0,constructor:function(a){this.addEvents("link");this.bindedOnImageLoad=this.onImageLoad.bind(this);this.connect(this.getDrawing(),"click",this.onClick);this.connect(this.getDrawing(),"keypress",this.onKeyPress)},getHtml:function(){return this.htmlDrawing.innerHTML},getElements:function(a){var b=[];this.searchElements(a.toUpperCase(),
this.htmlDrawing,b);return b},searchElements:function(a,b,c){for(var d=0;d<b.childNodes.length;d++){var e=b.childNodes[d];"tagName"in e&&e.tagName.toUpperCase()==a&&c.push(e);this.searchElements(a,e,c)}},getParentElement:function(a,b){do{if("tagName"in b&&b.tagName.toUpperCase()==a)return b;if(void 0===b.parentNode||null===b.parentNode||b.parentNode===this.getDrawing())break;b=b.parentNode}while(1)},setHtml:function(a){this.htmlDrawing.innerHTML=a;a=this.getElements("IMG");for(var b=0;b<a.length;b++)a[b].onload=
this.bindedOnImageLoad;this.invalidateMeasure()},setText:function(a){if("innerText"in this.htmlDrawing)this.htmlDrawing.innerText=a;else{var b=document.createElement("div");b.textContent=a;a=b.textContent.split("\n");for(var b="",c=0;c<a.length;c++)""!==a[c]&&(""!==b&&(b+="<br>"),b+=a[c]);this.setHtml(b)}this.invalidateMeasure()},getTextContent:function(a){var b="";if(3===a.nodeType)b+=a.textContent;else if(1===a.nodeType&&("BR"==a.nodeName||"P"==a.nodeName))b+="\n";if("childNodes"in a)for(var c=
0;c<a.childNodes.length;c++)b+=this.getTextContent(a.childNodes[c]);return b},getText:function(){return"innerText"in this.htmlDrawing?this.htmlDrawing.innerText:this.getTextContent(this.htmlDrawing)},getTextAlign:function(){return void 0!==this.textAlign?this.textAlign:this.getStyleProperty("textAlign")},setTextAlign:function(a){this.textAlign!==a&&(this.textAlign=a,this.getDrawing().style.textAlign=this.getTextAlign())},getFontSize:function(){return void 0!==this.fontSize?this.fontSize:this.getStyleProperty("fontSize")},
setFontSize:function(a){this.fontSize!==a&&(this.fontSize=a,this.getDrawing().style.fontSize=this.getFontSize()+"px",this.invalidateMeasure())},getFontFamily:function(){return void 0!==this.fontFamily?this.fontFamily:this.getStyleProperty("fontFamily")},setFontFamily:function(a){this.fontFamily!==a&&(this.fontFamily=a,this.getDrawing().style.fontFamily=this.getFontFamily(),this.invalidateMeasure())},getFontWeight:function(){return void 0!==this.fontWeight?this.fontWeight:this.getStyleProperty("fontWeight")},
setFontWeight:function(a){this.fontWeight!==a&&(this.fontWeight=a,this.getDrawing().style.fontWeight=this.getFontWeight(),this.invalidateMeasure())},getInterLine:function(){return void 0!==this.interLine?this.interLine:this.getStyleProperty("interLine")},setInterLine:function(a){this.interLine!==a&&(this.interLine=a,this.getDrawing().style.lineHeight=this.getInterLine(),this.invalidateMeasure())},getWordWrap:function(){return void 0!==this.wordWrap?this.wordWrap:this.getStyleProperty("wordWrap")},
setWordWrap:function(a){this.wordWrap!==a&&(this.wordWrap=a,this.getDrawing().style.wordWrap=this.getWordWrap(),this.invalidateMeasure())},getWhiteSpace:function(){return void 0!==this.whiteSpace?this.whiteSpace:this.getStyleProperty("whiteSpace")},setWhiteSpace:function(a){this.whiteSpace!==a&&(this.whiteSpace=a,this.getDrawing().style.whiteSpace=this.getWhiteSpace(),this.invalidateMeasure())},setColor:function(a){this.color!==a&&(this.color=Ui.Color.create(a),navigator.supportRgba?this.getDrawing().style.color=
this.color.getCssRgba():this.getDrawing().style.color=this.color.getCssHtml())},getColor:function(){return void 0!==this.color?this.color:Ui.Color.create(this.getStyleProperty("color"))},onSubtreeModified:function(a){this.invalidateMeasure()},onKeyPress:function(a){this.invalidateMeasure()},onImageLoad:function(a){this.invalidateMeasure()},onClick:function(a){var b=this.getParentElement("A",a.target);void 0!==b&&(a.preventDefault(),a.stopPropagation(),this.fireEvent("link",this,b.href))}},{onVisible:function(){this.invalidateMeasure()},
onStyleChange:function(){this.getDrawing().style.textAlign=this.getTextAlign();this.getDrawing().style.fontSize=this.getFontSize()+"px";this.getDrawing().style.fontFamily=this.getFontFamily();this.getDrawing().style.fontWeight=this.getFontWeight();navigator.supportRgba?this.getDrawing().style.color=this.getColor().getCssRgba():this.getDrawing().style.color=this.getColor().getCssHtml();this.getDrawing().style.lineHeight=this.getInterLine();this.getDrawing().style.wordWrap=this.getWordWrap()},renderDrawing:function(){var a=
Ui.Html.base.renderDrawing.apply(this,arguments);this.htmlDrawing=document.createElement("div");this.htmlDrawing.style.outline="none";this.htmlDrawing.style.padding="0px";this.htmlDrawing.style.margin="0px";this.htmlDrawing.style.display="inline-block";this.htmlDrawing.style.width="";a.appendChild(this.htmlDrawing);return a},measureCore:function(a,b){a=void 0!==this.getWidth()?Math.max(a,this.getWidth()):a;this.getDrawing().style.width=a+"px";this.htmlDrawing.style.width="";this.htmlDrawing.style.height=
"";this.htmlDrawing.clientWidth>a&&(this.htmlDrawing.style.width=a+"px");return{width:Math.max(this.htmlDrawing.clientWidth,this.htmlDrawing.scrollWidth),height:this.htmlDrawing.clientHeight}},arrangeCore:function(a,b){this.htmlDrawing.style.width=a+"px";this.htmlDrawing.style.height=b+"px"}},{style:{color:"black",fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal",textAlign:"left",wordWrap:"normal",whiteSpace:"normal",interLine:1}});Ui.Element.extend("Ui.Label",{text:"",orientation:"horizontal",fontSize:void 0,fontFamily:void 0,fontWeight:void 0,color:void 0,labelDrawing:void 0,textMeasureValid:!1,textWidth:0,textHeight:0,constructor:function(a){this.setSelectable(!1)},getText:function(){return this.text},setText:function(a){this.text!=a&&(this.text=a,"textContent"in this.labelDrawing?this.labelDrawing.textContent=this.text:this.labelDrawing.innerText=this.text,this.textMeasureValid=!1,this.invalidateMeasure())},setFontSize:function(a){this.fontSize!==
a&&(this.fontSize=a,this.labelDrawing.style.fontSize=this.getFontSize()+"px",this.textMeasureValid=!1,this.invalidateMeasure())},getFontSize:function(){return void 0!==this.fontSize?this.fontSize:this.getStyleProperty("fontSize")},setFontFamily:function(a){this.fontFamily!==a&&(this.fontFamily=a,this.labelDrawing.style.fontFamily=this.getFontFamily(),this.textMeasureValid=!1,this.invalidateMeasure())},getFontFamily:function(){return void 0!==this.fontFamily?this.fontFamily:this.getStyleProperty("fontFamily")},
setFontWeight:function(a){this.fontWeight!==a&&(this.fontWeight=a,this.labelDrawing.style.fontWeight=this.getFontWeight(),this.textMeasureValid=!1,this.invalidateMeasure())},getFontWeight:function(){return void 0!==this.fontWeight?this.fontWeight:this.getStyleProperty("fontWeight")},setColor:function(a){this.color!==a&&(this.color=Ui.Color.create(a),this.labelDrawing.style.color=navigator.supportRgba?this.getColor().getCssRgba():this.getColor().getCssHtml())},getColor:function(){return void 0!==this.color?
this.color:Ui.Color.create(this.getStyleProperty("color"))},getOrientation:function(){return this.orientation},setOrientation:function(a){this.orientation!=a&&(this.orientation=a,this.invalidateMeasure())}},{verticalAlign:"center",horizontalAlign:"center",onStyleChange:function(){this.labelDrawing.style.fontSize=this.getFontSize()+"px";this.labelDrawing.style.fontFamily=this.getFontFamily();this.labelDrawing.style.fontWeight=this.getFontWeight();this.labelDrawing.style.color=navigator.supportRgba?
this.getColor().getCssRgba():this.getColor().getCssHtml();this.textMeasureValid=!1;this.invalidateMeasure()},renderDrawing:function(){this.labelDrawing=document.createElement("div");this.labelDrawing.style.whiteSpace="nowrap";this.labelDrawing.style.display="inline";this.labelDrawing.style.position="absolute";this.labelDrawing.style.left="0px";this.labelDrawing.style.top="0px";return this.labelDrawing},measureCore:function(a,b){if(!this.textMeasureValid){this.textMeasureValid=!0;var c=Ui.Label.measureText(this.text,
this.getFontSize(),this.getFontFamily(),this.getFontWeight());this.textWidth=c.width;this.textHeight=c.height}return"vertical"===this.orientation?{width:this.textHeight,height:this.textWidth}:{width:this.textWidth,height:this.textHeight}},arrangeCore:function(a,b){var c;"vertical"==this.orientation?(c=Ui.Matrix.createTranslate(this.labelDrawing.offsetHeight,0),c.rotate(90),navigator.isIE?(this.labelDrawing.style.msTransform=c.toString(),this.labelDrawing.style.msTransformOrigin="0% 0%"):navigator.isGecko?
(this.labelDrawing.style.MozTransform="matrix("+c.svgMatrix.a.toFixed(4)+", "+c.svgMatrix.b.toFixed(4)+", "+c.svgMatrix.c.toFixed(4)+", "+c.svgMatrix.d.toFixed(4)+", "+c.svgMatrix.e.toFixed(0)+"px, "+c.svgMatrix.f.toFixed(0)+"px)",this.labelDrawing.style.MozTransformOrigin="0% 0%"):navigator.isWebkit?(this.labelDrawing.style.webkitTransform=c.toString(),this.labelDrawing.style.webkitTransformOrigin="0% 0%"):navigator.isOpera&&(this.labelDrawing.style.OTransform=c.toString(),this.labelDrawing.style.OTransformOrigin=
"0% 0%")):navigator.isIE&&"removeProperty"in this.labelDrawing?this.labelDrawing.style.removeProperty("-ms-transform"):navigator.isGecko?this.labelDrawing.style.removeProperty("-moz-transform"):navigator.isWebkit?this.labelDrawing.style.removeProperty("-webkit-transform"):navigator.isOpera&&this.labelDrawing.style.removeProperty("-o-transform")}},{measureBox:void 0,measureContext:void 0,measureTextCanvas:function(a,b,c,d){void 0===Ui.Label.measureBox&&this.createMeasureCanvas();Ui.Label.measureContext.font=
"normal "+d+" "+b+"px "+c;a=Ui.Label.measureContext.measureText(a);a.height=b;return a},createMeasureCanvas:function(){var a=window;if(navigator.isIE||navigator.isGecko)a=Ui.App.getRootWindow();if(void 0===a.document.body){var b=a.document.createElement("body");a.document.body=b}Ui.Label.measureBox=a.document.createElement("canvas");Ui.Label.measureBox.style.visibility="hidden";Ui.Label.measureBox.style.position="absolute";Ui.Label.measureBox.style.left="0px";Ui.Label.measureBox.style.top="0px";Ui.Label.measureBox.style.outline=
"none";Ui.Label.measureBox.setAttribute("width",10,null);Ui.Label.measureBox.setAttribute("height",10,null);a.document.body.appendChild(Ui.Label.measureBox);Ui.Label.measureContext=Ui.Label.measureBox.getContext("2d")},isFontAvailable:function(a,b){var c;if(!navigator.supportCanvas)return!0;void 0===Ui.Label.measureBox&&Ui.Label.createMeasureCanvas();var d=Ui.Label.measureContext;d.fillStyle="rgba(0,0,0,0)";d.clearRect(0,0,10,10);d.textBaseline="top";d.font="normal "+b+" 10px "+a;d.fillStyle="rgba(255,255,255,1)";
d.fillText("@",0,0);var e=d.getImageData(0,0,10,10),f=!0;for(c=0;f&&c<e.data.length;c+=4)0!==e.data[c+3]&&(f=!1);if(f)return!1;d.fillStyle="rgba(0,0,0,0)";d.clearRect(0,0,10,10);d.fillStyle="rgba(255,255,255,1)";d.font="normal "+b+" 10px Sans-Serif";d.fillText("@",0,0);e=d.getImageData(0,0,10,10);d.fillStyle="rgba(0,0,0,0)";d.clearRect(0,0,10,10);d.fillStyle="rgba(255,255,255,1)";d.font="normal "+b+" 10px "+a+",Sans-Serif";d.fillText("@",0,0);d=d.getImageData(0,0,10,10);for(c=0;c<d.data.length;c+=
4)if(d.data[c+3]!==e.data[c+3])return!0;return!1},measureTextHtml:function(a,b,c,d){void 0===Ui.Label.measureBox&&this.createMeasureHtml();Ui.Label.measureBox.style.fontSize=b+"px";Ui.Label.measureBox.style.fontFamily=c;Ui.Label.measureBox.style.fontWeight=d;"textContent"in Ui.Label.measureBox?Ui.Label.measureBox.textContent=a:Ui.Label.measureBox.innerText=a;return{width:Ui.Label.measureBox.offsetWidth,height:Ui.Label.measureBox.offsetHeight}},createMeasureHtml:function(){var a=window;if(navigator.isIE||
navigator.isGecko)a=Ui.App.getRootWindow();if(void 0===a.document.body){var b=a.document.createElement("body");a.document.body=b}Ui.Label.measureBox=a.document.createElement("div");Ui.Label.measureBox.style.whiteSpace="nowrap";Ui.Label.measureBox.style.position="absolute";Ui.Label.measureBox.style.left="0px";Ui.Label.measureBox.style.top="0px";Ui.Label.measureBox.style.position="absolute";Ui.Label.measureBox.style.display="inline";Ui.Label.measureBox.style.visibility="hidden";a.document.body.appendChild(Ui.Label.measureBox)},
measureText:function(a,b,c,d){return""===a||void 0===a?{width:0,height:0}:navigator.supportCanvas?Ui.Label.measureTextCanvas(a,b,c,d):Ui.Label.measureTextHtml(a,b,c,d)},style:{color:"#444444",fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal"}});Ui.Html.extend("Ui.Text",{constructor:function(a){this.getDrawing().style.whiteSpace="pre-wrap";this.setSelectable(!1)},setTextTransform:function(a){this.getDrawing().style.textTransform=a;this.invalidateMeasure()}});Core.Object.extend("Ui.CompactLabelContext",{text:"",fontSize:16,fontFamily:"Sans-Serif",fontWeight:"normal",maxLine:Number.MAX_VALUE,interLine:1,textAlign:"left",width:Number.MAX_VALUE,drawLine:void 0,whiteSpace:"pre-line",wordWrap:"normal",textTransform:"none",constructor:function(a){},setDrawLine:function(a){this.drawLine=a},getWhiteSpace:function(){return this.whiteSpace},setWhiteSpace:function(a){this.whiteSpace=a},getWordWrap:function(){return this.wordWrap},setWordWrap:function(a){this.wordWrap=
a},getMaxLine:function(){return this.maxLine},setMaxLine:function(a){this.maxLine!==a&&(this.maxLine=a)},getTextAlign:function(){return this.textAlign},setTextAlign:function(a){this.textAlign!==a&&(this.textAlign=a)},setInterLine:function(a){this.interLine!==a&&(this.interLine=a)},getInterLine:function(){return this.interLine},getText:function(){return this.text},setText:function(a){this.text!==a&&(this.text=a)},setFontSize:function(a){this.fontSize!==a&&(this.fontSize=a)},getFontSize:function(){return this.fontSize},
setFontFamily:function(a){this.fontFamily!==a&&(this.fontFamily=a)},getFontFamily:function(){return this.fontFamily},setFontWeight:function(a){this.fontWeight!==a&&(this.fontWeight=a)},getFontWeight:function(){return this.fontWeight},getTextTransform:function(){return this.textTransform},setTextTransform:function(a){this.textTransform=a},getTransformedText:function(){return"lowercase"===this.textTransform?this.text.toLowerCase():"uppercase"===this.textTransform?this.text.toUpperCase():this.text},
flushLine:function(a,b,c,d,e){var f=Ui.Label.measureText(b,this.getFontSize(),this.getFontFamily(),this.getFontWeight());d&&(c="left"==this.textAlign?0:"right"==this.textAlign?c-f.width:(c-f.width)/2,d&&this.drawLine(c,a,b));return f.height*(!0===e?1:this.getInterLine())},updateFlow:function(a,b){if(void 0===this.text)return{width:0,height:0};for(var c=this.getTransformedText(),d=this.getFontSize(),e=this.getFontFamily(),f=this.getFontWeight(),g=Ui.Label.measureText("...",d,e,f).width,l=0,k=0,h="",
n=0,m=0,p=0;p<c.length;p++){var q=Ui.Label.measureText(h+c.charAt(p),d,e,f);if(void 0!==this.maxLine&&n+1>=this.maxLine&&q.width+g>a)return l+=this.flushLine(l,h+"...",a,b),k+g>m&&(m=k+g),{width:m,height:l};q.width>a?(l+=this.flushLine(l,h,a,b),n++,k>m&&(m=k),h=c.charAt(p)):h+=c.charAt(p);k=q.width}""!==h&&(l+=this.flushLine(l,h,a,b,!0),k>m&&(m=k));return{width:m,height:l}},updateFlowWords:function(a,b){if(void 0===this.text||null===this.text)return{width:0,height:0};var c,d;c=this.getTransformedText();
var e=this.getFontSize(),f=this.getFontFamily(),g=this.getFontWeight(),l=Ui.Label.measureText("...",e,f,g).width;d=[];var k=[],h=c.split(" ");for(c=0;c<h.length;c++)for(var n=h[c];;){var m=Ui.Label.measureText(n,e,f,g).width;if(m<a){d.push(n);k.push(m);break}else for(var m="",p=0;p<n.length;p++)if(Ui.Label.measureText(m+n.charAt(p),e,f,g).width<a)m+=n.charAt(p);else{""===m&&(m=n.charAt(0));d.push(m);k.push(Ui.Label.measureText(m,e,f,g).width);n=n.substr(m.length,n.length-m.length);break}if(0===n.length)break}var q=
Ui.Label.measureText(". .",e,f,g).width-Ui.Label.measureText("..",e,f,g).width,m=n=h=0,p="",r=0;for(c=0;c<d.length;c++){if(""!==p)if(n+q>a){if(r+1>=this.maxLine){for(;;)if(d=Ui.Label.measureText(p,e,f,g).width,d+l>a){if(1>=p.length){p="...";break}p=p.substr(0,p.length-1)}else{p+="...";break}h+=this.flushLine(h,p,a,b);n>m&&(m=n);return{width:m,height:h}}h+=this.flushLine(h,p,a,b);n>m&&(m=n);n=0;r++;p=""}else p+=" ",n+=q;if(n+k[c]>a){if(r+1>=this.maxLine){for(;;)if(d=Ui.Label.measureText(p,e,f,g).width,
d+l>a){if(1>=p.length){p="...";break}p=p.substr(0,p.length-1)}else{p+="...";break}h+=this.flushLine(h,p,a,b);n>m&&(m=n);return{width:m,height:h}}h+=this.flushLine(h,p,a,b);r++;n>m&&(m=n);n=k[c];p=d[c]}else p+=d[c],n+=k[c]}""!==p&&(h+=this.flushLine(h,p,a,b,!0),n>m&&(m=n));return{width:m,height:h}},drawText:function(a,b){if("nowrap"===this.whiteSpace){var c=this.getTransformedText(),d=Ui.Label.measureText(c,this.fontSize,this.fontFamily,this.fontWeight);b&&this.flushLine(0,c,a,!0,!0);return d}return"normal"===
this.wordWrap?this.updateFlowWords(a,b):this.updateFlow(a,b)}});
Ui.Element.extend("Ui.CompactLabel",{fontSize:void 0,fontFamily:void 0,fontWeight:void 0,color:void 0,textDrawing:void 0,maxLine:void 0,interLine:void 0,textAlign:void 0,isMeasureValid:!1,isArrangeValid:!1,lastMeasureWidth:0,lastMeasureHeight:0,lastAvailableWidth:0,maxLine:void 0,textContext:void 0,whiteSpace:void 0,wordWrap:void 0,textTransform:void 0,constructor:function(a){this.setSelectable(!1);this.textContext=new Ui.CompactLabelContext},getMaxLine:function(){return void 0!==this.maxLine?this.maxLine:
this.getStyleProperty("maxLine")},setMaxLine:function(a){this.maxLine=a;this.textContext.setMaxLine(this.getMaxLine());this.invalidateMeasure()},getText:function(){return this.textContext.getText()},setText:function(a){this.textContext.setText(a);this.isMeasureValid=!1;this.invalidateMeasure()},getTextAlign:function(){return void 0!==this.textAlign?this.textAlign:this.getStyleProperty("textAlign")},setTextAlign:function(a){this.textAlign=a;this.textContext.setTextAlign(this.getTextAlign());this.invalidateArrange()},
setInterLine:function(a){this.interLine=a;this.textContext.setInterLine(this.getInterLine());this.isMeasureValid=!1;this.invalidateMeasure()},getInterLine:function(){return void 0!==this.interLine?this.interLine:this.getStyleProperty("interLine")},setFontSize:function(a){this.fontSize=a;this.isMeasureValid=!1;this.textContext.setFontSize(this.getFontSize());this.textDrawing.style.fontSize=this.getFontSize()+"px";this.invalidateMeasure()},getFontSize:function(){return void 0!==this.fontSize?this.fontSize:
this.getStyleProperty("fontSize")},setFontFamily:function(a){this.fontFamily=a;this.isMeasureValid=!1;this.textContext.setFontFamily(this.getFontFamily());this.textDrawing.style.fontFamily=this.getFontFamily();this.invalidateMeasure()},getFontFamily:function(){return void 0!==this.fontFamily?this.fontFamily:this.getStyleProperty("fontFamily")},setFontWeight:function(a){this.fontWeight=a;this.isMeasureValid=!1;this.textContext.setFontWeight(a);this.textDrawing.style.fontWeight=this.getFontWeight();
this.invalidateMeasure()},getFontWeight:function(){return void 0!==this.fontWeight?this.fontWeight:this.getStyleProperty("fontWeight")},getWhiteSpace:function(){return void 0!==this.whiteSpace?this.whiteSpace:this.getStyleProperty("whiteSpace")},setWhiteSpace:function(a){this.whiteSpace!==a&&(this.isMeasureValid=!1,this.whiteSpace=a,this.textContext.setWhiteSpace(this.getWhiteSpace()),this.invalidateMeasure())},getWordWrap:function(){return void 0!==this.wordWrap?this.wordWrap:this.getStyleProperty("wordWrap")},
setWordWrap:function(a){this.wordWrap!==a&&(this.isMeasureValid=!1,this.wordWrap=a,this.textContext.setWordWrap(this.getWordWrap()),this.invalidateMeasure())},getTextTransform:function(){return void 0!==this.textTransform?this.textTransform:this.getStyleProperty("textTransform")},setTextTransform:function(a){this.textTransform!==a&&(this.isMeasureValid=!1,this.textTransform=a,this.textContext.setTextTransform(this.getTextTransform()),this.invalidateMeasure())},setColor:function(a){this.color!==a&&
(this.color=Ui.Color.create(a),this.textDrawing.style.color=navigator.supportRgba?this.color.getCssRgba():this.color.getCssHtml())},getColor:function(){return void 0!==this.color?this.color:Ui.Color.create(this.getStyleProperty("color"))}},{renderDrawing:function(){var a=Ui.CompactLabel.base.renderDrawing.apply(this,arguments);this.textDrawing=document.createElement("div");this.textDrawing.style.fontFamily=this.getFontFamily();this.textDrawing.style.fontWeight=this.getFontWeight();this.textDrawing.style.fontSize=
this.getFontSize()+"px";this.textDrawing.style.color=navigator.supportRgba?this.getColor().getCssRgba():this.getColor().getCssHtml();this.textDrawing.style.position="absolute";this.textDrawing.style.left="0px";this.textDrawing.style.top="0px";a.appendChild(this.textDrawing);return a},onStyleChange:function(){this.textDrawing.style.fontSize=this.getFontSize()+"px";this.textDrawing.style.fontFamily=this.getFontFamily();this.textDrawing.style.fontWeight=this.getFontWeight();this.textDrawing.style.color=
navigator.supportRgba?this.getColor().getCssRgba():this.getColor().getCssHtml();this.textContext.setMaxLine(this.getMaxLine());this.textContext.setTextAlign(this.getTextAlign());this.textContext.setFontSize(this.getFontSize());this.textContext.setFontFamily(this.getFontFamily());this.textContext.setFontWeight(this.getFontWeight());this.textContext.setInterLine(this.getInterLine());this.textContext.setWhiteSpace(this.getWhiteSpace());this.textContext.setWordWrap(this.getWordWrap());this.textContext.setTextTransform(this.getTextTransform());
this.invalidateMeasure()},measureCore:function(a,b){if(!this.isMeasureValid||this.lastAvailableWidth!==a){this.lastAvailableWidth=a;var c=this.textContext.drawText(a,!1);this.lastMeasureHeight=c.height;this.lastMeasureWidth=c.width;this.isMeasureValid=!0;this.isArrangeValid=!1}return{width:this.lastMeasureWidth,height:this.lastMeasureHeight}},arrangeCore:function(a,b){for(;this.textDrawing.hasChildNodes();)this.textDrawing.removeChild(this.textDrawing.firstChild);var c=this.textDrawing;this.textContext.setDrawLine(function(a,
b,f){var g=document.createElement("div");g.style.whiteSpace="nowrap";g.style.display="inline";g.style.position="absolute";g.style.left=a+"px";g.style.top=b+"px";"textContent"in g?g.textContent=f:g.innerText=f;c.appendChild(g)});this.textContext.drawText(a,!0)}},{style:{maxLine:Number.MAX_VALUE,color:new Ui.Color({r:0,g:0,b:0}),fontSize:16,fontFamily:"sans-serif",fontWeight:"normal",interLine:1,textAlign:"left",whiteSpace:"pre-line",wordWrap:"normal",textTransform:"none"}});Ui.Html.extend("Ui.ContentEditable",{anchorNode:null,anchorOffset:0,constructor:function(a){this.addEvents("anchorchange");this.setSelectable(!0);this.htmlDrawing.setAttribute("contenteditable","true");this.connect(this.getDrawing(),"keyup",this.onKeyUp);this.connect(this.getDrawing(),"DOMSubtreeModified",this.onContentSubtreeModified)},onKeyUp:function(a){this.testAnchorChange()},testAnchorChange:function(){if(window.getSelection().anchorNode!=this.anchorNode||window.getSelection().anchorOffset!=
this.anchorOffset)this.anchorNode=window.getSelection().anchorNode,this.anchorOffset=window.getSelection().anchorOffset,this.fireEvent("anchorchange",this)},onContentSubtreeModified:function(a){this.testAnchorChange();this.invalidateMeasure()}});Ui.Element.extend("Ui.Image",{src:void 0,loaddone:!1,naturalWidth:void 0,naturalHeight:void 0,imageDrawing:void 0,setSrcLock:!1,constructor:function(a){this.addEvents("ready","error");this.connect(this.imageDrawing,"contextmenu",function(a){a.preventDefault()});this.connect(this.imageDrawing,"load",this.onImageLoad);this.connect(this.imageDrawing,"error",this.onImageError)},getSrc:function(){return this.src},setSrc:function(a){if(void 0===a)throw"Image src cant be undefined";this.setSrcLock=!0;this.loaddone=
!1;this.naturalHeight=this.naturalWidth=void 0;this.src=a;this.imageDrawing.setAttribute("src",a);!0===this.imageDrawing.complete&&!0!==this.loaddone&&(this.loaddone=!0,this.naturalWidth=this.imageDrawing.naturalWidth,this.naturalHeight=this.imageDrawing.naturalHeight,this.fireEvent("ready",this),this.invalidateMeasure());this.setSrcLock=!1},getNaturalWidth:function(){return this.naturalWidth},getNaturalHeight:function(){return this.naturalHeight},getIsReady:function(){return this.loaddone},onImageError:function(a){this.fireEvent("error",
this)},onImageLoad:function(a){if(void 0!==a.target&&null!==a.target&&void 0!==a.target.naturalWidth&&void 0!==a.target.naturalHeight)this.loaddone=!0,this.naturalWidth=a.target.naturalWidth,this.naturalHeight=a.target.naturalHeight,this.fireEvent("ready",this),this.invalidateMeasure();else if(this.setSrcLock)new Core.DelayedTask({delay:0,scope:this,callback:this.onImageDelayReady});else this.onImageDelayReady()},onAppReady:function(){this.disconnect(Ui.App.current,"ready",this.onAppReady);this.onImageDelayReady()},
onImageDelayReady:function(){if(Ui.App.current.getIsReady()){this.loaddone=!0;if(void 0===document.body||null===document.body){var a=document.createElement("body");document.body=a}a=document.createElement("img");a.setAttribute("src",this.src);document.body.appendChild(a);this.naturalWidth=a.width;this.naturalHeight=a.height;document.body.removeChild(a);this.fireEvent("ready",this);this.invalidateMeasure()}else this.connect(Ui.App.current,"ready",this.onAppReady)}},{renderDrawing:function(){this.imageDrawing=
document.createElement("img");this.imageDrawing.style.position="absolute";this.imageDrawing.style.top="0px";this.imageDrawing.style.left="0px";this.imageDrawing.style.width="0px";this.imageDrawing.style.height="0px";this.imageDrawing.style.pointerEvents="none";this.imageDrawing.setAttribute("draggable",!1);navigator.isWebkit?(this.imageDrawing.style.webkitUserSelect="none",this.imageDrawing.style.webkitTouchCallout="none"):navigator.isGecko?this.imageDrawing.style.MozUserSelect="none":navigator.isIE&&
this.connect(this.imageDrawing,"selectstart",function(a){a.preventDefault()});return this.imageDrawing},measureCore:function(a,b){if(!this.loaddone)return{width:0,height:0};var c;void 0===this.getWidth()?void 0===this.getHeight()?c={width:this.naturalWidth,height:this.naturalHeight}:(c=this.getHeight()-(this.getMarginTop()+this.getMarginBottom()),c={width:this.naturalWidth*c/this.naturalHeight,height:c}):void 0===this.getHeight()?(c=this.getWidth()-(this.getMarginLeft()+this.getMarginRight()),c={width:c,
height:this.naturalHeight*c/this.naturalWidth}):c={width:0,height:0};return c},arrangeCore:function(a,b){void 0!==this.imageDrawing&&(this.imageDrawing.style.width=a+"px",this.imageDrawing.style.height=b+"px")}});Ui.Element.extend("Ui.Audio",{src:void 0,oggSrc:void 0,mp3Src:void 0,wavSrc:void 0,loaddone:!1,audioDrawing:void 0,canplaythrough:!1,state:"initial",constructor:function(a){this.addEvents("ready","ended","timeupdate","bufferingupdate","statechange","error");this.connect(this,"unload",this.onAudioUnload);if(void 0!==a.oggSrc||void 0!==a.mp3Src||void 0!==a.wavSrc)void 0!==a.oggSrc&&Ui.Audio.supportOgg?this.setSrc(a.oggSrc):void 0!==a.aacSrc&&Ui.Audio.supportAac?this.setSrc(a.aacSrc):void 0!==a.mp3Src&&
Ui.Audio.supportMp3?this.setSrc(a.mp3Src):void 0!==a.wavSrc&&Ui.Audio.supportWav&&this.setSrc(a.wavSrc),delete a.oggSrc,delete a.aacSrc,delete a.mp3Src,delete a.wavSrc},setSrc:function(a){this.canplaythrough=!1;this.state="initial";this.src=a;this.audioDrawing.setAttribute("src",a);try{this.audioDrawing.load()}catch(b){}},play:function(){this.state="playing";this.fireEvent("statechange",this,this.state);this.canplaythrough?this.audioDrawing.play():this.audioDrawing.load()},pause:function(){this.state=
"paused";this.fireEvent("statechange",this,this.state);this.canplaythrough?this.audioDrawing.pause():this.audioDrawing.load()},stop:function(){this.audioDrawing.pause();this.onEnded()},setVolume:function(a){this.audioDrawing.volume=a},getVolume:function(){return this.audioDrawing.volume},getDuration:function(){var a=this.audioDrawing.duration;return void 0===a||isNaN(a)||null===a?void 0:a},setCurrentTime:function(a){this.audioDrawing.currentTime=a},getCurrentTime:function(){return void 0===this.audioDrawing.currentTime?
0:this.audioDrawing.currentTime},getState:function(){return this.state},getIsReady:function(){return this.canplaythrough},onReady:function(){this.canplaythrough=!0;"playing"==this.state?this.audioDrawing.play():"paused"==this.state&&this.audioDrawing.pause();this.fireEvent("ready")},onTimeUpdate:function(){this.fireEvent("timeupdate",this,this.audioDrawing.currentTime);this.checkBuffering()},onEnded:function(){this.audioDrawing.pause();this.state="initial";this.audioDrawing.currentTime=0;this.fireEvent("ended",
this);this.fireEvent("statechange",this,this.state)},onProgress:function(){this.checkBuffering()},getCurrentBufferSize:function(){var a=this.audioDrawing.buffered,b=0,c=this.audioDrawing.currentTime;void 0===c&&(c=0);for(var d,e=0;e<a.length;e++){var f=a.start(e),g=a.end(e);void 0===d?f<=c&&g>=c&&(b=g-c,d=g):d>=f-0.01&&d<=g&&(b+=g-d,d=g)}return b},checkBuffering:function(){var a=this.getCurrentBufferSize();this.fireEvent("bufferingupdate",this,a)},onError:function(){this.state="error";this.fireEvent("error",
this,this.audioDrawing.error.code);this.fireEvent("statechange",this,this.state)},onWaiting:function(){this.canplaythrough||this.audioDrawing.load()},onAudioUnload:function(){this.canplaythrough&&this.pause();this.audioDrawing.removeAttribute("src");try{this.audioDrawing.load()}catch(a){}}},{verticalAlign:"top",horizontalAlign:"left",renderDrawing:function(){var a;Ui.Audio.htmlAudio?(this.audioDrawing=document.createElement("audio"),this.audioDrawing.style.display="none",this.connect(this.audioDrawing,
"canplaythrough",this.onReady),this.connect(this.audioDrawing,"ended",this.onEnded),this.connect(this.audioDrawing,"timeupdate",this.onTimeUpdate),this.connect(this.audioDrawing,"error",this.onError),this.connect(this.audioDrawing,"progress",this.onProgress),this.connect(this.audioDrawing,"waiting",this.onWaiting),this.audioDrawing.setAttribute("preload","auto"),this.audioDrawing.load(),a=this.audioDrawing):a=Ui.Audio.base.renderDrawing.apply(this,arguments);return a}});Ui.Audio.htmlAudio=!1;
Ui.Audio.flashAudio=!1;Ui.Audio.supportOgg=!1;Ui.Audio.supportMp3=!1;Ui.Audio.supportWav=!1;Ui.Audio.supportAac=!1;Ui.Audio.audioTest=document.createElement("audio");
void 0!==Ui.Audio.audioTest.play&&(Ui.Audio.htmlAudio=!0,Ui.Audio.supportWav=!!Ui.Audio.audioTest.canPlayType&&""!==Ui.Audio.audioTest.canPlayType("audio/wav"),Ui.Audio.supportMp3=!!Ui.Audio.audioTest.canPlayType&&""!==Ui.Audio.audioTest.canPlayType("audio/mpeg"),Ui.Audio.supportOgg=!!Ui.Audio.audioTest.canPlayType&&""!==Ui.Audio.audioTest.canPlayType('audio/ogg; codecs="vorbis"'),Ui.Audio.supportAac=!!Ui.Audio.audioTest.canPlayType&&""!==Ui.Audio.audioTest.canPlayType('audio/mp4; codecs="mp4a.40.2"'));
Ui.Audio.audioTest=void 0;Ui.Element.extend("Ui.Video",{src:void 0,poster:void 0,oggSrc:void 0,mp4Src:void 0,webmSrc:void 0,loaddone:!1,videoDrawing:void 0,canplaythrough:!1,state:"initial",constructor:function(a){this.addEvents("ready","ended","timeupdate","bufferingupdate","statechange","error");this.connect(this,"unload",this.onVideoUnload);if(void 0!==a.oggSrc||void 0!==a.mp4Src||void 0!==a.webmSrc)void 0!==a.oggSrc&&Ui.Video.supportOgg?this.setSrc(a.oggSrc):void 0!==a.mp4Src&&Ui.Video.supportMp4?this.setSrc(a.mp4Src):
void 0!==a.webmSrc&&Ui.Video.supportWebm&&this.setSrc(a.webmSrc),delete a.oggSrc,delete a.mp4Src,delete a.webmSrc},setSrc:function(a){this.canplaythrough=!1;this.state="initial";this.src=a;"object"===typeof a?this.videoDrawing.src=URL.createObjectURL(a):this.videoDrawing.setAttribute("src",a);try{this.videoDrawing.load()}catch(b){}},setPoster:function(a){this.poster=a;this.videoDrawing.setAttribute("poster",a)},setAutoplay:function(a){this.videoDrawing.autoplay=a},play:function(){this.state="playing";
this.fireEvent("statechange",this,this.state);this.canplaythrough?this.videoDrawing.play():this.videoDrawing.load()},pause:function(){this.state="paused";this.fireEvent("statechange",this,this.state);this.canplaythrough?this.videoDrawing.pause():this.videoDrawing.load()},stop:function(){this.videoDrawing.pause();this.onEnded()},setVolume:function(a){this.videoDrawing.volume=a},getVolume:function(){return this.videoDrawing.volume},getDuration:function(){return this.videoDrawing.duration},setCurrentTime:function(a){this.videoDrawing.currentTime=
a},getCurrentTime:function(){return void 0===this.videoDrawing.currentTime?0:this.videoDrawing.currentTime},getState:function(){return this.state},getIsReady:function(){return this.canplaythrough},getNaturalWidth:function(){return this.naturalWidth},getNaturalHeight:function(){return this.naturalHeight},onReady:function(){this.canplaythrough=!0;this.naturalWidth=this.videoDrawing.videoWidth;this.naturalHeight=this.videoDrawing.videoHeight;"playing"==this.state?this.videoDrawing.play():"paused"==this.state&&
this.videoDrawing.pause();this.fireEvent("ready")},onTimeUpdate:function(){this.fireEvent("timeupdate",this,this.videoDrawing.currentTime);this.checkBuffering()},onEnded:function(){this.videoDrawing.pause();this.state="initial";this.videoDrawing.currentTime=0;this.fireEvent("ended",this);this.fireEvent("statechange",this,this.state)},onProgress:function(){this.checkBuffering()},getCurrentBufferSize:function(){var a=this.videoDrawing.buffered,b=0,c=this.videoDrawing.currentTime;void 0===c&&(c=0);for(var d,
e=0;e<a.length;e++){var f=a.start(e),g=a.end(e);void 0===d?f<=c&&g>=c&&(b=g-c,d=g):d>=f-0.01&&d<=g&&(b+=g-d,d=g)}return b},checkBuffering:function(){var a=this.getCurrentBufferSize();this.fireEvent("bufferingupdate",this,a)},onError:function(){this.state="error";this.fireEvent("error",this,this.videoDrawing.error.code);this.fireEvent("statechange",this,this.state)},onWaiting:function(){this.canplaythrough||this.videoDrawing.load()},onVideoUnload:function(){this.canplaythrough&&this.pause();this.videoDrawing.removeAttribute("src");
try{this.videoDrawing.load()}catch(a){}}},{renderDrawing:function(){Ui.Video.htmlVideo&&(this.videoDrawing=document.createElement("video"),this.connect(this.videoDrawing,"canplaythrough",this.onReady),this.connect(this.videoDrawing,"ended",this.onEnded),this.connect(this.videoDrawing,"timeupdate",this.onTimeUpdate),this.connect(this.videoDrawing,"error",this.onError),this.connect(this.videoDrawing,"progress",this.onProgress),this.connect(this.videoDrawing,"waiting",this.onWaiting),this.videoDrawing.setAttribute("preload",
"auto"),this.videoDrawing.load(),this.videoDrawing.style.position="absolute",this.videoDrawing.style.left="0px",this.videoDrawing.style.top="0px");return this.videoDrawing},arrangeCore:function(a,b){Ui.Video.htmlVideo&&(this.videoDrawing.setAttribute("width",a),this.videoDrawing.setAttribute("height",b))}});Ui.Video.htmlVideo=!1;Ui.Video.flashVideo=!1;Ui.Video.supportOgg=!1;Ui.Video.supportMp4=!1;Ui.Video.supportWebm=!1;Ui.Video.videoTest=document.createElement("video");
void 0!==Ui.Video.videoTest.play&&(Ui.Video.htmlVideo=!0,Ui.Video.supportMp4=!!Ui.Video.videoTest.canPlayType&&""!==Ui.Video.videoTest.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'),Ui.Video.supportOgg=!!Ui.Video.videoTest.canPlayType&&""!==Ui.Video.videoTest.canPlayType('video/ogg; codecs="theora, vorbis"'),Ui.Video.supportWebm=!!Ui.Video.videoTest.canPlayType&&""!==Ui.Video.videoTest.canPlayType('video/webm; codecs="vp8, vorbis"'));delete Ui.Video.videoTest;Ui.LBox.extend("Ui.Overable",{watcher:void 0,constructor:function(a){this.addEvents("enter","leave","move");this.connect(this,"ptrmove",function(a){!this.getIsDisabled()&&(!a.pointer.getIsDown()&&void 0===this.watcher)&&(this.watcher=a.pointer.watch(this),this.fireEvent("enter",this),this.connect(this.watcher,"move",function(){this.watcher.getIsInside()||this.watcher.cancel()}),this.connect(this.watcher,"down",function(){this.watcher.cancel()}),this.connect(this.watcher,"up",function(){this.watcher.cancel()}),
this.connect(this.watcher,"cancel",function(){this.watcher=void 0;this.fireEvent("leave",this)}))})},getIsOver:function(){return void 0!==this.watcher}});Ui.Overable.extend("Ui.Pressable",{lock:!1,lastTime:void 0,constructor:function(a){this.addEvents("press","down","up","activate");this.getDrawing().style.cursor="pointer";this.setFocusable(!0);this.setRole("button");this.connect(this,"ptrdown",this.onPointerDown);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.connect(this.getDrawing(),"keyup",this.onKeyUp)},getIsDown:function(){return this.isDown},setLock:function(a){(this.lock=a)?this.getDrawing().style.cursor="":this.getDrawing().style.cursor=
"pointer"},getLock:function(){return this.lock},press:function(){this.onPress()},activate:function(){this.onActivate()},onMouseOver:function(a){void 0!==this.task?(this.task.abort(),this.task=void 0):(this.isOver=!0,this.fireEvent("enter",this))},onMouseOut:function(a){this.task=new Core.DelayedTask({delay:0,scope:this,callback:this.onDelayedMouseOut})},onDelayedMouseOut:function(a){this.isOver=!1;this.fireEvent("leave",this);this.task=void 0},onPointerDown:function(a){if(!this.getIsDisabled()&&!this.isDown&&
!this.lock){var b=a.pointer.watch(this);this.connect(b,"move",function(){b.pointer.getIsMove()&&b.cancel()});this.connect(b,"up",function(a){this.onUp();this.onPress(a.pointer.getX(),a.pointer.getY());var d=(new Date).getTime()/1E3;if(void 0!==this.lastTime&&0.3>d-this.lastTime)this.onActivate(a.pointer.getX(),a.pointer.getY());this.lastTime=d;b.capture()});this.connect(b,"cancel",function(){this.onUp()});this.onDown()}},onKeyDown:function(a){13==a.which&&(!this.getIsDisabled()&&!this.lock)&&(a.preventDefault(),
a.stopPropagation(),this.onDown())},onKeyUp:function(a){var b=a.which;this.isDown&&(13==b&&!this.getIsDisabled()&&!this.lock)&&(a.preventDefault(),a.stopPropagation(),this.onUp(),this.onPress())},onDown:function(){this.isDown=!0;this.fireEvent("down",this)},onUp:function(){this.isDown=!1;this.fireEvent("up",this)},onPress:function(a,b){this.fireEvent("press",this,a,b)},onActivate:function(a,b){this.fireEvent("activate",this)}},{onDisable:function(){Ui.Pressable.base.onDisable.apply(this,arguments);
this.getDrawing().style.cursor=""},onEnable:function(){Ui.Pressable.base.onEnable.apply(this,arguments);this.lock?this.getDrawing().style.cursor="":this.getDrawing().style.cursor="pointer"}});Ui.Pressable.extend("Ui.Uploadable",{content:void 0,input:void 0,constructor:function(a){this.getDrawing().style.cursor="pointer";this.setFocusable(!0);this.setRole("button");this.addEvents("file");this.input=new Ui.UploadableFileWrapper;this.append(this.input);this.connect(this.input,"file",this.onFile)},setDirectoryMode:function(a){this.input.setDirectoryMode(a)},onFile:function(a,b){this.fireEvent("file",this,b)}},{onPress:function(){Ui.UploadableFileWrapper.hasInstance(this.input)&&this.input.select()},
setContent:function(a){this.content!==a&&(void 0!==this.content&&this.remove(this.content),void 0!==a&&(Ui.UploadableWrapper.hasInstance(this.input)?this.prepend(a):this.append(a)),this.content=a)}});
Ui.Element.extend("Ui.UploadableFileWrapper",{formDrawing:void 0,inputDrawing:void 0,iframeDrawing:void 0,directoryMode:!1,constructor:function(a){this.setOpacity(0);this.setClipToBounds(!0);this.addEvents("file")},select:function(){this.inputDrawing.click()},setDirectoryMode:function(a){this.directoryMode=a;void 0!==this.inputDrawing&&(this.directoryMode?this.inputDrawing.setAttribute("webkitdirectory",""):this.inputDrawing.removeAttribute("webkitdirectory"))},createInput:function(){this.formDrawing=
document.createElement("form");this.connect(this.formDrawing,"click",function(a){a.stopPropagation()});this.connect(this.formDrawing,"touchstart",function(a){a.stopPropagation()});this.formDrawing.method="POST";this.formDrawing.enctype="multipart/form-data";this.formDrawing.encoding="multipart/form-data";this.formDrawing.style.position="absolute";this.inputDrawing=document.createElement("input");this.inputDrawing.type="file";this.inputDrawing.setAttribute("name","file");this.directoryMode&&this.inputDrawing.setAttribute("webkitdirectory",
"");this.inputDrawing.style.position="absolute";this.inputDrawing.tabIndex=-1;this.connect(this.inputDrawing,"change",this.onChange);this.formDrawing.appendChild(this.inputDrawing);if(navigator.supportFileAPI){for(;0<this.getDrawing().childNodes.length;)this.getDrawing().removeChild(this.getDrawing().childNodes[0]);this.getDrawing().appendChild(this.formDrawing);this.arrangeCore(this.getLayoutX(),this.getLayoutY(),this.getLayoutWidth(),this.getLayoutHeight())}else this.iframeDrawing=document.createElement("iframe"),
this.iframeDrawing.style.position="absolute",this.iframeDrawing.style.top="0px",this.iframeDrawing.style.left="0px",this.iframeDrawing.style.width="0px",this.iframeDrawing.style.height="0px",this.iframeDrawing.style.clip="rect(0px 0px 0px 0px)",document.body.appendChild(this.iframeDrawing),this.iframeDrawing.contentWindow.document.write("<!DOCTYPE html><html><body></body></html>"),this.iframeDrawing.contentWindow.document.body.appendChild(this.formDrawing)},onChange:function(a){a.preventDefault();
a.stopPropagation();if(navigator.supportFileAPI)for(a=0;a<this.inputDrawing.files.length;a++)this.fireEvent("file",this,new Core.File({fileApi:this.inputDrawing.files[a]}));else this.disconnect(this.inputDrawing,"change",this.onChange),a=new Core.File({iframe:this.iframeDrawing,form:this.formDrawing,fileInput:this.inputDrawing}),this.createInput(),this.fireEvent("file",this,a)}},{onLoad:function(){Ui.UploadableFileWrapper.base.onLoad.call(this);this.createInput()},onUnload:function(){this.disconnect(this.inputDrawing,
"change",this.onChange);void 0!==this.iframeDrawing&&document.body.removeChild(this.iframeDrawing);Ui.UploadableFileWrapper.base.onUnload.call(this)},arrangeCore:function(a,b){Ui.UploadableFileWrapper.base.arrangeCore.apply(this,arguments);void 0!==this.formDrawing&&(this.formDrawing.style.top="0px",this.formDrawing.style.left="0px",this.formDrawing.style.width=Math.round(a)+"px",this.formDrawing.style.height=Math.round(b)+"px");void 0!==this.inputDrawing&&(this.inputDrawing.style.top="0px",this.inputDrawing.style.left=
"0px",this.inputDrawing.style.width=Math.round(a)+"px",this.inputDrawing.style.height=Math.round(b)+"px")}});
Ui.Element.extend("Ui.UploadableWrapper",{formDrawing:void 0,inputDrawing:void 0,directoryMode:!1,constructor:function(a){this.setClipToBounds(!0);this.setOpacity(0);this.addEvents("file")},setDirectoryMode:function(a){},createInput:function(){this.formDrawing=document.createElement("form");this.formDrawing.method="POST";this.formDrawing.enctype="multipart/form-data";this.formDrawing.encoding="multipart/form-data";this.formDrawing.style.display="block";this.formDrawing.style.position="absolute";this.formDrawing.style.left=
"0px";this.formDrawing.style.top="0px";this.formDrawing.style.width=this.getLayoutWidth()+"px";this.formDrawing.style.height=this.getLayoutHeight()+"px";this.inputDrawing=document.createElement("input");this.inputDrawing.type="file";this.inputDrawing.name="file";this.inputDrawing.tabIndex=-1;this.inputDrawing.style.fontSize="200px";this.inputDrawing.style.display="block";this.inputDrawing.style.cursor="pointer";this.inputDrawing.style.position="absolute";this.inputDrawing.style.left="0px";this.inputDrawing.style.top=
"0px";this.inputDrawing.style.width=this.getLayoutWidth()+"px";this.inputDrawing.style.height=this.getLayoutHeight()+"px";this.formDrawing.appendChild(this.inputDrawing);this.connect(this.inputDrawing,"change",this.onChange);navigator.isWebkit&&(this.inputDrawing.style.webkitUserSelect="none");this.connect(this.inputDrawing,"touchstart",function(a){a.dontPreventDefault=!0});this.connect(this.inputDrawing,"touchend",function(a){a.dontPreventDefault=!0});return this.formDrawing},onChange:function(a){if(!navigator.isOpera&&
navigator.supportFileAPI)for(a=0;a<this.inputDrawing.files.length;a++)this.fireEvent("file",this,new Core.File({fileApi:this.inputDrawing.files[a]}));else this.getDrawing().removeChild(this.formDrawing),a=document.createElement("iframe"),a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style.width="0px",a.style.height="0px",a.style.clip="rect(0px 0px 0px 0px)",document.body.appendChild(a),a.contentWindow.document.write("<!DOCTYPE html><html><body></body></html>"),a.contentWindow.document.body.appendChild(this.formDrawing),
this.disconnect(this.inputDrawing,"change",this.onChange),this.fireEvent("file",this,new Core.File({iframe:a,form:this.formDrawing,fileInput:this.inputDrawing})),this.getDrawing().appendChild(this.createInput())}},{renderDrawing:function(){Ui.UploadableWrapper.base.renderDrawing.apply(this,arguments).appendChild(this.createInput())},arrangeCore:function(a,b){this.formDrawing.style.width=Math.round(a)+"px";this.formDrawing.style.height=Math.round(b)+"px";this.inputDrawing.style.width=Math.round(a)+
"px";this.inputDrawing.style.height=Math.round(b)+"px"}});navigator.supportFormData=!0;try{new FormData}catch(err$$4){navigator.supportFormData=!1}Ui.Uploadable.testInput=document.createElement("input");navigator.supportFileAPI="files"in Ui.Uploadable.testInput;navigator.supportUploadDirectory="webkitdirectory"in Ui.Uploadable.testInput;delete Ui.Uploadable.testInput;Ui.Container.extend("Ui.MovableBase",{moveHorizontal:!0,moveVertical:!0,posX:0,posY:0,isMoving:!1,speedX:0,speedY:0,startPosX:void 0,startPosY:void 0,inertiaClock:void 0,inertia:!1,isDown:!1,lock:!1,isInMoveEvent:!1,cumulMove:0,constructor:function(a){this.addEvents("down","up","move");this.connect(this,"ptrdown",this.onPointerDown)},setLock:function(a){(this.lock=a)&&this.stopInertia()},getLock:function(){return this.lock},getIsDown:function(){return this.isDown},getInertia:function(){return this.inertia},
setInertia:function(a){this.inertia=a},getMoveHorizontal:function(){return this.moveHorizontal},setMoveHorizontal:function(a){this.moveHorizontal=a},getMoveVertical:function(){return this.moveVertical},setMoveVertical:function(a){this.moveVertical=a},setPosition:function(a,b,c){void 0!==a&&this.moveHorizontal&&(isNaN(a)?this.posX=0:this.posX=a);void 0!==b&&this.moveVertical&&(isNaN(b)?this.posY=0:this.posY=b);!this.isInMoveEvent&&!0!==c&&(this.isInMoveEvent=!0,this.fireEvent("move",this),this.onMove(this.posX,
this.posY),this.isInMoveEvent=!1)},getPositionX:function(){return this.posX},getPositionY:function(){return this.posY},onMove:function(a,b){},onDown:function(){this.cumulMove=0;this.isDown=!0;this.fireEvent("down",this)},onUp:function(a){this.isDown=!1;this.fireEvent("up",this,this.speedX,this.speedY,this.posX-this.startPosX,this.posY-this.startPosY,this.cumulMove,a)},onPointerDown:function(a){if(!this.isDown&&!this.getIsDisabled()&&!this.lock){this.stopInertia();this.startPosX=this.posX;this.startPosY=
this.posY;this.onDown(!1);var b=a.pointer.watch(this);this.connect(b,"move",function(){if(b.getIsCaptured())d=b.getDelta(),this.setPosition(this.startPosX+d.x,this.startPosY+d.y);else if(b.pointer.getIsMove()){var a=b.getDelta(),d=Math.sqrt(a.x*a.x+a.y*a.y);this.setPosition(this.startPosX+a.x,this.startPosY+a.y);var a=this.posX-this.startPosX,e=this.posY-this.startPosY,a=Math.sqrt(a*a+e*e),e=0;0<d&&(e=a/d);0.7<e?b.capture():(this.setPosition(this.startPosX,this.startPosY),b.cancel())}});this.connect(b,
"up",function(){this.cumulMove=b.pointer.getCumulMove();var a=b.getSpeed();this.speedX=a.x;this.speedY=a.y;this.inertia&&this.startInertia();this.onUp(!1)});this.connect(b,"cancel",function(){this.onUp(!0)})}},startInertia:function(){void 0===this.inertiaClock&&(this.inertiaClock=new Anim.Clock({duration:"forever",target:this}),this.connect(this.inertiaClock,"timeupdate",function(a,b,c){0!==c&&(a=this.posX,b=this.posY,this.setPosition(this.posX+this.speedX*c,this.posY+this.speedY*c),this.posX==a&&
this.posY==b?this.stopInertia():(this.speedX-=3*this.speedX*c,this.speedY-=3*this.speedY*c,0.1>Math.abs(this.speedX)&&(this.speedX=0),0.1>Math.abs(this.speedY)&&(this.speedY=0),0===this.speedX&&0===this.speedY&&this.stopInertia()))}),this.inertiaClock.begin())},stopInertia:function(){void 0!==this.inertiaClock&&(this.inertiaClock.stop(),this.inertiaClock=void 0)}});Ui.MovableBase.extend("Ui.Movable",{constructor:function(a){this.setFocusable(!0);this.contentBox=new Ui.LBox;this.appendChild(this.contentBox);this.contentBox.getDrawing().style.cursor="move";this.connect(this.getDrawing(),"keydown",this.onKeyDown)},onKeyDown:function(a){if(!this.getIsDisabled()){var b=a.which;if((37==b||39==b)&&this.moveHorizontal)a.preventDefault(),a.stopPropagation(),37==b&&this.setPosition(this.posX-10,void 0),39==b&&this.setPosition(this.posX+10,void 0);if((38==b||40==b)&&this.moveVertical)a.preventDefault(),
a.stopPropagation(),38==b&&this.setPosition(void 0,this.posY-10),40==b&&this.setPosition(void 0,this.posY+10)}}},{onMove:function(a,b){this.contentBox.setTransform(Ui.Matrix.createTranslate(this.posX,this.posY))},measureCore:function(a,b){return this.contentBox.measure(a,b)},arrangeCore:function(a,b){this.getDrawing().style.width="1px";this.getDrawing().style.height="1px";this.contentBox.arrange(0,0,a,b)},getContent:function(){return this.contentBox.getChildren()[0]},setContent:function(a){this.contentBox.setContent(a)},
onDisable:function(){this.contentBox.getDrawing().style.cursor="inherit"},onEnable:function(){this.contentBox.getDrawing().style.cursor="move"}});Ui.LBox.extend("Ui.Transformable",{inertia:!1,inertiaClock:void 0,contentBox:void 0,isDown:!1,transformLock:!1,watcher1:void 0,watcher2:void 0,angle:0,scale:1,translateX:0,translateY:0,startAngle:0,startScale:0,startTranslateX:0,startTranslateY:0,allowScale:!0,minScale:0.1,maxScale:10,allowRotate:!0,allowTranslate:!0,speedX:0,speedY:0,constructor:function(a){this.addEvents("down","up","transform","inertiastart","inertiaend");this.setFocusable(!0);this.contentBox=new Ui.LBox;this.contentBox.setTransformOrigin(0,
0,!0);this.appendChild(this.contentBox);this.connect(this,"ptrdown",this.onPointerDown);this.connect(this,"wheel",this.onWheel)},setAllowScale:function(a){this.allowScale=a},setMinScale:function(a){this.minScale=a},setMaxScale:function(a){this.maxScale=a},setAllowRotate:function(a){this.allowRotate=a},setAllowTranslate:function(a){this.allowTranslate=a},getIsDown:function(){return this.isDown},getIsInertia:function(){return void 0!==this.inertiaClock},getAngle:function(){return this.angle},setAngle:function(a){this.setContentTransform(void 0,
void 0,void 0,a)},getScale:function(){return this.scale},setScale:function(a){this.setContentTransform(void 0,void 0,a,void 0)},getTranslateX:function(){return this.translateX},setTranslateX:function(a){this.setContentTransform(a,void 0,void 0,void 0)},getTranslateY:function(){return this.translateY},setTranslateY:function(a){this.setContentTransform(void 0,a,void 0,void 0)},buildMatrix:function(a,b,c,d){void 0===a&&(a=this.translateX);void 0===b&&(b=this.translateY);void 0===c&&(c=this.scale);void 0===
d&&(d=this.angle);return Ui.Matrix.createTranslate(this.getLayoutWidth()*this.transformOriginX,this.getLayoutHeight()*this.transformOriginX).translate(a,b).scale(c,c).rotate(d).translate(-this.getLayoutWidth()*this.transformOriginX,-this.getLayoutHeight()*this.transformOriginX)},getMatrix:function(){return Ui.Matrix.createTranslate(this.getLayoutWidth()*this.transformOriginX,this.getLayoutHeight()*this.transformOriginX).translate(this.translateX,this.translateY).scale(this.scale,this.scale).rotate(this.angle).translate(-this.getLayoutWidth()*
this.transformOriginX,-this.getLayoutHeight()*this.transformOriginX)},getBoundaryBox:function(a){void 0===a&&(a=this.getMatrix());var b=(new Ui.Point({x:0,y:0})).multiply(a),c=(new Ui.Point({x:this.getLayoutWidth(),y:0})).multiply(a),d=(new Ui.Point({x:this.getLayoutWidth(),y:this.getLayoutHeight()})).multiply(a),e=(new Ui.Point({x:0,y:this.getLayoutHeight()})).multiply(a);a=Math.min(b.x,Math.min(c.x,Math.min(d.x,e.x)));var f=Math.min(b.y,Math.min(c.y,Math.min(d.y,e.y))),g=Math.max(b.x,Math.max(c.x,
Math.max(d.x,e.x))),b=Math.max(b.y,Math.max(c.y,Math.max(d.y,e.y)));return{x:a,y:f,width:g-a,height:b-f}},setContentTransform:function(a,b,c,d){void 0===a&&(a=this.translateX);void 0===b&&(b=this.translateY);void 0===c&&(c=this.scale);void 0===d&&(d=this.angle);this.translateX=a;this.translateY=b;this.scale=c;this.angle=d;this.transformLock||(this.transformLock=!0,this.fireEvent("transform",this),a=!((void 0===this.watcher1||this.watcher1.getIsCaptured())&&(void 0===this.watcher2||this.watcher2.getIsCaptured())),
this.onContentTransform(a),this.transformLock=!1)},onContentTransform:function(a){!0!==a&&this.contentBox.setTransform(this.getMatrix())},onDown:function(){this.isDown=!0;this.fireEvent("down",this)},onUp:function(){this.isDown=!1;this.fireEvent("up",this)},onPointerDown:function(a){this.stopInertia();if(void 0===this.watcher1){if(this.allowTranslate)this.onDown();this.watcher1=a=a.pointer.watch(this);this.connect(a,"move",this.onPointerMove);this.connect(a,"up",this.onPointerUp);this.connect(a,"cancel",
this.onPointerCancel);this.startAngle=this.angle;this.startScale=this.scale;this.startTranslateX=this.translateX;this.startTranslateY=this.translateY}else if(void 0===this.watcher2){if(!this.allowTranslate)this.onDown();this.watcher1.pointer.setInitialPosition(this.watcher1.pointer.getX(),this.watcher1.pointer.getY());this.watcher2=a=a.pointer.watch(this);this.connect(a,"move",this.onPointerMove);this.connect(a,"up",this.onPointerUp);this.connect(a,"cancel",this.onPointerUp);this.startAngle=this.angle;
this.startScale=this.scale;this.startTranslateX=this.translateX;this.startTranslateY=this.translateY}},onPointerMove:function(a){var b,c,d;if(void 0!==this.watcher1&&void 0!==this.watcher2){!this.watcher1.getIsCaptured()&&this.watcher1.pointer.getIsMove()&&this.watcher1.capture();!this.watcher2.getIsCaptured()&&this.watcher2.pointer.getIsMove()&&this.watcher2.capture();b=this.pointFromWindow({x:this.watcher1.pointer.getX(),y:this.watcher1.pointer.getY()});c=this.pointFromWindow({x:this.watcher2.pointer.getX(),
y:this.watcher2.pointer.getY()});a=this.pointFromWindow({x:this.watcher1.pointer.getInitialX(),y:this.watcher1.pointer.getInitialY()});d=this.pointFromWindow({x:this.watcher2.pointer.getInitialX(),y:this.watcher2.pointer.getInitialY()});var e=d.x-a.x;d=d.y-a.y;var f,g=c.x-b.x,l=c.y-b.y,k;f=Math.sqrt(e*e+d*d);k=Math.sqrt(g*g+l*l);c=k/f;e/=f;d/=f;g/=k;l/=k;e=-(180*Math.atan2(d*g-e*l,e*g+d*l))/Math.PI;b=Ui.Matrix.createTranslate(b.x-a.x,b.y-a.y).translate(a.x,a.y);if(this.allowScale){if(void 0!==this.minScale||
void 0!==this.maxScale)c*=this.startScale,void 0!==this.minScale&&c<this.minScale&&(c=this.minScale),void 0!==this.maxScale&&c>this.maxScale&&(c=this.maxScale),c/=this.startScale;b=b.scale(c,c)}else c=1;this.allowRotate?b=b.rotate(e):e=0;b=b.translate(-a.x,-a.y);a=new Ui.Point({x:this.getLayoutWidth()*this.transformOriginX,y:this.getLayoutHeight()*this.transformOriginX});b=b.translate(a.x,a.y).translate(this.startTranslateX,this.startTranslateY).scale(this.startScale,this.startScale).rotate(this.startAngle).translate(-a.x,
-a.y);a=a.multiply(b);this.setContentTransform(a.x-this.getLayoutWidth()*this.transformOriginX,a.y-this.getLayoutHeight()*this.transformOriginY,this.startScale*c,this.startAngle+e)}else void 0!==this.watcher1&&this.allowTranslate&&(b=this.pointFromWindow({x:this.watcher1.pointer.getX(),y:this.watcher1.pointer.getY()}),a=this.pointFromWindow({x:this.watcher1.pointer.getInitialX(),y:this.watcher1.pointer.getInitialY()}),c=b.x-a.x,e=b.y-a.y,c=Math.sqrt(c*c+e*e),this.setContentTransform(this.startTranslateX+
(b.x-a.x),this.startTranslateY+(b.y-a.y),this.startScale,this.startAngle),a=this.translateX-this.startTranslateX,b=this.translateY-this.startTranslateY,a=Math.sqrt(a*a+b*b),b=0,0<c&&(b=a/c),!this.watcher1.getIsCaptured()&&(this.watcher1.pointer.getIsMove()&&0.7<b)&&this.watcher1.capture())},onPointerCancel:function(a){this.onPointerUp(a);this.stopInertia();this.angle=this.startAngle;this.scale=this.startScale;this.translateX=this.startTranslateX;this.translateY=this.startTranslateY},onPointerUp:function(a){if(void 0!==
this.watcher1&&this.watcher1===a)if(void 0!==this.watcher2){if(this.watcher1=this.watcher2,this.watcher2=void 0,this.watcher1.pointer.setInitialPosition(this.watcher1.pointer.getX(),this.watcher1.pointer.getY()),this.startAngle=this.angle,this.startScale=this.scale,this.startTranslateX=this.translateX,this.startTranslateY=this.translateY,!this.allowTranslate)this.onUp()}else{if(this.allowTranslate)this.onUp();var b=this.watcher1.getSpeed();this.speedX=b.x;this.speedY=b.y;this.watcher1=void 0;this.startInertia()}if(void 0!==
this.watcher2&&this.watcher2===a&&(this.watcher2=void 0,this.watcher1.pointer.setInitialPosition(this.watcher1.pointer.getX(),this.watcher1.pointer.getY()),this.startAngle=this.angle,this.startScale=this.scale,this.startTranslateX=this.translateX,this.startTranslateY=this.translateY,!this.allowTranslate))this.onUp()},onWheel:function(a){var b=0,b=a.deltaX+a.deltaY;if(a.altKey){if(this.allowRotate){var c=b/5,d=this.pointFromWindow({x:a.clientX,y:a.clientY}),b=new Ui.Point({x:this.getLayoutWidth()*
this.transformOriginX,y:this.getLayoutHeight()*this.transformOriginX}),d=Ui.Matrix.createTranslate(d.x,d.y).rotate(c,c).translate(-d.x,-d.y).translate(b.x,b.y).translate(this.translateX,this.translateY).scale(this.scale,this.scale).rotate(this.angle).translate(-b.x,-b.y),b=b.multiply(d);this.setContentTransform(b.x-this.getLayoutWidth()*this.transformOriginX,b.y-this.getLayoutHeight()*this.transformOriginY,this.scale,this.angle+c)}}else if(a.ctrlKey){if(this.allowScale){c=Math.pow(2,Math.log(this.scale)/
Math.log(2)-b/60);void 0!==this.minScale&&c<this.minScale&&(c=this.minScale);void 0!==this.maxScale&&c>this.maxScale&&(c=this.maxScale);var e=c/this.scale,d=this.pointFromWindow({x:a.clientX,y:a.clientY}),b=new Ui.Point({x:this.getLayoutWidth()*this.transformOriginX,y:this.getLayoutHeight()*this.transformOriginX}),d=Ui.Matrix.createTranslate(d.x,d.y).scale(e,e).translate(-d.x,-d.y).translate(b.x,b.y).translate(this.translateX,this.translateY).scale(this.scale,this.scale).rotate(this.angle).translate(-b.x,
-b.y),b=b.multiply(d);this.setContentTransform(b.x-this.getLayoutWidth()*this.transformOriginX,b.y-this.getLayoutHeight()*this.transformOriginY,c,this.angle)}}else return;a.stopPropagation()},getInertia:function(){return this.inertia},setInertia:function(a){this.inertia=a},startInertia:function(){void 0===this.inertiaClock&&this.inertia&&(this.inertiaClock=new Anim.Clock({duration:"forever",target:this}),this.connect(this.inertiaClock,"timeupdate",this.onTimeupdate),this.inertiaClock.begin(),this.fireEvent("inertiastart",
this))},onTimeupdate:function(a,b,c){0!==c&&(a=this.translateX,b=this.translateY,this.setContentTransform(this.translateX+this.speedX*c,this.translateY+this.speedY*c,void 0,void 0),this.translateX===a&&this.translateY===b?this.stopInertia():(this.speedX-=3*this.speedX*c,this.speedY-=3*this.speedY*c,0.1>Math.abs(this.speedX)&&(this.speedX=0),0.1>Math.abs(this.speedY)&&(this.speedY=0),0===this.speedX&&0===this.speedY&&this.stopInertia()))},stopInertia:function(){void 0!==this.inertiaClock&&(this.inertiaClock.stop(),
this.inertiaClock=void 0,this.setContentTransform(Math.round(this.translateX),Math.round(this.translateY),void 0,void 0),this.fireEvent("inertiaend",this))}},{getContent:function(a){return this.contentBox.getFirstChild()},setContent:function(a){this.contentBox.setContent(a)},arrangeCore:function(a,b){Ui.Transformable.base.arrangeCore.apply(this,arguments);this.onContentTransform()}});Ui.Container.extend("Ui.Scrollable",{contentBox:void 0,scrollHorizontal:!0,scrollVertical:!0,scrollbarHorizontalBox:void 0,scrollbarVerticalBox:void 0,showShadows:!1,lock:!1,isOver:!1,showClock:void 0,offsetX:0,offsetY:0,relativeOffsetX:0,relativeOffsetY:0,viewWidth:0,viewHeight:0,contentWidth:0,contentHeight:0,overWatcher:void 0,scrollLock:!1,constructor:function(a){this.addEvents("scroll");this.contentBox=new Ui.ScrollableContent;this.connect(this.contentBox,"scroll",this.onScroll);this.connect(this.contentBox,
"down",this.autoShowScrollbars);this.connect(this.contentBox,"inertiaend",this.autoHideScrollbars);this.appendChild(this.contentBox);this.scrollbarHorizontalBox=new Ui.Movable({moveVertical:!1});this.connect(this.scrollbarHorizontalBox,"down",this.autoShowScrollbars);this.connect(this.scrollbarHorizontalBox,"up",this.autoHideScrollbars);this.connect(this.scrollbarHorizontalBox,"move",this.onScrollbarHorizontalMove);this.appendChild(this.scrollbarHorizontalBox);this.scrollbarVerticalBox=new Ui.Movable({moveHorizontal:!1});
this.connect(this.scrollbarVerticalBox,"down",this.autoShowScrollbars);this.connect(this.scrollbarVerticalBox,"up",this.autoHideScrollbars);this.connect(this.scrollbarVerticalBox,"move",this.onScrollbarVerticalMove);this.appendChild(this.scrollbarVerticalBox);this.scrollbarHorizontalBox.setOpacity(0);this.scrollbarVerticalBox.setOpacity(0);this.connect(this,"ptrmove",function(a){!this.getIsDisabled()&&(!a.pointer.getIsDown()&&void 0===this.overWatcher)&&(this.overWatcher=a.pointer.watch(this),this.isOver=
!0,this.autoShowScrollbars(),this.connect(this.overWatcher,"move",function(){this.overWatcher.getIsInside()||this.overWatcher.cancel()}),this.connect(this.overWatcher,"down",function(){this.overWatcher.cancel()}),this.connect(this.overWatcher,"up",function(){this.overWatcher.cancel()}),this.connect(this.overWatcher,"cancel",function(){this.overWatcher=void 0;this.isOver=!1;this.autoHideScrollbars()}))});this.connect(this,"wheel",this.onWheel)},setMaxScale:function(a){this.contentBox.setMaxScale(a)},
setContent:function(a){this.contentBox.setContent(a)},getContent:function(){return this.contentBox.getContent()},getInertia:function(){return this.contentBox.getInertia()},setInertia:function(a){this.contentBox.setInertia(a)},getScrollHorizontal:function(){return this.scrollHorizontal},setScrollHorizontal:function(a){a!==this.scrollHorizontal&&(this.scrollHorizontal=a,this.invalidateMeasure())},getScrollVertical:function(){return this.scrollVertical},setScrollVertical:function(a){a!==this.scrollVertical&&
(this.scrollVertical=a,this.invalidateMeasure())},setScrollbarVertical:function(a){this.scrollbarVerticalBox.setContent(a)},setScrollbarHorizontal:function(a){this.scrollbarHorizontalBox.setContent(a)},setOffset:function(a,b,c,d){void 0===c&&(c=!1);void 0===a?a=this.offsetX:c||(a*=this.contentWidth-this.viewWidth);void 0===b?b=this.offsetY:c||(b*=this.contentHeight-this.viewHeight);0>a?a=0:this.viewWidth+a>this.contentWidth&&(a=this.contentWidth-this.viewWidth);0>b?b=0:this.viewHeight+b>this.contentHeight&&
(b=this.contentHeight-this.viewHeight);this.relativeOffsetX=this.contentWidth<=this.viewWidth?0:a/(this.contentWidth-this.viewWidth);this.relativeOffsetY=this.contentHeight<=this.viewHeight?0:b/(this.contentHeight-this.viewHeight);return this.offsetX!==a||this.offsetY!==b?(this.offsetX=a,this.offsetY=b,this.contentBox.setOffset(a,b),!0):!1},getOffsetX:function(){return this.contentBox.getOffsetX()},getRelativeOffsetX:function(){return this.relativeOffsetX},getOffsetY:function(){return this.contentBox.getOffsetY()},
getRelativeOffsetY:function(){return this.relativeOffsetY},getScale:function(){return this.contentBox.getScale()},setScale:function(a){this.contentBox.setScale(a)},getIsDown:function(){return this.contentBox.getIsDown()},getIsInertia:function(){return this.contentBox.getIsInertia()},onWheel:function(a){this.setOffset(this.contentBox.getOffsetX()+3*a.deltaX,this.contentBox.getOffsetY()+3*a.deltaY,!0)&&a.stopPropagation()},autoShowScrollbars:function(){void 0===this.showClock&&(this.showClock=new Anim.Clock({duration:"forever"}),
this.connect(this.showClock,"timeupdate",this.onShowBarsTick),this.showClock.begin())},autoHideScrollbars:function(){!this.contentBox.getIsDown()&&(!this.contentBox.getIsInertia()&&!this.isOver)&&void 0===this.showClock&&(this.showClock=new Anim.Clock({duration:"forever"}),this.connect(this.showClock,"timeupdate",this.onShowBarsTick),this.showClock.begin())},onShowBarsTick:function(a,b,c){a=this.contentBox.getIsDown()||this.contentBox.getIsInertia()||this.isOver||this.scrollbarVerticalBox.getIsDown()||
this.scrollbarHorizontalBox.getIsDown();b=!1;var d=this.scrollbarHorizontalBox.getOpacity();a?(d+=2*c,1<=d&&(d=1,b=!0)):(d-=2*c,0>=d&&(d=0,b=!0));this.scrollbarHorizontalBox.setOpacity(d);this.scrollbarVerticalBox.setOpacity(d);b&&(this.showClock.stop(),this.showClock=void 0)},onScroll:function(){this.updateOffset();this.fireEvent("scroll",this,this.offsetX,this.offsetY)},updateOffset:function(){if(void 0!==this.contentBox){this.offsetX=this.contentBox.getOffsetX();this.offsetY=this.contentBox.getOffsetY();
this.viewWidth=this.getLayoutWidth();this.viewHeight=this.getLayoutHeight();this.contentWidth=this.contentBox.getContentWidth();this.contentHeight=this.contentBox.getContentHeight();this.relativeOffsetX=this.contentWidth<=this.viewWidth?0:this.offsetX/(this.contentWidth-this.viewWidth);this.relativeOffsetY=this.contentHeight<=this.viewHeight?0:this.offsetY/(this.contentHeight-this.viewHeight);this.scrollbarVerticalNeeded=this.contentHeight>this.viewHeight?!0:!1;this.scrollbarHorizontalNeeded=this.contentWidth>
this.viewWidth?!0:!1;this.scrollbarVerticalNeeded?(this.scrollbarVerticalHeight=Math.max(this.viewHeight/this.contentHeight*this.viewHeight,this.scrollbarVerticalBox.getMeasureHeight()),this.scrollbarVerticalBox.arrange(this.getLayoutWidth()-this.scrollbarVerticalBox.getMeasureWidth(),0,this.scrollbarVerticalBox.getMeasureWidth(),this.scrollbarVerticalHeight),this.scrollbarVerticalBox.show()):(this.scrollbarVerticalBox.hide(),this.offsetY=0);this.scrollbarHorizontalNeeded?(this.scrollbarHorizontalWidth=
Math.max(this.viewWidth/this.contentWidth*this.viewWidth,this.scrollbarHorizontalBox.getMeasureWidth()),this.scrollbarHorizontalBox.arrange(0,this.getLayoutHeight()-this.scrollbarHorizontalBox.getMeasureHeight(),this.scrollbarHorizontalWidth,this.scrollbarHorizontalBox.getMeasureHeight()),this.scrollbarHorizontalBox.show()):(this.scrollbarHorizontalBox.hide(),this.offsetX=0);this.scrollLock=!0;if(this.scrollbarHorizontalNeeded){var a=this.offsetX/(this.contentWidth-this.viewWidth);1<a&&(a=1,this.setOffset(a,
void 0));this.scrollbarHorizontalBox.setPosition((this.viewWidth-this.scrollbarHorizontalWidth)*a,void 0)}this.scrollbarVerticalNeeded&&(a=this.offsetY/(this.contentHeight-this.viewHeight),1<a&&(a=1,this.setOffset(void 0,a)),this.scrollbarVerticalBox.setPosition(void 0,(this.viewHeight-this.scrollbarVerticalHeight)*a));this.scrollLock=!1}},onScrollbarHorizontalMove:function(a){if(!this.scrollLock){var b=this.viewWidth-this.scrollbarHorizontalBox.getLayoutWidth(),c=Math.min(1,Math.max(0,a.getPositionX()/
b));this.setOffset(c,void 0);a.setPosition(c*b,void 0)}},onScrollbarVerticalMove:function(a){if(!this.scrollLock){var b=this.viewHeight-this.scrollbarVerticalBox.getLayoutHeight(),c=Math.min(1,Math.max(0,a.getPositionY()/b));this.setOffset(void 0,c);a.setPosition(void 0,c*b)}}},{onScrollIntoView:function(a){var b=Ui.Matrix.createTranslate(this.offsetX,this.offsetY).multiply(a.transformToElement(this)),c=(new Ui.Point({x:0,y:0})).multiply(b),b=(new Ui.Point({x:a.getLayoutWidth(),y:a.getLayoutHeight()})).multiply(b);
if(c.y<this.offsetY||c.y>this.offsetY+this.viewHeight||b.y>this.offsetY+this.viewHeight)Math.abs(this.offsetY+this.viewHeight-b.y)<Math.abs(this.offsetY-c.y)?this.setOffset(this.offsetX,b.y-this.viewHeight,!0):this.setOffset(this.offsetX,c.y,!0),this.contentBox.stopInertia();if(c.x<this.offsetX||c.x>this.offsetX+this.viewWidth||b.x>this.offsetX+this.viewWidth)Math.abs(this.offsetX+this.viewWidth-b.x)<Math.abs(this.offsetX-c.x)?this.setOffset(b.x-this.viewWidth,this.offsetY,!0):this.setOffset(c.x,
this.offsetY,!0),this.contentBox.stopInertia();Ui.Scrollable.base.onScrollIntoView.apply(this,arguments)},measureCore:function(a,b){var c={width:0,height:0};this.scrollbarHorizontalBox.measure(a,b);this.scrollbarVerticalBox.measure(a,b);var d=this.contentBox.measure(a,b);c.width=d.width<a?d.width:a;c.height=d.height<b?d.height:b;this.scrollVertical||(c.height=d.height);this.scrollHorizontal||(c.width=d.width);return c},arrangeCore:function(a,b){this.viewWidth=a;this.viewHeight=b;this.contentBox.arrange(0,
0,this.viewWidth,this.viewHeight);this.contentWidth=this.contentBox.getContentWidth();this.contentHeight=this.contentBox.getContentHeight();this.updateOffset()}});
Ui.Transformable.extend("Ui.ScrollableContent",{contentWidth:0,contentHeight:0,constructor:function(a){this.addEvents("scroll");this.setClipToBounds(!0);this.connect(this.getDrawing(),"scroll",function(){this.translateX-=this.getDrawing().scrollLeft;this.translateY-=this.getDrawing().scrollTop;this.getDrawing().scrollLeft=0;this.getDrawing().scrollTop=0;this.onContentTransform()});this.setAllowTranslate(!0);this.setAllowRotate(!1);this.setMinScale(1);this.setMaxScale(1);this.setTransformOrigin(0,
0);this.setInertia(!0)},getOffsetX:function(){return-this.getTranslateX()},getOffsetY:function(){return-this.getTranslateY()},setOffset:function(a,b){this.setContentTransform(-a,-b,void 0,void 0)},getContentWidth:function(){return this.contentWidth},getContentHeight:function(){return this.contentHeight}},{arrangeCore:function(a,b){Ui.ScrollableContent.base.arrangeCore.call(this,Math.max(a,this.getMeasureWidth()),Math.max(b,this.getMeasureHeight()));this.onContentTransform()},onContentTransform:function(a){var b=
this.getScale();0<this.translateX&&(this.translateX=0);0<this.translateY&&(this.translateY=0);var c=this.getLayoutWidth(),d=this.getLayoutHeight();this.contentWidth=this.getFirstChild().getLayoutWidth()*b;this.contentHeight=this.getFirstChild().getLayoutHeight()*b;this.translateX=Math.max(this.translateX,-(this.contentWidth-c));this.translateY=Math.max(this.translateY,-(this.contentHeight-d));Ui.ScrollableContent.base.onContentTransform.apply(this,arguments);this.contentWidth=this.getFirstChild().getLayoutWidth()*
b;this.contentHeight=this.getFirstChild().getLayoutHeight()*b;!0!==a&&this.fireEvent("scroll",this)}});Core.Object.extend("Ui.ScrollLoader",{constructor:function(a){this.addEvents("change")},getMin:function(){return 0},getMax:function(){return-1},getElementAt:function(a){}});
Ui.Container.extend("Ui.VBoxScrollable",{contentBox:void 0,scrollHorizontal:!0,scrollVertical:!0,scrollbarHorizontalBox:void 0,scrollbarVerticalBox:void 0,showShadows:!1,lock:!1,isOver:!1,showClock:void 0,offsetX:0,offsetY:0,viewWidth:0,viewHeight:0,contentWidth:0,contentHeight:0,overWatcher:void 0,scrollLock:!1,constructor:function(a){this.addEvents("scroll");this.contentBox=new Ui.VBoxScrollableContent;this.connect(this.contentBox,"scroll",this.onScroll);this.connect(this.contentBox,"down",this.autoShowScrollbars);
this.connect(this.contentBox,"inertiaend",this.autoHideScrollbars);this.appendChild(this.contentBox);this.scrollbarHorizontalBox=new Ui.Movable({moveVertical:!1});this.connect(this.scrollbarHorizontalBox,"down",this.autoShowScrollbars);this.connect(this.scrollbarHorizontalBox,"up",this.autoHideScrollbars);this.connect(this.scrollbarHorizontalBox,"move",this.onScrollbarHorizontalMove);this.appendChild(this.scrollbarHorizontalBox);this.scrollbarVerticalBox=new Ui.Movable({moveHorizontal:!1});this.connect(this.scrollbarVerticalBox,
"down",this.autoShowScrollbars);this.connect(this.scrollbarVerticalBox,"up",this.autoHideScrollbars);this.connect(this.scrollbarVerticalBox,"move",this.onScrollbarVerticalMove);this.appendChild(this.scrollbarVerticalBox);this.scrollbarHorizontalBox.setOpacity(0);this.scrollbarVerticalBox.setOpacity(0);this.connect(this,"ptrmove",function(a){!this.getIsDisabled()&&(!a.pointer.getIsDown()&&void 0===this.overWatcher)&&(this.overWatcher=a.pointer.watch(this),this.isOver=!0,this.autoShowScrollbars(),this.connect(this.overWatcher,
"move",function(){this.overWatcher.getIsInside()||this.overWatcher.cancel()}),this.connect(this.overWatcher,"down",function(){this.overWatcher.cancel()}),this.connect(this.overWatcher,"up",function(){this.overWatcher.cancel()}),this.connect(this.overWatcher,"cancel",function(){this.overWatcher=void 0;this.isOver=!1;this.autoHideScrollbars()}))});this.connect(this,"wheel",this.onWheel)},reload:function(){this.contentBox.reload()},getActiveItems:function(){return this.contentBox.getActiveItems()},setLoader:function(a){this.contentBox.setLoader(a)},
setMaxScale:function(a){this.contentBox.setMaxScale(a)},setContent:function(a){this.contentBox.setContent(a)},getContent:function(){return this.contentBox.getContent()},getScrollHorizontal:function(){return this.scrollHorizontal},setScrollHorizontal:function(a){a!==this.scrollHorizontal&&(this.scrollHorizontal=a,this.invalidateMeasure())},getScrollVertical:function(){return this.scrollVertical},setScrollVertical:function(a){a!==this.scrollVertical&&(this.scrollVertical=a,this.invalidateMeasure())},
setScrollbarVertical:function(a){this.scrollbarVerticalBox.setContent(a)},setScrollbarHorizontal:function(a){this.scrollbarHorizontalBox.setContent(a)},setOffset:function(a,b,c,d){void 0===c&&(c=!1);void 0===a?a=this.offsetX:c||(a*=this.contentWidth-this.viewWidth);void 0===b?b=this.offsetY:c||(b*=this.contentHeight-this.viewHeight);0>a?a=0:this.viewWidth+a>this.contentWidth&&(a=this.contentWidth-this.viewWidth);0>b?b=0:this.viewHeight+b>this.contentHeight&&(b=this.contentHeight-this.viewHeight);
this.relativeOffsetX=a/(this.contentWidth-this.viewWidth);this.relativeOffsetY=b/(this.contentHeight-this.viewHeight);return this.offsetX!==a||this.offsetY!==b?(this.offsetX=a,this.offsetY=b,this.contentBox.setOffset(a,b),!0):!1},getOffsetX:function(){return this.contentBox.getOffsetX()},getRelativeOffsetX:function(){return this.relativeOffsetX},getOffsetY:function(){return this.contentBox.getOffsetY()},getRelativeOffsetY:function(){return this.relativeOffsetY},onWheel:function(a){this.setOffset(this.contentBox.getOffsetX()+
3*a.deltaX,this.contentBox.getOffsetY()+3*a.deltaY,!0)&&a.stopPropagation()},autoShowScrollbars:function(){void 0===this.showClock&&(this.showClock=new Anim.Clock({duration:"forever"}),this.connect(this.showClock,"timeupdate",this.onShowBarsTick),this.showClock.begin())},autoHideScrollbars:function(){!this.contentBox.getIsDown()&&(!this.contentBox.getIsInertia()&&!this.isOver&&!this.scrollbarVerticalBox.getIsDown()&&!this.scrollbarHorizontalBox.getIsDown())&&void 0===this.showClock&&(this.showClock=
new Anim.Clock({duration:"forever"}),this.connect(this.showClock,"timeupdate",this.onShowBarsTick),this.showClock.begin())},onShowBarsTick:function(a,b,c){a=this.contentBox.getIsDown()||this.contentBox.getIsInertia()||this.isOver;a=this.contentBox.getIsDown()||this.contentBox.getIsInertia()||this.isOver||this.scrollbarVerticalBox.getIsDown()||this.scrollbarHorizontalBox.getIsDown();b=!1;var d=this.scrollbarHorizontalBox.getOpacity();a?(d+=2*c,1<=d&&(d=1,b=!0)):(d-=2*c,0>=d&&(d=0,b=!0));this.scrollbarHorizontalBox.setOpacity(d);
this.scrollbarVerticalBox.setOpacity(d);b&&(this.showClock.stop(),this.showClock=void 0)},onScroll:function(){this.updateOffset();this.fireEvent("scroll",this,this.offsetX,this.offsetY)},updateOffset:function(){if(void 0!==this.contentBox){this.offsetX=this.contentBox.getOffsetX();this.offsetY=this.contentBox.getOffsetY();this.viewWidth=this.getLayoutWidth();this.viewHeight=this.getLayoutHeight();this.contentWidth=this.contentBox.getContentWidth();this.contentHeight=this.contentBox.getContentHeight();
this.relativeOffsetX=this.offsetX/(this.contentWidth-this.viewWidth);this.relativeOffsetY=this.offsetY/(this.contentHeight-this.viewHeight);this.scrollbarVerticalNeeded=this.contentHeight>this.viewHeight?!0:!1;this.scrollbarHorizontalNeeded=this.contentWidth>this.viewWidth?!0:!1;this.scrollbarVerticalNeeded?(this.scrollbarVerticalHeight=Math.max(this.viewHeight/this.contentHeight*this.viewHeight,this.scrollbarVerticalBox.getMeasureHeight()),this.scrollbarVerticalBox.arrange(this.getLayoutWidth()-
this.scrollbarVerticalBox.getMeasureWidth(),0,this.scrollbarVerticalBox.getMeasureWidth(),this.scrollbarVerticalHeight),this.scrollbarVerticalBox.show()):(this.scrollbarVerticalBox.hide(),this.offsetY=0);this.scrollbarHorizontalNeeded?(this.scrollbarHorizontalWidth=Math.max(this.viewWidth/this.contentWidth*this.viewWidth,this.scrollbarHorizontalBox.getMeasureWidth()),this.scrollbarHorizontalBox.arrange(0,this.getLayoutHeight()-this.scrollbarHorizontalBox.getMeasureHeight(),this.scrollbarHorizontalWidth,
this.scrollbarHorizontalBox.getMeasureHeight()),this.scrollbarHorizontalBox.show()):(this.scrollbarHorizontalBox.hide(),this.offsetX=0);this.scrollLock=!0;if(this.scrollbarHorizontalNeeded){var a=this.offsetX/(this.contentWidth-this.viewWidth);1<a&&(a=1,this.setOffset(a,void 0));this.scrollbarHorizontalBox.setPosition((this.viewWidth-this.scrollbarHorizontalWidth)*a,void 0)}this.scrollbarVerticalNeeded&&(a=this.offsetY/(this.contentHeight-this.viewHeight),1<a&&(a=1,this.setOffset(void 0,a)),this.scrollbarVerticalBox.setPosition(void 0,
(this.viewHeight-this.scrollbarVerticalHeight)*a));this.scrollLock=!1}},onScrollbarHorizontalMove:function(a){if(!this.scrollLock){var b=this.viewWidth-this.scrollbarHorizontalBox.getLayoutWidth(),c=Math.min(1,Math.max(0,a.getPositionX()/b));this.setOffset(c,void 0);a.setPosition(c*b,void 0)}},onScrollbarVerticalMove:function(a){if(!this.scrollLock){var b=this.viewHeight-this.scrollbarVerticalBox.getLayoutHeight(),c=Math.min(1,Math.max(0,a.getPositionY()/b));this.setOffset(void 0,c);a.setPosition(void 0,
c*b)}}},{measureCore:function(a,b){var c={width:0,height:0};this.scrollbarHorizontalBox.measure(a,b);this.scrollbarVerticalBox.measure(a,b);var d=this.contentBox.measure(a,b);c.width=d.width<a?d.width:a;c.height=d.height<b?d.height:b;this.scrollVertical||(c.height=d.height);this.scrollHorizontal||(c.width=d.width);return c},arrangeCore:function(a,b){this.viewWidth=a;this.viewHeight=b;this.contentBox.arrange(0,0,this.viewWidth,this.viewHeight);this.contentWidth=this.contentBox.getContentWidth();this.contentHeight=
this.contentBox.getContentHeight();this.updateOffset()}});
Ui.Transformable.extend("Ui.VBoxScrollableContent",{contentWidth:0,contentHeight:0,estimatedHeight:36,estimatedHeightNeeded:!0,loader:void 0,activeItems:void 0,activeItemsPos:0,activeItemsY:0,activeItemsHeight:0,reloadNeeded:!1,constructor:function(a){this.addEvents("scroll");this.activeItems=[];this.setClipToBounds(!0);this.connect(this.getDrawing(),"scroll",function(){this.translateX-=this.getDrawing().scrollLeft;this.translateY-=this.getDrawing().scrollTop;this.getDrawing().scrollLeft=0;this.getDrawing().scrollTop=
0;this.onContentTransform()});this.setAllowTranslate(!0);this.setAllowRotate(!1);this.setMinScale(1);this.setMaxScale(1);this.setInertia(!0);this.setTransformOrigin(0,0);this.removeChild(this.contentBox)},setLoader:function(a){this.loader!==a&&(void 0!==this.loader&&this.disconnect(this.loader,"change",this.onLoaderChange),this.loader=a,void 0!==this.loader&&this.connect(this.loader,"change",this.onLoaderChange),this.reload())},getActiveItems:function(){return this.activeItems},getOffsetX:function(){return-this.getTranslateX()},
getOffsetY:function(){return Math.max(0,(-this.getTranslateY()/this.getScale()-this.getMinY())*this.getScale())},setOffset:function(a,b){var c=this.getMinY(),c=-((b/this.getScale()+c)*this.getScale());this.setContentTransform(-a,c,void 0,void 0)},getContentWidth:function(){return this.contentWidth},getContentHeight:function(){return this.getEstimatedContentHeight()*this.getScale()},getEstimatedContentHeight:function(){var a=this.activeItemsPos-this.loader.getMin(),b=this.loader.getMax()+1-(this.activeItemsPos+
this.activeItems.length);return this.activeItemsY+this.activeItemsHeight+b*this.estimatedHeight-(this.activeItemsY-a*this.estimatedHeight)},getMinY:function(){var a=this.activeItemsPos-this.loader.getMin();return this.activeItemsY-a*this.estimatedHeight},getMaxY:function(){var a=this.loader.getMax()+1-(this.activeItemsPos+this.activeItems.length);return this.activeItemsY+this.activeItemsHeight+a*this.estimatedHeight},loadItems:function(){if(!(0>this.loader.getMax()-this.loader.getMin())){var a=this.getLayoutWidth(),
b=this.getLayoutHeight();if(!(0===a||0===b)){for(var c=this.getMatrix(),d=c.inverse(),e=(new Ui.Point({x:0,y:0})).multiply(d),d=(new Ui.Point({x:a,y:b})).multiply(d),f,g,l=[],k=0,h=this.activeItemsY,n=0;n<this.activeItems.length;n++){var m=this.activeItems[n],p=m.getMeasureHeight();h>=e.y&&h<=d.y||h+p>=e.y&&h+p<=d.y||h<=e.y&&h+p>=d.y?(void 0===f&&(f=n+this.activeItemsPos,g=h),l.push(m),k+=m.getMeasureHeight()):this.removeChild(m);h+=p}void 0===f?(f=Math.floor(-this.translateY/(this.estimatedHeight*
this.getScale())),f=Math.max(this.loader.getMin(),Math.min(this.loader.getMax(),f)),g=-this.translateY/this.getScale(),this.activeItemsPos=f,this.activeItems=[],f=this.loader.getElementAt(f),this.appendChild(f),n=f.measure(a,b),f.arrange(0,0,a,n.height),f.setTransformOrigin(0,0),this.activeItems.push(f),this.activeItemsHeight=n.height):(this.activeItemsPos=f,this.activeItems=l,this.activeItemsHeight=k,refMatrix=c.clone().translate(0,g));for(;g>e.y;){l=this.activeItemsPos-1;if(l<this.loader.getMin())break;
f=this.loader.getElementAt(l);this.prependChild(f);n=f.measure(a,b);f.arrange(0,0,a,n.height);f.setTransformOrigin(0,0);this.activeItems.unshift(f);this.activeItemsHeight+=n.height;g-=n.height;this.activeItemsPos=l}for(;g+this.activeItemsHeight<d.y;){l=this.activeItemsPos+this.activeItems.length;if(l>this.loader.getMax())break;f=this.loader.getElementAt(l);this.appendChild(f);n=f.measure(a,b);f.arrange(0,0,a,n.height);f.setTransformOrigin(0,0);this.activeItems.push(f);this.activeItemsHeight+=n.height}this.activeItemsY=
g;for(var n=this.activeItemsHeight=0;n<this.activeItems.length;n++)f=this.activeItems[n],f.setTransform(c.clone().translate(0,this.activeItemsY+this.activeItemsHeight)),this.activeItemsHeight+=f.getMeasureHeight();this.estimatedHeightNeeded&&(this.estimatedHeightNeeded=!1,this.estimatedHeight=this.activeItemsHeight/this.activeItems.length)}}},updateItems:function(){this.getLayoutWidth();this.getLayoutHeight()},reload:function(){for(var a=0;a<this.activeItems.length;a++)this.removeChild(this.activeItems[a]);
this.activeItems=[];this.activeItemsHeight=this.activeItemsY=this.activeItemsPos=0;this.estimatedHeightNeeded=!0;this.onContentTransform()},onLoaderChange:function(){this.reloadNeeded=!0;this.invalidateMeasure()}},{measureCore:function(a,b){this.reloadNeeded&&(this.reloadNeeded=!1,this.reload());for(var c=0,d=0;d<this.activeItems.length;d++)var e=this.activeItems[d].measure(a,0),c=c+e.height;this.activeItemsHeight=c;return{width:a,height:this.getEstimatedContentHeight()}},arrangeCore:function(a,b){for(var c=
0;c<this.activeItems.length;c++){var d=this.activeItems[c];d.arrange(0,0,a,d.getMeasureHeight())}this.loadItems()},onContentTransform:function(a){var b=this.getScale();0<this.translateX&&(this.translateX=0);var c=this.activeItemsPos-this.loader.getMin(),d=this.loader.getMax()+1-(this.activeItemsPos+this.activeItems.length),c=this.activeItemsY-c*this.estimatedHeight,d=this.activeItemsY+this.activeItemsHeight+d*this.estimatedHeight,c=c*b,d=d*b,e=this.getLayoutWidth(),f=this.getLayoutHeight();this.contentWidth=
this.getLayoutWidth()*b;this.contentHeight=this.getEstimatedContentHeight()*b;this.translateX=Math.max(this.translateX,-(this.contentWidth-e));this.translateY<-(d-f)&&(this.translateY=-(d-f));this.translateY>-c&&(this.translateY=-c);this.loadItems();this.contentWidth=this.getLayoutWidth()*b;this.contentHeight=this.getEstimatedContentHeight()*b;!0!==a&&this.fireEvent("scroll",this)},onChildInvalidateMeasure:function(a,b){this.invalidateLayout()}});
Ui.VBoxScrollable.extend("Ui.VBoxScrollingArea",{horizontalScrollbar:void 0,verticalScrollbar:void 0,constructor:function(a){this.horizontalScrollbar=new Ui.Rectangle({width:30,height:4,margin:5});this.setScrollbarHorizontal(this.horizontalScrollbar);this.verticalScrollbar=new Ui.Rectangle({width:4,height:30,margin:5});this.setScrollbarVertical(this.verticalScrollbar)}},{onStyleChange:function(){var a=this.getStyleProperty("radius");this.horizontalScrollbar.setRadius(a);this.verticalScrollbar.setRadius(a);
a=this.getStyleProperty("color");this.horizontalScrollbar.setFill(a);this.verticalScrollbar.setFill(a)}},{style:{color:"#999999",radius:0}});Ui.Pressable.extend("Ui.Draggable",{draggableIcon:void 0,allowedMode:"all",draggableData:void 0,dragDelta:void 0,dataTransfer:void 0,constructor:function(a){this.addEvents("dragstart","dragend");this.connect(this,"ptrdown",this.onDraggablePointerDown)},getDraggableData:function(){return this.draggableData},setDraggableData:function(a){this.draggableData=a},setAllowedMode:function(a){this.allowedMode=a},setDraggableIcon:function(a){this.draggableIcon=a},getDragDelta:function(){return this.dragDelta},
onDraggablePointerDown:function(a){if(!this.lock&&!(this.getIsDisabled()||void 0===this.draggableData))this.dataTransfer=new Ui.DragDataTransfer({type:"pointer",draggable:this,x:a.clientX,y:a.clientY,delayed:!0,pointer:a.pointer}),this.dragDelta=this.pointFromWindow({x:a.clientX,y:a.clientY}),this.connect(this.dataTransfer,"start",this.onDragStart),this.connect(this.dataTransfer,"end",this.onDragEnd)},onDragStart:function(a){a.effectAllowed=this.allowedMode;a.setData(this.draggableData);this.fireEvent("dragstart",
this,a)},onDragEnd:function(a){this.fireEvent("dragend",this,a.dropEffect)}});Ui.LBox.extend("Ui.DropBox",{watchers:void 0,allowedTypes:void 0,constructor:function(a){this.addEvents("drageffect","dragenter","dragleave","drop","dropfile");this.watchers=[];this.connect(this,"dragover",this.onDragOver)},addType:function(a,b){"string"===typeof a&&(a=a.toLowerCase());void 0===this.allowedTypes&&(this.allowedTypes=[]);"string"===typeof b&&(b=[b]);if("function"!==typeof b)for(var c=0;c<b.length;c++){var d=b[c];"string"===typeof d&&(d={action:d});"text"in d||(d.text="copy"===d.action?
"Copier":"move"===d.action?"D\u00e9placer":"link"===d.action?"Lier":d.action);"dragicon"in d||(d.dragicon="drag"+d.action);b[c]=d}this.allowedTypes.push({type:a,effect:b})},onDragOver:function(a){for(var b=!1,c=0;!b&&c<this.watchers.length;c++)b=this.watchers[c].getDataTransfer()===a.dataTransfer;b?a.stopImmediatePropagation():(b=this.onDragEffect(a.dataTransfer),void 0!==b&&0<b.length&&(b=a.dataTransfer.capture(this,b),this.watchers.push(b),this.connect(b,"move",this.onWatcherMove),this.connect(b,
"drop",this.onWatcherDrop),this.connect(b,"leave",this.onWatcherLeave),a.stopImmediatePropagation(),this.onWatcherEnter(b)))},getWatchers:function(){return this.watchers},onWatcherEnter:function(a){this.onDragEnter(a.getDataTransfer())},onWatcherMove:function(a){},onWatcherDrop:function(a,b,c,d){c=this.pointFromWindow(new Ui.Point({x:c,y:d}));this.onDrop(a.getDataTransfer(),b,c.getX(),c.getY())},onWatcherLeave:function(a){for(var b=!1,c=0;!b&&c<this.watchers.length;c++)b=this.watchers[c]===a;c--;
b&&this.watchers.splice(c,1);if(0===this.watchers.length)this.onDragLeave()},getAllowedTypesEffect:function(a){if(void 0!==this.allowedTypes){for(var b=a.getData(),c=void 0,d=0;void 0===c&&d<this.allowedTypes.length;d++){var e=this.allowedTypes[d];"string"===typeof e.type?"all"===e.type?c=e.effect:Ui.DragNativeData.hasInstance(b)&&("files"===e.type&&b.hasFiles()?c=e.effect:("text"===e.type||"text/plain"===e.type)&&b.hasTypes("text/plain","text")?c=e.effect:b.hasType(e.type)&&(c=e.effect)):e.type.hasInstance(b)&&
(c=e.effect)}if("function"===typeof c){a=this.onDragEffectFunction(a,c);for(d=0;d<a.length;d++)c=a[d],"string"===typeof c&&(c={action:c}),"text"in c||(c.text="copy"===c.action?"Copier":"move"===c.action?"D\u00e9placer":"link"===c.action?"Lier":"run"===c.action?"Ex\u00e9cuter":"play"===c.action?"Jouer":c.action),"dragicon"in c||(c.dragicon="drag"+c.action),a[d]=c;c=a}void 0===c&&(c=[]);return c}return[]},onDragEffect:function(a){var b=new Ui.DragEvent({type:"drageffect",bubbles:!1,dataTransfer:a});
b.dispatchEvent(this);return void 0!==b.getEffectAllowed()?b.getEffectAllowed():this.getAllowedTypesEffect(a)},onDragEffectFunction:function(a,b){return b(a.getData(),a)},onDrop:function(a,b,c,d){var e=!1;if(this.fireEvent("drop",this,a.getData(),b,c,d,a))e=!0;else if(a=a.getData(),Ui.DragNativeData.hasInstance(a)&&a.hasFiles()){a=a.getFiles();for(var e=!0,f=0;f<a.length;f++)e&=this.fireEvent("dropfile",this,a[f],b,c,d)}return e},onDragEnter:function(a){this.fireEvent("dragenter",this,a.getData())},
onDragLeave:function(){this.fireEvent("dragleave",this)}});Ui.DropBox.extend("Ui.DropAtBox",{container:void 0,fixed:void 0,markerOrientation:"horizontal",constructor:function(a){this.addEvents("dropat","dropfileat");this.fixed=new Ui.Fixed;Ui.DropAtBox.base.append.call(this,this.fixed)},setContainer:function(a){this.container=a;Ui.DropAtBox.base.append.call(this,this.container)},getContainer:function(){return this.container},setMarkerOrientation:function(a){this.markerOrientation=a},setMarkerPos:function(a,b){a.show();var c=0;"getSpacing"in this.container&&
(c=this.container.getSpacing());if(b<this.container.getChildren().length){var d=this.container.getChildren()[b];if("horizontal"===this.markerOrientation){var e=d.getLayoutX()-d.getMarginLeft()-(a.getLayoutWidth()+a.getMarginLeft()+a.getMarginRight()+c)/2,c=d.getLayoutY(),d=d.getLayoutHeight();a.setHeight(d)}else e=d.getLayoutX(),c=d.getLayoutY()-d.getMarginTop()-(a.getLayoutHeight()+a.getMarginTop()+a.getMarginBottom())/2-c/2,a.setWidth(d.getLayoutWidth());this.fixed.setPosition(a,e,c)}else 0<this.container.getChildren().length&&
(d=this.container.getChildren()[this.container.getChildren().length-1],"horizontal"===this.markerOrientation?(e=d.getLayoutX()+d.getLayoutWidth()-(a.getLayoutWidth()-c)/2,c=d.getLayoutY(),d=d.getLayoutHeight(),a.setHeight(d)):(e=d.getLayoutX(),c=d.getLayoutY()+d.getLayoutHeight()-a.getLayoutHeight()/2,a.setWidth(d.getLayoutWidth())),this.fixed.setPosition(a,e,c))},findPosition:function(a){return"horizontal"===this.markerOrientation?this.findPositionHorizontal(a):this.findPositionVertical(a)},findPositionHorizontal:function(a){for(var b=
[],c=this.container.getChildren(),d=0;d<c.length;d++)a.y>=c[d].getLayoutY()&&a.y<c[d].getLayoutY()+c[d].getLayoutHeight()&&b.push(c[d]);for(var e=void 0,f=Number.MAX_VALUE,d=0;d<b.length;d++){var g=b[d].getLayoutX()+b[d].getLayoutWidth()/2,g=Math.abs(a.x-g);g<f&&(f=g,e=b[d])}void 0===e&&0<b.length&&(e=b[b.length-1]);d=c.length;if(void 0!==e){b=-1;for(d=0;-1==b&&d<c.length;d++)c[d]==e&&(b=d);d=a.x<e.getLayoutX()+e.getLayoutWidth()/2?b:b+1}return d},findPositionVertical:function(a){for(var b=this.container.getChildren(),
c=void 0,d=Number.MAX_VALUE,e=0;e<b.length;e++){var f=b[e].getLayoutY()+b[e].getLayoutHeight()/2,f=Math.abs(a.y-f);f<d&&(d=f,c=b[e])}void 0===c&&0<b.length&&(c=b[b.length-1]);e=b.length;if(void 0!==c){d=-1;for(e=0;-1===d&&e<b.length;e++)b[e]===c&&(d=e);e=a.y<c.getLayoutY()+c.getLayoutHeight()/2?d:d+1}return e},insertAt:function(a,b){this.container.insertAt(a,b)},moveAt:function(a,b){this.container.moveAt(a,b)},getLogicalChildren:function(){return this.container.getChildren()}},{setContent:function(a){this.container.setContent(a)},
clear:function(){this.container.clear()},append:function(a){this.container.append(a)},remove:function(a){this.container.remove(a)},onStyleChange:function(){for(var a=this.getStyleProperty("markerColor"),b=this.getWatchers(),c=0;c<b.length;c++)b[c]["Ui.DropAtBox.marker"].setFill(a)},onDragOver:function(a){for(var b=void 0,c=0;void 0===b&&c<this.getWatchers().length;c++)this.getWatchers()[c].getDataTransfer()===a.dataTransfer&&(b=this.getWatchers()[c]);var d=this.onDragEffect(a.dataTransfer);if(void 0!==
b){for(var e=d.length===b.getEffectAllowed(),c=0;e&&c<d.length;c++)e=d[c]===b.getEffectAllowed()[c];e||(b.release(),b=void 0)}void 0!==d&&0<d.length&&void 0===b?(b=a.dataTransfer.capture(this,d),this.watchers.push(b),this.connect(b,"move",this.onWatcherMove),this.connect(b,"drop",this.onWatcherDrop),this.connect(b,"leave",this.onWatcherLeave),a.stopImmediatePropagation(),this.onWatcherEnter(b)):void 0!==b&&a.stopImmediatePropagation()},onDragEffectFunction:function(a,b){var c=this.findPosition(this.pointFromWindow(a.getPosition()));
return b(a.getData(),c)},onWatcherEnter:function(a){Ui.DropAtBox.base.onWatcherEnter.apply(this,arguments);var b=new Ui.Frame({margin:2,frameWidth:2,width:6,height:6});b.setFill(this.getStyleProperty("markerColor"));b.hide();this.fixed.append(b);a["Ui.DropAtBox.marker"]=b},onWatcherMove:function(a){Ui.DropAtBox.base.onWatcherMove.apply(this,arguments);var b=a["Ui.DropAtBox.marker"],c=this.findPosition(this.pointFromWindow(a.getPosition()));this.setMarkerPos(b,c)},onDrop:function(a,b,c,d){var e=!1;
if(Ui.DropAtBox.base.onDrop.apply(this,arguments))e=!0;else{var f=new Ui.Point({x:c,y:d}),f=this.findPosition(f);if(this.fireEvent("dropat",this,a.getData(),b,f,c,d))e=!0;else{var g=a.getData();if(Ui.DragNativeData.hasInstance(g)&&g.hasFiles())for(var g=g.getFiles(),e=!0,l=0;l<g.length;l++)e&=this.fireEvent("dropfileat",this,g[l],b,f,c,d)}}return e},onWatcherLeave:function(a){Ui.DropAtBox.base.onWatcherLeave.apply(this,arguments);this.fixed.remove(a["Ui.DropAtBox.marker"])}},{style:{markerColor:new Ui.Color({r:0.4,
g:0,b:0.35,a:0.8})}});Ui.DropAtBox.extend("Ui.FlowDropBox",{constructor:function(a){this.setContainer(new Ui.Flow);this.setMarkerOrientation("horizontal")},setUniform:function(a){this.getContainer().setUniform(a)},setSpacing:function(a){this.getContainer().setSpacing(a)}});
Ui.DropAtBox.extend("Ui.SFlowDropBox",{constructor:function(a){this.setContainer(new Ui.SFlow);this.setMarkerOrientation("horizontal")},setStretchMaxRatio:function(a){this.getContainer().setStretchMaxRatio(a)},setUniform:function(a){this.getContainer().setUniform(a)},setUniformRatio:function(a){this.getContainer().setUniformRatio(a)},setItemAlign:function(a){this.getContainer().setItemAlign(a)},setSpacing:function(a){this.getContainer().setSpacing(a)}});
Ui.DropAtBox.extend("Ui.VDropBox",{constructor:function(a){this.setContainer(new Ui.VBox);this.setMarkerOrientation("vertical")},setUniform:function(a){this.getContainer().setUniform(a)},setSpacing:function(a){this.getContainer().setSpacing(a)}});Ui.DropAtBox.extend("Ui.HDropBox",{constructor:function(a){this.setContainer(new Ui.HBox);this.setMarkerOrientation("horizontal")},setUniform:function(a){this.getContainer().setUniform(a)},setSpacing:function(a){this.getContainer().setSpacing(a)}});Ui.Element.extend("Ui.IFrame",{iframeDrawing:void 0,isReady:!1,constructor:function(a){this.connect(this.iframeDrawing,"load",this.onIFrameLoad);this.addEvents("ready")},getSrc:function(){return this.iframeDrawing.getAttribute("src")},setSrc:function(a){this.iframeDrawing.setAttribute("src",a)},getIFrame:function(){return this.iframeDrawing},onIFrameLoad:function(){this.isReady||(this.isReady=!0,this.fireEvent("ready",this))}},{renderDrawing:function(){if(navigator.iOs){var a=Ui.IFrame.base.renderDrawing.apply(this,
arguments);a.style.overflow="scroll";a.style.webkitOverflowScrolling="touch";this.iframeDrawing=document.createElement("iframe");this.iframeDrawing.scrolling="no";this.iframeDrawing.style.border="0px";this.iframeDrawing.style.margin="0px";this.iframeDrawing.style.padding="0px";this.iframeDrawing.style.width="100%";this.iframeDrawing.style.height="100%";a.appendChild(this.iframeDrawing);return a}this.iframeDrawing=document.createElement("iframe");this.iframeDrawing.style.border="0px";this.iframeDrawing.style.margin=
"0px";this.iframeDrawing.style.padding="0px";this.iframeDrawing.style.width="100%";this.iframeDrawing.style.height="100%";navigator.isIE&&(this.iframeDrawing.frameBorder="0");return this.iframeDrawing},arrangeCore:function(a,b){this.iframeDrawing.style.width=a+"px"}});Ui.MovableBase.extend("Ui.Carouselable",{ease:void 0,items:void 0,pos:0,lastPosition:void 0,activeItems:void 0,alignClock:void 0,animNext:void 0,animStart:void 0,bufferingSize:1,autoPlayDelay:void 0,autoPlayTask:void 0,constructor:function(a){this.addEvents("change");this.setClipToBounds(!0);this.setFocusable(!0);this.setMoveVertical(!1);this.items=[];this.activeItems=[];this.ease=Anim.EasingFunction.create({type:Anim.PowerEase,mode:"out"});this.connect(this,"down",this.onCarouselableDown);this.connect(this,
"up",this.onCarouselableUp);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.connect(this,"wheel",this.onWheel)},setAutoPlay:function(a){this.autoPlayDelay!==a&&(void 0!==this.autoPlayTask&&this.autoPlayTask.abort(),this.autoPlayTask=void 0,this.autoPlayDelay=a,this.startAutoPlay())},stopAutoPlay:function(){void 0!==this.autoPlayTask&&(this.autoPlayTask.abort(),this.autoPlayTask=void 0)},startAutoPlay:function(){void 0!==this.autoPlayDelay&&(this.autoPlayTask=new Core.DelayedTask({scope:this,
delay:this.autoPlayDelay,callback:this.onAutoPlayTimeout}))},onAutoPlayTimeout:function(){this.getCurrentPosition()>=this.items.length-1?this.setCurrentAt(0):this.next();this.startAutoPlay()},getBufferingSize:function(){return this.bufferingSize},setBufferingSize:function(a){this.bufferingSize!=a&&(this.bufferingSize=a,this.updateItems())},getLogicalChildren:function(){return this.items},getCurrentPosition:function(){return void 0!==this.alignClock?this.animNext:this.pos},getCurrent:function(){return this.items[this.getCurrentPosition()]},
setCurrentAt:function(a,b){a=Math.min(2*(this.items.length-1),Math.max(0,a));b?(this.pos=a,this.setPosition(-this.pos*this.getLayoutWidth(),void 0),this.onChange()):this.startAnimation(2*(this.pos-a),a)},setCurrent:function(a,b){for(var c=0;c<this.items.length;c++)if(this.items[c]==a){this.setCurrentAt(c,b);break}},next:function(){void 0===this.alignClock?this.pos<this.items.length-1&&this.startAnimation(-2,this.pos+1):this.animNext>this.pos?this.startAnimation(-2*(this.animNext+1-Math.floor(this.pos)),
Math.min(this.animNext+1,this.items.length-1)):this.startAnimation(-2,Math.min(Math.ceil(this.pos),this.items.length-1))},previous:function(){void 0===this.alignClock?0<this.pos&&this.startAnimation(2,this.pos-1):this.animNext<this.pos?this.startAnimation(2*(Math.floor(this.pos)-(this.animNext-1)),Math.max(this.animNext-1,0)):this.startAnimation(2,Math.floor(this.pos))},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},append:function(a){this.items.push(a);this.onChange()},remove:function(a){for(var b=
0;b<this.items.length&&this.items[b]!==a;)b++;if(b<this.items.length){this.items.splice(b,1);if(0>this.pos||this.pos>this.items.length-1)this.pos=Math.max(0,Math.min(this.pos,this.items.length-1));void 0!==this.alignClock&&(this.animNext=Math.max(0,Math.min(this.animNext,this.items.length-1)));this.setPosition(-this.pos*this.getLayoutWidth(),void 0,!0);this.onChange()}},insertAt:function(a,b){0>b&&(b=this.items.length+b);0>b&&(b=0);b>=this.items.length&&(b=this.items.length);this.items.splice(b,0,
a);this.onChange()},moveAt:function(a,b){0>b&&(b=this.items.length+b);0>b&&(b=0);b>=this.items.length&&(b=this.items.length);for(var c=0;c<this.items.length&&this.items[c]!=a;)c++;c<this.items.length&&(this.items.splice(c,1),this.items.splice(b,0,a));this.onChange()},onKeyDown:function(a){if(!this.getIsDisabled()){var b=a.which;if(37==b||39==b)a.stopPropagation(),a.preventDefault(),37==b?this.previous():39==b&&this.next()}},onWheel:function(a){0!==a.deltaX&&(a.stopPropagation(),0>a.deltaX?this.previous():
this.next())},onCarouselableDown:function(){this.stopAutoPlay();this.stopAnimation()},onCarouselableUp:function(a,b,c,d,e,f,g){!0===g?(a=this.pos%1,b=0.5<a?-400:400):50>Math.abs(b)&&(d>0.2*this.getLayoutWidth()||100<Math.abs(d)?b=0>d?-400:400:(a=this.pos%1,b=0.5<a?-400:400));800>Math.abs(b)&&(b=0>b?-800:800);0!==b&&this.startAnimation(b/this.getLayoutWidth());this.startAutoPlay()},onChange:function(){this.loadItems();this.updateItems();var a=this.getCurrent();void 0!==a&&a.enable();a=this.getCurrentPosition();
if(void 0===this.lastPosition||this.lastPosition!==a)void 0!==this.lastPosition&&void 0!==this.items[this.lastPosition]&&this.items[this.lastPosition].disable(),this.lastPosition=a,this.fireEvent("change",this,a)},onAlignTick:function(a,b,c){if(0!==c&&(a=-(a.getTime()*this.speed)/(this.animNext-this.animStart),1<=a&&(this.alignClock.stop(),this.alignClock=void 0,a=1),a=this.ease.ease(a),this.pos=this.animStart+a*(this.animNext-this.animStart),this.setPosition(-this.pos*this.getLayoutWidth(),void 0),
void 0===this.alignClock))this.onChange()},startAnimation:function(a,b){this.stopAnimation();this.speed=a;this.animStart=this.pos;this.animNext=void 0===b?0>this.speed?Math.ceil(this.animStart):Math.floor(this.animStart):b;this.animStart!==this.animNext&&(this.alignClock=new Anim.Clock({duration:"forever",target:this}),this.connect(this.alignClock,"timeupdate",this.onAlignTick),this.alignClock.begin())},stopAnimation:function(){void 0!==this.alignClock&&(this.alignClock.stop(),this.alignClock=void 0)},
loadItems:function(){if(this.getIsLoaded()){var a;for(a=0;a<this.activeItems.length;a++)this.activeItems[a].carouselableSeen=void 0;var b=[];for(a=Math.max(0,Math.floor(this.pos-this.bufferingSize));a<Math.min(this.items.length,Math.floor(this.pos+1+this.bufferingSize));a++){for(var c=this.items[a],d=!1,e=0;!d&&e<this.activeItems.length;e++)this.activeItems[e]===c&&(d=!0,this.activeItems[e].carouselableSeen=!0);b.push(c);d||(c.disable(),this.appendChild(c))}for(a=0;a<this.activeItems.length;a++)this.activeItems[a].carouselableSeen||
this.removeChild(this.activeItems[a]);this.activeItems=b}},updateItems:function(){if(this.getIsLoaded()){var a=this.getLayoutWidth(),b=this.getLayoutHeight();void 0!==this.animClock&&(target=this.animNext);for(var c=0;c<this.activeItems.length;c++){for(var d=this.activeItems[c],e=-1,e=0;e<this.items.length&&this.items[e]!==d;e++);e<this.items.length&&(d.measure(a,b),d.arrange(0,0,a,b),d.setTransform(Ui.Matrix.createTranslate((e-this.pos)*a,0)))}}}},{onLoad:function(){Ui.Carouselable.base.onLoad.call(this);
this.loadItems();this.updateItems()},onMove:function(a,b){if(!(0>=this.getLayoutWidth())){this.pos=-a/this.getLayoutWidth();if(0>this.pos||this.pos>this.items.length-1)this.pos=Math.max(0,Math.min(this.pos,this.items.length-1)),this.setPosition(-this.pos*this.getLayoutWidth());this.updateItems()}},measureCore:function(a,b){return this.getCurrent().measure(a,b)},arrangeCore:function(a,b){this.setPosition(-this.pos*a,void 0)},onChildInvalidateMeasure:function(a,b){}});Ui.Scrollable.extend("Ui.Carouselable2",{hbox:void 0,snapTimer:void 0,ease:void 0,animStart:void 0,animNext:void 0,alignClock:void 0,bufferingSize:1,current:void 0,supportCssSnap:!1,pos:0,isDown:!1,constructor:function(){this.addEvents("change");this.setScrollVertical(!1);this.ease=Anim.EasingFunction.create({type:Anim.PowerEase,mode:"out"});this.supportCssSnap=!1;if("getComputedStyle"in window){var a=window.getComputedStyle(this.contentBox.getDrawing());this.supportCssSnap="msScrollSnapPointsX"in
a||"scrollSnapPointsX"in a}this.supportCssSnap&&(this.contentBox.getDrawing().style.msScrollSnapType="mandatory",this.contentBox.getDrawing().style.msScrollSnapPointsX="snapInterval(0px, 100%)",this.contentBox.getDrawing().style.scrollSnapType="mandatory",this.contentBox.getDrawing().style.scrollSnapPointsX="snapInterval(0px, 100%)",this.contentBox.getDrawing().style.msScrollChaining="none");this.hbox=new Ui.FixedBox;this.setContent(this.hbox)},append:function(a){a.hide();this.hbox.append(a,!0);this.updateItems()},
insertAt:function(a,b){a.hide();this.hbox.insertAt(a,b);this.updateItems()},moveAt:function(a,b){this.hbox.moveAt(a,b);this.updateItems()},remove:function(a){this.hbox.remove(a);a.show();this.updateItems()},getBufferingSize:function(){return this.bufferingSize},setBufferingSize:function(a){this.bufferingSize!=a&&(this.bufferingSize=a,this.updateItems())},setAutoPlay:function(a){},next:function(){if(void 0===this.alignClock)this.getCurrentPosition()<this.hbox.getChildren().length-1&&this.startAnimation(-3,
this.getCurrentPosition()+1);else{var a=this.getOffsetX()/this.getLayoutWidth();this.animNext>a?this.startAnimation(-3*(this.animNext+1-Math.floor(a)),Math.min(this.animNext+1,this.hbox.getChildren().length-1)):this.startAnimation(-3,Math.min(Math.ceil(a),this.hbox.getChildren().length-1))}},previous:function(){if(void 0===this.alignClock)0<this.getCurrentPosition()&&this.startAnimation(3,this.getCurrentPosition()-1);else{var a=this.getOffsetX()/this.getLayoutWidth();this.animNext<a?this.startAnimation(3*
(Math.floor(a)-(this.animNext-1)),Math.max(this.animNext-1,0)):this.startAnimation(3,Math.floor(a))}},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},getLogicalChildren:function(){return this.hbox.getChildren()},getCurrentPosition:function(){return void 0!==this.alignClock?this.animNext:this.pos},getCurrent:function(){return this.hbox.getChildren()[this.getCurrentPosition()]},setCurrentAt:function(a){void 0!==this.animClock&&this.stopAnimation();void 0!==this.snapTimer&&(this.snapTimer.abort(),
this.snapTimer=void 0);this.pos=Math.min(this.hbox.getChildren().length-1,Math.max(a,0));this.setOffset(this.getLayoutWidth()*this.pos,void 0,!0)},setCurrent:function(a){for(var b=0;b<this.hbox.getChildren().length;b++)if(this.hbox.getChildren()[b]===a){this.setCurrentAt(b);break}},startAnimation:function(a,b){void 0!==this.snapTimer&&(this.snapTimer.abort(),this.snapTimer=void 0);this.stopAnimation();this.speed=a;this.animStart=this.pos;this.animNext=void 0===b?0>this.speed?Math.ceil(this.animStart):
Math.floor(this.animStart):b;this.animStart!==this.animNext&&(this.alignClock=new Anim.Clock({duration:"forever",target:this}),this.connect(this.alignClock,"timeupdate",this.onAlignTick),this.alignClock.begin())},stopAnimation:function(){void 0!==this.alignClock&&(this.alignClock.stop(),this.alignClock=void 0)},onAlignTick:function(a,b,c){0!==c&&(a=-(a.getTime()*this.speed)/(this.animNext-this.animStart),1<=a&&(this.alignClock.stop(),this.alignClock=void 0,a=1),a=this.ease.ease(a),this.pos=this.animStart+
a*(this.animNext-this.animStart),this.setOffset(this.pos*this.getLayoutWidth(),void 0,!0),void 0===this.alignClock&&this.snap())},snap:function(){void 0!==this.snapTimer&&(this.snapTimer.abort(),this.snapTimer=void 0);this.setOffset(Math.round(this.getOffsetX()/this.getLayoutWidth())*this.getLayoutWidth(),void 0,!0);this.updateItems();this.current!==this.getCurrent()&&(this.current=this.getCurrent(),this.fireEvent("change",this,this.getCurrentPosition()))},updateItems:function(){var a,b=this.getCurrentPosition();
for(a=0;a<this.hbox.getChildren().length;a++)a>=b-this.bufferingSize&a<=b+this.bufferingSize?this.hbox.getChildren()[a].show():this.hbox.getChildren()[a].hide()}},{onScroll:function(){Ui.Carouselable2.base.onScroll.apply(this,arguments);void 0===this.animClock&&(0<this.getLayoutWidth()&&(this.pos=Math.round(this.getOffsetX()/this.getLayoutWidth())),this.updateItems(),this.supportCssSnap||(void 0!==this.snapTimer&&this.snapTimer.abort(),this.snapTimer=new Core.DelayedTask({scope:this,callback:this.snap,
delay:0.3})),this.current!==this.getCurrent()&&(this.current=this.getCurrent(),this.fireEvent("change",this,this.getCurrentPosition())))},measureCore:function(a,b){this.hbox.setItemWidth(a);this.hbox.setItemHeight(b);return Ui.Carouselable2.base.measureCore.apply(this,arguments)},onChildInvalidateMeasure:function(a,b){this.invalidateLayout()},onChildInvalidateArrange:function(a){this.invalidateLayout()},arrangeCore:function(a,b){Ui.Carouselable2.base.arrangeCore.apply(this,arguments);this.supportCssSnap&&
(this.contentBox.getDrawing().style.msScrollSnapPointsX="snapInterval(0px,"+a+"px)",this.contentBox.getDrawing().style.scrollSnapPointsX="snapInterval(0px,"+a+"px)");this.setOffset(this.pos*a,0,!0)}});
Ui.Container.extend("Ui.FixedBox",{vertical:!1,itemWidth:100,itemHeight:100,constructor:function(a){},setItemWidth:function(a){this.itemWidth!==a&&(this.itemWidth=a)},setItemHeight:function(a){this.itemHeight!==a&&(this.itemHeight=a)},setContent:function(a){for(;void 0!==this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!==a&&"object"===typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.append(a[b]);else this.append(a)},getOrientation:function(){return this.vertical?
"vertical":"horizontal"},setOrientation:function(a){var b=!0;"vertical"!==a&&(b=!1);this.vertical!==b&&(this.vertical=b,this.invalidateMeasure())},append:function(a,b){this.appendChild(a)},prepend:function(a,b){this.prependChild(a)},insertAt:function(a,b,c){this.insertChildAt(a,b)},moveAt:function(a,b){this.moveChildAt(a,b)},remove:function(a){this.removeChild(a)}},{measureCore:function(a,b){for(var c=0;c<this.getChildren().length;c++)this.getChildren()[c].measure(this.itemWidth,this.itemHeight);
return this.vertical?{width:this.itemWidth,height:this.itemHeight*this.getChildren().length}:{width:this.itemWidth*this.getChildren().length,height:this.itemHeight}},arrangeCore:function(a,b){for(var c=0;c<this.getChildren().length;c++)this.vertical?this.getChildren()[c].arrange(0,c*this.itemHeight,this.itemWidth,this.itemHeight):this.getChildren()[c].arrange(c*this.itemWidth,0,this.itemWidth,this.itemHeight)},layoutCore:function(){for(var a=0;a<this.getChildren().length;a++){var b=this.getChildren()[a];
b.measure(this.itemWidth,this.itemHeight);this.vertical?b.arrange(0,a*this.itemHeight,this.itemWidth,this.itemHeight):b.arrange(a*this.itemWidth,0,this.itemWidth,this.itemHeight)}}});Core.Object.extend("Ui.CarouselableLoader",{constructor:function(a){this.addEvents("change")},getMin:function(){return 0},getMax:function(){return-1},getElementAt:function(a){}});
Ui.CarouselableLoader.extend("Ui.CarouselableInfiniteLoader",{constructor:function(a){}},{getMin:function(){return Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:-9007199254740991},getMax:function(){return Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:9007199254740991},getElementAt:function(a){a%=4;return 0===a?new Ui.Rectangle({fill:"pink"}):1===a?new Ui.Rectangle({fill:"lightgreen"}):2===a?new Ui.Rectangle({fill:"orange"}):new Ui.Rectangle({fill:"lightblue"})}});
Ui.CarouselableLoader.extend("Ui.CarouselableElementsLoader",{elements:void 0,constructor:function(a){"elements"in a?(this.elements=a.elements,delete a.elements):this.elements=[]},append:function(a){this.elements.push(a)}},{getMin:function(){return 0},getMax:function(){return this.elements.length-1},getElementAt:function(a){return this.elements[a]}});
Ui.CarouselableLoader.extend("Ui.CarouselableDataLoader",{data:void 0,constructor:function(a){"data"in a?(this.data=a.data,delete a.data):this.data=[]},append:function(a){this.data.push(a)},buildUi:function(a,b){return new Ui.Label({verticalAlign:"center",horizontalAlign:"center",text:a})}},{getMin:function(){return 0},getMax:function(){return this.data.length-1},getElementAt:function(a){return this.buildUi(this.data[a],a)}});
Ui.MovableBase.extend("Ui.Carouselable3",{ease:void 0,items:void 0,pos:0,lastPosition:void 0,activeItems:void 0,activeItemsPos:0,alignClock:void 0,animNext:void 0,animStart:void 0,animSource:void 0,bufferingSize:1,loader:void 0,constructor:function(a){this.addEvents("change");this.setClipToBounds(!0);this.setFocusable(!0);this.setMoveVertical(!1);this.activeItems=[];this.ease=Anim.EasingFunction.create({type:Anim.PowerEase,mode:"out"});this.connect(this,"down",this.onCarouselableDown);this.connect(this,
"up",this.onCarouselableUp);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.connect(this,"wheel",this.onWheel)},setLoader:function(a){for(this.loader=a;void 0!==this.getFirstChild();)this.removeChild(this.getFirstChild());this.lastPosition=void 0;this.activeItems=[];this.activeItemsPos=0;this.pos<this.loader.getMin()&&(this.pos=this.loader.getMin());this.pos>this.loader.getMax()&&(this.pos=this.loader.getMax());this.loadItems();this.updateItems()},getLoader:function(){return this.loader},
getBufferingSize:function(){return this.bufferingSize},setBufferingSize:function(a){this.bufferingSize!==a&&(this.bufferingSize=a,this.updateItems())},getCurrentPosition:function(){return void 0!==this.alignClock?this.animNext:this.pos},getCurrent:function(){var a=this.getCurrentPosition()-this.activeItemsPos;if(0<=a&&a<this.activeItems.length)return this.activeItems[a]},setCurrentAt:function(a,b){a=Math.min(2*this.loader.getMax(),Math.max(2*this.loader.getMin(),a));b?(this.pos=a,this.setPosition(-this.pos*
this.getLayoutWidth(),void 0),this.onChange()):this.startAnimation(2*(this.pos-a),a,"program")},next:function(a){void 0===a&&(a="program");void 0===this.alignClock?this.pos<this.loader.getMax()&&this.startAnimation(-2,this.pos+1,a):this.animNext>this.pos?this.startAnimation(-2*(this.animNext+1-Math.floor(this.pos)),Math.min(this.animNext+1,this.loader.getMax()),a):this.startAnimation(-2,Math.min(Math.ceil(this.pos),this.loader.getMax()),a)},previous:function(a){void 0===a&&(a="program");void 0===
this.alignClock?this.pos>this.loader.getMin()&&this.startAnimation(2,this.pos-1,a):this.animNext<this.pos?this.startAnimation(2*(Math.floor(this.pos)-(this.animNext-1)),Math.max(this.animNext-1,0),a):this.startAnimation(2,Math.floor(this.pos),a)},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},onKeyDown:function(a){if(!this.getIsDisabled()){var b=a.which;if(37==b||39==b)a.stopPropagation(),a.preventDefault(),37==b?this.previous():39==b&&this.next()}},onWheel:function(a){0!==a.deltaX&&
(a.stopPropagation(),0>a.deltaX?this.previous():this.next())},onCarouselableDown:function(){this.stopAnimation()},onCarouselableUp:function(a,b,c,d,e,f,g){!0===g?(a=this.pos%1,b=0.5<a?-400:400):50>Math.abs(b)&&(d>0.2*this.getLayoutWidth()||100<Math.abs(d)?b=0>d?-400:400:(a=this.pos%1,b=0.5<a?-400:400));800>Math.abs(b)&&(b=0>b?-800:800);0!==b&&this.startAnimation(b/this.getLayoutWidth(),void 0,"user")},onChange:function(a){void 0===a&&(a="program");this.loadItems();this.updateItems();var b=this.getCurrentPosition();
if(void 0===this.lastPosition||this.lastPosition!==b)this.lastPosition=b,this.fireEvent("change",this,b,a)},onAlignTick:function(a,b,c){if(0!==c&&(a=-(a.getTime()*this.speed)/(this.animNext-this.animStart),1<=a&&(this.alignClock.stop(),this.alignClock=void 0,a=1),a=this.ease.ease(a),this.pos=this.animStart+a*(this.animNext-this.animStart),this.setPosition(-this.pos*this.getLayoutWidth(),void 0),void 0===this.alignClock))this.onChange(this.animSource)},startAnimation:function(a,b,c){this.stopAnimation();
this.speed=a;this.animStart=this.pos;this.animSource=c;this.animNext=void 0===b?0>this.speed?Math.ceil(this.animStart):Math.floor(this.animStart):b;this.animStart!==this.animNext&&(this.alignClock=new Anim.Clock({duration:"forever",target:this}),this.connect(this.alignClock,"timeupdate",this.onAlignTick),this.alignClock.begin())},stopAnimation:function(){void 0!==this.alignClock&&(this.alignClock.stop(),this.alignClock=void 0)},loadItems:function(){if(this.getIsLoaded()){var a,b=[];for(a=Math.max(this.loader.getMin(),
Math.floor(this.pos-this.bufferingSize));a<Math.min(this.loader.getMax()+1,Math.floor(this.pos+1+this.bufferingSize));a++){var c;a>=this.activeItemsPos&&a<this.activeItemsPos+this.activeItems.length?c=this.activeItems[a-this.activeItemsPos]:(c=this.loader.getElementAt(a),this.appendChild(c));b.push(c)}for(a=0;a<this.activeItems.length;a++)(this.activeItemsPos+a<Math.max(this.loader.getMin(),Math.floor(this.pos-this.bufferingSize))||this.activeItemsPos+a>=Math.min(this.loader.getMax()+1,Math.floor(this.pos+
1+this.bufferingSize)))&&this.removeChild(this.activeItems[a]);this.activeItems=b;this.activeItemsPos=Math.max(this.loader.getMin(),Math.floor(this.pos-this.bufferingSize))}},updateItems:function(){if(this.getIsLoaded()){var a=this.getLayoutWidth(),b=this.getLayoutHeight();void 0!==this.animClock&&(target=this.animNext);for(var c=0;c<this.activeItems.length;c++){var d=this.activeItems[c],e=this.activeItemsPos+c;d.measure(a,b);d.arrange(0,0,a,b);d.setTransform(Ui.Matrix.createTranslate((e-this.pos)*
a,0))}}},getLogicalChildren:function(){return this.getChildren()}},{onLoad:function(){Ui.Carouselable3.base.onLoad.call(this);this.loadItems();this.updateItems()},onMove:function(a,b){if(!(0>=this.getLayoutWidth())){this.pos=-a/this.getLayoutWidth();if(this.pos<this.loader.getMin()||this.pos>this.loader.getMax())this.pos=Math.max(this.loader.getMin(),Math.min(this.pos,this.loader.getMax())),this.setPosition(-this.pos*this.getLayoutWidth());this.updateItems()}},arrangeCore:function(a,b){this.setPosition(-this.pos*
a,void 0)},onChildInvalidateMeasure:function(a,b){}});Ui.LBox.extend("Ui.Form",{constructor:function(a){this.addEvents("submit");this.connect(this.getDrawing(),"submit",this.onSubmit)},onSubmit:function(a){a.preventDefault();a.stopPropagation();this.fireEvent("submit",this)},submit:function(){this.getDrawing().submit()}},{renderDrawing:function(){var a;a=document.createElement("form");var b=document.createElement("input");b.type="submit";b.style.visibility="hidden";a.appendChild(b);b=document.createElement("div");this.setContainerDrawing(b);a.appendChild(b);
return a}});Core.Object.extend("Ui.Selection",{elements:void 0,constructor:function(a){this.addEvents("change");this.elements=[]},clear:function(){var a=this.elements;this.elements=[];for(var b=0;b<a.length;b++)this.connect(a[b],"unload",this.onElementUnload),a[b].setIsSelected(!1);this.fireEvent("change",this)},append:function(a){var b,c=!1;for(b=0;!c&&b<this.elements.length;b++)c=this.elements[b]===a;if(!c){var c=!1,d=this.getElementActions(a),e;for(e in d)!0===d[e].multiple&&(c=!0);if(0<this.elements.length){e=
!0;for(b=0;e&&b<this.elements.length;b++){var f=!1,g=this.getElementActions(this.elements[b]),l;for(l in d){var k=d[l];if(!0===k.multiple)for(var h in g){var n=g[h];if(!0===n.multiple&&n.callback===k.callback){f=!0;break}}}e=e&&f}if(!e||!c){for(b=0;b<this.elements.length;b++)this.elements[b].setIsSelected(!1);this.elements=[]}}this.elements.push(a);this.connect(a,"unload",this.onElementUnload);this.fireEvent("change",this)}},remove:function(a){for(var b,c=0;void 0===b&&c<this.elements.length;c++)this.elements[c]===
a&&(b=c);void 0!==b&&(this.elements.splice(b,1),this.disconnect(a,"unload",this.onElementUnload),this.fireEvent("change",this))},getElements:function(){return this.elements.slice()},getElementActions:function(a){for(var b=Core.Util.clone(a.getSelectionActions()),c=a.getParent();null!==c&&void 0!==c;)"getContextActions"in c&&(b=c.getContextActions(a,b)),c=c.getParent();return b},getActions:function(){var a,b,c,d;if(0!==this.elements.length){if(1===this.elements.length)for(c in a={},b=this.getElementActions(this.elements[0]),
b){if(d=b[c],!("testRight"in d)||d.testRight.call(this.elements[0]))a[c]=b[c]}else for(c in a={},b=this.getElementActions(this.elements[0]),b)if(d=b[c],!0===d.multiple){for(var e=!0,f=1;e&&f<this.elements.length;f++){var g=!1,l=this.getElementActions(this.elements[f]),k;for(k in l){var h=l[k];if(!0===h.multiple&&h.callback===d.callback){g=!0;break}}e=e&&g}if(e){e=!0;if("testRight"in d)for(var f=0;e&&f<this.elements.length;f++)e&=d.testRight.call(this.elements[f]);e&&(a[c]=b[c])}}return a}},getDefaultAction:function(){var a=
this.getActions(),b;for(b in a)if(!0===a[b]["default"])return a[b]},executeDefaultAction:function(){var a=this.getDefaultAction();if(void 0!==a){var b=this;"scope"in a&&(b=a.scope);a.callback.call(b,this);this.clear();return!0}return!1},getDeleteAction:function(){var a=this.getActions();if("delete"in a)return a["delete"];if(void 0!==a.suppress)return a.suppress},executeDeleteAction:function(){var a=this.getDeleteAction();if(void 0!==a){var b=this;"scope"in a&&(b=a.scope);a.callback.call(b,this);this.clear();
return!0}return!1},onElementUnload:function(a){this.remove(a)}});Ui.Draggable.extend("Ui.Selectionable",{isSelected:!1,handler:void 0,constructor:function(a){this.connect(this,"activate",this.onSelectionableActivate);this.connect(this,"dragstart",this.onSelectionableDragStart);this.connect(this,"dragend",this.onSelectionableDragEnd)},getIsSelected:function(){return this.isSelected},setIsSelected:function(a){if(this.isSelected!==a)if(this.isSelected=a)this.onSelect();else this.onUnselect()},onSelect:function(){},onUnselect:function(){},getSelectionActions:function(){return{}},
getParentSelectionHandler:function(){for(var a=this.getParent();void 0!==a&&!("getSelectionHandler"in a);)a=a.getParent();if(void 0!==a)return a.getSelectionHandler()},onSelectionableDragStart:function(){this.select()},onSelectionableDragEnd:function(){if(this.getIsSelected()){var a=this.getParentSelectionHandler();void 0!==a&&a.clear()}},onSelectionableActivate:function(){if(this.getIsLoaded()){this.select();var a=this.getParentSelectionHandler();void 0!==a&&(void 0!==a.getDefaultAction()?a.executeDefaultAction():
this.unselect())}},select:function(){this.getIsLoaded()&&(this.handler=this.getParentSelectionHandler(),void 0!==this.handler&&(this.handler.append(this),this.setIsSelected(!0)))},unselect:function(){void 0!==this.handler&&(this.handler.remove(this),this.setIsSelected(!1))}},{onUnload:function(){this.getIsSelected()&&this.unselect();Ui.Selectionable.base.onUnload.call(this)}});Ui.Rectangle.extend("Ui.Separator",{constructor:function(a){this.setHeight(1);this.setWidth(1)}},{onStyleChange:function(){this.setFill(this.getStyleProperty("color"))}},{style:{color:"#444444"}});Ui.Element.extend("Ui.Entry",{fontSize:void 0,fontFamily:void 0,fontWeight:void 0,color:void 0,value:"",passwordMode:!1,constructor:function(a){this.addEvents("change","validate");this.setSelectable(!0);this.setFocusable(!0);this.connect(this.getDrawing(),"change",this.onChange);this.connect(this.getDrawing(),"paste",this.onPaste);this.connect(this.getDrawing(),"keyup",this.onKeyUp);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},setPasswordMode:function(a){if(this.passwordMode!=a){this.passwordMode=
a;try{this.passwordMode?this.getDrawing().setAttribute("type","password"):this.getDrawing().setAttribute("type","text")}catch(b){a=this.getDrawing().cloneNode(!1),this.passwordMode?a.setAttribute("type","password"):a.setAttribute("type","text"),this.getDrawing().parentNode.replaceChild(a,this.getDrawing()),this.drawing=a,this.invalidateArrange()}}},setFontSize:function(a){this.fontSize!=a&&(this.fontSize=a,this.getDrawing().style.fontSize=this.getFontSize()+"px",this.invalidateMeasure())},getFontSize:function(){return void 0!=
this.fontSize?this.fontSize:this.getStyleProperty("fontSize")},setFontFamily:function(a){this.fontFamily!=a&&(this.fontFamily=a,this.getDrawing().style.fontFamily=this.getFontFamily(),this.invalidateMeasure())},getFontFamily:function(){return void 0!=this.fontFamily?this.fontFamily:this.getStyleProperty("fontFamily")},setFontWeight:function(a){this.fontWeight!=a&&(this.fontWeight=a,this.getDrawing().style.fontWeight=this.getFontWeight(),this.invalidateMeasure())},getFontWeight:function(){return void 0!=
this.fontWeight?this.fontWeight:this.getStyleProperty("fontWeight")},setColor:function(a){this.color!=a&&(this.color=Ui.Color.create(a),navigator.supportRgba?this.getDrawing().style.color=this.getColor().getCssRgba():this.getDrawing().style.color=this.getColor().getCssHtml())},getColor:function(){return void 0!=this.color?this.color:Ui.Color.create(this.getStyleProperty("color"))},getValue:function(){return this.value},setValue:function(a){if(null===a||void 0===a)a="";this.value=a;this.getDrawing().value=
this.value},onPaste:function(a){a.stopPropagation();new Core.DelayedTask({delay:0,scope:this,callback:this.onAfterPaste})},onAfterPaste:function(){this.getDrawing().value!=this.value&&(this.value=this.getDrawing().value,this.fireEvent("change",this,this.value))},onChange:function(a){this.getDrawing().value!=this.value&&(this.value=this.getDrawing().value,this.fireEvent("change",this,this.value))},onKeyDown:function(a){var b=a.which;(37==b||39==b||46==b||8==b)&&a.stopPropagation()},onKeyUp:function(a){var b=
a.which;(37==b||39==b||46==b||8==b)&&a.stopPropagation();this.getDrawing().value!==this.value&&(this.value=this.getDrawing().value,this.fireEvent("change",this,this.value))}},{renderDrawing:function(){var a=document.createElement("input");a.setAttribute("type","text");a.style.opacity=1;a.style.border="0px";a.style.margin="0px";a.style.padding="0px";a.style.outline="none";navigator.isIE?a.style.backgroundColor="rgba(255,255,255,0.01)":a.style.background="none";navigator.isWebkit&&(a.style.webkitAppearance=
"none");a.style.fontSize=this.getFontSize()+"px";a.style.fontFamily=this.getFontFamily();a.style.fontWeight=this.getFontWeight();a.style.color=this.getColor();return a},measureCore:function(a,b){return{width:8,height:3*this.getFontSize()/2}},arrangeCore:function(a,b){this.getDrawing().style.width=a+"px";this.getDrawing().style.height=b+"px";this.getDrawing().style.lineHeight=b+"px"},onDisable:function(){Ui.Entry.base.onDisable.call(this);this.getDrawing().blur();this.getDrawing().style.cursor="default";
this.getDrawing().disabled=!0},onEnable:function(){Ui.Entry.base.onEnable.call(this);this.getDrawing().style.cursor="auto";this.getDrawing().disabled=!1},onStyleChange:function(){this.getDrawing().style.fontSize=this.getFontSize()+"px";this.getDrawing().style.fontFamily=this.getFontFamily();this.getDrawing().style.fontWeight=this.getFontWeight();navigator.supportRgba?this.getDrawing().style.color=this.getColor().getCssRgba():this.getDrawing().style.color=this.getColor().getCssHtml();this.invalidateMeasure()}},
{style:{color:new Ui.Color({r:0,g:0,b:0}),fontSize:14,fontFamily:"Sans-serif",fontWeight:"normal"}});Ui.Element.extend("Ui.TextArea",{fontSize:void 0,fontFamily:void 0,fontWeight:void 0,color:void 0,value:"",constructor:function(a){this.addEvents("change");this.setSelectable(!0);this.setFocusable(!0);this.connect(this.getDrawing(),"change",this.onChange);this.connect(this.getDrawing(),"paste",this.onPaste);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.connect(this.getDrawing(),"keyup",this.onKeyUp)},setFontSize:function(a){this.fontSize!=a&&(this.fontSize=a,this.getDrawing().style.fontSize=
this.getFontSize()+"px",this.invalidateMeasure())},getFontSize:function(){return void 0!==this.fontSize?this.fontSize:this.getStyleProperty("fontSize")},setFontFamily:function(a){this.fontFamily!==a&&(this.fontFamily=a,this.getDrawing().style.fontFamily=this.getFontFamily(),this.invalidateMeasure())},getFontFamily:function(){return void 0!==this.fontFamily?this.fontFamily:this.getStyleProperty("fontFamily")},setFontWeight:function(a){this.fontWeight!==a&&(this.fontWeight=a,this.getDrawing().style.fontWeight=
this.getFontWeight(),this.invalidateMeasure())},getFontWeight:function(){return void 0!==this.fontWeight?this.fontWeight:this.getStyleProperty("fontWeight")},setColor:function(a){this.color!==a&&(this.color=Ui.Color.create(a),navigator.supportRgba?this.getDrawing().style.color=this.getColor().getCssRgba():this.getDrawing().style.color=this.getColor().getCssHtml())},getColor:function(){return void 0!==this.color?this.color:Ui.Color.create(this.getStyleProperty("color"))},getValue:function(){return this.getDrawing().value},
setValue:function(a){null===a||void 0===a?this.getDrawing().value="":this.getDrawing().value=a;this.invalidateMeasure()},setOffset:function(a,b){this.getDrawing().scrollLeft=a;this.getDrawing().scrollTop=b},getOffsetX:function(){return this.getDrawing().scrollLeft},getOffsetY:function(){return this.getDrawing().scrollTop},onPaste:function(a){a.stopPropagation();new Core.DelayedTask({delay:0,scope:this,callback:this.onAfterPaste})},onAfterPaste:function(){this.getDrawing().value!=this.value&&(this.value=
this.getDrawing().value,this.fireEvent("change",this,this.value))},onChange:function(a){this.getDrawing().value!=this.value&&(this.value=this.getDrawing().value,this.fireEvent("change",this,this.value),this.invalidateMeasure())},onKeyDown:function(a){var b=a.which;(37==b||39==b||38==b||40==b||46==b||8==b)&&a.stopPropagation()},onKeyUp:function(a){var b=a.which;(37==b||39==b||38==b||40==b||46==b||8==b)&&a.stopPropagation();this.getDrawing().value!==this.value&&(this.value=this.getDrawing().value,this.fireEvent("change",
this,this.value),this.invalidateMeasure())}},{renderDrawing:function(){var a=document.createElement("textarea");a.setAttribute("rows",1);a.setAttribute("cols",1);a.style.opacity=1;a.style.display="block";a.style.resize="none";a.style.overflow="hidden";a.style.border="0px";a.style.margin="0px";a.style.padding="0px";a.style.outline="none";navigator.isIE?a.style.backgroundColor="rgba(255,255,255,0.01)":a.style.background="none";navigator.isWebkit&&(a.style.webkitAppearance="none");a.style.fontSize=this.getFontSize()+
"px";a.style.fontFamily=this.getFontFamily();a.style.fontWeight=this.getFontWeight();a.style.color=navigator.supportRgba?this.getColor().getCssRgba():this.getColor().getCssHtml();return a},measureCore:function(a,b){this.getDrawing().style.width=a+"px";this.getDrawing().style.height="0px";var c={width:this.getDrawing().scrollWidth,height:Math.max(3*this.getFontSize()/2,this.getDrawing().scrollHeight)};this.getDrawing().style.width=this.getLayoutWidth()+"px";this.getDrawing().style.height=this.getLayoutHeight()+
"px";return c},arrangeCore:function(a,b){this.getDrawing().style.width=a+"px";this.getDrawing().style.height=b+"px"},onDisable:function(){Ui.TextArea.base.onDisable.call(this);this.getDrawing().blur();this.getDrawing().style.cursor="default";this.getDrawing().disabled=!0},onEnable:function(){Ui.TextArea.base.onEnable.call(this);this.getDrawing().style.cursor="auto";this.getDrawing().disabled=!1},onStyleChange:function(){this.getDrawing().style.fontSize=this.getFontSize()+"px";this.getDrawing().style.fontFamily=
this.getFontFamily();this.getDrawing().style.fontWeight=this.getFontWeight();navigator.supportRgba?this.getDrawing().style.color=this.getColor().getCssRgba():this.getDrawing().style.color=this.getColor().getCssHtml();this.invalidateMeasure()}},{style:{color:new Ui.Color({r:0,g:0,b:0}),fontSize:14,fontFamily:"Sans-serif",fontWeight:"normal"}});Ui.CompactLabel.extend("Ui.ButtonText",{});
Ui.CanvasElement.extend("Ui.ButtonBackground",{borderWidth:1,border:void 0,background:void 0,radius:3,constructor:function(){this.setBorder("black");this.setBackground("white")},setBorderWidth:function(a){this.borderWidth=a;this.invalidateDraw()},setBorder:function(a){this.border=Ui.Color.create(a);this.invalidateDraw()},setRadius:function(a){this.radius=a;this.invalidateDraw()}},{setBackground:function(a){this.background=Ui.Color.create(a);this.invalidateDraw()},updateCanvas:function(a){var b=this.getLayoutWidth(),
c=this.getLayoutHeight(),d=Math.min(this.radius,Math.min(b,c)/2);a.beginPath();var e=Math.max(0,d-this.borderWidth);a.roundRect(this.borderWidth,this.borderWidth,b-2*this.borderWidth,c-2*this.borderWidth,e,e,e,e);a.closePath();a.fillStyle=this.background.getCssRgba();a.fill();0<this.borderWidth&&(a.beginPath(),a.roundRect(0,0,b,c,d,d,d,d),a.roundRect(this.borderWidth,this.borderWidth,b-2*this.borderWidth,c-2*this.borderWidth,e,e,e,e,!0),a.closePath(),a.fillStyle=this.border.getCssRgba(),a.fill())}});
Ui.CanvasElement.extend("Ui.ButtonIcon",{badge:void 0,badgeColor:void 0,badgeTextColor:void 0,fill:void 0,icon:"eye",constructor:function(){this.setFill("black");this.setBadgeColor("red");this.setBadgeTextColor("white")},getIcon:function(){return this.icon},setIcon:function(a){this.icon=a;this.invalidateDraw()},setBadge:function(a){this.badge=a;this.invalidateDraw()},setBadgeColor:function(a){this.badgeColor=Ui.Color.create(a);this.invalidateDraw()},setBadgeTextColor:function(a){this.badgeTextColor=
Ui.Color.create(a);this.invalidateDraw()},setFill:function(a){this.fill=Ui.Color.create(a);this.invalidateDraw()}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=Math.min(b,c);a.save();a.translate((b-d)/2,(c-d)/2);void 0!==this.badge?Ui.Icon.drawIconAndBadge(a,this.icon,d,this.fill.getCssRgba(),this.badge,d/2.5,this.badgeColor.getCssRgba(),this.badgeTextColor.getCssRgba()):Ui.Icon.drawIcon(a,this.icon,d,this.fill.getCssRgba());a.restore()}});
Ui.Selectionable.extend("Ui.Button",{dropbox:void 0,isActive:!1,mainBox:void 0,buttonPartsBox:void 0,icon:void 0,iconBox:void 0,text:void 0,textBox:void 0,marker:void 0,badge:void 0,bg:void 0,orientation:void 0,constructor:function(a){this.dropbox=new Ui.DropBox;this.setContent(this.dropbox);this.bg=new Ui.ButtonBackground;this.dropbox.setContent(this.bg);this.mainBox=new Ui.HBox({verticalAlign:"center"});this.dropbox.append(this.mainBox);this.buttonPartsBox=new Ui.Box;this.mainBox.append(this.buttonPartsBox,
!0);this.textBox=new Ui.LBox;this.iconBox=new Ui.LBox;this.connect(this,"down",this.updateColors);this.connect(this,"up",this.updateColors);this.connect(this,"focus",this.updateColors);this.connect(this,"blur",this.updateColors);this.connect(this,"enter",this.updateColors);this.connect(this,"leave",this.updateColors)},getDropBox:function(){return this.dropbox},getBackground:function(){return this.bg},setBackground:function(a){this.dropbox.remove(this.bg);this.bg=void 0===a?new Ui.ButtonBackground:
a;this.dropbox.prepend(this.bg);this.onStyleChange()},getTextBox:function(){return this.textBox},getText:function(){return this.text},setText:function(a){"string"===typeof a?void 0!==this.text?Ui.ButtonText.hasInstance(this.text)?this.text.setText(a):(this.text=new Ui.ButtonText({text:a,color:this.getForeground()}),this.textBox.setContent(this.text)):(this.text=new Ui.ButtonText({text:a,color:this.getForeground()}),this.textBox.setContent(this.text)):(this.text=a,Ui.Element.hasInstance(this.text)?
this.textBox.setContent(this.text):void 0!==this.text&&(this.text=new Ui.ButtonText({text:this.text.toString(),color:this.getForeground()}),this.textBox.setContent(this.text)));this.updateVisibles()},getIconBox:function(){return this.iconBox},getIcon:function(){return this.icon},setIcon:function(a){"string"===typeof a?void 0!==this.icon?Ui.ButtonIcon.hasInstance(this.icon)?this.icon.setIcon(a):(this.icon=new Ui.ButtonIcon({icon:a,badge:this.badge,fill:this.getForeground(),badgeColor:this.getStyleProperty("badgeColor"),
badgeTextColor:this.getStyleProperty("badgeTextColor")}),this.iconBox.setContent(this.icon)):(this.icon=new Ui.ButtonIcon({icon:a,badge:this.badge,fill:this.getForeground(),badgeColor:this.getStyleProperty("badgeColor"),badgeTextColor:this.getStyleProperty("badgeTextColor")}),this.iconBox.setContent(this.icon)):(this.icon=a,this.iconBox.setContent(this.icon));this.updateVisibles()},setMarker:function(a){void 0!==this.marker&&this.mainBox.remove(this.marker);this.marker=a;this.mainBox.append(this.marker)},
getIsActive:function(){return this.isActive},setIsActive:function(a){this.isActive!==a&&(this.isActive=a,this.updateColors())},getBadge:function(){return this.badge},setBadge:function(a){this.badge=a;Ui.ButtonIcon.hasInstance(this.icon)&&this.icon.setBadge(a)},getOrientation:function(){return void 0!==this.orientation?this.orientation:this.getStyleProperty("orientation")},setOrientation:function(a){this.orientation=a;this.buttonPartsBox.setOrientation(this.getOrientation());this.updateVisibles()},
getBackground:function(){var a=(this.isActive?this.getHasFocus()&&!this.getIsMouseFocus()?Ui.Color.create(this.getStyleProperty("focusActiveBackground")):Ui.Color.create(this.getStyleProperty("activeBackground")):this.getHasFocus()&&!this.getIsMouseFocus()?Ui.Color.create(this.getStyleProperty("focusBackground")):Ui.Color.create(this.getStyleProperty("background"))).getYuva(),b=0;this.getIsDown()?b=-0.2:this.getIsOver()&&(b=0.2,a.a=Math.max(0.4,a.a));return new Ui.Color({y:a.y+b,u:a.u,v:a.v,a:a.a})},
getBackgroundBorder:function(){var a=(this.isActive?this.getHasFocus()&&!this.getIsMouseFocus()?Ui.Color.create(this.getStyleProperty("focusActiveBackgroundBorder")):Ui.Color.create(this.getStyleProperty("activeBackgroundBorder")):this.getHasFocus()&&!this.getIsMouseFocus()?Ui.Color.create(this.getStyleProperty("focusBackgroundBorder")):Ui.Color.create(this.getStyleProperty("backgroundBorder"))).getYuva(),b=0;this.getIsDown()?b=-0.2:this.getIsOver()&&(b=0.2);return new Ui.Color({y:a.y+b,u:a.u,v:a.v,
a:a.a})},getForeground:function(){var a;a=this.isActive?this.getHasFocus()&&!this.getIsMouseFocus()?Ui.Color.create(this.getStyleProperty("focusActiveForeground")):Ui.Color.create(this.getStyleProperty("activeForeground")):this.getHasFocus()&&!this.getIsMouseFocus()?Ui.Color.create(this.getStyleProperty("focusForeground")):Ui.Color.create(this.getStyleProperty("foreground"));var b=0;this.getIsDown()?b=-0.2:this.getIsOver()&&(b=0.2);a=a.getYuva();return new Ui.Color({y:a.y+b,u:a.u,v:a.v,a:a.a})},getIsTextVisible:function(){return void 0!==
this.text&&(this.getStyleProperty("showText")||void 0===this.icon)},getIsIconVisible:function(){return void 0!==this.icon&&(this.getStyleProperty("showIcon")||void 0===this.text)},updateVisibles:function(){this.getIsTextVisible()?(void 0===this.textBox.getParent()&&this.buttonPartsBox.append(this.textBox,!0),Ui.ButtonText.hasInstance(this.text)&&(this.getIsIconVisible()&&"horizontal"===this.getOrientation()?(this.text.setTextAlign("left"),this.mainBox.setHorizontalAlign(void 0)):(this.text.setTextAlign("center"),
this.mainBox.setHorizontalAlign("center")),this.text.setFontFamily(this.getStyleProperty("fontFamily")),this.text.setFontSize(this.getStyleProperty("fontSize")),this.text.setFontWeight(this.getStyleProperty("fontWeight")),this.text.setMaxLine(this.getStyleProperty("maxLine")),this.text.setWhiteSpace(this.getStyleProperty("whiteSpace")),this.text.setInterLine(this.getStyleProperty("interLine")),this.text.setTextTransform(this.getStyleProperty("textTransform")))):void 0!==this.textBox.getParent()&&
this.buttonPartsBox.remove(this.textBox);this.getIsIconVisible()?(Ui.Box.setResizable(this.iconBox,!this.getIsTextVisible()),void 0===this.iconBox.getParent()&&this.buttonPartsBox.prepend(this.iconBox)):void 0!==this.iconBox.getParent()&&this.buttonPartsBox.remove(this.iconBox);"horizontal"===this.getOrientation()?this.getIsTextVisible()&&this.text.setVerticalAlign("center"):this.getIsIconVisible()&&this.getIsTextVisible()?this.text.setVerticalAlign("top"):this.getIsTextVisible()&&this.text.setVerticalAlign("center")},
updateColors:function(){var a=this.getForeground();Ui.ButtonBackground.hasInstance(this.bg)&&(this.bg.setBackground(this.getBackground()),this.bg.setBorder(this.getBackgroundBorder()));Ui.ButtonText.hasInstance(this.text)&&this.text.setColor(a);Ui.ButtonIcon.hasInstance(this.icon)&&(this.icon.setFill(a),this.icon.setBadgeColor(this.getStyleProperty("badgeColor")),this.icon.setBadgeTextColor(this.getStyleProperty("badgeTextColor")))}},{onDisable:function(){Ui.Button.base.onDisable.apply(this,arguments);
this.setOpacity(0.4)},onEnable:function(){Ui.Button.base.onEnable.apply(this,arguments);this.setOpacity(1)},onStyleChange:function(){this.buttonPartsBox.setSpacing(Math.max(0,this.getStyleProperty("spacing")));this.buttonPartsBox.setMargin(Math.max(0,this.getStyleProperty("padding")));Ui.ButtonBackground.hasInstance(this.bg)&&(this.bg.setRadius(this.getStyleProperty("radius")),this.bg.setBorderWidth(this.getStyleProperty("borderWidth")));var a=Math.max(0,this.getStyleProperty("iconSize"));this.iconBox.setWidth(a);
this.iconBox.setHeight(a);this.textBox.setWidth(this.getStyleProperty("textWidth"));this.textBox.setMaxWidth(this.getStyleProperty("maxTextWidth"));this.textBox.setHeight(this.getStyleProperty("textHeight"));this.buttonPartsBox.setOrientation(this.getOrientation());this.updateVisibles();this.updateColors()}},{style:{orientation:"horizontal",borderWidth:1,badgeColor:"red",badgeTextColor:"white",background:"rgba(250,250,250,1)",backgroundBorder:"rgba(140,140,140,1)",foreground:"#444444",activeBackground:"rgba(250,250,250,1)",
activeBackgroundBorder:"rgba(140,140,140,1)",activeForeground:"#dc6c36",focusBackground:"#07a0e5",focusBackgroundBorder:new Ui.Color({r:0.04,g:0.43,b:0.5}),focusForeground:"rgba(250,250,250,1)",focusActiveBackground:"rgb(33,211,255)",focusActiveBackgroundBorder:new Ui.Color({r:0.04,g:0.43,b:0.5}),focusActiveForeground:"white",radius:3,spacing:10,padding:7,iconSize:26,fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal",textWidth:70,textTransform:"uppercase",maxTextWidth:Number.MAX_VALUE,textHeight:26,
interLine:1,maxLine:3,whiteSpace:"nowrap",showText:!0,showIcon:!0}});Ui.Button.extend("Ui.DefaultButton",{},{},{style:{borderWidth:1,background:"#444444",backgroundBorder:"#444444",foreground:"rgba(250,250,250,1)"}});Ui.Button.extend("Ui.ToggleButton",{isToggled:!1,constructor:function(a){this.addEvents("toggle","untoggle");this.setRole("checkbox");this.getDrawing().setAttribute("aria-checked","false");this.connect(this,"press",this.onToggleButtonPress)},getIsToggled:function(){return this.isToggled},onToggleButtonPress:function(){if(this.isToggled)this.onUntoggle();else this.onToggle()},onToggle:function(){this.isToggled||(this.isToggled=!0,this.setIsActive(!0),this.getDrawing().setAttribute("aria-checked","true"),
this.fireEvent("toggle",this))},onUntoggle:function(){this.isToggled&&(this.isToggled=!1,this.setIsActive(!1),this.getDrawing().setAttribute("aria-checked","false"),this.fireEvent("untoggle",this))},toggle:function(){this.onToggle()},untoggle:function(){this.onUntoggle()}});Ui.Button.extend("Ui.UploadButton",{input:void 0,constructor:function(a){this.addEvents("file");this.input=new Ui.UploadableFileWrapper;this.prepend(this.input);this.connect(this.input,"file",this.onFile);this.connect(this,"press",this.onUploadButtonPress);this.getDropBox().addType("files","copy");this.connect(this.getDropBox(),"dropfile",this.onFile)},setDirectoryMode:function(a){this.input.setDirectoryMode(a)},onUploadButtonPress:function(){this.input.select()},onFile:function(a,b){this.fireEvent("file",
this,b)}});Ui.Button.extend("Ui.LinkButton",{link:void 0,openWindow:!0,target:"_blank",constructor:function(a){this.addEvents("link");this.connect(this,"press",this.onLinkButtonPress)},setSrc:function(a){this.link=a},setOpenWindow:function(a){this.openWindow=a},setTarget:function(a){this.target=a},onLinkButtonPress:function(){this.fireEvent("link",this);this.openWindow?window.open(this.link,this.target):window.location=this.link}},{},{style:{background:"#a4f4f4"}});Ui.LinkButton.extend("Ui.DownloadButton",{constructor:function(a){this.addEvents("download");this.connect(this,"link",this.onLinkPress)},onLinkPress:function(){this.fireEvent("download",this)}},{},{style:{background:"#a4f4a4"}});Ui.Button.extend("Ui.ActionButton",{action:void 0,selection:void 0,constructor:function(a){this.action=a.action;delete a.action;this.selection=a.selection;delete a.selection;this.connect(this.getDropBox(),"drop",this.onActionButtonDrop);this.connect(this,"press",this.onActionButtonDrop);this.getDropBox().addType("all",this.onActionButtonEffect.bind(this))},onActionButtonEffect:function(a,b){if("draggable"in b){for(var c=this.selection.getElements(),d=void 0,e=0;void 0===d&&e<c.length;e++)c[e]===b.draggable&&
(d=c[e]);if(void 0!==d)return["run"]}return[]},onActionButtonDrop:function(){var a=this;"scope"in this.action&&(a=this.action.scope);this.action.callback.call(a,this.selection);this.selection.clear()}},{},{style:{textTransform:"uppercase",radius:0,borderWidth:0,foreground:"rgba(250,250,250,1)",background:"rgba(60,60,60,0)",backgroundBorder:"rgba(60,60,60,0)",focusColor:"#f6caa2"}});Ui.CanvasElement.extend("Ui.CheckBoxGraphic",{isDown:!1,isChecked:!1,color:void 0,checkColor:void 0,activeColor:void 0,borderWidth:2,radius:3,constructor:function(a){this.color=new Ui.Color({r:1,g:1,b:1});this.activeColor=new Ui.Color({r:0.31,g:0.66,b:0.31});this.checkColor=new Ui.Color({r:1,g:1,b:1})},getIsDown:function(){return this.isDown},setIsDown:function(a){this.isDown!=a&&(this.isDown=a,this.invalidateDraw())},getIsChecked:function(){return this.isChecked},setIsChecked:function(a){this.isChecked!=
a&&(this.isChecked=a,this.invalidateDraw())},setRadius:function(a){this.radius!==a&&(this.radius=a,this.invalidateDraw())},getColor:function(){return this.color},setColor:function(a){this.color!==a&&(this.color=Ui.Color.create(a),this.invalidateDraw())},setBorderWidth:function(a){this.borderWidth!==a&&(this.borderWidth=a,this.invalidateDraw())},setCheckColor:function(a){this.checkColor!==a&&(this.checkColor=Ui.Color.create(a),this.invalidateDraw())},getCheckColor:function(){var a=0;this.getIsDown()&&
(a=0.2);var b=this.checkColor.getYuv();return new Ui.Color({y:b.y+a,u:b.u,v:b.v})}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=b/2,e=c/2,f=Math.min(this.radius,10);this.getIsDown()&&(a.globalAlpha=0.8);this.getIsDisabled()&&(a.globalAlpha=0.4);this.isChecked?(a.fillStyle=this.getColor().getCssRgba(),a.beginPath(),a.roundRect(d-10,e-10,20,20,f,f,f,f),a.closePath(),a.fill(),a.globalAlpha=1,d=Ui.Icon.getPath("check"),e=20/48,a.save(),a.translate((b-20)/2,(c-20)/
2),a.scale(e,e),a.fillStyle=this.getCheckColor().getCssRgba(),a.beginPath(),a.svgPath(d),a.closePath(),a.fill(),a.restore()):(a.strokeStyle=this.getColor().getCssRgba(),a.lineWidth=this.borderWidth,a.beginPath(),a.roundRect(d-10+this.borderWidth/2,e-10+this.borderWidth/2,20-this.borderWidth,20-this.borderWidth,f,f,f,f),a.closePath(),a.stroke())},measureCore:function(a,b){return{width:30,height:30}},onDisable:function(){this.invalidateDraw()},onEnable:function(){this.invalidateDraw()}});Ui.Pressable.extend("Ui.CheckBox",{graphic:void 0,contentBox:void 0,hbox:void 0,content:void 0,text:void 0,isToggled:!1,constructor:function(a){this.addEvents("change","toggle","untoggle");this.setRole("checkbox");this.getDrawing().setAttribute("aria-checked","false");this.setPadding(3);this.hbox=new Ui.HBox;this.append(this.hbox);this.graphic=new Ui.CheckBoxGraphic;this.hbox.append(this.graphic);this.connect(this,"down",this.onCheckBoxDown);this.connect(this,"up",this.onCheckBoxUp);this.connect(this,
"focus",this.onCheckFocus);this.connect(this,"blur",this.onCheckBlur);this.connect(this,"press",this.onCheckPress)},getIsToggled:function(){return this.isToggled},getValue:function(){return this.getIsToggled()},setValue:function(a){a?this.toggle():this.untoggle()},setText:function(a){void 0===a?(void 0!==this.contentBox&&(this.hbox.remove(this.contentBox),this.contentBox=void 0),this.content=this.text=void 0):void 0!==this.text?(this.text=a,this.contentBox.setText(this.text)):(void 0!==this.content&&
(this.hbox.remove(this.contentBox),this.content=void 0),this.text=a,this.contentBox=new Ui.Text({margin:8,text:this.text,verticalAlign:"center"}),this.hbox.append(this.contentBox,!0))},getText:function(){return this.text},toggle:function(){this.onToggle()},untoggle:function(){this.onUntoggle()},onCheckPress:function(){if(this.isToggled)this.onUntoggle();else this.onToggle()},onToggle:function(){this.isToggled||(this.isToggled=!0,this.getDrawing().setAttribute("aria-checked","true"),this.fireEvent("toggle",
this),this.graphic.setIsChecked(!0),this.graphic.setColor(this.getStyleProperty("activeColor")),this.fireEvent("change",this,!0))},onUntoggle:function(){this.isToggled&&(this.isToggled=!1,this.getDrawing().setAttribute("aria-checked","false"),this.fireEvent("untoggle",this),this.graphic.setIsChecked(!1),this.graphic.setColor(this.getStyleProperty("color")),this.fireEvent("change",this,!1))},onCheckFocus:function(){this.getIsMouseFocus()||this.graphic.setColor(this.getStyleProperty("focusColor"))},
onCheckBlur:function(){this.isToggled?this.graphic.setColor(this.getStyleProperty("activeColor")):this.graphic.setColor(this.getStyleProperty("color"))},onCheckBoxDown:function(){this.graphic.setIsDown(!0)},onCheckBoxUp:function(){this.graphic.setIsDown(!1)}},{onStyleChange:function(){this.getHasFocus()?this.graphic.setColor(this.getStyleProperty("focusColor")):this.isToggled?this.graphic.setColor(this.getStyleProperty("activeColor")):this.graphic.setColor(this.getStyleProperty("color"));this.graphic.setCheckColor(this.getStyleProperty("checkColor"));
this.graphic.setBorderWidth(this.getStyleProperty("borderWidth"));this.graphic.setRadius(this.getStyleProperty("radius"))},setContent:function(a){void 0===a?(void 0!==this.contentBox&&(this.hbox.remove(this.contentBox),this.contentBox=void 0),this.content=this.text=void 0):(void 0!==this.text&&(this.hbox.remove(this.contentBox),this.text=void 0),void 0!==this.content?this.contentBox.remove(this.content):(this.contentBox=new Ui.LBox({padding:8,verticalAlign:"center"}),this.hbox.append(this.contentBox)),
this.content=a,this.contentBox.append(this.content))}},{style:{borderWidth:2,color:"#444444",activeColor:"#07a0e5",focusColor:"#21d3ff",checkColor:"#ffffff",radius:3}});Ui.Button.extend("Ui.ContextBarCloseButton",{},{},{style:{textWidth:5,radius:0,borderWidth:0,foreground:"rgba(250,250,250,1)",background:"rgba(60,60,60,0)"}});
Ui.LBox.extend("Ui.ContextBar",{bg:void 0,selection:void 0,actionsBox:void 0,closeButton:void 0,constructor:function(a){this.selection=a.selection;delete a.selection;this.bg=new Ui.Rectangle;this.append(this.bg);a=new Ui.HBox({spacing:5});this.append(a);this.closeButton=new Ui.ContextBarCloseButton({icon:"backarrow"});a.append(this.closeButton);this.connect(this.closeButton,"press",this.onClosePress);this.actionsBox=new Ui.MenuToolBar({spacing:5,menuPosition:"left",itemsAlign:"right"});a.append(this.actionsBox,
!0);this.connect(this.selection,"change",this.onSelectionChange)},onClosePress:function(){this.selection.clear()},onSelectionChange:function(){this.closeButton.setText(this.selection.getElements().length);var a=this.selection.getActions();this.actionsBox.clear();for(var b in a){var c=a[b];!0!==c.hidden&&(c=new Ui.ActionButton({icon:c.icon,text:c.text,action:c,selection:this.selection}),this.actionsBox.append(c))}}},{onStyleChange:function(){this.bg.setFill(this.getStyleProperty("background"))}},{style:{background:"#07a0e5"}});Ui.Container.extend("Ui.Popup",{popupSelection:void 0,background:void 0,shadow:void 0,shadowGraphic:void 0,contextBox:void 0,contentBox:void 0,scroll:void 0,posX:void 0,posY:void 0,attachedElement:void 0,attachedBorder:void 0,lbox:void 0,autoClose:!0,preferredWidth:void 0,preferredHeight:void 0,openClock:void 0,isClosed:!0,constructor:function(a){this.addEvents("close");this.setHorizontalAlign("stretch");this.setVerticalAlign("stretch");this.popupSelection=new Ui.Selection;this.shadow=new Ui.Pressable({focusable:!1});
this.shadow.getDrawing().style.cursor="inherit";this.appendChild(this.shadow);this.shadowGraphic=new Ui.Rectangle;this.shadow.setContent(this.shadowGraphic);this.background=new Ui.PopupBackground({radius:0,fill:"#f8f8f8"});this.background.setTransformOrigin(0,0);this.appendChild(this.background);this.contentBox=new Ui.LBox({margin:2,marginTop:1});this.contentBox.setTransformOrigin(0,0);this.appendChild(this.contentBox);this.scroll=new Ui.ScrollingArea({margin:2,marginTop:1});this.contentBox.append(this.scroll);
this.contextBox=new Ui.ContextBar({selection:this.popupSelection,verticalAlign:"top"});this.contextBox.hide(!0);this.contentBox.append(this.contextBox);this.connect(this.popupSelection,"change",this.onPopupSelectionChange);this.connect(this.shadow,"press",this.onShadowPress)},setPreferredWidth:function(a){this.preferredWidth=a;this.invalidateMeasure()},setPreferredHeight:function(a){this.preferredHeight=a;this.invalidateMeasure()},getSelectionHandler:function(){return this.popupSelection},setAutoClose:function(a){this.autoClose=
a},getContent:function(){return this.scroll.getContent()},setContent:function(a){this.scroll.setContent(a)},onWindowResize:function(){this.autoClose&&void 0!==this.posX&&this.close()},onShadowPress:function(){this.autoClose&&this.close()},onOpenTick:function(a,b,c){a=1<=b;this.isClosed&&(b=1-b);this.setOpacity(b);c=this.background.getArrowBorder();this.background.getArrowOffset();"right"===c?(this.background.setTransform(Ui.Matrix.createTranslate(20*(1-b),0)),this.contentBox.setTransform(Ui.Matrix.createTranslate(20*
(1-b),0))):"left"===c?(this.background.setTransform(Ui.Matrix.createTranslate(-20*(1-b),0)),this.contentBox.setTransform(Ui.Matrix.createTranslate(-20*(1-b),0))):"top"===c||"none"===c?(this.background.setTransform(Ui.Matrix.createTranslate(0,-20*(1-b))),this.contentBox.setTransform(Ui.Matrix.createTranslate(0,-20*(1-b)))):"bottom"===c&&(this.background.setTransform(Ui.Matrix.createTranslate(0,20*(1-b))),this.contentBox.setTransform(Ui.Matrix.createTranslate(0,20*(1-b))));a&&(this.openClock.stop(),
this.openClock=void 0,this.isClosed&&(Ui.App.current.removeDialog(this),this.enable()))},onPopupSelectionChange:function(a){0===a.getElements().length?this.contextBox.hide(!0):this.contextBox.show()}},{onStyleChange:function(){this.background.setFill(this.getStyleProperty("background"));this.shadowGraphic.setFill(this.getStyleProperty("shadow"))},onChildInvalidateMeasure:function(a,b){this.invalidateLayout()},onChildInvalidateArrange:function(a){this.invalidateLayout()},open:function(a,b){if(this.isClosed){Ui.App.current.appendDialog(this);
this.isClosed=!1;this.posY=this.posX=this.attachedElement=void 0;if("object"==typeof a&&Ui.Element.hasInstance(a)){this.attachedElement=a;void 0!==b&&"string"===typeof b&&(this.attachedBorder=b);var c=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth(),y:this.attachedElement.getLayoutHeight()/2});this.posX=c.x;this.posY=c.y}else void 0!==a&&void 0!==b?(this.posX=a,this.posY=b):this.posY=this.posX=void 0;void 0===this.openClock&&(this.openClock=new Anim.Clock({duration:1,target:this,
speed:5}),this.openClock.setEase(new Anim.PowerEase({mode:"out"})),this.connect(this.openClock,"timeupdate",this.onOpenTick),this.setOpacity(0));this.invalidateArrange();this.connect(window,"resize",this.onWindowResize)}},close:function(){this.isClosed||(this.isClosed=!0,this.fireEvent("close",this),this.disconnect(window,"resize",this.onWindowResize),this.disable(),void 0===this.openClock&&(this.openClock=new Anim.Clock({duration:1,target:this,speed:5}),this.openClock.setEase(new Anim.PowerEase({mode:"out"})),
this.connect(this.openClock,"timeupdate",this.onOpenTick),this.openClock.begin()))},measureCore:function(a,b){var c=Math.max(a-40,0),d=Math.max(b-40,0);void 0!==this.preferredWidth&&this.preferredWidth<c&&(c=this.preferredWidth);void 0!==this.preferredHeight&&this.preferredHeight<d&&(d=this.preferredHeight);this.background.measure(c,d);c=this.contentBox.measure(c,d);return void 0!==this.posX||void 0!==this.attachedElement?{width:Math.max(50,c.width),height:Math.max(50,c.height)}:{width:Math.max(a,
c.width+40),height:Math.max(b,c.height+40)}},arrangeCore:function(a,b){void 0!==this.openClock&&!this.openClock.getIsActive()&&this.openClock.begin();var c,d,e;this.shadow.arrange(0,0,a,b);if(void 0===this.posX&&void 0===this.attachedElement||150>a||150>b)this.setCenter(a,b);else if(void 0!==this.attachedElement){d=["right","left","top","bottom","center"];void 0!==this.attachedBorder&&d.unshift(this.attachedBorder);for(e=0;e<d.length;e++)if(c=d[e],"left"===c){if(c=this.attachedElement.pointToWindow({x:0,
y:this.attachedElement.getLayoutHeight()/2}),this.contentBox.getMeasureWidth()+10<c.x){this.setLeft(c.x,c.y,a,b);break}}else if("right"===c){if(c=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth(),y:this.attachedElement.getLayoutHeight()/2}),this.contentBox.getMeasureWidth()+c.x+10<a){this.setRight(c.x,c.y,a,b);break}}else if("top"===c){if(c=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth()/2,y:0}),this.contentBox.getMeasureHeight()+10<c.y){this.setTop(c.x,
c.y,a,b);break}}else if("bottom"===c){if(c=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth()/2,y:this.attachedElement.getLayoutHeight()}),this.contentBox.getMeasureHeight()+10+c.y<b){this.setBottom(c.x,c.y,a,b);break}}else{this.setCenter(a,b);break}}else{d=["right","left","top","bottom","center"];void 0!==this.attachedBorder&&d.unshift(this.attachedBorder);for(e=0;e<d.length;e++)if(c=d[e],"left"===c){if(this.contentBox.getMeasureWidth()+10<this.posX){this.setLeft(this.posX,
this.posY,a,b);break}}else if("right"===c){if(this.contentBox.getMeasureWidth()+this.posX+10<a){this.setRight(this.posX,this.posY,a,b);break}}else if("top"===c){if(this.contentBox.getMeasureHeight()+10<this.posY){this.setTop(this.posX,this.posY,a,b);break}}else if("bottom"===c){if(this.contentBox.getMeasureHeight()+10+this.posY<b){this.setBottom(this.posX,this.posY,a,b);break}}else{this.setCenter(a,b);break}}},setRight:function(a,b,c,d){a+=10;c=b-30;this.background.setArrowBorder("left");c+this.contentBox.getMeasureHeight()>
d?(c=d-this.contentBox.getMeasureHeight(),b-=c,b>this.contentBox.getMeasureHeight()-18&&(b=this.contentBox.getMeasureHeight()-18),this.background.setArrowOffset(b)):this.background.setArrowOffset(30);this.background.arrange(a-10,c,this.contentBox.getMeasureWidth()+10,this.contentBox.getMeasureHeight());this.contentBox.arrange(a,c,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},setLeft:function(a,b,c,d){a-=10+this.contentBox.getMeasureWidth();c=b-30;this.background.setArrowBorder("right");
c+this.contentBox.getMeasureHeight()>d?(c=d-this.contentBox.getMeasureHeight(),b-=c,b>this.contentBox.getMeasureHeight()-18&&(b=this.contentBox.getMeasureHeight()-18),this.background.setArrowOffset(b)):this.background.setArrowOffset(30);this.background.arrange(a,c,this.contentBox.getMeasureWidth()+10,this.contentBox.getMeasureHeight());this.contentBox.arrange(a,c,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},setTop:function(a,b,c,d){b-=this.contentBox.getMeasureHeight();d=
a-30;this.background.setArrowBorder("bottom");d+this.contentBox.getMeasureWidth()>c?(d=c-this.contentBox.getMeasureWidth(),a-=d,a>this.contentBox.getMeasureWidth()-18&&(a=this.contentBox.getMeasureWidth()-18),this.background.setArrowOffset(a)):2>d?(this.background.setArrowOffset(a+2),d=2):this.background.setArrowOffset(30);this.background.arrange(d,b-10,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight()+10);this.contentBox.arrange(d,b-10,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},
setBottom:function(a,b,c,d){b+=10;d=a-30;this.background.setArrowBorder("top");d+this.contentBox.getMeasureWidth()>c?(d=c-this.contentBox.getMeasureWidth(),a-=d,a>this.contentBox.getMeasureWidth()-18&&(a=this.contentBox.getMeasureWidth()-18),this.background.setArrowOffset(a)):2>d?(this.background.setArrowOffset(a+2),d=2):this.background.setArrowOffset(30);this.background.arrange(d,b-10,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight()+10);this.contentBox.arrange(d,b,this.contentBox.getMeasureWidth(),
this.contentBox.getMeasureHeight())},setCenter:function(a,b){this.background.setArrowBorder("none");x=(a-this.contentBox.getMeasureWidth())/2;y=(b-this.contentBox.getMeasureHeight())/2;this.background.arrange(x,y,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight());this.contentBox.arrange(x,y,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())}},{style:{background:"#f8f8f8",shadow:new Ui.Color({r:1,g:1,b:1,a:0.1})}});
Ui.CanvasElement.extend("Ui.PopupBackground",{radius:8,fill:"black",arrowBorder:"left",arrowOffset:30,arrowSize:10,constructor:function(a){},getArrowBorder:function(){return this.arrowBorder},setArrowBorder:function(a){this.arrowBorder!=a&&(this.arrowBorder=a,this.invalidateArrange())},getArrowOffset:function(){return this.arrowOffset},setArrowOffset:function(a){this.arrowOffset!=a&&(this.arrowOffset=a,this.invalidateArrange())},setRadius:function(a){this.radius!=a&&(this.radius=a,this.invalidateArrange())},
setFill:function(a){this.fill!=a&&(this.fill=Ui.Color.create(a))},genPath:function(a,b,c,d,e,f){var g;if("none"==d)return d=a-c,g=b-c,"M"+c+",0 L"+d+",0 Q"+a+",0 "+a+","+c+" L"+a+","+g+" Q"+a+","+b+" "+d+","+b+" L"+c+","+b+" Q0,"+b+" 0,"+g+" L0,"+c+" Q0,0 "+c+",0 z";if("left"==d)return d=a-this.radius,g=b-this.radius,"M"+(c+e)+",0 L"+d+",0 Q"+a+",0 "+a+","+c+" L"+a+","+g+" Q"+a+","+b+" "+d+","+b+" L"+(c+e)+","+b+" Q"+e+","+b+" "+e+","+g+" L"+e+","+(f+e)+" L0,"+f+" L"+e+","+(f-e)+" L"+e+","+c+" Q"+
e+",0 "+(c+e)+",0 z";if("right"==d)return d=a-(this.radius+e),g=b-this.radius,"M"+c+",0 L"+d+",0 Q"+(a-e)+",0 "+(a-e)+","+c+" L"+(a-e)+","+(f-e)+" L"+a+","+f+" L"+(a-e)+","+(f+e)+" L "+(a-e)+","+g+" Q"+(a-e)+","+b+" "+d+","+b+" L"+c+","+b+" Q0,"+b+" 0,"+g+" L0,"+c+" Q0,0 "+c+",0 z";if("top"==d)return d=a-this.radius,g=b-this.radius,"M"+c+","+e+" L"+(f-e)+","+e+" L"+f+",0 L"+(f+e)+","+e+" L"+d+","+e+" Q"+a+","+e+" "+a+","+(e+c)+" L"+a+","+g+" Q"+a+","+b+" "+d+","+b+" L"+c+","+b+" Q0,"+b+" 0,"+g+" L0,"+
(e+c)+" Q0,"+e+" "+c+","+e+" z";if("bottom"==d)return d=a-this.radius,g=b-(this.radius+e),"M"+c+",0 L"+d+",0 Q"+a+",0 "+a+","+c+" L"+a+","+g+" Q"+a+","+(b-e)+" "+d+","+(b-e)+" L "+(f+e)+","+(b-e)+" L"+f+","+b+" L"+(f-e)+","+(b-e)+" L"+c+","+(b-e)+" Q0,"+(b-e)+" 0,"+g+" L0,"+c+" Q0,0 "+c+",0 z"}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight();"none"==this.arrowBorder?(a.fillStyle="rgba(0,0,0,0.1)",a.fillRect(0,0,b,c),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(1,1,b-2,
c-2),a.fillStyle=this.fill.getCssRgba(),a.fillRect(2,2,b-4,c-4)):(a.fillStyle="rgba(0,0,0,0.1)",a.svgPath(this.genPath(b,c,this.radius,this.arrowBorder,this.arrowSize,this.arrowOffset)),a.fill(),a.save(),a.fillStyle="rgba(0,0,0,0.5)",a.translate(1,1),a.svgPath(this.genPath(b-2,c-2,this.radius-1,this.arrowBorder,this.arrowSize-1,this.arrowOffset-1)),a.fill(),a.restore(),a.fillStyle=this.fill.getCssRgba(),a.translate(2,2),a.svgPath(this.genPath(b-4,c-4,this.radius-2,this.arrowBorder,this.arrowSize-
1,this.arrowOffset-2)),a.fill())}});Ui.Popup.extend("Ui.MenuPopup",{});Ui.Separator.extend("Ui.MenuPopupSeparator",{});Ui.Button.extend("Ui.Combo",{field:void 0,data:void 0,position:-1,current:void 0,placeHolder:"...",sep:void 0,constructor:function(a){this.addEvents("change");this.arrowtop=new Ui.Icon({icon:"arrowtop",width:10,height:10});this.arrowbottom=new Ui.Icon({icon:"arrowbottom",width:10,height:10});this.setMarker(new Ui.VBox({verticalAlign:"center",content:[this.arrowtop,this.arrowbottom],marginRight:5}))},setPlaceHolder:function(a){this.placeHolder=a;-1===this.position&&this.setText(this.placeHolder)},
setField:function(a){this.field=a;void 0!==this.data&&this.setData(this.data)},setData:function(a){this.data=a},getData:function(){return this.data},getPosition:function(){return this.position},setCurrentAt:function(a){-1===a?(this.position=-1,this.current=void 0,this.setText(this.placeHolder),this.fireEvent("change",this,this.current,this.position)):0<=a&&a<this.data.length&&(this.current=this.data[a],this.position=a,this.setText(this.current[this.field]),this.fireEvent("change",this,this.current,
this.position))},getCurrent:function(){return this.current},getValue:function(){return this.current},setCurrent:function(a){void 0===a&&this.setCurrentAt(-1);for(var b=-1,c=0;c<this.data.length;c++)if(this.data[c]==a){b=c;break}-1!=b&&this.setCurrentAt(b)},onItemPress:function(a,b,c){this.setCurrentAt(c)}},{onPress:function(){var a=new Ui.ComboPopup({field:this.field,data:this.data});-1!==this.position&&a.setCurrentAt(this.position);this.connect(a,"item",this.onItemPress);a.open(this,"right")},updateColors:function(){Ui.Combo.base.updateColors.apply(this,
arguments);this.arrowtop.setFill(this.getForeground());this.arrowbottom.setFill(this.getForeground())}});
Ui.MenuPopup.extend("Ui.ComboPopup",{list:void 0,data:void 0,field:void 0,constructor:function(a){this.addEvents("item");this.setAutoClose(!0);this.list=new Ui.VBox;this.setContent(this.list)},setField:function(a){this.field=a;void 0!==this.data&&this.setData(this.data)},setData:function(a){this.data=a;if(void 0!==this.field)for(var b=0;b<a.length;b++){var c=new Ui.ComboItem({text:a[b][this.field]});this.connect(c,"press",this.onItemPress);this.list.append(c)}},setCurrentAt:function(a){this.list.getChildren()[a].setIsActive(!0)},
onItemPress:function(a){for(var b=-1,c=0;c<this.list.getChildren().length;c++)if(this.list.getChildren()[c]==a){b=c;break}this.fireEvent("item",this,a,b);this.close()}});Ui.Button.extend("Ui.ComboItem",{},{},{style:{borderWidth:0}});Ui.Button.extend("Ui.DialogCloseButton",{constructor:function(){this.setIcon("backarrow");this.setText("Fermer")}},{},{style:{showText:!1,background:"rgba(250,250,250,0)",backgroundBorder:"rgba(250,250,250,0)",activeBackground:"rgba(250,250,250,0)",activeBackgroundBorder:"rgba(250,250,250,0)"}});
Ui.CanvasElement.extend("Ui.DialogGraphic",{background:void 0,constructor:function(){this.background=Ui.Color.create("#f8f8f8")}},{setBackground:function(a){this.background=Ui.Color.create(a);this.invalidateDraw()},updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight();a.roundRectFilledShadow(0,0,b,c,2,2,2,2,!1,3,new Ui.Color({a:0.3}));a.fillStyle=this.background.getCssRgba();a.fillRect(3,3,b-6,c-6)}});
Ui.CompactLabel.extend("Ui.DialogTitle",{},{},{style:{color:"#666666",textAlign:"left",fontWeight:"bold",fontSize:18,maxLine:2}});
Ui.LBox.extend("Ui.DialogButtonBox",{bg:void 0,actionBox:void 0,cancelButton:void 0,actionButtonsBox:void 0,titleLabel:void 0,constructor:function(a){this.addEvents("cancel");this.bg=new Ui.Rectangle;this.append(this.bg);this.actionBox=new Ui.HBox({margin:5,spacing:10});this.append(this.actionBox);this.actionButtonsBox=new Ui.MenuToolBar({spacing:5});this.actionBox.append(this.actionButtonsBox,!0);this.titleLabel=new Ui.DialogTitle({width:50,verticalAlign:"center"});this.actionButtonsBox.append(this.titleLabel,
!0)},getTitle:function(){return this.titleLabel.getText()},setTitle:function(a){this.titleLabel.setText(a)},setCancelButton:function(a){void 0!==this.cancelButton&&(Ui.Pressable.hasInstance(this.cancelButton)&&this.disconnect(this.cancelButton,"press",this.onCancelPress),this.actionBox.remove(this.cancelButton));this.cancelButton=a;void 0!==this.cancelButton&&(Ui.Pressable.hasInstance(this.cancelButton)&&this.connect(this.cancelButton,"press",this.onCancelPress),this.actionBox.prepend(this.cancelButton))},
setActionButtons:function(a){this.actionButtonsBox.setContent(a);this.actionButtonsBox.prepend(this.titleLabel,!0)},getActionButtons:function(){for(var a=[],b=1;b<this.actionButtonsBox.getLogicalChildren().length;b++)a.push(this.actionButtonsBox.getLogicalChildren()[b]);return a},onCancelPress:function(){this.fireEvent("cancel",this)}},{onStyleChange:function(){this.bg.setFill(this.getStyleProperty("background"))}},{style:{background:"#e8e8e8"}});
Ui.Container.extend("Ui.Dialog",{dialogSelection:void 0,shadow:void 0,shadowGraphic:void 0,graphic:void 0,lbox:void 0,vbox:void 0,titleLabel:void 0,contentBox:void 0,contentVBox:void 0,actionButtons:void 0,cancelButton:void 0,buttonsBox:void 0,buttonsVisible:!1,preferredWidth:100,preferredHeight:100,actionBox:void 0,contextBox:void 0,autoClose:!0,openClock:void 0,isClosed:!0,constructor:function(a){this.addEvents("close");this.dialogSelection=new Ui.Selection;this.shadow=new Ui.Pressable({focusable:!1});
this.shadow.getDrawing().style.cursor="inherit";this.appendChild(this.shadow);this.shadowGraphic=new Ui.Rectangle;this.shadow.setContent(this.shadowGraphic);this.lbox=new Ui.Form;this.connect(this.lbox,"submit",this.onFormSubmit);this.appendChild(this.lbox);this.graphic=new Ui.DialogGraphic;this.lbox.append(this.graphic);this.vbox=new Ui.VBox({margin:3});this.lbox.append(this.vbox);this.buttonsBox=new Ui.LBox({height:32});this.buttonsBox.hide(!0);this.vbox.append(this.buttonsBox);this.scroll=new Ui.ScrollingArea({marginLeft:2,
marginTop:2,marginRight:2});this.scroll.setScrollHorizontal(!1);this.scroll.setScrollVertical(!1);this.vbox.append(this.scroll,!0);this.contentVBox=new Ui.VBox;this.scroll.setContent(this.contentVBox);this.contentBox=new Ui.LBox({margin:8});this.contentVBox.append(this.contentBox,!0);this.contextBox=new Ui.ContextBar({selection:this.dialogSelection});this.contextBox.hide();this.buttonsBox.append(this.contextBox);this.actionBox=new Ui.DialogButtonBox;this.connect(this.actionBox,"cancel",this.close);
this.buttonsBox.append(this.actionBox);this.connect(this.dialogSelection,"change",this.onDialogSelectionChange);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.connect(this.shadow,"press",this.onShadowPress)},getSelectionHandler:function(){return this.dialogSelection},setPreferredWidth:function(a){this.preferredWidth=a;this.invalidateMeasure()},setPreferredHeight:function(a){this.preferredHeight=a;this.invalidateMeasure()},open:function(){this.isClosed&&(Ui.App.current.appendDialog(this),
this.isClosed=!1,void 0===this.openClock&&(this.openClock=new Anim.Clock({duration:1,target:this,speed:5}),this.openClock.setEase(new Anim.PowerEase({mode:"out"})),this.connect(this.openClock,"timeupdate",this.onOpenTick),this.onOpenTick(this.openClock,0,0)))},close:function(){this.isClosed||(this.fireEvent("close",this),this.isClosed=!0,this.lbox.disable(),void 0===this.openClock&&(this.openClock=new Anim.Clock({duration:1,target:this,speed:5}),this.openClock.setEase(new Anim.PowerEase({mode:"out"})),
this.connect(this.openClock,"timeupdate",this.onOpenTick),this.openClock.begin()))},onOpenTick:function(a,b,c){a=1<=b;this.isClosed&&(b=1-b);this.shadow.setOpacity(b);this.lbox.setOpacity(b);this.lbox.setTransform(Ui.Matrix.createTranslate(0,-20*(1-b)));a&&(this.openClock.stop(),this.openClock=void 0,this.isClosed&&(Ui.App.current.removeDialog(this),this.lbox.enable()))},getDefaultButton:function(){for(var a=this.actionBox.getActionButtons(),b,c=0;void 0===b&&c<a.length;c++)Ui.DefaultButton.hasInstance(a[c])&&
(b=a[c]);return b},defaultAction:function(){var a=this.getDefaultButton();void 0!==a&&a.press()},setFullScrolling:function(a){this.scroll.setScrollHorizontal(a);this.scroll.setScrollVertical(a)},getTitle:function(){return this.actionBox.getTitle()},setTitle:function(a){this.actionBox.setTitle(a)},updateButtonsBoxVisible:function(){var a=void 0!==this.cancelButton||void 0!==this.actionButtons||0<this.dialogSelection.getElements().length;!this.buttonsVisible&&a?(this.buttonsVisible=!0,this.buttonsBox.show()):
this.buttonsVisible&&!a&&(this.buttonsVisible=!1,this.buttonsBox.hide(!0))},setCancelButton:function(a){this.cancelButton=a;this.actionBox.setCancelButton(a);this.updateButtonsBoxVisible()},setActionButtons:function(a){this.actionButtons=a;this.actionBox.setActionButtons(a);this.updateButtonsBoxVisible()},setContent:function(a){this.contentBox.setContent(a)},getContent:function(){return this.contentBox.getFirstChild()},setAutoClose:function(a){this.autoClose=a},onCancelPress:function(){this.close()},
onFormSubmit:function(){this.defaultAction()},onDialogSelectionChange:function(a){0===a.getElements().length?(this.contextBox.hide(),this.actionBox.show()):(this.contextBox.show(),this.actionBox.hide());this.updateButtonsBoxVisible()},onKeyDown:function(a){46===a.which&&(0!==this.dialogSelection.getElements().length&&this.dialogSelection.executeDeleteAction())&&(a.preventDefault(),a.stopPropagation())},onShadowPress:function(){this.autoClose&&this.close()}},{onStyleChange:function(){this.shadowGraphic.setFill(this.getStyleProperty("shadow"));
this.graphic.setBackground(this.getStyleProperty("background"))},onChildInvalidateMeasure:function(a,b){this.invalidateLayout()},onChildInvalidateArrange:function(a){this.invalidateLayout()},measureCore:function(a,b){this.shadow.measure(a,b);this.lbox.measure(a<this.preferredWidth?a:this.preferredWidth,b<this.preferredHeight?b:this.preferredHeight);return{width:a,height:b}},arrangeCore:function(a,b){void 0!==this.openClock&&!this.openClock.getIsActive()&&this.openClock.begin();this.shadow.arrange(0,
0,a,b);var c=Math.max(a<this.preferredWidth?a:this.preferredWidth,this.lbox.getMeasureWidth()),d=Math.max(b<this.preferredHeight?b:this.preferredHeight,this.lbox.getMeasureHeight());this.lbox.arrange((a-c)/2,(b-d)/2,c,d)}},{style:{shadow:"rgba(255,255,255,0.1)",background:"#f8f8f8"}});Ui.Scrollable.extend("Ui.ScrollingArea",{horizontalScrollbar:void 0,verticalScrollbar:void 0,constructor:function(a){this.horizontalScrollbar=new Ui.Rectangle({width:30,height:4,margin:6});this.setScrollbarHorizontal(this.horizontalScrollbar);this.verticalScrollbar=new Ui.Rectangle({width:4,height:30,margin:6});this.setScrollbarVertical(this.verticalScrollbar)}},{onStyleChange:function(){var a=this.getStyleProperty("radius");this.horizontalScrollbar.setRadius(a);this.verticalScrollbar.setRadius(a);
a=this.getStyleProperty("color");this.horizontalScrollbar.setFill(a);this.verticalScrollbar.setFill(a)}},{style:{color:"#999999",radius:0}});Ui.ScrollingArea.extend("Ui.ToolBar",{hbox:void 0,constructor:function(a){this.setVerticalAlign("center");this.setScrollVertical(!1);this.hbox=new Ui.HBox({eventsHidden:!0});Ui.ToolBar.base.setContent.call(this,this.hbox)}},{append:function(a,b){this.hbox.append(a,b)},remove:function(a){this.hbox.remove(a)},setContent:function(a){this.hbox.setContent(a)},onStyleChange:function(){var a=this.getStyleProperty("spacing");this.hbox.setMargin(a);this.hbox.setSpacing(a)}},{style:{spacing:3}});Ui.Container.extend("Ui.Slider",{value:0,background:void 0,button:void 0,orientation:"horizontal",updateLock:void 0,constructor:function(a){this.addEvents("change");this.background=new Ui.Rectangle({width:4,height:4});this.appendChild(this.background);this.bar=new Ui.Rectangle({width:4,height:4});this.appendChild(this.bar);this.button=new Ui.Movable({moveVertical:!1});this.appendChild(this.button);this.connect(this.button,"move",this.onButtonMove);this.connect(this.button,"focus",this.updateColors);
this.connect(this.button,"blur",this.updateColors);this.connect(this.button,"down",this.updateColors);this.connect(this.button,"up",this.updateColors);this.buttonContent=new Ui.Rectangle({radius:10,width:20,height:20,margin:10});this.button.setContent(this.buttonContent)},getValue:function(){return this.value},setValue:function(a,b){a=Math.min(1,Math.max(0,a));this.value!==a&&(this.value=a,this.disconnect(this.button,"move",this.onButtonMove),this.updateValue(),this.connect(this.button,"move",this.onButtonMove),
!0!==b&&this.fireEvent("change",this,this.value))},getOrientation:function(){return this.orientation},setOrientation:function(a){this.orientation!==a&&(this.orientation=a,this.button.setMoveHorizontal(!0),this.button.setMoveVertical(!0),this.updateValue(),"horizontal"===this.orientation?(this.button.setMoveHorizontal(!0),this.button.setMoveVertical(!1)):(this.button.setMoveHorizontal(!1),this.button.setMoveVertical(!0)),this.invalidateMeasure(),this.onStyleChange())},onButtonMove:function(a){a=this.value;
if(!0!==this.updateLock){var b,c;"horizontal"===this.orientation?(b=this.button.getPositionX(),c=this.getLayoutWidth(),c-=this.button.getLayoutWidth()):(c=this.getLayoutHeight(),c-=this.button.getLayoutHeight(),b=c-this.button.getPositionY());0>b?b=0:b>c&&(b=c);this.value=b/c}this.disconnect(this.button,"move",this.onButtonMove);this.updateValue();this.connect(this.button,"move",this.onButtonMove);a!=this.value&&this.fireEvent("change",this,this.value)},updateValue:function(){this.updateLock=!0;var a,
b=this.getLayoutWidth(),c=this.getLayoutHeight();"horizontal"===this.orientation?(a=b-this.button.getLayoutWidth(),this.button.setPosition(a*this.value,0),this.bar.arrange(this.button.getLayoutWidth()/2,(c-this.bar.getMeasureHeight())/2,a*this.value,this.bar.getMeasureHeight())):(a=c-this.button.getLayoutHeight(),this.button.setPosition(0,a*(1-this.value)),this.bar.arrange((b-this.bar.getMeasureWidth())/2,this.button.getLayoutHeight()/2+a*(1-this.value),this.bar.getMeasureWidth(),a*this.value));delete this.updateLock},
getColor:function(){var a=Ui.Color.create(this.getStyleProperty("background")).getYuv();return new Ui.Color({y:a.y,u:a.u,v:a.v})},getForeground:function(){return Ui.Color.create(this.getStyleProperty("foreground"))},getBackground:function(){var a=Ui.Color.create(this.getStyleProperty("background")).getYuv(),b=0;this.button.getIsDown()&&(b=-0.3);return new Ui.Color({y:a.y+b,u:a.u,v:a.v})},getButtonColor:function(){var a=Ui.Color.create(this.getStyleProperty("background")).getYuv(),b=0;this.button.getIsDown()?
b=-0.3:this.button.getHasFocus()&&(b=0.1);return new Ui.Color({y:a.y+b,u:a.u,v:a.v})},updateColors:function(){this.bar.setFill(this.getForeground());this.background.setFill(this.getBackground());this.buttonContent.setFill(this.getForeground())}},{measureCore:function(a,b){var c=this.button.measure(0,0),d;"horizontal"===this.orientation?(d=this.background.measure(a-c.width,0),d.width>c.width&&(c.width=d.width),d.height>c.height&&(c.height=d.height),d=this.bar.measure(a-c.width,0)):(d=this.background.measure(0,
b-c.height),d.width>c.width&&(c.width=d.width),d.height>c.height&&(c.height=d.height),d=this.bar.measure(0,b-c.height));d.width>c.width&&(c.width=d.width);d.height>c.height&&(c.height=d.height);return c},arrangeCore:function(a,b){"horizontal"===this.orientation?(this.button.arrange(0,(b-this.button.getMeasureHeight())/2,this.button.getMeasureWidth(),this.button.getMeasureHeight()),this.background.arrange(this.button.getLayoutWidth()/2,(b-this.background.getMeasureHeight())/2,a-this.button.getLayoutWidth(),
this.background.getMeasureHeight())):(this.button.arrange((a-this.button.getMeasureWidth())/2,0,this.button.getMeasureWidth(),this.button.getMeasureHeight()),this.background.arrange((a-this.background.getMeasureWidth())/2,this.button.getLayoutHeight()/2,this.background.getMeasureWidth(),b-this.button.getLayoutHeight()));this.updateValue()},onStyleChange:function(){this.background.setRadius(this.getStyleProperty("radius"));this.bar.setRadius(this.getStyleProperty("radius"));this.updateColors()},onDisable:function(){Ui.Slider.base.onDisable.call(this);
this.button.setOpacity(0.2)},onEnable:function(){Ui.Slider.base.onEnable.call(this);this.button.setOpacity(1)}},{style:{radius:0,background:"#e1e1e1",backgroundBorder:"#919191",foreground:"#07a0e5"}});Ui.Container.extend("Ui.ProgressBar",{value:0,bar:void 0,background:void 0,constructor:function(a){this.background=new Ui.Rectangle({height:4});this.appendChild(this.background);this.bar=new Ui.Rectangle({height:4});this.appendChild(this.bar)},setValue:function(a){a!=this.value&&(this.value=a,a=this.getLayoutWidth()*this.value,2>a?this.bar.hide():(this.bar.show(),this.bar.arrange(0,0,a,this.getLayoutHeight())))},getValue:function(){return this.value}},{measureCore:function(a,b){var c=0,d=0,e;e=this.bar.measure(a,
b);c=Math.max(e.height,c);d=Math.max(e.width,d);e=this.background.measure(a,b);c=Math.max(e.height,c);d=Math.max(e.width,d);return{width:Math.max(d,12),height:c}},arrangeCore:function(a,b){this.background.arrange(0,0,a,b);var c=a*this.value;2>c?this.bar.hide():(this.bar.show(),this.bar.arrange(0,0,c,this.getLayoutHeight()))},onStyleChange:function(){var a=this.getStyleProperty("radius");this.bar.setRadius(a);this.bar.setFill(this.getStyleProperty("foreground"));this.background.setRadius(a);this.background.setFill(this.getStyleProperty("background"))}},
{style:{background:"#e1e1e1",foreground:"#07a0e5",color:"#999999",radius:0}});Ui.CanvasElement.extend("Ui.Loading",{fill:"black",clock:void 0,ease:void 0,constructor:function(a){"fill"in a?(this.setFill(a.fill),delete a.fill):this.setFill(this.fill);this.ease=new Anim.PowerEase({mode:"inout"});this.clock=new Anim.Clock({repeat:"forever",duration:2});this.connect(this.clock,"timeupdate",this.onTick)},setFill:function(a){this.fill=Ui.Color.create(a);this.invalidateDraw()},onTick:function(a,b){this.invalidateDraw()}},{onVisible:function(){Ui.Loading.base.onVisible.apply(this,
arguments);this.clock.begin()},onHidden:function(){Ui.Loading.base.onHidden.apply(this,arguments);this.clock.stop()},updateCanvas:function(a){var b=this.clock.getProgress();void 0===b&&(b=0);var c=0.8<b?1-5*(b-0.8):b/0.8,d=this.getLayoutWidth(),e=this.getLayoutHeight(),f=d/2,g=e/2,l=Math.max(2,Math.min(5,5*Math.min(d,e)/60)),d=(Math.min(d,e)-l)/2-5,e=2*Math.PI*b;0.8<b&&(e=2*Math.PI*b-10*Math.PI*this.ease.ease(c)/6);b=e+Math.PI/4+10*Math.PI*this.ease.ease(c)/6;a.strokeStyle=this.getStyleProperty("color").getCssRgba();
a.beginPath();a.arc(f,g,d,e,b,!1);a.lineWidth=l;a.stroke()},measureCore:function(a,b){return{width:30,height:30}}},{style:{color:new Ui.Color({r:0.27,g:0.52,b:0.9})}});Ui.Container.extend("Ui.Locator",{path:void 0,foregrounds:void 0,backgrounds:void 0,border:void 0,focusedPart:void 0,constructor:function(a){this.addEvents("change");this.connect(this,"focus",this.updateColors);this.connect(this,"blur",this.updateColors)},setPath:function(a){var b=this.getStyleProperty("spacing"),c=this.getStyleProperty("radius"),d=this.getStyleProperty("padding");for(this.path=a;0<this.getChildren().length;)this.removeChild(this.getChildren()[0]);this.border=new Ui.Rectangle({fill:"#888888",
radius:c});this.appendChild(this.border);this.backgrounds=[];this.foregrounds=[];var e,f,g;if("/"==a)e=new Ui.Rectangle({radius:c-1}),this.backgrounds.push(e),this.appendChild(e),b=new Ui.Pressable({padding:d}),b.locatorPath="/",b.locatorPos=0,this.connect(b,"press",this.onPathPress),this.connect(b,"down",this.onPathDown),this.connect(b,"up",this.onPathUp),this.connect(b,"focus",this.onPathFocus),this.connect(b,"blur",this.onPathBlur),f=new Ui.Icon({icon:"home",width:24,height:24}),f.setVerticalAlign("center"),
f.setHorizontalAlign("center"),b.appendChild(f),this.foregrounds.push(b),this.appendChild(b);else{a=a.split("/");e=[];for(g=0;g<a.length;g++)""!==a[g]&&e.push(a[g]);a=e;e=new Ui.LocatorRightArrow({arrowLength:b,radius:c-1});this.backgrounds.push(e);this.appendChild(e);for(g=0;g<a.length;g++)e=g==a.length-1?new Ui.LocatorLeftArrow({arrowLength:b,radius:c-1}):new Ui.LocatorLeftRightArrow({arrowLength:b}),this.backgrounds.push(e),this.appendChild(e);b=new Ui.Pressable({padding:d});b.locatorPath=f;b.locatorPos=
0;this.connect(b,"press",this.onPathPress);this.connect(b,"down",this.onPathDown);this.connect(b,"up",this.onPathUp);this.connect(b,"focus",this.onPathFocus);this.connect(b,"blur",this.onPathBlur);f=new Ui.Icon({icon:"home",width:24,height:24});f.setVerticalAlign("center");f.setHorizontalAlign("center");b.locatorPos=0;b.locatorPath="/";b.appendChild(f);this.foregrounds.push(b);this.appendChild(b);f="/";for(g=0;g<a.length;g++)f+=a[g],b=new Ui.Pressable({padding:d}),b.locatorPos=g+1,this.connect(b,
"press",this.onPathPress),this.connect(b,"down",this.onPathDown),this.connect(b,"up",this.onPathUp),this.connect(b,"focus",this.onPathFocus),this.connect(b,"blur",this.onPathBlur),b.locatorPath=f,b.appendChild(new Ui.Label({text:a[g],verticalAlign:"center"})),this.foregrounds.push(b),this.appendChild(b),f+="/"}this.updateColors()},getPath:function(){return this.path},getBackground:function(){return Ui.Color.create(this.getStyleProperty("background"))},getLightColor:function(){var a=this.getBackground().getYuv();
return 0.4>a.y?new Ui.Color({y:a.y-0.15+0,u:a.u,v:a.v}):new Ui.Color({y:a.y+0.15+0,u:a.u,v:a.v})},getBackgroundBorder:function(){var a=(void 0!==this.focusedPart&&!this.focusedPart.getIsMouseFocus()?Ui.Color.create(this.getStyleProperty("focusBackgroundBorder")):Ui.Color.create(this.getStyleProperty("backgroundBorder"))).getYuva();return new Ui.Color({y:a.y+0,u:a.u,v:a.v,a:a.a})},getDownColor:function(){var a=this.getBackground().getYuv();return 0.4>a.y?new Ui.Color({y:a.y-0.15+-0.2,u:a.u,v:a.v}):
new Ui.Color({y:a.y+0.15+-0.2,u:a.u,v:a.v})},onPathPress:function(a){this.fireEvent("change",this,a.locatorPath,a.locatorPos)},onPathDown:function(a){this.backgrounds[a.locatorPos].setFill(this.getDownColor())},onPathUp:function(a){this.backgrounds[a.locatorPos].setFill(this.getLightColor())},onPathFocus:function(a){this.focusedPart=a;this.updateColors()},onPathBlur:function(a){this.focusedPart=void 0;this.updateColors()},updateColors:function(){var a=this.getBackground(),b=Ui.Color.create(this.getStyleProperty("focusBackground"));
this.border.setFill(this.getBackgroundBorder());var c=-1;if(void 0!==this.focusedPart)for(var d=0;-1===c&&d<this.foregrounds.length;d++)this.foregrounds[d]===this.focusedPart&&(c=d);for(d=0;d<this.backgrounds.length;d++)d===c?this.backgrounds[d].setFill(b):this.backgrounds[d].setFill(a)}},{measureCore:function(a,b){if(0===this.foregrounds.length)return{width:0,height:0};var c;for(c=0;c<this.foregrounds.length;c++)this.foregrounds[c].measure(0,0);for(c=0;c<this.backgrounds.length;c++)this.backgrounds[c].measure(0,
0);this.border.measure(0,0);if(1==this.foregrounds.length)return{width:this.foregrounds[0].getMeasureWidth()+2,height:this.foregrounds[0].getMeasureHeight()+2};var d=0,e=0;for(c=0;c<this.foregrounds.length;c++){var f=this.foregrounds[c];f.getMeasureHeight()>e&&(e=f.getMeasureHeight());d+=f.getMeasureWidth()}c=this.getStyleProperty("spacing");f=this.getStyleProperty("borderWidth");d+=(this.foregrounds.length-1)*(c+f);return{width:d+2*f,height:e+2*f}},arrangeCore:function(a,b){var c=this.getStyleProperty("borderWidth");
if(1==this.foregrounds.length)this.foregrounds[0].arrange(c,c,a-2*c,b-2*c),this.backgrounds[0].arrange(c,c,a-2*c,b-2*c);else{var d=this.getStyleProperty("spacing");x=c;for(var e=0;e<this.foregrounds.length;e++){var f=this.backgrounds[e],g=this.foregrounds[e],l=g.getMeasureWidth();g.arrange(x+1,0+c,l,b-2*c);0===e?f.arrange(x,0+c,l+d,b-2*c):e==this.foregrounds.length-1?f.arrange(x-d,0+c,l+d,b-2*c):f.arrange(x-d,0+c,l+2*d,b-2*c);x+=l+d+c}}this.border.arrange(0,0,a,b)},onStyleChange:function(){for(var a=
this.getStyleProperty("spacing"),b=this.getStyleProperty("padding"),c=this.getStyleProperty("radius"),d=this.getStyleProperty("borderWidth"),e=0;e<this.backgrounds.length;e++){var f=this.backgrounds[e];"setArrowLength"in f&&f.setArrowLength(a);f.setRadius(c-d)}for(e=0;e<this.foregrounds.length;e++)this.foregrounds[e].setPadding(b);this.border.setRadius(c);this.updateColors()},onDisable:function(){Ui.Locator.base.onDisable.apply(this,arguments);for(var a=0;a<this.foregrounds.length;a++)this.foregrounds[a].setOpacity(0.4)},
onEnable:function(){Ui.Locator.base.onEnable.apply(this,arguments);for(var a=0;a<this.foregrounds.length;a++)this.foregrounds[a].setOpacity(1)}},{style:{background:"rgba(250,250,250,1)",backgroundBorder:"rgba(140,140,140,1)",focusBackground:"#07a0e5",focusBackgroundBorder:new Ui.Color({r:0.04,g:0.43,b:0.5}),focusActiveBackgroundBorder:new Ui.Color({r:0.04,g:0.43,b:0.5}),radius:3,spacing:10,padding:8,borderWidth:1}});
Ui.CanvasElement.extend("Ui.LocatorRightArrow",{radius:8,length:10,fill:void 0,constructor:function(a){this.fill=new Ui.Color},setRadius:function(a){this.radius=a;this.invalidateArrange()},setArrowLength:function(a){this.length=a;this.invalidateArrange()},setFill:function(a){this.fill=Ui.Color.create(a);this.invalidateDraw()}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=b-this.length;a.svgPath("M"+this.radius+",0 L"+d+",0 L"+b+","+c/2+" L"+d+","+c+" L"+this.radius+
","+c+" Q0,"+c+" 0,"+(c-this.radius)+" L0,"+this.radius+" Q0,0 "+this.radius+",0 z");a.fillStyle=this.fill.getCssRgba();a.fill()}});
Ui.Shape.extend("Ui.LocatorLeftArrow",{radius:8,length:10,constructor:function(a){},setRadius:function(a){this.radius=a},setArrowLength:function(a){this.length=a;this.invalidateDraw()}},{arrangeCore:function(a,b){Ui.LocatorLeftArrow.base.arrangeCore.call(this,a,b);var c=a-this.radius;this.setPath("M0,0 L"+c+",0 Q"+a+",0 "+a+","+this.radius+" L"+a+","+(b-this.radius)+" Q"+a+","+b+" "+c+","+b+" L0,"+b+" L"+this.length+","+b/2+" z")}});
Ui.Shape.extend("Ui.LocatorLeftRightArrow",{length:10,constructor:function(a){},setRadius:function(a){},setArrowLength:function(a){this.length=a;this.invalidateDraw()}},{arrangeCore:function(a,b){Ui.LocatorLeftRightArrow.base.arrangeCore.call(this,a,b);var c=a-this.length,d=b/2;this.setPath("M0,0 L"+c+",0 L"+a+","+d+" L"+c+","+b+" L0,"+b+" L"+this.length+","+d+" z")}});Ui.CanvasElement.extend("Ui.TextBgGraphic",{textHasFocus:!1,setHasFocus:function(a){this.textHasFocus!==a&&(this.textHasFocus=a,this.invalidateDraw())},getBackground:function(){return this.textHasFocus?Ui.Color.create(this.getStyleProperty("focusBackground")):Ui.Color.create(this.getStyleProperty("background"))}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=this.getStyleProperty("radius"),d=Math.max(0,Math.min(d,Math.min(b/2,c/2)));this.getStyleProperty("borderWidth");
Math.max(8,c-4-16);this.getIsDisabled()&&(a.globalAlpha=0.2);a.fillStyle=this.getBackground().getCssRgba();a.beginPath();a.roundRect(0,0,b,c,d,d,d,d);a.closePath();a.fill()},onDisable:function(){this.invalidateDraw()},onEnable:function(){this.invalidateDraw()},onStyleChange:function(){this.invalidateDraw()}},{style:{radius:3,borderWidth:2,background:"rgba(120,120,120,0.2)",focusBackground:"rgba(33,211,255,0.4)"}});Ui.LBox.extend("Ui.TextField",{entry:void 0,graphic:void 0,textholder:void 0,constructor:function(a){this.addEvents("change");this.setPadding(3);this.graphic=new Ui.TextBgGraphic;this.append(this.graphic);this.textholder=new Ui.Label({opacity:0.5,horizontalAlign:"center",margin:3});this.append(this.textholder);this.entry=new Ui.Entry({margin:4,fontSize:16});this.connect(this.entry,"focus",this.onEntryFocus);this.connect(this.entry,"blur",this.onEntryBlur);this.append(this.entry);this.connect(this.entry,
"change",this.onEntryChange)},setTextHolder:function(a){this.textholder.setText(a)},setPasswordMode:function(a){this.entry.setPasswordMode(a)},getValue:function(){return this.entry.getValue()},setValue:function(a){this.entry.setValue(a);void 0===a||""===a?this.textholder.show():this.textholder.hide()},onEntryFocus:function(){this.textholder.hide();this.graphic.setHasFocus(!0)},onEntryBlur:function(){""===this.getValue()&&this.textholder.show();this.graphic.setHasFocus(!1)},onEntryChange:function(a,
b){this.fireEvent("change",this,b)}},{onStyleChange:function(){}});Ui.Button.extend("Ui.TextFieldButton",{},{},{style:{padding:6,iconSize:22,background:"rgba(250,250,250,0)",backgroundBorder:"rgba(140,140,140,0)"}});
Ui.Form.extend("Ui.TextButtonField",{graphic:void 0,entry:void 0,textholder:void 0,button:void 0,buttonIcon:void 0,buttonText:void 0,constructor:function(a){this.addEvents("change","validate","buttonpress");this.setPadding(3);this.graphic=new Ui.TextBgGraphic;this.append(this.graphic);this.textholder=new Ui.Label({opacity:0.5,horizontalAlign:"center",margin:3});this.append(this.textholder);a=new Ui.HBox;this.append(a);this.entry=new Ui.Entry({margin:4,fontSize:16});this.connect(this.entry,"focus",
this.onEntryFocus);this.connect(this.entry,"blur",this.onEntryBlur);a.append(this.entry,!0);this.connect(this.entry,"change",this.onEntryChange);this.button=new Ui.TextFieldButton({orientation:"horizontal",margin:1});a.append(this.button);this.connect(this,"submit",this.onFormSubmit);this.connect(this.button,"press",this.onButtonPress)},setTextHolder:function(a){this.textholder.setText(a)},setWidthText:function(a){this.entry.setWidth(32*a/3)},getButtonIcon:function(){return this.buttonIcon},setButtonIcon:function(a){this.button.setIcon(a)},
setButtonText:function(a){this.button.setText(a)},getTextValue:function(){return this.entry.getValue()},setTextValue:function(a){this.entry.setValue(a)},getValue:function(){return this.getTextValue()},setValue:function(a){this.setTextValue(a)},onButtonPress:function(){this.fireEvent("buttonpress",this);this.fireEvent("validate",this,this.getValue())},onEntryChange:function(a,b){this.fireEvent("change",this,b)},onFormSubmit:function(){this.fireEvent("validate",this,this.getValue())},onEntryFocus:function(){this.textholder.hide();
this.graphic.setHasFocus(!0)},onEntryBlur:function(){""===this.getValue()&&this.textholder.show();this.graphic.setHasFocus(!1)},onEntryChange:function(a,b){this.fireEvent("change",this,b)}});Ui.LBox.extend("Ui.TextAreaField",{textarea:void 0,graphic:void 0,textholder:void 0,constructor:function(a){this.addEvents("change");this.setPadding(3);this.graphic=new Ui.TextBgGraphic;this.append(this.graphic);this.textholder=new Ui.Label({opacity:0.5,horizontalAlign:"center",margin:3});this.append(this.textholder);this.textarea=new Ui.TextArea({margin:4,fontSize:16});this.append(this.textarea);this.connect(this.textarea,"focus",this.onTextAreaFocus);this.connect(this.textarea,"blur",this.onTextAreaBlur);
this.connect(this.textarea,"change",this.onTextAreaChange)},setTextHolder:function(a){this.textholder.setText(a)},getValue:function(){return this.textarea.getValue()},setValue:function(a){this.textarea.setValue(a);void 0===a||""===a?this.textholder.show():this.textholder.hide()},onTextAreaFocus:function(){this.textholder.hide();this.graphic.setHasFocus(!0)},onTextAreaBlur:function(){""===this.getValue()&&this.textholder.show();this.graphic.setHasFocus(!1)},onTextAreaChange:function(a,b){this.fireEvent("change",
this,b)}},{onStyleChange:function(){}});Ui.Pressable.extend("Ui.ListViewHeader",{title:void 0,uiTitle:void 0,background:void 0,constructor:function(a){this.background=new Ui.Rectangle({verticalAlign:"bottom",height:4});this.append(this.background);this.uiTitle=new Ui.Label({margin:8,fontWeight:"bold"});this.append(this.uiTitle);this.connect(this,"down",this.onListViewHeaderDown);this.connect(this,"up",this.onListViewHeaderUp)},getTitle:function(){return this.title},setTitle:function(a){this.title!==a&&(this.title=a,this.uiTitle.setText(a))},
getColor:function(){return Ui.Color.create(this.getStyleProperty("color"))},getColorDown:function(){var a=Ui.Color.create(this.getStyleProperty("color")).getYuv();return new Ui.Color({y:a.y+0.4,u:a.u,v:a.v})},onListViewHeaderDown:function(){this.background.setFill(this.getColorDown())},onListViewHeaderUp:function(){this.background.setFill(this.getColor())}},{onStyleChange:function(){this.background.setFill(this.getStyleProperty("color"));var a=this.getStyleProperty("spacing");this.uiTitle.setMargin(a+
2)}},{style:{color:"#444444",spacing:5}});
Ui.Container.extend("Ui.ListViewHeadersBar",{headers:void 0,sortColKey:void 0,sortInvert:!1,sortArrow:void 0,cols:void 0,constructor:function(a){this.addEvents("header");this.headers=a.headers;delete a.headers;this.sortArrow=new Ui.Icon({icon:"sortarrow",width:10,height:10,margin:4});this.appendChild(this.sortArrow);this.cols=[];for(i=0;i<this.headers.length;i++)a=this.headers[i],a["Ui.ListViewHeadersBar.ui"]=new Ui.ListViewHeader({title:a.title,width:a.width}),this.connect(a["Ui.ListViewHeadersBar.ui"],
"press",this.onHeaderPress),a.colWidth=a.width,this.appendChild(a["Ui.ListViewHeadersBar.ui"]),a=new Ui.ListViewColBar({header:a["Ui.ListViewHeadersBar.ui"]}),this.cols.push(a),this.appendChild(a)},getSortColKey:function(){return this.sortColKey},getSortInvert:function(){return this.sortInvert},sortBy:function(a,b){this.sortColKey=a;(this.sortInvert=!0===b)?this.sortArrow.setTransform(Ui.Matrix.createRotate(180)):this.sortArrow.setTransform();this.invalidateArrange()},onHeaderPress:function(a){for(var b,
c=0;c<this.headers.length;c++){var d=this.headers[c];d["Ui.ListViewHeadersBar.ui"]===a&&(b=d.key)}void 0!==b&&this.fireEvent("header",this,b)}},{measureCore:function(a,b){var c=this.headersHeight=this.rowsHeight=0,d,e;for(d=0;d<this.headers.length;d++)e=this.headers[d],e=e["Ui.ListViewHeadersBar.ui"].measure(0,0),e.height>c&&(c=e.height);this.headersHeight=c;for(d=c=0;d<this.headers.length;d++)c+=this.headers[d]["Ui.ListViewHeadersBar.ui"].getMeasureWidth();this.sortArrow.measure(0,0);for(e=0;e<this.cols.length;e++)d=
this.cols[e],d.measure(0,this.headersHeight+this.rowsHeight);return{width:c,height:this.headersHeight}},arrangeCore:function(a,b){var c=0,d,e,f,g=a;for(f=0;f<this.headers.length;f++){d=this.headers[f];var l=this.cols[f];e=d["Ui.ListViewHeadersBar.ui"].getMeasureWidth();f==this.headers.length-1&&(e=Math.max(e,g));d["Ui.ListViewHeadersBar.ui"].arrange(c,0,e,this.headersHeight);l.setHeaderHeight(this.headersHeight);l.arrange(c+e-l.getMeasureWidth(),0,l.getMeasureWidth(),this.headersHeight);this.sortColKey===
d.key&&this.sortArrow.arrange(c+e-0.8*b,0.1*b,0.8*b,0.8*b);c+=e;g-=e}}});
Ui.Selectionable.extend("Ui.ListViewRow",{headers:void 0,data:void 0,cells:void 0,background:void 0,selectionActions:void 0,constructor:function(a){this.headers=a.headers;delete a.headers;this.data=a.data;delete a.data;this.setDraggableData(this.data);this.cells=[];this.background=new Ui.Rectangle;this.appendChild(this.background);for(a=0;a<this.headers.length;a++){var b=this.headers[a].key,b=void 0!==this.headers[a].ui?new this.headers[a].ui({key:b}):new Ui.ListViewCellString({key:b});b.setValue(this.data[this.headers[a].key]);
this.cells.push(b);this.appendChild(b)}},getData:function(){return this.data},setSelectionActions:function(a){this.selectionActions=a}},{onPress:function(){this.setIsSelected(!this.getIsSelected())},onSelect:function(){this.select();this.onStyleChange()},onUnselect:function(){this.unselect();this.onStyleChange()},getSelectionActions:function(){return this.selectionActions},measureCore:function(a,b){this.background.measure(a,b);var c=0;for(col=0;col<this.headers.length;col++){var d=this.cells[col].measure(0,
0);d.height>c&&(c=d.height)}return{width:0,height:c}},arrangeCore:function(a,b){this.background.arrange(0,0,a,b);var c=0;for(col=0;col<this.headers.length;col++){var d=this.cells[col];colWidth=this.headers[col]["Ui.ListViewHeadersBar.ui"].getLayoutWidth();d.arrange(c,0,colWidth,b);c+=colWidth}},onStyleChange:function(){this.getIsSelected()?this.background.setFill(this.getStyleProperty("selectColor")):this.background.setFill(this.getStyleProperty("color"))}},{style:{color:new Ui.Color({r:0.99,g:0.99,
b:0.99,a:0.1}),selectColor:new Ui.Color({r:0.88,g:0.88,b:0.88})}});Ui.ListViewRow.extend("Ui.ListViewRowOdd",{},{},{style:{color:new Ui.Color({r:0.5,g:0.5,b:0.5,a:0.05}),selectColor:new Ui.Color({r:0.88,g:0.88,b:0.88})}});Ui.ListViewRow.extend("Ui.ListViewRowEven",{},{},{style:{color:new Ui.Color({r:0.5,g:0.5,b:0.5,a:0.1}),selectColor:new Ui.Color({r:0.88,g:0.88,b:0.88})}});
Ui.ScrollLoader.extend("Ui.ListViewScrollLoader",{listView:void 0,data:void 0,constructor:function(a){this.listView=a.listView;delete a.listView;this.data=a.data;delete a.data},signalChange:function(){this.fireEvent("change",this)}},{getMin:function(){return 0},getMax:function(){return this.data.length-1},getElementAt:function(a){return this.listView.getElementAt(a)}});
Ui.VBox.extend("Ui.ListView",{data:void 0,headers:void 0,headersBar:void 0,firstRow:void 0,firstCol:void 0,cols:void 0,rowsHeight:0,headersHeight:0,headersVisible:!0,sortColKey:void 0,sortInvert:!1,sortArrow:void 0,dataLoader:void 0,scroll:void 0,selectionActions:void 0,scrolled:!0,vbox:void 0,constructor:function(a){this.addEvents("select","unselect","activate","header");void 0!==a.headers?(this.headers=a.headers,delete a.headers):this.headers=[{width:100,type:"string",title:"Title",key:"default"}];
this.selectionActions={edit:{"default":!0,text:"Edit",icon:"edit",scope:this,callback:this.onSelectionEdit,multiple:!1}};this.headersBar=new Ui.ListViewHeadersBar({headers:this.headers});this.connect(this.headersBar,"header",this.onHeaderPress);this.append(this.headersBar);this.data=[];this.dataLoader=new Ui.ListViewScrollLoader({data:this.data,listView:this});this.scroll=new Ui.VBoxScrollingArea({loader:this.dataLoader});this.append(this.scroll,!0)},setScrolled:function(a){this.scrolled!==(!0===
a)&&((this.scrolled=a)?(this.remove(this.vbox),this.scroll=new Ui.VBoxScrollingArea({loader:this.dataLoader}),this.append(this.scroll,!0)):(this.remove(this.scroll),this.vbox=new Ui.VBox,this.append(this.vbox,!0),this.updateData(this.data)))},showHeaders:function(){this.headersVisible||(this.headersVisible=!0,this.headersBar.show())},hideHeaders:function(){this.headersVisible&&(this.headersVisible=!1,this.headersBar.hide(!0))},getSelectionActions:function(){return this.selectionActions},setSelectionActions:function(a){this.selectionActions=
a},getElementAt:function(a){return 0===a%2?new Ui.ListViewRowOdd({headers:this.headers,data:this.data[a],selectionActions:this.selectionActions}):new Ui.ListViewRowEven({headers:this.headers,data:this.data[a],selectionActions:this.selectionActions})},appendData:function(a){this.data.push(a);this.sortData();this.scrolled?this.dataLoader.signalChange():this.vbox.append(this.getElementAt(this.data.length-1))},updateData:function(a){this.sortData();if(this.scrolled)this.scroll.reload();else{this.vbox.clear();
for(a=0;a<this.data.length;a++)this.vbox.append(this.getElementAt(a))}},removeData:function(a){a=this.findDataRow(a);-1!=a&&this.removeDataAt(a)},removeDataAt:function(a){if(a<this.data.length)if(this.data.splice(a,1),this.scrolled)this.scroll.reload();else{this.vbox.clear();for(a=0;a<this.data.length;a++)this.vbox.append(this.getElementAt(a))}},clearData:function(){this.data=[];this.dataLoader=new Ui.ListViewScrollLoader({data:this.data,listView:this});this.scrolled?this.scroll.setLoader(this.dataLoader):
this.vbox.clear()},getData:function(){return this.data},setData:function(a){if(void 0!==a)if(this.data=a,this.sortData(),this.dataLoader=new Ui.ListViewScrollLoader({data:this.data,listView:this}),this.scrolled)this.scroll.setLoader(this.dataLoader);else{this.vbox.clear();for(a=0;a<this.data.length;a++)this.vbox.append(this.getElementAt(a))}else this.clearData()},sortData:function(){var a=this.sortColKey,b=this.sortInvert;this.data.sort(function(c,d){var e;e=c[a]<d[a]?-1:c[a]>d[a]?1:0;return b?-e:
e})},sortBy:function(a,b){this.sortColKey=a;this.sortInvert=!0===b;this.headersBar.sortBy(this.sortColKey,this.sortInvert);this.sortData();if(this.scrolled)this.scroll.reload(),this.invalidateArrange();else{this.vbox.clear();for(var c=0;c<this.data.length;c++)this.vbox.append(this.getElementAt(c))}},findDataRow:function(a){for(var b=0;b<this.data.length;b++)if(a==this.data[b])return b;return-1},onHeaderPress:function(a,b){this.sortBy(b,this.sortColKey===b?!this.sortInvert:!1)},onSelectionEdit:function(a){a=
a.getElements()[0].getData();this.fireEvent("activate",this,this.findDataRow(a),a)}},{onChildInvalidateArrange:function(a){Ui.ListView.base.onChildInvalidateArrange.apply(this,arguments);a===this.headersBar&&(this.scrolled&&void 0!==this.scroll?this.scroll.getActiveItems().forEach(function(a){a.invalidateArrange()}):this.scrolled||this.vbox.getChildren().forEach(function(a){a.invalidateArrange()}))}});
Ui.LBox.extend("Ui.ListViewCell",{value:void 0,ui:void 0,key:void 0,constructor:function(a){this.setClipToBounds(!0);this.ui=new Ui.Label({margin:8,horizontalAlign:"left"});this.append(this.ui)},getKey:function(){return this.key},setKey:function(a){this.key=a},getValue:function(){return this.value},setValue:function(a){this.value!==a&&(this.value=a,this.ui.setText(a))}},{onStyleChange:function(){var a=this.getStyleProperty("spacing");this.ui.setMargin(a+2)}},{style:{spacing:5}});Ui.ListViewCell.extend("Ui.ListViewCellString");
Ui.Container.extend("Ui.ListViewColBar",{headerHeight:0,header:void 0,grip:void 0,separator:void 0,constructor:function(a){this.grip=new Ui.Movable({moveVertical:!1});this.appendChild(this.grip);this.connect(this.grip,"move",this.onMove);this.connect(this.grip,"up",this.onUp);a=new Ui.LBox;this.grip.setContent(a);a.append(new Ui.Rectangle({width:1,opacity:0.2,fill:"black",marginLeft:14,marginRight:10,marginTop:6,marginBottom:6}));a.append(new Ui.Rectangle({width:1,opacity:0.2,fill:"black",marginLeft:19,
marginRight:5,marginTop:6,marginBottom:6}));this.separator=new Ui.Rectangle({width:1,fill:"black",opacity:0.3});this.appendChild(this.separator)},setHeader:function(a){this.header=a},setHeaderHeight:function(a){this.headerHeight=a},onMove:function(){this.separator.setTransform(Ui.Matrix.createTranslate(this.grip.getPositionX(),0))},onUp:function(){var a=this.grip.getPositionX();this.header.setWidth(Math.max(this.getMeasureWidth(),this.header.getMeasureWidth()+a));this.invalidateArrange()}},{measureCore:function(a,
b){var c=this.grip.measure(a,b);this.separator.measure(a,b);return{width:c.width,height:0}},arrangeCore:function(a,b){this.grip.setPosition(0,0);this.separator.setTransform(Ui.Matrix.createTranslate(0,0));this.grip.arrange(0,0,a,this.headerHeight);this.separator.arrange(a-1,0,1,b)},onDisable:function(){Ui.ListViewColBar.base.onDisable.call(this);this.grip.hide()},onEnable:function(){Ui.ListViewColBar.base.onEnable.call(this);this.grip.show()}});Ui.IFrame.extend("Ui.Program",{arguments:void 0,constructor:function(a){this.connect(window,"message",this.onMessage,!1);if(!("location"in a))throw"location config parameter is NEEDED";var b=a.location;delete a.location;"arguments"in a&&(b+="?base64="+encodeURIComponent(JSON.stringify(a.arguments).toBase64()),delete a.arguments);this.setSrc(b);this.addEvents("message")},sendMessage:function(a){this.getIFrame().contentWindow.postMessage(a.serialize(),"*")},onMessage:function(a){this.getIFrame().contentWindow===
a.source&&(a.preventDefault(),a.stopPropagation(),a=JSON.parse(a.data),this.fireEvent("message",this,a))}});Core.Object.extend("Ui.Transition",{constructor:function(a){},run:function(a,b,c){throw"transition classes MUST override run method";}},{},{transitions:{},register:function(a,b){this.transitions[a]=b},parse:function(a){return new this.transitions[a]}});Ui.Transition.extend("Ui.Fade",{},{run:function(a,b,c){void 0!==a&&(1==c?(a.hide(),a.setOpacity(1)):a.setOpacity(Math.min(1,Math.max(0,1-3*c))));void 0!==b&&b.setOpacity(c)}},{constructor:function(){Ui.Transition.register("fade",this)}});Ui.Transition.extend("Ui.Flip",{orientation:"horizontal",constructor:function(a){},setOrientation:function(a){this.orientation=a}},{run:function(a,b,c){0.5>c?(void 0!==a&&(a.setTransformOrigin(0.5,0.5),"horizontal"==this.orientation?a.setTransform(Ui.Matrix.createScale(1-2*c,1)):a.setTransform(Ui.Matrix.createScale(1,1-2*c))),void 0!==b&&b.hide()):(void 0!==a&&(a.hide(),a.setTransformOrigin(0,0),a.setTransform(void 0)),void 0!==b&&(1==c?(b.show(),b.setTransformOrigin(0,0),b.setTransform(void 0)):
(b.show(),b.setTransformOrigin(0.5,0.5),"horizontal"==this.orientation?b.setTransform(Ui.Matrix.createScale(2*(c-0.5),1)):b.setTransform(Ui.Matrix.createScale(1,2*(c-0.5))))))}},{constructor:function(){Ui.Transition.register("flip",this)}});Ui.Transition.extend("Ui.Slide",{direction:"right",constructor:function(a){},setDirection:function(a){this.direction=a}},{run:function(a,b,c){void 0!==a&&(1===c?(a.hide(),a.setTransformOrigin(0,0),a.setTransform(void 0)):(a.setTransformOrigin(0,0),"right"==this.direction?a.setTransform(Ui.Matrix.createTranslate(-a.getLayoutWidth()*c,0)):"left"==this.direction?a.setTransform(Ui.Matrix.createTranslate(a.getLayoutWidth()*c,0)):"top"==this.direction?a.setTransform(Ui.Matrix.createTranslate(0,a.getLayoutHeight()*
c)):a.setTransform(Ui.Matrix.createTranslate(0,-a.getLayoutHeight()*c))));void 0!==b&&(1===c?(b.setTransformOrigin(0,0),b.setTransform(void 0)):(b.setTransformOrigin(0,0),"right"==this.direction?b.setTransform(Ui.Matrix.createTranslate(b.getLayoutWidth()*(1-c),0)):"left"==this.direction?b.setTransform(Ui.Matrix.createTranslate(-b.getLayoutWidth()*(1-c),0)):"top"==this.direction?b.setTransform(Ui.Matrix.createTranslate(0,-b.getLayoutHeight()*(1-c))):b.setTransform(Ui.Matrix.createTranslate(0,b.getLayoutHeight()*
(1-c)))))}},{constructor:function(){Ui.Transition.register("slide",this)}});Ui.LBox.extend("Ui.TransitionBox",{transition:void 0,duration:0.5,ease:void 0,position:-1,transitionClock:void 0,current:void 0,next:void 0,replaceMode:!1,constructor:function(a){this.addEvents("change");this.connect(this,"load",this.onTransitionBoxLoad);this.connect(this,"unload",this.onTransitionBoxUnload);this.setClipToBounds(!0);this.setTransition("fade")},getPosition:function(){return this.position},setDuration:function(a){this.duration=a},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},
setTransition:function(a){this.transition=Ui.Transition.create(a)},setCurrent:function(a){a=this.getChildPosition(a);-1!=a&&this.setCurrentAt(a)},setCurrentAt:function(a){this.position!=a&&(void 0!==this.next&&void 0!==this.current&&(this.current.hide(),this.current=this.next,this.current.show(),this.next=void 0),void 0!==this.transitionClock&&(this.disconnect(this.transitionClock,"complete",this.onTransitionComplete),this.transitionClock.stop()),this.current=-1!=this.position?this.getChildren()[this.position]:
void 0,this.next=this.getChildren()[a],this.next.show(),this.transition.run(this.current,this.next,0),this.transitionClock=new Anim.Clock({duration:this.duration,ease:this.ease}),this.connect(this.transitionClock,"timeupdate",this.onTransitionTick),this.connect(this.transitionClock,"complete",this.onTransitionComplete),this.transitionClock.begin(),this.position=a)},getCurrent:function(){return-1==this.position?void 0:this.getChildren()[this.position].getChildren()[0]},replaceContent:function(a){this.replaceMode=
!0;this.append(a);this.setCurrent(a)},onTransitionBoxLoad:function(){},onTransitionBoxUnload:function(){void 0!==this.transitionClock&&(this.transitionClock.stop(),this.transitionClock=void 0)},onTransitionTick:function(a,b){this.progress=b;this.transition.run(this.current,this.next,b)},onTransitionComplete:function(a){this.transitionClock=void 0;var b=this.next;void 0!==this.current&&this.current.hide();this.next=void 0;if(this.replaceMode){this.replaceMode=!1;var c=[];for(a=0;a<this.getChildren().length;a++){var d=
this.getChildren()[a];d!==b&&c.push(d.getFirstChild())}for(a=0;a<c.length;a++)this.remove(c[a])}this.fireEvent("change",this,this.position)}},{arrangeCore:function(a,b){Ui.TransitionBox.base.arrangeCore.call(this,a,b);void 0!==this.transitionClock&&this.transition.run(this.current,this.next,this.transitionClock.getProgress())},append:function(a){var b=new Ui.TransitionBoxContent;b.append(a);b.hide();Ui.TransitionBox.base.append.call(this,b)},prepend:function(a){-1!==this.position&&this.position++;
var b=new Ui.TransitionBoxContent;b.append(a);b.hide();Ui.TransitionBox.base.prepend.call(this,this.position)},remove:function(a){for(var b=0;b<this.getChildren().length;b++)if(this.getChildren()[b].getFirstChild()==a){b<this.position?this.position--:b==this.position&&(this.position=-1);this.getChildren()[b].remove(a);Ui.TransitionBox.base.remove.call(this,this.getChildren()[b]);break}},getChildPosition:function(a){for(var b=0;b<this.getChildren().length;b++)if(this.getChildren()[b].getChildren()[0]==
a)return b;return-1}});Ui.LBox.extend("Ui.TransitionBoxContent",{});Ui.Accordeonable.extend("Ui.Accordeon",{});Ui.Overable.extend("Ui.Carousel",{carouselable:void 0,buttonNext:void 0,buttonNextIcon:void 0,buttonPrevious:void 0,buttonPreviousIcon:void 0,showClock:void 0,hideTimeout:void 0,showNext:!1,showPrevious:!1,constructor:function(a){this.addEvents("change");this.setFocusable(!0);this.connect(this,"enter",this.onMouseEnter);this.connect(this,"leave",this.onMouseLeave);this.connect(this,"move",this.onMouseOverMove);this.carouselable=new Ui.Carouselable;Ui.Carousel.base.append.call(this,this.carouselable);
this.connect(this,"focus",this.onCarouselableFocus);this.connect(this,"blur",this.onCarouselableBlur);this.connect(this.carouselable,"change",this.onCarouselableChange);this.buttonPrevious=new Ui.Pressable({horizontalAlign:"left",verticalAlign:"center",opacity:0});this.buttonPrevious.setFocusable(!1);this.buttonPreviousIcon=new Ui.Icon({icon:"arrowleft",width:48,height:48});this.buttonPrevious.append(this.buttonPreviousIcon);Ui.Carousel.base.append.call(this,this.buttonPrevious);this.connect(this.buttonPrevious,
"press",this.onPreviousPress);this.buttonNext=new Ui.Pressable({horizontalAlign:"right",verticalAlign:"center",opacity:0});this.buttonNext.setFocusable(!1);this.buttonNextIcon=new Ui.Icon({icon:"arrowright",width:48,height:48});this.buttonNext.append(this.buttonNextIcon);Ui.Carousel.base.append.call(this,this.buttonNext);this.connect(this.buttonNext,"press",this.onNextPress);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},setAutoPlay:function(a){this.carouselable.setAutoPlay(a)},next:function(){this.carouselable.next()},
previous:function(){this.carouselable.previous()},getLogicalChildren:function(){return this.carouselable.getLogicalChildren()},getCurrentPosition:function(){return this.carouselable.getCurrentPosition()},getCurrent:function(){return this.carouselable.getCurrent()},setCurrentAt:function(a,b){this.carouselable.setCurrentAt(a,b)},setCurrent:function(a,b){this.carouselable.setCurrent(a,b)},getBufferingSize:function(){return this.carouselable.getBufferingSize()},setBufferingSize:function(a){this.carouselable.setBufferingSize(a)},
onCarouselableChange:function(a,b){this.showArrows();this.fireEvent("change",this,b)},onCarouselableFocus:function(){this.showArrows()},onCarouselableBlur:function(){this.hideArrows()},onPreviousPress:function(){this.focus();this.previous()},onNextPress:function(){this.focus();this.next()},onMouseEnter:function(){this.showArrows();this.carouselable.stopAutoPlay()},onMouseOverMove:function(){this.showArrows()},onMouseLeave:function(){this.hideArrows();this.carouselable.startAutoPlay()},showArrows:function(){var a=
this.carouselable.getCurrentPosition(),b=this.carouselable.getLogicalChildren();0<b.length?(this.showPrevious=0<a,this.showNext=a<b.length-1):this.showNext=this.showPrevious=!1;void 0===this.showClock&&(this.showClock=new Anim.Clock({duration:"forever",target:this}),this.connect(this.showClock,"timeupdate",this.onShowTick),this.showClock.begin())},hideArrows:function(){void 0!==this.hideTimeout&&(this.hideTimeout.abort(),this.hideTimeout=void 0);this.showNext=this.showPrevious=!1;void 0===this.showClock&&
(this.showClock=new Anim.Clock({duration:"forever",target:this}),this.connect(this.showClock,"timeupdate",this.onShowTick),this.showClock.begin())},onShowTick:function(a,b,c){if(0!==c){b=!1;this.showPrevious?(a=this.buttonPrevious.getOpacity(),a=Math.min(a+c,1),this.buttonPrevious.setOpacity(a),1==a&&(b=!0)):(a=this.buttonPrevious.getOpacity(),a=Math.max(a-2*c,0),this.buttonPrevious.setOpacity(a),0===a&&(b=!0));var d=!1;this.showNext?(a=this.buttonNext.getOpacity(),a=Math.min(a+c,1),this.buttonNext.setOpacity(a),
1==a&&(d=!0)):(a=this.buttonNext.getOpacity(),a=Math.max(a-2*c,0),this.buttonNext.setOpacity(a),0===a&&(d=!0));b&&d&&(this.showClock.stop(),this.showClock=void 0)}},onKeyDown:function(a){this.getHasFocus()&&(39==a.which?this.next():37==a.which&&this.previous())}},{append:function(a){this.carouselable.append(a)},remove:function(a){this.carouselable.remove(a)},insertAt:function(a,b){this.carouselable.insertAt(a,b)},moveAt:function(a,b){this.carouselable.moveAt(a,b)},setContent:function(a){this.carouselable.setContent(a)},
onStyleChange:function(){var a=this.getStyleProperty("focusColor");this.buttonPreviousIcon.setFill(a);this.buttonNextIcon.setFill(a)}},{style:{focusColor:"#21d3ff"}});Ui.Overable.extend("Ui.Carousel3",{carouselable:void 0,buttonNext:void 0,buttonNextIcon:void 0,buttonPrevious:void 0,buttonPreviousIcon:void 0,showClock:void 0,hideTimeout:void 0,showNext:!1,showPrevious:!1,constructor:function(a){this.addEvents("change");this.setFocusable(!0);this.connect(this,"enter",this.onMouseEnter);this.connect(this,"leave",this.onMouseLeave);this.connect(this,"move",this.onMouseOverMove);this.carouselable=new Ui.Carouselable3;this.append(this.carouselable);this.connect(this,
"focus",this.onCarouselableFocus);this.connect(this,"blur",this.onCarouselableBlur);this.connect(this.carouselable,"change",this.onCarouselableChange);this.buttonPrevious=new Ui.Pressable({horizontalAlign:"left",verticalAlign:"center",opacity:0});this.buttonPrevious.setFocusable(!1);this.buttonPreviousIcon=new Ui.Icon({icon:"arrowleft",width:48,height:48});this.buttonPrevious.append(this.buttonPreviousIcon);this.append(this.buttonPrevious);this.connect(this.buttonPrevious,"press",this.onPreviousPress);
this.buttonNext=new Ui.Pressable({horizontalAlign:"right",verticalAlign:"center",opacity:0});this.buttonNext.setFocusable(!1);this.buttonNextIcon=new Ui.Icon({icon:"arrowright",width:48,height:48});this.buttonNext.append(this.buttonNextIcon);this.append(this.buttonNext);this.connect(this.buttonNext,"press",this.onNextPress);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},setLoader:function(a){this.carouselable.setLoader(a)},getLoader:function(){return this.carouselable.getLoader()},setAutoPlay:function(a){this.carouselable.setAutoPlay(a)},
next:function(a){this.carouselable.next(a)},previous:function(a){this.carouselable.previous(a)},getLogicalChildren:function(){return this.carouselable.getLogicalChildren()},getCurrentPosition:function(){return this.carouselable.getCurrentPosition()},getCurrent:function(){return this.carouselable.getCurrent()},setCurrentAt:function(a,b){this.carouselable.setCurrentAt(a,b)},setCurrent:function(a,b){this.carouselable.setCurrent(a,b)},getBufferingSize:function(){return this.carouselable.getBufferingSize()},
setBufferingSize:function(a){this.carouselable.setBufferingSize(a)},getIsDown:function(){return this.carouselable.getIsDown()},onCarouselableChange:function(a,b,c){this.showArrows();this.fireEvent("change",this,b,c)},onCarouselableFocus:function(){this.showArrows()},onCarouselableBlur:function(){this.hideArrows()},onPreviousPress:function(){this.focus();this.previous("user")},onNextPress:function(){this.focus();this.next("user")},onMouseEnter:function(){this.showArrows()},onMouseOverMove:function(){this.showArrows()},
onMouseLeave:function(){this.hideArrows()},showArrows:function(){void 0!==this.hideTimeout&&this.hideTimeout.abort();this.hideTimeout=new Core.DelayedTask({delay:2,scope:this,callback:this.hideArrows});var a=this.carouselable.getCurrentPosition();this.showPrevious=a>this.getLoader().getMin();this.showNext=a<this.getLoader().getMax();void 0===this.showClock&&(this.showClock=new Anim.Clock({duration:"forever",target:this}),this.connect(this.showClock,"timeupdate",this.onShowTick),this.showClock.begin())},
hideArrows:function(){void 0!==this.hideTimeout&&(this.hideTimeout.abort(),this.hideTimeout=void 0);this.showNext=this.showPrevious=!1;void 0===this.showClock&&(this.showClock=new Anim.Clock({duration:"forever",target:this}),this.connect(this.showClock,"timeupdate",this.onShowTick),this.showClock.begin())},onShowTick:function(a,b,c){if(0!==c){b=!1;this.showPrevious?(a=this.buttonPrevious.getOpacity(),a=Math.min(a+c,1),this.buttonPrevious.setOpacity(a),1==a&&(b=!0)):(a=this.buttonPrevious.getOpacity(),
a=Math.max(a-2*c,0),this.buttonPrevious.setOpacity(a),0===a&&(b=!0));var d=!1;this.showNext?(a=this.buttonNext.getOpacity(),a=Math.min(a+c,1),this.buttonNext.setOpacity(a),1==a&&(d=!0)):(a=this.buttonNext.getOpacity(),a=Math.max(a-2*c,0),this.buttonNext.setOpacity(a),0===a&&(d=!0));b&&d&&(this.showClock.stop(),this.showClock=void 0)}},onKeyDown:function(a){this.getHasFocus()&&(39==a.which?this.next():37==a.which&&this.previous())}},{onStyleChange:function(){var a=this.getStyleProperty("focusColor");
this.buttonPreviousIcon.setFill(a);this.buttonNextIcon.setFill(a)}},{style:{focusColor:"#21d3ff"}});Ui.Container.extend("Ui.Switch",{value:!1,pos:0,background:void 0,button:void 0,alignClock:void 0,speed:0,animNext:0,animStart:0,ease:void 0,constructor:function(a){this.addEvents("change");this.background=new Ui.Rectangle({width:4,height:14,radius:7});this.appendChild(this.background);this.bar=new Ui.Rectangle({width:4,height:14,radius:7});this.appendChild(this.bar);this.button=new Ui.Movable({moveVertical:!1});this.appendChild(this.button);this.connect(this.button,"move",this.onButtonMove);this.connect(this.button,
"focus",this.updateColors);this.connect(this.button,"blur",this.updateColors);this.connect(this.button,"down",this.onDown);this.connect(this.button,"up",this.onUp);this.buttonContent=new Ui.Rectangle({radius:10,width:20,height:20,margin:10});this.button.setContent(this.buttonContent);this.ease=new Anim.PowerEase({mode:"out"})},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},getValue:function(){return this.value},setValue:function(a){a=!0===a;this.value!==a&&(this.value=a,this.getIsLoaded()?
this.value?this.startAnimation(4):this.startAnimation(-4):this.pos=this.value?1:0)},onButtonMove:function(a){a=this.button.getPositionX();var b=this.getLayoutWidth()-this.button.getLayoutWidth();0>a?a=0:a>b&&(a=b);this.pos=a/b;this.disconnect(this.button,"move",this.onButtonMove);this.updatePos();this.connect(this.button,"move",this.onButtonMove)},updatePos:function(){var a;a=this.getLayoutWidth();var b=this.getLayoutHeight();a-=this.button.getLayoutWidth();this.button.setPosition(a*this.pos,0);this.bar.arrange(this.button.getLayoutWidth()/
2,(b-this.bar.getMeasureHeight())/2,a*this.pos,this.bar.getMeasureHeight())},getColor:function(){var a=Ui.Color.create(this.getStyleProperty("background")).getYuv();return new Ui.Color({y:a.y,u:a.u,v:a.v})},getForeground:function(){return Ui.Color.create(this.getStyleProperty("foreground"))},getBackground:function(){var a=Ui.Color.create(this.getStyleProperty("background")).getYuv(),b=0;this.button.getIsDown()&&(b=-0.3);return new Ui.Color({y:a.y+b,u:a.u,v:a.v})},getButtonColor:function(){var a=Ui.Color.create(this.getStyleProperty("background")).getYuv(),
b=0;this.button.getIsDown()?b=-0.3:this.button.getHasFocus()&&(b=0.1);return new Ui.Color({y:a.y+b,u:a.u,v:a.v})},updateColors:function(){this.bar.setFill(this.getForeground().addA(-0.6));this.background.setFill(this.getBackground());this.buttonContent.setFill(this.getForeground())},onDown:function(a){this.stopAnimation();this.updateColors()},onUp:function(a,b,c,d,e,f,g){!g&&10>f?this.setValue(!this.value):(b=0.5<this.pos?1:-1,this.startAnimation(b));this.updateColors()},startAnimation:function(a){this.stopAnimation();
this.speed=a;this.animStart=this.pos;this.animNext=0<this.speed?1:0;this.animStart!==this.animNext?(this.alignClock=new Anim.Clock({duration:"forever",target:this}),this.connect(this.alignClock,"timeupdate",this.onAlignTick),this.alignClock.begin()):this.value!==(1===this.animNext)&&(this.value=1===this.animNext,this.fireEvent("change",this,this.value))},stopAnimation:function(){void 0!==this.alignClock&&(this.alignClock.stop(),this.alignClock=void 0)},onAlignTick:function(a,b,c){0!==c&&(a=a.getTime()*
this.speed/(this.animNext-this.animStart),1<=a&&(this.alignClock.stop(),this.alignClock=void 0,a=1,this.value=1===this.animNext,this.fireEvent("change",this,this.value)),a=this.ease.ease(a),this.pos=this.animStart+a*(this.animNext-this.animStart),this.updatePos())}},{measureCore:function(a,b){var c=this.button.measure(0,0),d;d=this.background.measure(1.75*c.width,0);d.width>c.width&&(c.width=d.width);d.height>c.height&&(c.height=d.height);d=this.bar.measure(1.75*c.width,0);d.width>c.width&&(c.width=
d.width);d.height>c.height&&(c.height=d.height);1.75*c.width>c.width&&(c.width*=1.75);return c},arrangeCore:function(a,b){this.button.arrange(0,(b-this.button.getMeasureHeight())/2,this.button.getMeasureWidth(),this.button.getMeasureHeight());this.background.arrange(this.button.getLayoutWidth()/2,(b-this.background.getMeasureHeight())/2,a-this.button.getLayoutWidth(),this.background.getMeasureHeight());this.updatePos()},onStyleChange:function(){this.getStyleProperty("borderWidth");this.updateColors()},
onDisable:function(){Ui.Slider.base.onDisable.call(this);this.button.setOpacity(0.2)},onEnable:function(){Ui.Slider.base.onEnable.call(this);this.button.setOpacity(1)}},{style:{radius:0,borderWidth:1,background:"#e1e1e1",backgroundBorder:"#919191",foreground:"#07a0e5"}});Ui.VBox.extend("Ui.MonthCalendar",{selectedDate:void 0,date:void 0,title:void 0,leftarrow:void 0,rightarrow:void 0,grid:void 0,dayFilter:void 0,dateFilter:void 0,constructor:function(a){this.addEvents("dayselect");"date"in a?(this.date=new Date(a.date.getTime()),delete a.date):this.date=new Date;"selectedDate"in a&&(this.selectedDate=a.selectedDate,delete a.selectedDate);a=new Ui.HBox;this.append(a);var b=new Ui.Pressable({verticalAlign:"center"});this.leftarrow=new Ui.Icon({icon:"arrowleft",width:24,
height:24});b.append(this.leftarrow);a.append(b);this.connect(b,"press",this.onLeftButtonPress);this.title=new Ui.Label({fontWeight:"bold",fontSize:18,margin:5});a.append(this.title,!0);b=new Ui.Pressable({verticalAlign:"center"});this.rightarrow=new Ui.Icon({icon:"arrowright",width:24,height:24});b.append(this.rightarrow);a.append(b);this.connect(b,"press",this.onRightButtonPress);this.grid=new Ui.Grid({cols:"auto,auto,auto,auto,auto,auto,auto",rows:"auto,auto,auto,auto,auto,auto,auto",horizontalAlign:"center"});
this.append(this.grid);this.updateDate()},setDayFilter:function(a){this.dayFilter=a;this.updateDate()},setDateFilter:function(a){this.dateFilter=a;this.updateDate()},onLeftButtonPress:function(){this.date.setMonth(this.date.getMonth()-1);this.updateDate()},onRightButtonPress:function(){this.date.setMonth(this.date.getMonth()+1);this.updateDate()},getSelectedDate:function(){return this.selectedDate},onDaySelect:function(a){this.selectedDate=a.monthCalendarDate;this.updateDate();this.fireEvent("dayselect",
this,this.selectedDate)},updateDate:function(){var a,b=[6,0,1,2,3,4,5],c="Lu Ma Me Je Ve Sa Di".split(" ");for(this.title.setText("Janvier F\u00e9vrier Mars Avril Mai Juin Juillet Ao\u00fbt Septembre Octobre Novembre D\u00e9cembre".split(" ")[this.date.getMonth()]+" "+this.date.getFullYear());void 0!==this.grid.getFirstChild();)this.grid.detach(this.grid.getFirstChild());for(a=0;7>a;a++)this.grid.attach(new Ui.Label({text:c[a],fontWeight:"bold",margin:5}),a,0);var c=this.date.getMonth(),d=new Date(this.date.getTime());
d.setDate(1);var e=1,f=new Date;do{var g=new Ui.Pressable;g.monthCalendarDate=d;this.connect(g,"press",this.onDaySelect);d.getFullYear()==f.getFullYear()&&d.getMonth()==f.getMonth()&&d.getDate()==f.getDate()?(g.monthCalendarCurrent=!0,a=new Ui.Rectangle({fill:new Ui.Color({r:0.2,g:0.4,b:1,a:0.4}),margin:1})):a=new Ui.Rectangle({fill:new Ui.Color({r:0.8,g:0.8,b:0.8,a:0.4}),margin:1});g.append(a);void 0!==this.selectedDate&&(d.getFullYear()===this.selectedDate.getFullYear()&&d.getMonth()===this.selectedDate.getMonth()&&
d.getDate()===this.selectedDate.getDate())&&g.append(new Ui.Frame({frameWidth:3,fill:"red",radius:0}));var l=!1;if(void 0!==this.dayFilter){var k=d.getDay();for(a=0;a<this.dayFilter.length&&!l;a++)k==this.dayFilter[a]&&(l=!0)}if(void 0!==this.dateFilter){k=d.getFullYear()+"/";10>d.getMonth()+1&&(k+="0");k+=d.getMonth()+1+"/";10>d.getDate()&&(k+="0");k+=d.getDate();for(a=0;a<this.dateFilter.length&&!l;a++)RegExp(this.dateFilter[a]).test(k)&&(l=!0)}l&&(g.disable(),g.setOpacity(0.2));g.append(new Ui.Label({text:d.getDate(),
margin:5}));this.grid.attach(g,b[d.getDay()],e);d=new Date(d.getTime()+864E5);0===b[d.getDay()]&&e++}while(c==d.getMonth());this.onStyleChange()}},{onStyleChange:function(){var a=this.getStyleProperty("color"),b=this.getStyleProperty("dayColor"),c=this.getStyleProperty("currentDayColor");this.title.setColor(a);this.leftarrow.setFill(a);this.rightarrow.setFill(a);for(var d=0;d<this.grid.getChildren().length;d++){var e=this.grid.getChildren()[d];if(Ui.Label.hasInstance(e))e.setColor(a);else if(Ui.Pressable.hasInstance(e))for(var f=
0;f<e.getChildren().length;f++){var g=e.getChildren()[f];Ui.Label.hasInstance(g)?g.setColor(a):Ui.Rectangle.hasInstance(g)&&(e.monthCalendarCurrent?g.setFill(c):g.setFill(b))}}}},{style:{color:"black",dayColor:new Ui.Color({r:0.81,g:0.81,b:0.81,a:0.5}),currentDayColor:new Ui.Color({r:1,g:0.31,b:0.66,a:0.5})}});Ui.TextButtonField.extend("Ui.DatePicker",{popup:void 0,calendar:void 0,selectedDate:void 0,lastValid:"",isValid:!1,dayFilter:void 0,dateFilter:void 0,constructor:function(a){this.setButtonIcon("calendar");this.setWidthText(9);this.connect(this,"buttonpress",this.onDatePickerButtonPress);this.connect(this,"change",this.onDatePickerChange)},setDayFilter:function(a){this.dayFilter=a},setDateFilter:function(a){this.dateFilter=a},getIsValid:function(){return this.isValid},getSelectedDate:function(){return this.selectedDate},
setSelectedDate:function(a){if(void 0===a)this.selectedDate=void 0;else{if("string"===typeof a)throw"STOP HERE";this.lastValid=(10>a.getDate()?"0":"")+a.getDate()+"/"+(9>a.getMonth()?"0":"")+(a.getMonth()+1)+"/"+a.getFullYear();this.selectedDate=a;this.setTextValue(this.lastValid)}this.isValid=!0;this.fireEvent("change",this,this.getValue())},onDatePickerButtonPress:function(){var a=this.getTextValue().match(/^(\d{1,2})\/(\d{1,2})\/(\d{1,4})$/);null!==a&&(this.selectedDate=new Date,this.selectedDate.setFullYear(parseInt(a[3]),
parseInt(a[2])-1,parseInt(a[1])));this.popup=new Ui.Popup;this.calendar=void 0!==this.selectedDate?new Ui.MonthCalendar({horizontalAlign:"center",margin:10,selectedDate:this.selectedDate,date:this.selectedDate}):new Ui.MonthCalendar({horizontalAlign:"center",margin:10});void 0!==this.dayFilter&&this.calendar.setDayFilter(this.dayFilter);void 0!==this.dateFilter&&this.calendar.setDateFilter(this.dateFilter);this.popup.setContent(this.calendar);this.connect(this.calendar,"dayselect",this.onDaySelect);
this.popup.open(this)},onDatePickerChange:function(){this.isValid=!1;this.selectedDate=void 0;var a=this.getTextValue();if(a.match(/^(\d{1,2})\/(\d{1,2})\/(\d{1,4})$/)){var a=this.getTextValue().match(/^(\d{1,2})\/(\d{1,2})\/(\d{1,4})$/),b=new Date;b.setFullYear(parseInt(a[3]),parseInt(a[2])-1,parseInt(a[1]));var c=(10>b.getDate()?"0":"")+b.getDate()+"/"+(9>b.getMonth()?"0":"")+(b.getMonth()+1)+"/"+b.getFullYear();if(parseInt(a[3])!=b.getFullYear()||parseInt(a[2])-1!=b.getMonth()||parseInt(a[1])!=
b.getDate())this.lastValid=c,this.setTextValue(this.lastValid);this.selectedDate=b;this.isValid=!0}else a.match(/^(\d{1,2})\/(\d{1,2})\/(\d{0,4})$/)?this.lastValid=a:a.match(/^(\d{1,2})\/(\d{0,2})$/)?this.lastValid=a:a.match(/^(\d{0,2})$/)?this.lastValid=a:this.setTextValue(this.lastValid)},onDaySelect:function(a,b){this.setSelectedDate(b);this.popup.close();this.popup=void 0}},{getValue:function(){return this.selectedDate},setValue:function(a){this.setSelectedDate(a)}});Ui.ToolBar.extend("Ui.MenuBar",{});
Ui.Pressable.extend("Ui.Menu",{headerLabel:void 0,header:void 0,dialog:void 0,scope:void 0,constructor:function(a){this.addEvents("item");a=new Ui.VBox;this.append(a);this.headerLabel=new Ui.Label({margin:5,marginBottom:0,horizontalAlign:"left"});a.append(this.headerLabel);a.append(new Ui.Rectangle({height:1,width:1,fill:"#aaaaaa",marginLeft:5,marginRight:5}));this.dialog=new Ui.MenuDialog({element:this.headerLabel});this.connect(this.dialog,"item",this.onItemPress);this.connect(this,"press",this.onTitlePress)},
setHeader:function(a){this.header!=a&&(this.header=a,this.headerLabel.setText(a))},appendItem:function(a,b,c){"string"==typeof a&&(a=new Ui.Label({horizontalAlign:"left",text:a}));var d=this;a=this.dialog.appendItem(a);void 0!==b&&(void 0===c&&(c=void 0===this.scope?this:this.scope),c.connect(a,"press",function(a){b.call(this,d,a.getChildren()[0])}))},setScope:function(a){this.scope=a},setItems:function(a){this.dialog.clearItems();for(var b=0;b<a.length;b++)this.appendItem(a[b].item,a[b].callback,
a[b].scope)},appendSeparator:function(){this.dialog.appendSeparator()},getIsOpen:function(){return this.dialog.getIsVisible()},open:function(){this.dialog.open()},close:function(){this.dialog.close()},onItemPress:function(a,b){this.fireEvent("item",this,b)},onTitlePress:function(){this.open()}});
Ui.Popup.extend("Ui.MenuDialog",{element:void 0,content:void 0,constructor:function(a){this.addEvents("item");if("element"in a)this.element=a.element,delete a.element;else throw"element property is NEEDED for Ui.MenuDialog";this.setAutoClose(!0);this.content=new Ui.VBox;this.setContent(this.content);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},clearItems:function(){for(;void 0!==this.content.getFirstChild();)this.content.remove(this.content.getFirstChild())},appendItem:function(a){var b=
new Ui.MenuItem;b.setContent(a);this.connect(b,"press",this.onItemPress);this.content.append(b);return b},appendSeparator:function(){this.content.append(new Ui.Separator)},onItemPress:function(a){a=a.getContent();this.fireEvent("item",this,a);this.close()},onKeyDown:function(a){var b;b=a.which;if(27==b)a.preventDefault(),a.stopPropagation(),this.close();else if(40==b)for(b=0;b<this.content.getChildren().length;b++){if(Ui.MenuItem.hasInstance(this.content.getChildren()[b])&&this.content.getChildren()[b].getIsCurrent())for(b+=
1;b<this.content.getChildren().length;b++)if(Ui.MenuItem.hasInstance(this.content.getChildren()[b])){a.preventDefault();a.stopPropagation();this.content.getChildren()[b].setCurrent();break}}else if(38==b){var c;for(b=0;b<this.content.getChildren().length;b++)if(Ui.MenuItem.hasInstance(this.content.getChildren()[b])){if(this.content.getChildren()[b].getIsCurrent()){void 0!==c&&(a.preventDefault(),a.stopPropagation(),c.setCurrent());break}c=this.content.getChildren()[b]}}}},{open:function(){this.getIsVisible();
Ui.MenuDialog.base.open.call(this,this.element,"bottom")}});
Ui.Overable.extend("Ui.MenuItem",{background:void 0,pressable:void 0,constructor:function(){this.addEvents("press");this.background=new Ui.Rectangle({fill:"#cecece",opacity:0});this.append(this.background);this.pressable=new Ui.Pressable({padding:10});this.append(this.pressable);this.connect(this.pressable,"press",this.onItemPress);this.connect(this,"enter",this.onEnter);this.connect(this,"leave",this.onLeave);this.connect(this.pressable,"down",this.onDown);this.connect(this.pressable,"up",this.onUp);
this.connect(this.pressable,"focus",this.onItemFocus);this.connect(this.pressable,"blur",this.onItemBlur)},getIsCurrent:function(){return this.pressable.getHasFocus()},setCurrent:function(){this.pressable.focus()},getContent:function(){return this.pressable.getChildren()[0]},onEnter:function(){this.pressable.focus()},onLeave:function(){},onDown:function(){this.background.setOpacity(1)},onUp:function(){this.background.setOpacity(0)},onItemFocus:function(){this.background.setOpacity(0.6)},onItemBlur:function(){this.background.setOpacity(0)},
onItemPress:function(){this.fireEvent("press",this)}},{setContent:function(a){this.pressable.append(a)}});Ui.LBox.extend("Ui.SegmentBar",{border:void 0,box:void 0,current:void 0,field:"text",data:void 0,orientation:"horizontal",constructor:function(a){this.setFocusable(!0);this.addEvents("change");this.border=new Ui.Frame;this.append(this.border);this.box=new Ui.Box({uniform:!0,margin:1,spacing:1,orientation:this.orientation});this.append(this.box);this.connect(this,"focus",this.onStyleChange);this.connect(this,"blur",this.onStyleChange);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},setOrientation:function(a){this.orientation=
a;this.box.setOrientation(a)},setField:function(a){this.field=a},setData:function(a){for(;void 0!==this.box.getFirstChild();)this.disconnect(this.box.getFirstChild(),"toggle",this.onSegmentSelect),this.box.remove(this.box.getFirstChild());this.data=a;for(var b=0;b<a.length;b++){var c=new Ui.SegmentButton({data:a[b],text:a[b][this.field],mode:"horizontal"===this.orientation?0===b?"left":b===a.length-1?"right":"middle":0===b?"top":b===a.length-1?"bottom":"middle"});this.box.append(c,!0);this.connect(c,
"press",this.onSegmentSelect)}},setCurrentPosition:function(a){0<=a&&a<this.box.getChildren().length&&(this.current=this.box.getChildren()[a],this.onSegmentSelect(this.current))},getCurrentPosition:function(){for(var a=0;a<this.box.getChildren().length;a++)if(this.box.getChildren()[a]===this.current)return a},next:function(){for(var a=0;a<this.box.getChildren().length;a++)if(this.box.getChildren()[a]===this.current){this.setCurrentPosition(a+1);break}},previous:function(){for(var a=0;a<this.box.getChildren().length;a++)if(this.box.getChildren()[a]===
this.current){this.setCurrentPosition(a-1);break}},onSegmentSelect:function(a){this.current=a;this.onStyleChange();this.fireEvent("change",this,a.getData())},onKeyDown:function(a){if(!this.getIsDisabled()){var b=a.which;if(37==b||39==b)a.stopPropagation(),a.preventDefault();37==b?this.previous():39==b&&this.next()}}},{onStyleChange:function(){this.getStyleProperty("spacing");var a=this.getStyleProperty("padding"),b=this.getStyleProperty("radius"),c=this.getStyleProperty("borderWidth");this.border.setRadius(b);
this.border.setFrameWidth(c);var d=this.getStyleProperty("background"),e=this.getStyleProperty("backgroundBorder"),f=this.getStyleProperty("foreground");this.getHasFocus()&&!this.getIsMouseFocus()&&(d=this.getStyleProperty("focusBackground"),e=this.getStyleProperty("focusBackgroundBorder"),f=this.getStyleProperty("focusForeground"));var g=this.getStyleProperty("activeBackground"),l=this.getStyleProperty("activeForeground"),k=this.getStyleProperty("textHeight"),h=this.getStyleProperty("textTransform");
this.box.setMargin(c);this.border.setFill(e);for(e=0;e<this.box.getChildren().length;e++){var n=this.box.getChildren()[e];n.setRadius(Math.max(0,b-c));n.setSpacing(a-c);n.setTextHeight(k);n.setTextTransform(h);this.current===n?(n.setBackground(g),n.setForeground(l)):(n.setBackground(d),n.setForeground(f))}}},{style:{borderWidth:1,background:"rgba(240,240,240,1)",backgroundBorder:"rgba(102,102,102,1)",foreground:"#444444",focusBackground:"rgba(240,240,240,1)",focusBackgroundBorder:"#07a0e5",focusForeground:"#07a0e5",
activeBackground:"#07a0e5",activeForeground:"rgba(250,250,250,1)",radius:3,textHeight:26,spacing:10,padding:7,textTransform:"uppercase"}});
Ui.Pressable.extend("Ui.SegmentButton",{textBox:void 0,label:void 0,bg:void 0,mode:void 0,data:void 0,radius:3,constructor:function(a){this.setFocusable(!1);this.bg=new Ui.Rectangle;this.append(this.bg);this.textBox=new Ui.LBox;this.append(this.textBox);this.label=new Ui.CompactLabel({verticalAlign:"center",whiteSpace:"nowrap",textAlign:"center"});this.textBox.setContent(this.label)},setTextTransform:function(a){this.label.setTextTransform(a)},setForeground:function(a){this.label.setColor(a)},getData:function(){return this.data},
setData:function(a){this.data=a},setText:function(a){this.label.setText(a)},setTextHeight:function(a){this.textBox.setHeight(a)},setMode:function(a){this.mode=a;"left"==a?(this.bg.setRadiusTopLeft(this.radius),this.bg.setRadiusBottomLeft(this.radius),this.bg.setRadiusTopRight(0),this.bg.setRadiusBottomRight(0)):"right"==a?(this.bg.setRadiusTopLeft(0),this.bg.setRadiusBottomLeft(0),this.bg.setRadiusTopRight(this.radius),this.bg.setRadiusBottomRight(this.radius)):"top"==a?(this.bg.setRadiusTopLeft(this.radius),
this.bg.setRadiusBottomLeft(0),this.bg.setRadiusTopRight(this.radius),this.bg.setRadiusBottomRight(0)):"bottom"==a?(this.bg.setRadiusTopLeft(0),this.bg.setRadiusBottomLeft(this.radius),this.bg.setRadiusTopRight(0),this.bg.setRadiusBottomRight(this.radius)):(this.bg.setRadiusTopLeft(0),this.bg.setRadiusBottomLeft(0),this.bg.setRadiusTopRight(0),this.bg.setRadiusBottomRight(0))},setRadius:function(a){this.radius=a;this.setMode(this.mode)},setSpacing:function(a){this.textBox.setMargin(a)},setBackground:function(a){this.bg.setFill(a)}},
{onDisable:function(){Ui.SegmentButton.base.onDisable.apply(this,arguments);this.bg.setOpacity(0.2)},onEnable:function(){Ui.SegmentButton.base.onEnable.apply(this,arguments);this.bg.setOpacity(1)}});Ui.Container.extend("Ui.Paned",{vertical:!0,cursor:void 0,content1Box:void 0,content1:void 0,minContent1Size:0,content2Box:void 0,content2:void 0,minContent2Size:0,pos:0.5,constructor:function(a){this.addEvents("change");this.content1Box=new Ui.LBox;this.appendChild(this.content1Box);this.content2Box=new Ui.LBox;this.appendChild(this.content2Box);this.cursor=new Ui.Movable;this.appendChild(this.cursor);this.cursor.setContent(new Ui.VPanedCursor);this.connect(this.cursor,"move",this.onCursorMove)},
getOrientation:function(){return this.vertical?"vertical":"horizontal"},setOrientation:function(a){var b=!0;"vertical"!=a&&(b=!1);this.vertical!=b&&((this.vertical=b)?this.cursor.setContent(new Ui.VPanedCursor):this.cursor.setContent(new Ui.HPanedCursor),this.invalidateMeasure())},getPos:function(){return this.pos},setPos:function(a){this.pos=a;this.invalidateMeasure()},getContent1:function(){return this.content1},setContent1:function(a){this.content1!==a&&(void 0!==this.content1&&this.content1Box.remove(this.content1),
this.content1=a,void 0!==this.content1&&this.content1Box.append(this.content1))},getContent2:function(){return this.content2},setContent2:function(a){this.content2!==a&&(void 0!==this.content2&&this.content2Box.remove(this.content2),this.content2=a,void 0!==this.content2&&this.content2Box.append(this.content2))},invert:function(){var a;a=this.content1Box;this.content1Box=this.content2Box;this.content2Box=a;a=this.content1;this.content1=this.content2;this.content2=a;this.pos=1-this.pos;this.invalidateArrange()},
onCursorMove:function(){this.disconnect(this.cursor,"move",this.onCursorMove);var a,b;this.vertical?(a=this.cursor.getPositionY(),b=this.getLayoutHeight()-this.cursor.getLayoutHeight()):(a=this.cursor.getPositionX(),b=this.getLayoutWidth()-this.cursor.getLayoutWidth());this.pos=a/b;b*this.pos<this.minContent1Size&&(this.pos=this.minContent1Size/b);b*(1-this.pos)<this.minContent2Size&&(this.pos=1-this.minContent2Size/b);a=this.pos*b;0>a&&(a=0);a>b&&(a=b);this.vertical?this.cursor.setPosition(0,a):
this.cursor.setPosition(a,0);this.invalidateMeasure();this.connect(this.cursor,"move",this.onCursorMove);this.fireEvent("change",this,this.pos)}},{measureCore:function(a,b){var c,d,e;if(this.vertical)return c=this.cursor.measure(a,0),this.minContent1Size=this.content1Box.measure(a,0).height,this.minContent2Size=this.content2Box.measure(a,0).height,d=this.content1Box.measure(a,(b-c.height)*this.pos),e=this.content2Box.measure(a,(b-c.height)*(1-this.pos)),{width:Math.max(c.width,Math.max(d.width,e.width)),
height:d.height+c.height+e.height};c=this.cursor.measure(0,b);this.minContent1Size=this.content1Box.measure(0,0).width;this.minContent2Size=this.content2Box.measure(0,0).width;d=this.content1Box.measure((a-c.width)*this.pos,b);e=this.content2Box.measure((a-c.width)*(1-this.pos),b);return{width:d.width+c.width+e.width,height:Math.max(c.height,Math.max(d.height,e.height))}},arrangeCore:function(a,b){if(this.vertical){var c=this.cursor.getMeasureHeight(),d=b-c;this.cursor.arrange(0,0,a,c);this.cursor.setPosition(0,
d*this.pos);this.content1Box.arrange(0,0,a,d*this.pos);this.content2Box.arrange(0,d*this.pos+c,a,d*(1-this.pos))}else c=this.cursor.getMeasureWidth(),d=a-c,this.content1Box.arrange(0,0,d*this.pos,b),this.cursor.arrange(0,0,c,b),this.cursor.setPosition(d*this.pos,0),this.content2Box.arrange(d*this.pos+c,0,d*(1-this.pos),b)}});Ui.Paned.extend("Ui.VPaned",{constructor:function(a){this.setOrientation("vertical")}});Ui.Paned.extend("Ui.HPaned",{constructor:function(a){this.setOrientation("horizontal")}});
Ui.LBox.extend("Ui.HPanedCursor",{constructor:function(a){this.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.05})}));this.append(new Ui.Rectangle({fill:"rgba(140,140,140,1)",width:1,margin:5,marginRight:10,height:30,verticalAlign:"center"}));this.append(new Ui.Rectangle({fill:"rgba(140,140,140,1)",width:1,margin:5,marginLeft:10,height:30,verticalAlign:"center"}));this.append(new Ui.Frame({frameWidth:1,fill:"rgba(140,140,140,1)"}))}});
Ui.LBox.extend("Ui.VPanedCursor",{constructor:function(a){this.append(new Ui.Rectangle({fill:"rgba(250,250,250,1)"}));this.append(new Ui.Rectangle({fill:"rgba(140,140,140,1)",height:1,margin:5,marginTop:10,width:30,horizontalAlign:"center"}));this.append(new Ui.Rectangle({fill:"rgba(140,140,140,1)",height:1,margin:5,marginBottom:10,width:30,horizontalAlign:"center"}));this.append(new Ui.Frame({frameWidth:1,radius:0,fill:"rgba(140,140,140,1)"}))}});Ui.MenuPopup.extend("Ui.MenuToolBarPopup",{});Ui.Button.extend("Ui.MenuToolBarButton",{constructor:function(){this.setIcon("arrowbottom")}});
Ui.Container.extend("Ui.MenuToolBar",{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,star:0,measureLock:void 0,items:void 0,menuButton:void 0,itemsAlign:"left",menuPosition:"right",uniform:!1,uniformSize:0,spacing:0,itemsWidth:0,keepItems:void 0,menuNeeded:!1,bg:void 0,constructor:function(a){this.items=[];this.bg=new Ui.Rectangle;this.appendChild(this.bg);this.menuButton=new Ui.MenuToolBarButton;this.connect(this.menuButton,"press",this.onMenuButtonPress);this.appendChild(this.menuButton)},
getUniform:function(){return this.uniform},setUniform:function(a){this.uniform!==a&&(this.uniform=a,this.invalidateMeasure())},getMenuPosition:function(){return this.menuPosition},setMenuPosition:function(a){this.menuPosition!==a&&(this.menuPosition=a,this.invalidateArrange())},getItemsAlign:function(){return this.itemsAlign},setItemsAlign:function(a){this.itemsAlign!==a&&(this.itemsAlign=a,this.invalidateArrange())},getLogicalChildren:function(){return this.items},setPadding:function(a){this.setPaddingTop(a);
this.setPaddingBottom(a);this.setPaddingLeft(a);this.setPaddingRight(a)},getPaddingTop:function(){return this.paddingTop},setPaddingTop:function(a){this.paddingTop!==a&&(this.paddingTop=a,this.invalidateMeasure())},getPaddingBottom:function(){return this.paddingBottom},setPaddingBottom:function(a){this.paddingBottom!==a&&(this.paddingBottom=a,this.invalidateMeasure())},getPaddingLeft:function(){return this.paddingLeft},setPaddingLeft:function(a){this.paddingLeft!==a&&(this.paddingLeft=a,this.invalidateMeasure())},
getPaddingRight:function(){return this.paddingRight},setPaddingRight:function(a){this.paddingRight!==a&&(this.paddingRight=a,this.invalidateMeasure())},getSpacing:function(){return this.spacing},setSpacing:function(a){this.spacing!==a&&(this.spacing=a,this.invalidateMeasure())},append:function(a,b){void 0!==b&&Ui.Box.setResizable(a,!0===b);this.items.push(a);this.invalidateMeasure()},prepend:function(a,b){void 0!==b&&Ui.Box.setResizable(a,!0===b);this.items.unshift(a);this.invalidateMeasure()},remove:function(a){for(var b=
0;b<this.items.length&&this.items[b]!==a;)b++;b<this.items.length&&(this.items.splice(b,1),a.getParent()===this&&a.getParent().removeChild(a),this.invalidateMeasure())},moveAt:function(a,b){0>b&&(b=this.items.length+b);0>b&&(b=0);b>=this.items.length&&(b=this.items.length);for(var c=0;c<this.items.length&&this.items[c]!==a;)c++;c<this.items.length&&(this.items.splice(c,1),this.items.splice(b,0,a));this.onChildInvalidateMeasure(a,"move")},insertAt:function(a,b,c){void 0!==c&&Ui.Box.setResizable(a,
!0===c);b=Math.max(0,Math.min(b,this.items.length));this.items.splice(b,0,a);this.invalidateMeasure()},setContent:function(a){if(void 0===a)this.clear();else if("object"===typeof a){a.constructor!==Array&&(a=[a]);for(var b=0;b<this.items.length;b++){for(var c=!1,d=0;!1===c&&d<a.length;d++)c=this.items[b]===a[d];!1===c&&this.items[b].getParent()===this&&this.removeChild(this.items[b])}this.items=a;this.invalidateMeasure()}},onMenuButtonPress:function(){var a=new Ui.MenuToolBarPopup,b=new Ui.VBox;a.setContent(b);
for(var c=0;c<this.items.length;c++){var d=this.items[c];d.getParent()!==this&&(b.append(d),c<this.items.length-1&&b.append(new Ui.MenuPopupSeparator))}a.open(this.menuButton,"bottom")}},{clear:function(){for(var a=0;a<this.items.length;a++)this.items[a].getParent()===this&&this.items[a].getParent().removeChild(this.items[a]);this.items=[];this.invalidateMeasure()},measureCore:function(a,b){var c=this.getPaddingLeft(),d=this.getPaddingRight(),e=this.getPaddingTop(),f=this.getPaddingBottom(),g=Math.max(0,
a-(c+d)),l=Math.max(0,b-(e+f)),k;this.bg.measure(a,b);this.measureLock=!0;var h=this.menuButton.measure(0,0),n=[];for(k=0;k<this.items.length;k++){var m=this.items[k];m.getParent()!==this&&(void 0!==m.getParent()&&m.getParent().removeChild(m),this.appendChild(m));n.push(m.measure(0,0))}this.keepItems=[];var p=0,q=m=0,r=h.height,t=0;for(k="left"===this.menuPosition?k=this.items.length-1:0;0<=k&&k<this.items.length;){var s=n[k];if(p+s.width+this.spacing>g)break;p+=s.width+this.spacing;if(p+h.width>
g)break;"left"===this.menuPosition?this.keepItems.unshift(this.items[k]):this.keepItems.push(this.items[k]);Ui.Box.getResizable(this.items[k])?m++:(t+=s.width,s.height>r&&(r=s.height));s.width>q&&(q=s.width);"left"===this.menuPosition?k--:k++}0<p&&(p-=this.spacing);this.menuNeeded=this.keepItems.length!==this.items.length;n=g;if(this.menuNeeded)for(n-=h.width+this.spacing;0<=k&&k<this.items.length;)this.removeChild(this.items[k]),"left"===this.menuPosition?k--:k++;if(this.uniform)if(this.keepItems.length*
(q+this.spacing)-this.spacing<=g){for(k=0;k<this.keepItems.length;k++)this.keepItems[k].measure(q,r);this.uniformSize=q;g={width:this.keepItems.length*(q+this.spacing)-this.spacing,height:r}}else this.uniformSize=void 0,g={width:p,height:r};else if(0<m){n=n-t-(this.keepItems.length-1)*this.spacing;p=!0;q=n/m;do{p=!0;for(k=0;k<this.keepItems.length;k++)if(s=this.keepItems[k],Ui.Box.getResizable(s)&&!s.menutoolbarStarDone&&(g=s.measure(q,l),g.height>r&&(r=g.height),g.width>q)){s.menutoolbarStarDone=
!0;p=!1;n-=g.width;t+=g.width;m--;q=n/m;break}}while(!p);t+=this.spacing*(this.keepItems.length-1);0<m?(t+=q*m,this.star=q):this.star=0;g={width:t,height:r}}else g={width:p,height:r};this.menuNeeded&&(g.width+=h.width+this.spacing);g.width+=c+d;g.height+=e+f;this.measureLock=void 0;return g},arrangeCore:function(a,b){this.bg.arrange(0,0,a,b);var c=this.paddingLeft,d=this.paddingTop,e=this.paddingBottom;a-=c+this.paddingRight;b-=d+e;e=!0;"left"!==this.itemsAlign&&(c=a-this.getMeasureWidth());this.menuNeeded&&
"left"===this.menuPosition&&(e=!1,this.menuButton.arrange(c,d,this.menuButton.getMeasureWidth(),b),c+=this.menuButton.getMeasureWidth());for(var f=0;f<this.keepItems.length;f++){var g=this.keepItems[f];e?e=!1:c+=this.spacing;var l;this.uniform&&void 0!==this.uniformSize?l=this.uniformSize:(l=g.getMeasureWidth(),Ui.Box.getResizable(g)&&l<this.star&&(l=this.star));g.arrange(c,d,l,b);c+=l}this.menuNeeded&&"left"!==this.menuPosition&&(e||(c+=this.spacing),this.menuButton.arrange(c,d,this.menuButton.getMeasureWidth(),
b));this.menuNeeded?this.menuButton.getDrawing().style.visibility="":this.menuButton.getDrawing().style.visibility="hidden"},onChildInvalidateMeasure:function(a,b){!0!==this.measureLock&&Ui.MenuToolBar.base.onChildInvalidateMeasure.call(this,a,b)},onStyleChange:function(){this.bg.setFill(this.getStyleProperty("background"))}},{style:{background:"rgba(250, 250, 250, 0)"}});Ui.Container.extend("Ui.Toaster",{arrangeClock:void 0,constructor:function(a){this.setMargin(10);this.setEventsHidden(!0)},appendToast:function(a){a.newToast=!0;0===this.getChildren().length&&Ui.App.current.appendTopLayer(this,!1,2);this.appendChild(a)},removeToast:function(a){this.removeChild(a);0===this.getChildren().length&&Ui.App.current.removeTopLayer(this)},onArrangeTick:function(a,b,c){for(a=0;a<this.getChildren().length;a++)c=this.getChildren()[a],1===b?(c.setTransform(void 0),c.newToast=
!1):!0!==c.newToast&&c.setTransform(Ui.Matrix.createTranslate((c.lastLayoutX-c.getLayoutX())*(1-b),(c.lastLayoutY-c.getLayoutY())*(1-b)));1===b&&(this.arrangeClock=void 0)}},{measureCore:function(a,b){for(var c=0,d=0,e=0;e<this.getChildren().length;e++){var f=this.getChildren()[e].measure(0,0),d=d+f.height;f.width>c&&(c=f.width)}d+=10*Math.max(0,this.getChildren().length-1);return{width:c,height:d}},arrange:function(){Ui.Toaster.base.arrange.apply(this,arguments)},arrangeCore:function(a,b){for(var c=
0,d=0;d<this.getChildren().length;d++){var e=this.getChildren()[d];e.lastLayoutX=e.getLayoutX();e.lastLayoutY=e.getLayoutY();c+=e.getMeasureHeight();e.arrange(0,b-c,this.getMeasureWidth(),e.getMeasureHeight());c+=10}void 0===this.arrangeClock&&(this.arrangeClock=new Anim.Clock({duration:1,speed:5}),this.connect(this.arrangeClock,"timeupdate",this.onArrangeTick),this.arrangeClock.begin())}},{current:void 0,constructor:function(){Ui.Toaster.current=new Ui.Toaster},appendToast:function(a){Ui.Toaster.current.appendToast(a)},
removeToast:function(a){Ui.Toaster.current.removeToast(a)}});
Ui.LBox.extend("Ui.Toast",{isClosed:!0,openClock:void 0,toastContentBox:void 0,constructor:function(a){this.addEvents("close");this.append(new Ui.Shadow({shadowWidth:2,radius:1,inner:!1,opacity:0.8}));this.append(new Ui.Rectangle({fill:"#666666",width:200,height:30,margin:2,opacity:0.5}));this.toastContentBox=new Ui.LBox({margin:2,width:200});this.append(this.toastContentBox)},getIsClosed:function(){return this.isClosed},open:function(){this.isClosed&&(this.isClosed=!1,void 0===this.openClock&&(this.openClock=
new Anim.Clock({duration:1,target:this,speed:5}),this.openClock.setEase(new Anim.PowerEase({mode:"out"})),this.connect(this.openClock,"timeupdate",this.onOpenTick),this.setOpacity(0)),new Core.DelayedTask({delay:2,scope:this,callback:this.close}),Ui.Toaster.appendToast(this))},close:function(){this.isClosed||(this.isClosed=!0,this.disable(),void 0===this.openClock&&(this.openClock=new Anim.Clock({duration:1,target:this,speed:5}),this.openClock.setEase(new Anim.PowerEase({mode:"out"})),this.connect(this.openClock,
"timeupdate",this.onOpenTick),this.openClock.begin()))},onOpenTick:function(a,b,c){a=1<=b;this.isClosed&&(b=1-b);this.setOpacity(b);this.setTransform(Ui.Matrix.createTranslate(-20*(1-b),0));a&&(this.openClock.stop(),this.openClock=void 0,this.isClosed&&(this.enable(),this.fireEvent("close",this),Ui.Toaster.removeToast(this)))}},{setContent:function(a){"string"===typeof a&&(a=new Ui.Text({text:a,verticalAlign:"center",margin:5,color:"#deff89"}));this.toastContentBox.setContent(a)},getContent:function(){return this.toastContentBox.getContent()},
arrangeCore:function(a,b){Ui.Toast.base.arrangeCore.apply(this,arguments);void 0!==this.openClock&&!this.openClock.getIsActive()&&this.openClock.begin()}},{send:function(a,b){(new Ui.Toast({content:a})).open()}});Ui.LBox.extend("Ui.App",{styles:void 0,updateTask:!1,loaded:!1,focusElement:void 0,arguments:void 0,ready:!1,orientation:0,webApp:!0,lastArrangeHeight:0,drawList:void 0,layoutList:void 0,windowWidth:0,windowHeight:0,contentBox:void 0,content:void 0,dialogs:void 0,topLayers:void 0,requireFonts:void 0,testFontTask:void 0,bindedUpdate:void 0,selection:void 0,constructor:function(a){var b;this.addEvents("resize","ready","parentmessage","orientationchange");this.setClipToBounds(!0);Ui.App.current=this;
this.getDrawing().style.cursor="default";this.selection=new Ui.Selection;this.connect(this.selection,"change",this.onSelectionChange);if(void 0!==window.location.search&&""!==window.location.search){var c;b={};for(var d=window.location.search.substring(1).split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if(2==f.length){var g=decodeURIComponent(f[0]),f=decodeURIComponent(f[1]);"base64"===g?c=JSON.parse(f.fromBase64()):b[g]=f}}if(void 0!==c){this.arguments=c;for(var l in b)this.arguments[l]=b[l]}else this.arguments=
b}else this.arguments={};void 0!==this.arguments.remotedebug&&(b=this.arguments.remotedebug.split(":"),new Core.RemoteDebug({host:b[0],port:b[1]}));this.contentBox=new Ui.VBox;this.append(this.contentBox);"webApp"in a&&(this.webApp=a.webApp,delete a.webApp);this.setTransformOrigin(0,0);this.connect(window,"load",this.onWindowLoad);this.connect(window,"resize",this.onWindowResize);this.connect(window,"keyup",this.onWindowKeyUp);this.connect(window,"focus",function(a){void 0===a.target||null===a.target||
(this.focusElement=a.target)},!0);this.connect(window,"blur",function(a){this.focusElement=void 0},!0);this.connect(window,"dragstart",function(a){a.preventDefault()});this.connect(window,"dragenter",function(a){a.preventDefault();return!1});this.connect(window,"dragover",function(a){a.dataTransfer.dropEffect="none";a.preventDefault();return!1});this.connect(window,"drop",function(a){a.preventDefault();return!1});"onorientationchange"in window&&this.connect(window,"orientationchange",this.onOrientationChange);
this.connect(window,"message",this.onMessage);this.bindedUpdate=this.update.bind(this)},getSelectionHandler:function(){return this.selection},forceInvalidateMeasure:function(a){void 0===a&&(a=this);if("getChildren"in a)for(var b=0;b<a.getChildren().length;b++)this.forceInvalidateMeasure(a.getChildren()[b]);a.invalidateMeasure()},requireFont:function(a,b){var c=a+":"+b;void 0===this.requireFonts&&(this.requireFonts={});if(!this.requireFonts[c]){var d=!1;this.getIsReady()&&(d=Ui.Label.isFontAvailable(a,
b));(this.requireFonts[c]=d)?this.forceInvalidateMeasure(this):this.getIsReady()&&(!d&&void 0===this.testFontTask)&&(this.testFontTask=new Core.DelayedTask({scope:this,delay:0.25,callback:this.testRequireFonts}))}},testRequireFonts:function(){var a=!0,b;for(b in this.requireFonts){var c=this.requireFonts[b];c||(c=b.split(":"),(c=Ui.Label.isFontAvailable(c[0],c[1]))?(this.requireFonts[b]=!0,this.forceInvalidateMeasure(this)):a=!1)}this.testFontTask=a?void 0:new Core.DelayedTask({scope:this,delay:0.25,
callback:this.testRequireFonts})},checkWindowSize:function(){var a=void 0!==window.innerHeight?window.innerHeight:document.body.clientHeight;((void 0!==window.innerWidth?window.innerWidth:document.body.clientWidth)!==this.getLayoutWidth()||a!==this.getLayoutHeight())&&this.invalidateMeasure()},getOrientation:function(){return this.orientation},onSelectionChange:function(a){},onWindowLoad:function(){var a;if((navigator.iPad||navigator.iPhone||navigator.Android)&&this.webApp)a=document.createElement("meta"),
a.name="apple-mobile-web-app-capable",a.content="yes",document.getElementsByTagName("head")[0].appendChild(a),a=document.createElement("meta"),a.name="apple-mobile-web-app-status-bar-style",a.content="black",document.getElementsByTagName("head")[0].appendChild(a),a=document.createElement("meta"),a.name="mobile-web-app-capable",a.content="yes",document.getElementsByTagName("head")[0].appendChild(a);a=document.createElement("meta");a.name="viewport";a.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";
document.getElementsByTagName("head")[0].appendChild(a);navigator.isWebkit?(a=document.createElement("style"),a.type="text/css",a.innerHTML="* { -webkit-tap-highlight-color: rgba(0, 0, 0, 0); }",document.getElementsByTagName("head")[0].appendChild(a)):navigator.isIE&&(a=document.createElement("style"),a.type="text/css",a.innerHTML="@-ms-viewport { width: device-width; } body { -ms-content-zooming: none; } * { touch-action: none; } ",document.getElementsByTagName("head")[0].appendChild(a));this.loaded=
!0;this.onReady()},onWindowResize:function(a){this.checkWindowSize()},onOrientationChange:function(a){this.orientation=window.orientation;this.fireEvent("orientationchange",this.orientation);this.checkWindowSize()},update:function(){var a=document.body.clientWidth,b=document.body.clientHeight;if(this.windowWidth!==a||this.windowHeight!==b)this.windowWidth=a,this.windowHeight=b,this.fireEvent("resize",this,this.windowWidth,this.windowHeight),this.invalidateLayout();this.layoutWidth=this.windowWidth;
for(this.layoutHeight=this.windowHeight;void 0!==this.layoutList;)a=this.layoutList.layoutNext,this.layoutList.layoutValid=!0,this.layoutList.layoutNext=void 0,this.layoutList.updateLayout(),this.layoutList=a;for(;void 0!==this.drawList;)a=this.drawList.drawNext,this.drawList.drawNext=void 0,this.drawList.draw(),this.drawList=a;this.updateTask=!1},getContent:function(){return this.content},getFocusElement:function(){return this.focusElement},appendDialog:function(a){void 0===this.dialogs&&(this.dialogs=
new Ui.LBox({eventsHidden:!0}),void 0!==this.topLayers?this.insertBefore(this.dialogs,this.topLayers):this.append(this.dialogs));this.dialogs.append(a);this.contentBox.disable();for(a=0;a<this.dialogs.getChildren().length-1;a++)this.dialogs.getChildren()[a].disable()},removeDialog:function(a){void 0!==this.dialogs&&(this.dialogs.remove(a),0===this.dialogs.getChildren().length?(this.remove(this.dialogs),this.dialogs=void 0,this.contentBox.enable()):this.dialogs.getLastChild().enable())},appendTopLayer:function(a){void 0===
this.topLayers&&(this.topLayers=new Ui.LBox({eventsHidden:!0}),this.append(this.topLayers));this.topLayers.append(a)},removeTopLayer:function(a){void 0!==this.topLayers&&(this.topLayers.remove(a),0===this.topLayers.getChildren().length&&(this.remove(this.topLayers),this.topLayers=void 0))},getArguments:function(){return this.arguments},getIsReady:function(){return this.ready},onReady:function(){if(this.loaded){document.documentElement.style.position="absolute";document.documentElement.style.padding=
"0px";document.documentElement.style.margin="0px";document.documentElement.style.border="0px solid black";document.documentElement.style.width="100%";document.documentElement.style.height="100%";document.body.style.position="absolute";document.body.style.overflow="hidden";document.body.style.padding="0px";document.body.style.margin="0px";document.body.style.border="0px solid black";document.body.style.outline="none";document.body.style.width="100%";document.body.style.height="100%";document.body.appendChild(this.getDrawing());
this.handleScrolling(document.body);void 0!==this.requireFonts&&void 0===this.testFontTask&&this.testRequireFonts();this.setIsLoaded(!0);this.setParentVisible(!0);this.fireEvent("ready");this.ready=!0;if(!1===this.updateTask&&this.ready){var a=this;this.updateTask=!0;requestAnimationFrame(function(){a.update()})}new Ui.WheelManager({app:this});new Ui.PointerManager({app:this});new Ui.DragNativeManager({app:this})}},onWindowKeyUp:function(a){if(27==a.which&&void 0!==this.dialogs&&0<this.dialogs.getChildren().length){var b=
this.dialogs.getChildren()[this.dialogs.getChildren().length-1];"close"in b?b.close():b.hide();a.preventDefault();a.stopPropagation()}},onMessage:function(a){parent===a.source&&(a.preventDefault(),a.stopPropagation(),a=JSON.parse(a.data),this.fireEvent("parentmessage",a))},sendMessageToParent:function(a){parent.postMessage(a.serialize(),"*")},findFocusableDiv:function(a){if("tabIndex"in a&&0<=a.tabIndex)return a;if("childNodes"in a)for(var b=0;b<a.childNodes.length;b++){var c=this.findFocusableDiv(a.childNodes[b]);
if(void 0!==c)return c}},enqueueDraw:function(a){a.drawNext=this.drawList;this.drawList=a;!1===this.updateTask&&this.ready&&(this.updateTask=!0,setTimeout(this.bindedUpdate,0))},enqueueLayout:function(a){a.layoutNext=this.layoutList;this.layoutList=a;!1===this.updateTask&&this.ready&&(this.updateTask=!0,requestAnimationFrame(this.bindedUpdate))},handleScrolling:function(a){this.connect(this,"ptrdown",function(b){var c=a.scrollLeft,d=a.scrollTop,e=b.pointer.watch(this);this.connect(e,"move",function(){if(e.getIsCaptured()){var b=
e.getDelta();a.scrollLeft=c-b.x;a.scrollTop=d-b.y}else if(e.pointer.getIsMove()){var b=e.getDirection(),g=!1;"left"===b?g=a.scrollLeft+a.clientWidth<a.scrollWidth:"right"===b?g=0<a.scrollLeft:"bottom"===b?g=0<a.scrollTop:"top"===b&&(g=!0);g?e.capture():e.cancel()}})})},getElementsByClassName:function(a){var b=[],c=function(d){d.classType===a&&b.push(d);if(void 0!==d.children)for(var e=0;e<d.children.length;e++)c(d.children[e])};c(this);return b},getElementByDrawing:function(a){var b=function(c){if(c.drawing===
a)return c;if(void 0!==c.children)for(var d=0;d<c.children.length;d++){var e=b(c.children[d]);if(void 0!==e)return e}};return b(this)}},{getInverseLayoutTransform:function(){return Ui.Matrix.createTranslate(-document.body.scrollLeft,-document.body.scrollTop).multiply(Ui.App.base.getInverseLayoutTransform())},getLayoutTransform:function(){return Ui.App.base.getLayoutTransform().translate(document.body.scrollLeft,document.body.scrollTop)},invalidateMeasure:function(){this.invalidateLayout()},invalidateArrange:function(){this.invalidateLayout()},
arrangeCore:function(a,b){navigator.Android&&navigator.isWebkit&&void 0!==this.focusElement&&("INPUT"===this.focusElement.tagName||"TEXTAREA"===this.focusElement.tagName||this.focusElement.contenteditable)&&b-100>this.lastArrangeHeight&&this.focusElement.blur();this.lastArrangeHeight=b;Ui.App.base.arrangeCore.call(this,a,b)},setContent:function(a){this.content!==a&&(void 0!==this.content&&this.contentBox.remove(this.content),void 0!==a&&this.contentBox.prepend(a,!0),this.content=a)}},{current:void 0,
getWindowIFrame:function(a){void 0===a&&(a=window);var b;if(a.parent!==a)try{for(var c=a.parent.document.getElementsByTagName("IFRAME"),d=0;d<c.length;d++)if(c[d].contentWindow===a){b=c[d];break}}catch(e){}return b},getRootWindow:function(){for(var a=window;a.parent!=a;)a=a.parent;return a}});
