navigator.isGecko=(navigator.userAgent.match(/Gecko\//i)!=null);navigator.isWebkit=(navigator.userAgent.match(/WebKit\//i)!=null);navigator.isIE=(navigator.userAgent.match(/MSIE/i)!=null);navigator.isIE7=(navigator.userAgent.match(/MSIE 7\./i)!=null);navigator.isIE8=(navigator.userAgent.match(/MSIE 8\./i)!=null);navigator.isOpera=((navigator.userAgent==undefined)||(navigator.userAgent.match(/Opera\//i)!=null));navigator.isChrome=(navigator.userAgent.match(/ Chrome\//)!=null);navigator.isSafari=(navigator.userAgent.match(/ Safari\//)!=null);navigator.isFirefox=(navigator.userAgent.match(/ Firefox\//)!=null);navigator.isFirefox3=(navigator.userAgent.match(/ Firefox\/3\./)!=null);navigator.isFirefox3_5=(navigator.userAgent.match(/ Firefox\/3\.5\./)!=null);navigator.isFirefox3_6=(navigator.userAgent.match(/ Firefox\/3\.6\./)!=null);navigator.iPad=(navigator.userAgent.match(/iPad/i)!=null);navigator.iPhone=(navigator.userAgent.match(/iPhone/i)!=null);navigator.Android=(navigator.userAgent.match(/Android/i)!=null);var svgNS="http://www.w3.org/2000/svg";var htmlNS="http://www.w3.org/1999/xhtml";navigator.supportSVG=false;try{var test=document.createElementNS(svgNS,"g");if("ownerSVGElement" in test){navigator.supportSVG=true}}catch(e){}var test=document.createElement("canvas");navigator.supportCanvas="getContext" in test;navigator.supportRgba=true;navigator.supportRgb=true;var test=document.createElement("div");try{test.style.background="rgba(0, 0, 0, 0.5)"}catch(e){navigator.supportRgba=false}try{test.style.background="rgb(0, 0, 0)"}catch(e){navigator.supportRgb=false}Core={};Core.Util={};Core.Util.idGenerator=0;Core.Util.generateId=function(){return ++Core.Util.idGenerator};Core.Util.baseDirectory=function(c){var a;if(document.scripts!=undefined){a=document.scripts}else{a=document.getElementsByTagName("script")}for(var b=0;b<a.length;b++){var d=a[b].src.search(c);if(d!=-1){return a[b].src.substring(0,d)}}return undefined};Core.Util.include=function(a){document.write("<script type='text/javascript' src='"+a+"'><\/script>")};Core.Util.clone=function(a){if(a===null||typeof(a)!=="object"){return null}var c={};for(var b in a){c[b]=a[b]}return c};Core.Util.encodeURIQuery=function(b){var a="";if(b!=undefined){for(var d in b){var c=b[d];if((typeof(c)!="number")&&(typeof(c)!="string")&&(typeof(c)!="boolean")&&(typeof(c)!="object")){continue}if(a!=""){a+="&"}a+=encodeURIComponent(d)+"=";if(typeof(c)=="object"){a+=encodeURIComponent(JSON.stringify(c))}else{a+=encodeURIComponent(c)}}}return a};String.prototype.utf8Encode=function(){var b="";for(var a=0;a<this.length;a++){var d=this.charCodeAt(a);if(d<128){b+=String.fromCharCode(d)}else{if((d>=128)&&(d<2048)){b+=String.fromCharCode((d>>6)|192);b+=String.fromCharCode((d&63)|128)}else{b+=String.fromCharCode((d>>12)|224);b+=String.fromCharCode(((d>>6)&63)|128);b+=String.fromCharCode((d&63)|128)}}}return b};String.prototype.utf8Decode=function(){var b="";var a=0;var d;while(a<this.length){d=this.charCodeAt(a++);if(d<128){b+=String.fromCharCode(d)}else{if((d>=192)&&(d<224)){b+=String.fromCharCode(((d&31)<<6)|(this.charCodeAt(a++)&63))}else{b+=String.fromCharCode(((d&15)<<12)|((this.charCodeAt(a++)&63)<<6)|(this.charCodeAt(a++)&63))}}}return b};String.prototype.toBase64=function(){var h=this.utf8Encode();var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var g="";var b=0;while(b+2<h.length){var f=h.charCodeAt(b++)&255;var d=h.charCodeAt(b++)&255;var c=h.charCodeAt(b++)&255;var m=a.charAt(f>>2);var l=a.charAt(((f&3)<<4)|(d>>4));var k=a.charAt(((d&15)<<2)|(c>>6));var j=a.charAt(c&63);g+=m+l+k+j}if(b+1<h.length){var f=h.charCodeAt(b++)&255;var d=h.charCodeAt(b++)&255;var m=a.charAt(f>>2);var l=a.charAt(((f&3)<<4)|(d>>4));var k=a.charAt((d&15)<<2);g+=m+l+k+"="}else{if(b<h.length){var f=h.charCodeAt(b++)&255;var m=a.charAt(f>>2);var l=a.charAt((f&3)<<4);g+=m+l+"=="}}return g};String.prototype.fromBase64=function(){var d=this;var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var b="";var a=0;while(a<d.length){enc1=c.indexOf(d.charAt(a++));enc2=c.indexOf(d.charAt(a++));enc3=c.indexOf(d.charAt(a++));enc4=c.indexOf(d.charAt(a++));char1=(enc1<<2)|(enc2>>4);char2=((enc2&15)<<4)|(enc3>>2);char3=((enc3&3)<<6)|enc4;b+=String.fromCharCode(char1);if(enc3!=64){b+=String.fromCharCode(char2);if(enc4!=64){b+=String.fromCharCode(char3)}}}return b.utf8Decode()};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}navigator.supportVML=false;if(navigator.isIE){if(navigator.supportSVG){SVGTextContentElement.prototype.__getStartPositionOfChar=SVGTextContentElement.prototype.getStartPositionOfChar;SVGTextContentElement.prototype.getStartPositionOfChar=function(b){var a=this.__getStartPositionOfChar(b);return a.matrixTransform(this.getScreenCTM().inverse())};SVGTextContentElement.prototype.__getEndPositionOfChar=SVGTextContentElement.prototype.getEndPositionOfChar;SVGTextContentElement.prototype.getEndPositionOfChar=function(b){var a=this.__getEndPositionOfChar(b);return a.matrixTransform(this.getScreenCTM().inverse())};SVGTextContentElement.prototype.__getCharNumAtPosition=SVGTextContentElement.prototype.getCharNumAtPosition;SVGTextContentElement.prototype.getCharNumAtPosition=function(a){return this.getCharNumAtPositionHelper(a.x,0,this.getNumberOfChars()-1)};SVGTextContentElement.prototype.getCharNumAtPositionHelper=function(a,f,b){startX=this.getStartPositionOfChar(f).x;endX=this.getEndPositionOfChar(b).x;if((a<startX)||(a>endX)){return -1}if(f==b){return f}var c=Math.floor((f+b)/2);var d=this.getCharNumAtPositionHelper(a,f,c);if(d!=-1){return d}return this.getCharNumAtPositionHelper(a,c+1,b)}}else{if(!document.namespaces.vml){if(navigator.userAgent.match(/MSIE 8/i)!=null){document.namespaces.add("vml","urn:schemas-microsoft-com:vml","#default#VML")}else{document.namespaces.add("vml","urn:schemas-microsoft-com:vml")}}var styleSheet=(document.styleSheets.length>0)?document.styleSheets[0]:document.createStyleSheet();styleSheet.addRule("vml\\:shape","behavior:url(#default#VML)");styleSheet.addRule("vml\\:fill","behavior:url(#default#VML)");styleSheet.addRule("vml\\:rect","behavior:url(#default#VML)");styleSheet.addRule("vml\\:roundrect","behavior:url(#default#VML)");navigator.supportVML=true}if((navigator.isIE7||navigator.isIE8)&&(window.parent!=window)){document.elementFromPoint=function(a,f,d){if(d==undefined){d=document.body}if(!(("childNodes" in d)&&("offsetLeft" in d)&&("offsetTop" in d))){return undefined}for(var c=0;c<d.childNodes.length;c++){var b=document.elementFromPoint(a-d.offsetLeft,f-d.offsetTop,d.childNodes[c]);if(b!=undefined){return b}}if((a>=d.offsetLeft)&&(f>=d.offsetTop)&&(a-d.offsetLeft<=d.clientWidth)&&(f-d.offsetTop<=d.clientHeight)){return d}return undefined}}}if(navigator.isOpera){CanvasRenderingContext2D.prototype.arcTo=function(b,d,a,c,f){this.quadraticCurveTo(b,d,a,c)}}if(window.JSON==undefined){var json={};json.parse=function(json){return eval("("+json+")")};json.stringify=function(b){var c="";var g=true;var a=(b.constructor.toString().indexOf("function Array()")!=-1);for(var h in b){try{var f=b[h];if((typeof(f)!="number")&&(typeof(f)!="string")&&(typeof(f)!="object")){continue}if(g){g=false}else{c+=", "}if(!a){c+='"'+h+'": '}if(typeof(f)=="object"){c+=JSON.stringify(f)}else{if(typeof(f)=="number"){c+=f}else{if(typeof(f)=="string"){c+='"'+f.replace('"','\\"')+'"'}}}}catch(d){}}if(a){c="[ "+c+" ]"}else{c="{ "+c+" }"}return c};window.JSON=json}if(window.console==undefined){window.console={log:function(){},error:function(){},warn:function(){}}}Core.Object=function(){};Core.Object.prototype.classType="Core.Object";Core.Object.prototype.toString=function(){return"[object "+this.classType+"]"};Core.Object.prototype.dump=function(a){if(a!=undefined){a=new RegExp(a,"i")}console.log(this+":");for(var d in this){try{var c=true;if(a!=undefined){c=a.test(d)}if(c){console.log(d+" => "+this[d])}}catch(b){}}};Core.Object.dump=function(c,a){if(a!=undefined){a=new RegExp(a,"i")}console.log(c+":");for(var f in c){try{var d=true;if(a!=undefined){d=a.test(f)}if(d){console.log(f+" => "+c[f])}}catch(b){}}};Core.Object.prototype.serialize=function(){return JSON.stringify(this)};Core.Object.prototype.constructorHelper=function(a,b){if(b==undefined){b=this.__proto__}if(b==undefined){return}if(a==undefined){a={}}if(b.__baseclass__!=undefined){this.constructorHelper.call(this,a,b.__baseclass__)}else{if(b.__proto__!=undefined){this.constructorHelper.call(this,a,b.__proto__)}}if(b.__constructor!=undefined){b.__constructor.call(this,a)}};Function.prototype.extend=function(classType,classDefine,classOverride,classStatic){var tab=classType.split(".");var namespace="";var current=window;for(var i=0;i<tab.length-1;i++){if(namespace!=""){namespace+="."}namespace+=tab[i];if(current[tab[i]]==undefined){current[tab[i]]={}}current=current[tab[i]]}var func=eval("( "+classType+" = function(config) { Core.Object.currentScopes.push(this); var nconfig = Core.Util.clone(config); this.constructorHelper.call(this, nconfig); Core.Object.currentScopes.pop(); this.autoConfig(nconfig); } )");if(navigator.isIE){for(var prop in this.prototype){func.prototype[prop]=this.prototype[prop]}func.prototype.__proto__=func.prototype}else{func.prototype.__proto__=this.prototype}func.prototype.__baseclass__=this.prototype;func.base=this.prototype;for(var prop in func.base.constructor){if(typeof(func.base.constructor[prop])=="function"){func[prop]=func.base.constructor[prop]}}if(classStatic!=undefined){for(var prop in classStatic){func[prop]=classStatic[prop]}}for(var prop in classDefine){if(prop=="constructor"){func.prototype.__constructor=classDefine[prop]}else{if((typeof(classDefine[prop])=="object")&&(classDefine[prop]!=null)){throw ("object are not allowed in classDefine ("+prop+"). Create object in the constructor")}if(prop in func.prototype){throw ("Try to override "+prop+" on class "+classType+". Use classOverride you want to do it")}func.prototype[prop]=classDefine[prop]}}if(classDefine.constructor===Object.prototype.constructor){func.prototype.__constructor=undefined}if((navigator.isIE)&&(classDefine.constructor!==Object.prototype.constructor)){func.prototype.__constructor=classDefine.constructor}if(classOverride!=undefined){for(var prop in classOverride){if((typeof(classOverride[prop])=="object")&&(classOverride[prop]!=null)){throw ("object are not allowed in classOverride ("+prop+"). Create object in the constructor")}func.prototype[prop]=classOverride[prop]}}func.prototype.classType=classType;if((classStatic!=undefined)&&("constructor" in classStatic)){classStatic.constructor.call(func)}return func};Function.prototype.hasInstance=function(b){if((typeof(b)!="object")||(b==null)||(b.constructorHelper!=Core.Object.prototype.constructorHelper)){return false}var a=b;while(a!=undefined){if(a.classType==this.prototype.classType){return true}a=a.__baseclass__}return false};Core.Object.prototype.isSubclassOf=function(a){var b=this;while(b!=undefined){if(b.classType==a){return true}b=b.__baseclass__}return false};Core.Object.prototype.addEvents=function(){if(this.events==undefined){this.events=[]}for(var a=0;a<arguments.length;a++){this.events[arguments[a]]=[]}};Core.Object.prototype.fireEvent=function(a){var b=[];for(var c=1;c<arguments.length;c++){b[c-1]=arguments[c]}var d=false;var f=this.events[a];if(f!=null){for(var c=0;(c<f.length)&&!d;c++){d=this.events[a][c].method.apply(this.events[a][c].scope,b);if(d==undefined){d=false}}}return d};Core.Object.prototype.connect=function(d,b,g,a){if(a==undefined){a=false}if("addEventListener" in d){var f=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};f.scope=this;f.callback=g;f.eventName=b;f.capture=a;d.addEventListener(b,f,a);if(d.events==undefined){d.events=[]}d.events.push(f)}else{if("attachEvent" in d){var f=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};f.scope=this;f.callback=g;f.eventName=b;f.capture=a;d.attachEvent(b,f);if(d.events==undefined){d.events=[]}d.events.push(f)}else{var c={scope:this,method:g,capture:a};eventListeners=d.events[b];if(eventListeners!=null){eventListeners.push(c)}}}};Core.Object.prototype.disconnect=function(d,a,g){if("removeEventListener" in d){for(var b=0;(d.events!=undefined)&&(b<d.events.length);b++){var f=d.events[b];if((f.scope==this)&&(f.eventName==a)){if((g!=undefined)&&(f.callback!=g)){continue}d.removeEventListener(f.eventName,f,f.capture);d.events.splice(b,1);b--}}}else{if("detachEvent" in d){for(var b=0;(d.events!=undefined)&&(b<d.events.length);b++){var f=d.events[b];if((f.scope==this)&&(f.eventName==a)){if((g!=undefined)&&(f.callback!=g)){continue}d.detachEvent(f.eventName,f);d.events.splice(b,1);b--}}}else{for(var b=0;(d.events!=undefined)&&(b<d.events[a].length);b++){var c=d.events[a][b];if(c.scope==this){if((g!=undefined)&&(c.method!=g)){continue}d.events[a].splice(b,1);b--}}}}};Core.Object.currentScopes=[];Core.Object.prototype.autoConfig=function(b){if(b==undefined){return}var m;var g=false;if("scope" in b){m=b.scope;Core.Object.currentScopes.push(m);g=true}else{if(Core.Object.currentScopes.length>0){m=Core.Object.currentScopes[Core.Object.currentScopes.length-1]}else{m=this;Core.Object.currentScopes.push(m);g=true}}for(var a in b){if(a==="name"){m[b.name]=this;delete (b.name);continue}var d="set"+a.charAt(0).toUpperCase()+a.substr(1);if((d in this)&&(typeof(this[d])=="function")){this[d].call(this,b[a]);delete (b[a])}else{if(a.indexOf(".")!=-1){var l=a.split(".");var j=window;for(var f=0;f<l.length-1;f++){j=j[l[f]]}var k=l[l.length-1];var d="set"+k.charAt(0).toUpperCase()+k.substr(1);if((d in j)&&(typeof(j[d]=="function"))){j[d].call(j,this,b[a]);delete (b[a])}}else{if(a.indexOf("on")==0){var h=a.charAt(2).toLowerCase()+a.substr(3);if((this.events!=undefined)&&(h in this.events)){m.connect(this,h,b[a]);delete (b[a])}}}}}if(g){Core.Object.currentScopes.pop()}};Core.Object.create=function(b,d){if(b===undefined){return undefined}else{if(typeof(b)=="string"){if("parse" in this){return this.parse(b)}else{throw ("static parse need to be defined in class "+this.prototype.classType+" to create from a string")}}else{if(Core.Object.hasInstance(b)){return b}else{if(d!==undefined){Core.Object.currentScopes.push(d)}var c=b.type;if(c===undefined){c=this}var a=new c(b);if(d!==undefined){Core.Object.currentScopes.pop()}return a}}}};Core.Object.extend("Core.Uri",{scheme:undefined,user:undefined,password:undefined,host:undefined,port:undefined,path:undefined,query:undefined,fragment:undefined,constructor:function(a){var d=true;var h;if("baseURI" in document){h=document.baseURI}else{h=document.location.href}var c;if("uri" in a){c=a.uri;delete (a.uri)}else{c=h}var b=c.match(/^([^:\/]+):\/\/([^\/]+)(\/.*)$/);if(b===null){d=false;b=h.match(/^([^:\/]+):\/\/([^\/]+)(\/.*)$/)}this.scheme=b[1];var g=b[2];var f=b[3];b=g.match(/^(.+):(.+)@(.*)$/);if(b!==null){this.user=b[1];this.password=b[2];g=b[3]}b=g.match(/^(.+):(.+)$/);if(b!==null){g=b[1];this.port=b[2]}else{if(this.scheme=="https"){this.port=443}else{this.port=80}}this.host=g;if(d){this.path=f}else{if(c.indexOf("/")==0){this.path=Core.Uri.cleanPath(c)}else{this.path=Core.Uri.mergePath(f,c)}}},getScheme:function(){return this.scheme},getUser:function(){return this.user},getPassword:function(){return this.password},getHost:function(){return this.host},getPort:function(){return this.port},getPath:function(){return this.path},getQuery:function(){return this.query},getFragment:function(){return this.fragment}},{toString:function(){var a=this.scheme+"://";if((this.user!=undefined)&&(this.password!=undefined)){a+=this.user+":"+this.password+"@"}a+=this.host;if(this.port!=undefined){a+=":"+this.port}a+=this.path;return a}},{cleanPath:function(a){while(a.match(/\/([^\/]*)\/\.\.\//)){a=a.replace(/\/([^\/]*)\/\.\.\//,"/")}while(a.match(/\/\//,"/")){a=a.replace(/\/\//,"/")}while(a.match(/\/\.\//)){a=a.replace(/\/\.\//,"/")}return a},mergePath:function(c,b){var a=c.match(/^(.*)\//)[0];a+=b;return Core.Uri.cleanPath(a)}});Core.Object.extend("Core.Event",{defaultPrevented:false,type:undefined,bubbles:true,cancelable:true,view:undefined,target:undefined,cancelBubble:false,constructor:function(a){if(a.type!=undefined){this.type=a.type}},preventDefault:function(){this.defaultPrevented=true},stopPropagation:function(){this.cancelBubble=true},stopImmediatePropagation:function(){},dispatchEvent:function(g){this.target=g;if(this.bubbles){var a=[];var f=this.target;while(f!=undefined){if("dispatchEvent" in f){a.push(f)}f=f.parentNode}a.push(window);for(var b=a.length-1;(b>=0)&&(!this.cancelBubble);b--){f=a[b];if((f.__extendCaptureEvents!=undefined)&&(f.__extendCaptureEvents[this.type]!=undefined)){var d=[];for(var c=0;c<f.__extendCaptureEvents[this.type].length;c++){d.push(f.__extendCaptureEvents[this.type][c])}for(var c=0;c<d.length;c++){d[c].call(f,this)}}}for(var b=0;(b<a.length)&&(!this.cancelBubble);b++){f=a[b];if((f.__extendEvents!=undefined)&&(f.__extendEvents[this.type]!=undefined)){var d=[];for(var c=0;c<f.__extendEvents[this.type].length;c++){d.push(f.__extendEvents[this.type][c])}for(var c=0;c<d.length;c++){d[c].call(f,this)}}}}else{if((g.__extendCaptureEvents!=undefined)&&(g.__extendCaptureEvents[this.type]!=undefined)){var d=[];for(var c=0;c<g.__extendCaptureEvents[this.type].length;c++){d.push(g.__extendCaptureEvents[this.type][c])}for(var b=0;b<d.length;b++){d[b].call(g,this)}}if((g.__extendEvents!=undefined)&&(g.__extendEvents[this.type]!=undefined)){var d=[];for(var c=0;c<g.__extendEvents[this.type].length;c++){d.push(g.__extendEvents[this.type][c])}for(var b=0;b<d.length;b++){d[b].call(g,this)}}}return this.defaultPrevented}},{},{events:{},types:{},registerEvent:function(a,b){Core.Event.events[a]=b},getEvent:function(a){return Core.Event.events[a]},register:function(a,b){Core.Event.types[a]=b},getType:function(a){return Core.Event.types[a]},dispatchEvent:function(a){if(Core.Event.hasInstance(a)){return a.dispatchEvent(this)}else{if(this.__dispatchEvent!=undefined){return this.__dispatchEvent(a)}}},addEventListener:function(b,d,a){if(Core.Event.getType(b)!=undefined){if(a){if(this.__extendCaptureEvents==undefined){this.__extendCaptureEvents={}}if(this.__extendCaptureEvents[b]==undefined){this.__extendCaptureEvents[b]=[]}this.__extendCaptureEvents[b].push(d)}else{if(this.__extendEvents==undefined){this.__extendEvents={}}if(this.__extendEvents[b]==undefined){this.__extendEvents[b]=[]}this.__extendEvents[b].push(d)}}else{if(this.__addEventListener!=undefined){return this.__addEventListener(b,d,a)}else{if(this.attachEvent!=undefined){var c=function(){if(arguments.length==1){var h={};for(var g in arguments[0]){h[g]=arguments[0][g]}if(("keyCode" in arguments[0])&&!("which" in arguments[0])){h.which=arguments[0].keyCode}h.preventDefault=function(){this.defaultPrevented=true;this.returnValue=false};h.stopPropagation=function(){this.cancelBubble=true};h.target=h.srcElement;var f=arguments.callee.callback.call(arguments.callee.scope,h);arguments[0].returnValue=h.returnValue;arguments[0].cancelBubble=h.cancelBubble;return f}else{return arguments.callee.callback.apply(arguments.callee.scope,arguments)}};c.scope=this;c.callback=d;c.eventName=b;c.capture=a;this.attachEvent("on"+b,c);if(this.__ieevents==undefined){this.__ieevents=[]}this.__ieevents.push(c)}}}},removeEventListener:function(b,f,a){if(Core.Event.getType(b)!=undefined){if(a){if(this.__extendCaptureEvents!=undefined){for(var c=0;c<this.__extendCaptureEvents[b].length;c++){if(this.__extendCaptureEvents[b][c]==f){this.__extendCaptureEvents[b].splice(c,1);break}}}}else{if(this.__extendEvents!=undefined){for(var c=0;c<this.__extendEvents[b].length;c++){if(this.__extendEvents[b][c]==f){this.__extendEvents[b].splice(c,1);break}}}}}else{if(this.__removeEventListener!=undefined){return this.__removeEventListener(b,f,a)}else{if(this.detachEvent!=undefined){for(var c=0;c<this.__ieevents.length;c++){var d=this.__ieevents[c];if((d.scope==this)&&(d.eventName==b)){if((f!=undefined)&&(d.callback!=f)){continue}this.detachEvent(d.eventName,d);this.__ieevents.splice(c,1);c--}}}}}},createEvent:function(a){var b=Core.Event.getEvent(a);if(b!=undefined){return new b()}else{if(document.__createEvent!=undefined){return document.__createEvent.call(document,a)}}},createElement:function(a){var b=document.__createElement.call(document,a);if(b.dispatchEvent!=Core.Event.dispatchEvent){b.__dispatchEvent=b.dispatchEvent;b.dispatchEvent=Core.Event.dispatchEvent}if(b.addEventListener!=Core.Event.addEventListener){b.__addEventListener=b.addEventListener;b.addEventListener=Core.Event.addEventListener}if(b.removeEventListener!=Core.Event.removeEventListener){b.__removeEventListener=b.removeEventListener;b.removeEventListener=Core.Event.removeEventListener}return b},cleanTarget:function(b){var a=b;while(a!=undefined){if(("dispatchEvent" in a)&&("innerHTML" in a)&&(a.dispatchEvent===Core.Event.dispatchEvent)){return a}if("offsetParent" in a){a=a.offsetParent}else{a=a.parentNode}}return window}});if("HTMLElement" in window){HTMLElement.prototype.__dispatchEvent=HTMLElement.prototype.dispatchEvent;HTMLElement.prototype.dispatchEvent=Core.Event.dispatchEvent;HTMLElement.prototype.__addEventListener=HTMLElement.prototype.addEventListener;HTMLElement.prototype.addEventListener=Core.Event.addEventListener;HTMLElement.prototype.__removeEventListener=HTMLElement.prototype.removeEventListener;HTMLElement.prototype.removeEventListener=Core.Event.removeEventListener}if("SVGElement" in window){SVGElement.prototype.__dispatchEvent=SVGElement.prototype.dispatchEvent;SVGElement.prototype.dispatchEvent=Core.Event.dispatchEvent;SVGElement.prototype.__addEventListener=SVGElement.prototype.addEventListener;SVGElement.prototype.addEventListener=Core.Event.addEventListener;SVGElement.prototype.__removeEventListener=SVGElement.prototype.removeEventListener;SVGElement.prototype.removeEventListener=Core.Event.removeEventListener}window.__dispatchEvent=window.dispatchEvent;window.dispatchEvent=Core.Event.dispatchEvent;window.__addEventListener=window.addEventListener;window.addEventListener=Core.Event.addEventListener;window.__removeEventListener=window.removeEventListener;window.removeEventListener=Core.Event.removeEventListener;if("HTMLDocument" in window){HTMLDocument.prototype.__createEvent=HTMLDocument.prototype.createEvent;HTMLDocument.prototype.createEvent=Core.Event.createEvent;HTMLDocument.prototype.__createElement=HTMLDocument.prototype.createElement;HTMLDocument.prototype.createElement=Core.Event.createElement}else{document.__createEvent=document.createEvent;document.createEvent=Core.Event.createEvent;document.__createElement=document.createElement;document.createElement=Core.Event.createElement}Core.Event.extend("Core.MouseEvents",{detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,constructor:function(a){},initMouseEvent:function(o,q,f,p,k,h,g,d,b,c,a,n,m,j,l){this.type=o;this.bubbles=q;this.cancelable=f;this.view=p;this.detail=k;this.screenX=h;this.screenY=g;this.clientX=d;this.clientY=b;this.ctrlKey=c;this.altKey=a;this.shiftKey=n;this.metaKey=m;this.button=j}});Core.Object.extend("Core.MouseManager",{captureElement:undefined,constructor:function(d){Core.Event.registerEvent("MouseEvents",Core.MouseEvents);Core.Event.register("mousedown",Core.MouseEvents);Core.Event.register("mousemove",Core.MouseEvents);Core.Event.register("mouseup",Core.MouseEvents);var b=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};b.scope=this;b.callback=this.onMouseDown;document.attachEvent("onmousedown",b);var c=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};c.scope=this;c.callback=this.onMouseMove;document.attachEvent("onmousemove",c);var f=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};f.scope=this;f.callback=this.onMouseUp;document.attachEvent("onmouseup",f);var a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onMouseDblClick;document.attachEvent("ondblclick",a)},onMouseDblClick:function(a){this.onMouseDown(a);return this.onMouseUp(a)},onMouseDown:function(b){if(("tagName" in b.srcElement)&&((b.srcElement.tagName=="INPUT")||(b.srcElement.tagName=="TEXTAREA"))){return}this.captureElement=b.srcElement;this.captureElement.setCapture();var c=Core.Event.cleanTarget(b.srcElement);var d=document.createEvent("MouseEvents");var a=b.button;if(a==1){a=0}else{if(a==4){a=1}}d.initMouseEvent("mousedown",true,true,b.view,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,a,c);c.dispatchEvent(d);b.returnValue=!d.defaultPrevented;return b.returnValue},onMouseMove:function(b){if(("tagName" in b.srcElement)&&((b.srcElement.tagName=="INPUT")||(b.srcElement.tagName=="TEXTAREA"))){return}var d=document.createEvent("MouseEvents");var c=Core.Event.cleanTarget(b.srcElement);var a=b.button;if(a==1){a=0}else{if(a==4){a=1}}d.initMouseEvent("mousemove",true,true,b.view,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,a,c);c.dispatchEvent(d);b.returnValue=!d.defaultPrevented;return b.returnValue},onMouseUp:function(b){if(("tagName" in b.srcElement)&&((b.srcElement.tagName=="INPUT")||(b.srcElement.tagName=="TEXTAREA"))){return}if(this.captureElement!=undefined){this.captureElement.releaseCapture()}var c=Core.Event.cleanTarget(b.srcElement);var d=document.createEvent("MouseEvents");var a=b.button;if(a==1){a=0}else{if(a==4){a=1}}d.initMouseEvent("mouseup",true,true,b.view,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,a,c);c.dispatchEvent(d);b.returnValue=!d.defaultPrevented;return b.returnValue}});if(("attachEvent" in window)&&((navigator.userAgent.match(/MSIE 7.0/i)!=null)||(navigator.userAgent.match(/MSIE 8.0/i)))){new Core.MouseManager()}Core.Event.extend("Core.FingerEvent",{constructor:function(a){},initFingerEvent:function(c,f,b,a,d){this.type=c;this.bubbles=f;this.cancelable=b;this.view=a;this.finger=d}},{},{constructor:function(){Core.Event.registerEvent("FingerEvent",Core.FingerEvent);Core.Event.register("fingerdown",Core.FingerEvent);Core.Event.register("fingermove",Core.FingerEvent);Core.Event.register("fingerup",Core.FingerEvent)}});Core.Object.extend("Core.Finger",{id:undefined,x:undefined,y:undefined,initialX:undefined,initialY:undefined,captureElement:undefined,constructor:function(b){this.addEvents("fingermove","fingerup");this.id=b.id;delete (b.id);this.x=b.x;this.y=b.y;this.initialX=b.x;this.initialY=b.y;delete (b.x);delete (b.y);var c=Core.Event.cleanTarget(document.elementFromPoint(this.x,this.y));if(c!=undefined){var a=document.createEvent("FingerEvent");a.initFingerEvent("fingerdown",true,true,window,this);c.dispatchEvent(a)}},getX:function(){return this.x},getY:function(){return this.y},setPosition:function(a,d){if(a==undefined){a=this.x}if(d==undefined){d=this.y}if((this.x!=a)||(this.y!=d)){this.x=a;this.y=d;var c;if(this.captureElement!=undefined){c=this.captureElement}else{c=document.elementFromPoint(this.x,this.y)}if(c!=undefined){var b=document.createEvent("FingerEvent");b.initFingerEvent("fingermove",(this.captureElement==undefined),true,window,this);this.fireEvent("fingermove",b);if(!b.defaultPrevented){c.dispatchEvent(b)}}}},capture:function(a){this.captureElement=a},release:function(){if(this.captureElement!=undefined){this.x=this.initialX;this.y=this.initialY;var b=this.captureElement.offsetParent;this.captureElement=undefined;if(b!=undefined){var a=document.createEvent("FingerEvent");a.initFingerEvent("fingerdown",true,true,window,this);b.dispatchEvent(a)}}},end:function(){var b;if(this.captureElement!=undefined){b=this.captureElement}else{b=document.elementFromPoint(this.x,this.y)}if(b!=undefined){var a=document.createEvent("FingerEvent");a.initFingerEvent("fingerup",(this.captureElement==undefined),true,window,this);this.fireEvent("fingerup",a);if(!a.defaultPrevented){b.dispatchEvent(a)}}}});Core.Object.extend("Core.FingerManager",{touches:undefined,constructor:function(a){this.touches={};this.connect(window,"load",this.onWindowLoad)},onWindowLoad:function(){try{this.connect(window,"touchstart",this.updateTouches);this.connect(window,"touchmove",this.updateTouches);this.connect(window,"touchend",this.updateTouches)}catch(a){}},updateTouches:function(b){for(var f in this.touches){var d=false;for(var a=0;(a<b.touches.length)&&!d;a++){if(f==b.touches[a].identifier){d=true;this.touches[f].setPosition(b.touches[a].clientX,b.touches[a].clientY)}}if(!d){this.touches[f].end();delete (this.touches[f])}}for(var a=0;a<b.touches.length;a++){if(this.touches[b.touches[a].identifier]==undefined){var c=new Core.Finger({id:b.touches[a].identifier,x:b.touches[a].clientX,y:b.touches[a].clientY});this.touches[b.touches[a].identifier]=c}}b.preventDefault();b.stopPropagation()}},{},{current:undefined,constructor:function(){this.current=new Core.FingerManager()}});Core.Event.extend("Core.DragEvent",{dataTransfer:undefined,constructor:function(a){},initDragEvent:function(l,n,f,m,o,h,g,d,b,c,a,k,j){this.type=l;this.bubbles=n;this.cancelable=f;this.view=m;this.dataTransfer=o;this.screenX=h;this.screenY=g;this.clientX=d;this.clientY=b;this.ctrlKey=c;this.altKey=a;this.shiftKey=k;this.metaKey=j}});Core.Object.extend("Core.DragDataTransfer",{draggable:undefined,image:undefined,startX:0,startY:0,startImagePoint:undefined,overElement:undefined,hasStarted:false,rootWindow:undefined,dropEffect:"none",type:undefined,data:undefined,finger:undefined,mouse:false,constructor:function(a){this.draggable=a.draggable;delete (a.draggable);this.startX=a.x;this.startY=a.y;delete (a.x);delete (a.y);this.data={};if(a.mouse!=undefined){this.mouse=a.mouse;delete (a.mouse);a.event.preventDefault();a.event.stopPropagation();delete (a.event);this.rootWindow=window;this.connect(window,"mouseup",this.onMouseUp,true);this.connect(window,"mousemove",this.onMouseMove,true)}if(a.finger!=undefined){this.finger=a.finger;delete (a.finger);var b=document.createEvent("DragEvent");b.initDragEvent("dragstart",false,true,a.event.window,this,this.startX,this.startY,this.startX,this.startY,a.event.ctrlKey,a.event.altKey,a.event.shiftKey,a.event.metaKey);this.draggable.dispatchEvent(b);if(this.hasData()){this.hasStarted=true;this.image=this.draggable.cloneNode(true);document.body.appendChild(this.image);this.startImagePoint=Ui.Element.pointToWindow(this.draggable,{x:0,y:0});this.image.style.left=this.startImagePoint.x+"px";this.image.style.top=this.startImagePoint.y+"px";a.event.preventDefault();a.event.stopPropagation();this.connect(a.event.finger,"fingermove",this.onFingerMove);this.connect(a.event.finger,"fingerup",this.onFingerUp)}delete (a.event)}},setData:function(a,b){this.data[a]=b},getData:function(a){return this.data[a]},hasData:function(){var a=false;for(var b in this.data){a=true}return a},onMouseMove:function(f){var b=f.clientX-this.startX;var a=f.clientY-this.startY;var h=Math.sqrt(b*b+a*a);if(!this.hasStarted&&(h>10)){var g=document.createEvent("DragEvent");g.initDragEvent("dragstart",false,true,f.window,this,this.startX,this.startY,this.startX,this.startY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey);this.draggable.dispatchEvent(g);if(this.hasData()){this.hasStarted=true;this.rootWindow=window;var d=Ui.Element.transformToWindow(this.draggable);this.image=this.draggable.cloneNode(true);this.rootWindow.document.body.appendChild(this.image);this.startImagePoint=new Ui.Point({x:0,y:0});this.startImagePoint.matrixTransform(d);this.image.style.left=this.startImagePoint.x+"px";this.image.style.top=this.startImagePoint.y+"px";f.preventDefault();f.stopPropagation();if(this.rootWindow!=window){this.disconnect(window,"mouseup",this.onMouseUp,true);this.disconnect(window,"mousemove",this.onMouseMove,true);this.catcher=document.createElement("div");this.catcher.style.position="absolute";this.catcher.style.left="0px";this.catcher.style.right="0px";this.catcher.style.top="0px";this.catcher.style.bottom="0px";this.catcher.zIndex=1000;this.rootWindow.document.body.appendChild(this.catcher);this.connect(this.rootWindow,"mouseup",this.onMouseUp,true);this.connect(this.rootWindow,"mousemove",this.onMouseMove,true)}}}else{if(this.hasStarted){f.preventDefault();f.stopPropagation();this.rootWindow.document.body.removeChild(this.image);var c=this.rootWindow.document.elementFromPoint(f.clientX,f.clientY);this.rootWindow.document.body.appendChild(this.image);while((c!=undefined)&&("parentNode" in c)&&("ownerSVGElement" in c)){c=c.parentNode}this.image.style.left=(this.startImagePoint.x+b)+"px";this.image.style.top=(this.startImagePoint.y+a)+"px";if((c!=undefined)&&("dispatchEvent" in c)){var g=document.createEvent("DragEvent");if(this.overElement!=c){g.initDragEvent("dragenter",true,true,f.window,this,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey)}else{g.initDragEvent("dragover",true,true,f.window,this,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey)}c.dispatchEvent(g)}this.overElement=c}}},onMouseUp:function(a){if(a.button!=0){return}if(this.hasStarted){a.preventDefault();a.stopPropagation();if(this.rootWindow!=window){this.rootWindow.document.body.removeChild(this.catcher)}this.rootWindow.document.body.removeChild(this.image);if((this.overElement!=undefined)&&("dispatchEvent" in this.overElement)){var b=document.createEvent("DragEvent");b.initDragEvent("drop",true,true,a.window,this,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey);this.overElement.dispatchEvent(b)}var b=document.createEvent("DragEvent");b.initDragEvent("dragend",false,true,a.window,this,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey);this.draggable.dispatchEvent(b)}this.disconnect(this.rootWindow,"mouseup",this.onMouseUp,true);this.disconnect(this.rootWindow,"mousemove",this.onMouseMove,true)},onFingerMove:function(d){d.preventDefault();d.stopPropagation();document.body.removeChild(this.image);var c=document.elementFromPoint(d.finger.getX(),d.finger.getY());document.body.appendChild(this.image);var b=d.finger.getX()-this.startX;var a=d.finger.getY()-this.startY;this.image.style.left=(this.startImagePoint.x+b)+"px";this.image.style.top=(this.startImagePoint.y+a)+"px";if(c!=undefined){var f=document.createEvent("DragEvent");if(this.overElement!=c){f.initDragEvent("dragenter",true,true,d.window,this,d.finger.getX(),d.finger.getY(),d.finger.getX(),d.finger.getY(),d.ctrlKey,d.altKey,d.shiftKey,d.metaKey)}else{f.initDragEvent("dragover",true,true,d.window,this,d.finger.getX(),d.finger.getY(),d.finger.getX(),d.finger.getY(),d.ctrlKey,d.altKey,d.shiftKey,d.metaKey)}c.dispatchEvent(f)}this.overElement=c},onFingerUp:function(a){a.preventDefault();a.stopPropagation();this.disconnect(a.finger,"fingerup",this.onFingerUp);this.disconnect(a.finger,"fingermove",this.onFingerMove);document.body.removeChild(this.image);if(this.overElement!=undefined){var b=document.createEvent("DragEvent");b.initDragEvent("drop",true,true,a.window,this,a.finger.getX(),a.finger.getY(),a.finger.getX(),a.finger.getY(),a.ctrlKey,a.altKey,a.shiftKey,a.metaKey);this.overElement.dispatchEvent(b)}var b=document.createEvent("DragEvent");b.initDragEvent("dragend",false,true,a.window,this,a.finger.getX(),a.finger.getY(),a.finger.getX(),a.finger.getY(),a.ctrlKey,a.altKey,a.shiftKey,a.metaKey);this.draggable.dispatchEvent(b)}});Core.Object.extend("Core.DragManager",{constructor:function(a){this.connect(window,"mousedown",this.onMouseDown);this.connect(window,"fingerdown",this.onFingerDown);Core.Event.registerEvent("DragEvent",Core.DragEvent);Core.Event.register("dragstart",Core.DragEvent);Core.Event.register("dragend",Core.DragEvent);Core.Event.register("dragenter",Core.DragEvent);Core.Event.register("dragover",Core.DragEvent);Core.Event.register("drop",Core.DragEvent)},onDragDown:function(g,a,h,c,b,d){var f=g;while((f!=undefined)&&("getAttribute" in f)&&!((f.getAttribute("draggable")===true)||(f.getAttribute("draggable")==="true"))){f=f.parentNode}if((f!=undefined)&&("getAttribute" in f)&&((f.getAttribute("draggable")===true)||(f.getAttribute("draggable")==="true"))){new Core.DragDataTransfer({draggable:f,x:a,y:h,event:c,mouse:b,finger:d})}},onMouseDown:function(a){if(a.button!=0){return}this.onDragDown(a.target,a.clientX,a.clientY,a,true,undefined)},onFingerDown:function(a){this.onDragDown(a.target,a.finger.getX(),a.finger.getY(),a,false,a.finger)}});navigator.supportDrag=(("ondragstart" in window)||navigator.isGecko)&&!navigator.isIE&&!navigator.iPad&&!navigator.iPhone&&!navigator.Android;if(!navigator.supportDrag){Core.DragManager.current=new Core.DragManager()}Core.Object.extend("Core.DelayedTask",{delay:1,scope:undefined,callback:undefined,arguments:undefined,isDone:false,constructor:function(a){if("delay" in a){this.delay=a.delay;delete (a.delay)}if("scope" in a){this.scope=a.scope;delete (a.scope)}if("arguments" in a){this.arguments=a.arguments;delete (a.arguments)}else{this.arguments=[]}if("callback" in a){this.callback=a.callback;delete (a.callback)}else{throw ("callback MUST be given for a DelayedTask")}var b=function(){arguments.callee.delayedtask.handle=undefined;arguments.callee.delayedtask.callback.apply(arguments.callee.delayedtask.scope,arguments.callee.delayedtask.arguments);arguments.callee.delayedtask.isDone=true};b.delayedtask=this;this.handle=setTimeout(b,this.delay*1000)},abort:function(){if(this.handle!=undefined){clearTimeout(this.handle);this.handle=undefined}}});Core.Object.extend("Core.Timer",{interval:1,arguments:undefined,constructor:function(a){this.addEvents("timeupdate");if("interval" in a){this.interval=a.interval;delete (a.interval)}if("arguments" in a){this.arguments=a.arguments;delete (a.arguments)}else{this.arguments=[]}this.wrapper=function(){var f=(new Date().getTime())/1000;var g=arguments.callee.timer;g.fireEvent("timeupdate",g,g.arguments);var d=(new Date().getTime())/1000;var c=d-f;if(c<0){c=0}var b=(g.interval*1000)-c;if(b<0){b=0}if(g.handle!=undefined){g.handle=setTimeout(g.wrapper,b)}};this.wrapper.timer=this;this.handle=setTimeout(this.wrapper,0)},abort:function(){if(this.handle!=undefined){clearTimeout(this.handle);this.handle=undefined}}});Core.Object.extend("Core.HttpRequest",{url:undefined,method:"GET",binary:false,request:undefined,arguments:undefined,content:undefined,constructor:function(a){this.addEvents("error","done");this.request=new XMLHttpRequest();var b=function(){var c=arguments.callee.httprequest;if(c.request.readyState==4){if((c.request.status>=200)&&(c.request.status<300)){c.fireEvent("done",c)}else{c.fireEvent("error",c,c.request.status)}}};b.httprequest=this;this.request.onreadystatechange=b},setUrl:function(a){this.url=a},setBinary:function(a){this.binary=a},setMethod:function(a){this.method=a},setRequestHeader:function(b,a){this.request.setRequestHeader(b,a)},setArguments:function(a){this.arguments=a},addArgument:function(b,a){if(this.arguments==undefined){this.arguments={}}this.arguments[b]=a},setContent:function(a){this.content=a},abort:function(){this.request.abort()},send:function(){if(this.url==undefined){throw ("url MUST be given for an HttpRequest")}var b="";if(this.arguments!=undefined){b=Core.Util.encodeURIQuery(this.arguments)}var a=this.url;if(((this.method=="GET")||(this.method=="DELETE")||(this.content!=undefined))&&(b!="")){if(this.url.indexOf("?")==-1){a+="?"+b}else{a+="&"+b}}this.request.open(this.method,a,true);if(this.binary){this.request.overrideMimeType("text/plain; charset=x-user-defined")}this.request.setRequestHeader("X-Requested-With","XMLHttpRequest");if(Core.HttpRequest.requestHeaders!=undefined){for(var c in Core.HttpRequest.requestHeaders){this.request.setRequestHeader(c,Core.HttpRequest.requestHeaders[c])}}if((this.method=="POST")||(this.method=="PUT")){if(this.content==undefined){this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.request.send(b)}else{this.request.setRequestHeader("Content-type","text/plain; charset=utf-8");this.request.send(this.content)}}else{this.request.send()}},setRequestHeader:function(b,a){this.request.setRequestHeader(b,a)},getResponseHeader:function(a){return this.request.getResponseHeader(a)},getResponseText:function(){return this.request.responseText},getResponseBase64:function(){var h=this.request.responseText;var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var g="";var b=0;while(b+2<h.length){var f=h.charCodeAt(b++)&255;var d=h.charCodeAt(b++)&255;var c=h.charCodeAt(b++)&255;var m=a[f>>2];var l=a[((f&3)<<4)|(d>>4)];var k=a[((d&15)<<2)|(c>>6)];var j=a[c&63];g+=m+l+k+j}if(b+1<h.length){var f=h.charCodeAt(b++)&255;var d=h.charCodeAt(b++)&255;var m=a[f>>2];var l=a[((f&3)<<4)|(d>>4)];var k=a[(d&15)<<2];g+=m+l+k+"="}else{if(b<h.length){var f=h.charCodeAt(b++)&255;var m=a[f>>2];var l=a[(f&3)<<4];g+=m+l+"=="}}return g},getResponseJSON:function(){var a;try{a=JSON.parse(this.getResponseText())}catch(b){a=undefined}return a},getResponseXML:function(){var c=new DOMParser();try{var a=c.parseFromString(this.getResponseText(),"text/xml");return a}catch(b){}return undefined},getStatus:function(){return httprequest.request.status}},{},{requestHeaders:undefined,setRequestHeader:function(b,a){if(Core.HttpRequest.requestHeaders==undefined){Core.HttpRequest.requestHeaders={}}Core.HttpRequest.requestHeaders[b]=a}});Core.Object.extend("Core.Socket",{host:undefined,service:"/",port:80,mode:undefined,secure:false,websocket:undefined,websocketdelay:undefined,emuopenrequest:undefined,emupollrequest:undefined,emusendrequest:undefined,emuid:undefined,emumessages:undefined,lastPosition:0,readSize:true,size:0,data:"",isClosed:false,closeSent:false,constructor:function(a){this.addEvents("error","message","close","open");if("host" in a){this.host=a.host;delete (a.host)}else{this.host=document.location.hostname}if("secure" in a){this.secure=a.secure;delete (a.secure)}if("port" in a){this.port=a.port;delete (a.port)}else{if((document.location.port!=undefined)&&(document.location.port!="")){this.port=document.location.port}else{if(this.secure){this.port=443}else{this.port=80}}}if("service" in a){this.service=a.service;delete (a.service)}if("mode" in a){this.mode=a.mode;delete (a.mode)}else{if(Core.Socket.supportWebSocket){this.mode="websocket"}else{this.mode="poll"}}if(this.mode=="websocket"){this.websocket=new WebSocket((this.secure?"wss":"ws")+"://"+this.host+":"+this.port+this.service);this.websocketdelay=new Core.DelayedTask({scope:this,callback:this.onWebSocketOpenTimeout,delay:2});this.connect(this.websocket,"open",this.onWebSocketOpen);this.connect(this.websocket,"error",this.onWebSocketError);this.connect(this.websocket,"message",this.onWebSocketMessage);this.connect(this.websocket,"close",this.onWebSocketClose)}else{this.emumessages=[];this.emuopenrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+"?socket=poll&command=open"});this.connect(this.emuopenrequest,"done",this.onEmuSocketOpenDone);this.connect(this.emuopenrequest,"error",this.onEmuSocketOpenError);this.emuopenrequest.send()}},send:function(a){if(this.websocket!=undefined){this.websocket.send(JSON.stringify(a))}else{if(this.emusendrequest==undefined){this.emusendrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+"?socket="+this.mode+"&command=send&id="+this.emuid+"&messages="+encodeURIComponent((JSON.stringify(a)).toBase64())});this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone);this.connect(this.emusendrequest,"error",this.onEmuSocketSendError);this.emusendrequest.send()}else{this.emumessages.push((JSON.stringify(a)).toBase64())}}},close:function(){if(this.websocket!=undefined){this.isClosed=true;this.websocket.close()}else{if(!this.isClosed){this.isClosed=true;if(this.emuopenrequest!=undefined){this.emuopenrequest.abort();this.emuopenrequest=undefined}else{if(this.emuid!=undefined){if(this.emusendrequest==undefined){this.closeSent=true;this.emusendrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+"?socket="+this.mode+"&command=close&id="+this.emuid});this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone);this.connect(this.emusendrequest,"error",this.onEmuSocketSendError);this.emusendrequest.send()}}}}}},onWebSocketOpenTimeout:function(){this.websocketdelay=undefined;this.disconnect(this.websocket,"open",this.onWebSocketOpen);this.disconnect(this.websocket,"error",this.onWebSocketError);this.disconnect(this.websocket,"message",this.onWebSocketMessage);this.disconnect(this.websocket,"close",this.onWebSocketClose);this.websocket.close();this.websocket=undefined;this.mode="poll";this.emumessages=[];this.emuopenrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+"?socket=poll&command=open"});this.connect(this.emuopenrequest,"done",this.onEmuSocketOpenDone);this.connect(this.emuopenrequest,"error",this.onEmuSocketOpenError);this.emuopenrequest.send()},onWebSocketOpen:function(){if(this.websocketdelay!=undefined){this.websocketdelay.abort();this.websocketdelay=undefined}this.fireEvent("open",this)},onWebSocketError:function(){if(this.websocketdelay!=undefined){this.websocketdelay.abort();this.websocketdelay=undefined}this.fireEvent("error",this)},onWebSocketMessage:function(a){if(a.data=="PING"){this.websocket.send("PONG")}else{this.fireEvent("message",this,JSON.parse(a.data))}},onWebSocketClose:function(a){if(this.websocketdelay!=undefined){this.websocketdelay.abort();this.websocketdelay=undefined}this.fireEvent("close",this)},emuSocketDataAvailable:function(a){if(this.emuid==undefined){this.emuid=a;this.fireEvent("open",this)}else{if(a!="keepalive"){this.fireEvent("message",this,JSON.parse(a.fromBase64()))}}},emuSocketUpdate:function(c){for(var a=0;a<c.length;a++){var b=c[a];if(this.readSize){if(b==":"){this.readSize=false;this.size=parseInt("0x"+this.data);this.data=""}else{this.data+=b}}else{this.data+=b;if(this.data.length>=this.size+2){this.emuSocketDataAvailable(this.data.substring(0,this.data.length-2));this.readSize=true;this.data=""}}}},onEmuSocketSendDone:function(){var a=this.emusendrequest.getResponseJSON();if(this.emumessages.length>0){var c="";for(var b=0;b<this.emumessages.length;b++){if(c!=""){c+=";"}c+=this.emumessages[b]}this.emusendrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+"?socket="+this.mode+"&command=send&id="+this.emuid+"&messages="+encodeURIComponent(c)});this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone);this.connect(this.emusendrequest,"error",this.onEmuSocketSendError);this.emusendrequest.send();this.emumessages=[]}else{if(this.isClosed&&!this.closeSent){this.emusendrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+"?socket="+this.mode+"&command=close&id="+this.emuid});this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone);this.connect(this.emusendrequest,"error",this.onEmuSocketSendError);this.emusendrequest.send()}else{this.emusendrequest=undefined}}},onEmuSocketSendError:function(){this.emusendrequest=undefined},onEmuSocketOpenDone:function(){var a=this.emuopenrequest.getResponseJSON();this.emuopenrequest=undefined;if(a==undefined){this.fireEvent("error",this);this.fireEvent("close",this)}else{this.emuid=a.id;if(a.status!="open"){this.fireEvent("error",this);this.fireEvent("close",this)}else{this.fireEvent("open",this);this.emupollrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+"?socket=poll&command=poll&id="+this.emuid});this.connect(this.emupollrequest,"done",this.onEmuSocketPollDone);this.connect(this.emupollrequest,"error",this.onEmuSocketPollError);this.emupollrequest.send()}}},onEmuSocketOpenError:function(b,a){this.emuopenrequest=undefined;this.fireEvent("error",this);this.fireEvent("close",this)},onEmuSocketPollDone:function(){var a=this.emupollrequest.getResponseJSON();if(a==undefined){this.close();this.fireEvent("close",this)}else{if(a.messages!=undefined){for(var b=0;b<a.messages.length;b++){var c=JSON.parse(a.messages[b].fromBase64());this.fireEvent("message",this,c)}}if(a.status!="open"){this.close();this.fireEvent("close",this)}else{this.emupollrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+"?socket=poll&command=poll&id="+this.emuid});this.connect(this.emupollrequest,"done",this.onEmuSocketPollDone);this.connect(this.emupollrequest,"error",this.onEmuSocketPollError);this.emupollrequest.send()}}},onEmuSocketPollError:function(){this.emupollrequest=undefined;this.fireEvent("error",this);this.close()}});if(("MozWebSocket" in window)&&!("WebSocket" in window)){window.WebSocket=window.MozWebSocket}Core.Socket.supportWebSocket="WebSocket" in window;Core.Object.extend("Core.File",{iframe:undefined,form:undefined,fileInput:undefined,fileApi:undefined,constructor:function(a){if(a.form!=undefined){this.form=a.form;delete (a.form)}if(a.iframe!=undefined){this.iframe=a.iframe;delete (a.iframe)}if(a.fileInput!=undefined){this.fileInput=a.fileInput;delete (a.fileInput)}if(a.fileApi!=undefined){this.fileApi=a.fileApi;delete (a.fileApi)}},getFileName:function(){if(this.fileApi!=undefined){return(this.fileApi.fileName!=undefined)?this.fileApi.fileName:this.fileApi.name}else{return(this.fileInput.fileName!=undefined)?this.fileInput.fileName:this.fileInput.name}},getRelativePath:function(){var a=undefined;if(this.fileApi!=undefined){if("relativePath" in this.fileApi){a=this.fileApi.relativePath}else{if("webkitRelativePath" in this.fileApi){a=this.fileApi.webkitRelativePath}else{if("mozRelativePath" in this.fileApi){a=this.fileApi.mozRelativePath}}}}if(a===""){a=undefined}return a},getMimetype:function(){if((this.fileApi!=undefined)&&("type" in this.fileApi)){return this.fileApi.type}else{return"application/octet-stream"}}});Core.Object.extend("Core.FilePostUploader",{file:undefined,destination:undefined,service:undefined,reader:undefined,request:undefined,binaryString:false,responseText:undefined,fileReader:undefined,boundary:undefined,method:"POST",constructor:function(a){this.addEvents("progress","complete","error")},setMethod:function(a){this.method=a},getFile:function(){return this.file},setFile:function(a){this.file=a},setService:function(a){this.service=a},setDestination:function(a){this.destination=a},send:function(){if(this.file.fileApi!=undefined){if(navigator.supportFormData){var b=new FormData();if(this.destination==undefined){this.destination=this.file.getFileName()}b.append("destination",this.destination);b.append("file",this.file.fileApi);this.request=new XMLHttpRequest();if("upload" in this.request){this.connect(this.request.upload,"progress",this.onUpdateProgress)}this.request.open(this.method,this.service);this.request.send(b);var a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onStateChange;this.request.onreadystatechange=a}else{this.fileReader=new FileReader();this.request=new XMLHttpRequest();if("upload" in this.request){this.connect(this.request.upload,"progress",this.onUpdateProgress)}this.request.open(this.method,this.service);this.boundary="----";var c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var f=0;f<16;f++){this.boundary+=c[Math.floor(Math.random()*c.length)]}this.boundary+="----";this.request.setRequestHeader("Content-Type","multipart/form-data, boundary="+this.boundary);this.request.setRequestHeader("Content-Length",this.file.fileApi.size);var a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onStateChange;this.request.onreadystatechange=a;var j=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};j.scope=this;j.callback=this.onFileReaderLoad;this.fileReader.onload=j;var h=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};h.scope=this;h.callback=this.onFileReaderError;this.fileReader.onerror=h;this.fileReader.readAsBinaryString(this.file.fileApi)}}else{this.file.form.action=this.service;var l=document.createElement("input");l.type="hidden";l.setAttribute("name","destination");l.setAttribute("value",this.destination);this.file.form.insertBefore(l,this.file.form.firstChild);this.connect(this.file.iframe,"load",this.onIFrameLoad);var k=0;var d=false;while(!d&&(k<5)){try{this.file.form.submit();d=true}catch(g){k++}}}},getResponseText:function(){return this.responseText},getResponseJSON:function(){var a;try{a=JSON.parse(this.getResponseText())}catch(b){a=undefined}return a},onStateChange:function(a){if(this.request.readyState==4){if(this.request.status==200){this.responseText=this.request.responseText;this.fireEvent("complete",this)}else{this.responseText=this.request.responseText;this.fireEvent("error",this,this.request.status)}this.request=undefined}},onUpdateProgress:function(a){this.fireEvent("progress",this,a.loaded,a.total)},onFileReaderError:function(a){this.request.abort();this.request=undefined;this.fireEvent("error",this);this.fileReader=undefined},onFileReaderLoad:function(b){var a="--"+this.boundary+"\r\n";a+="Content-Disposition: form-data; name='file'; filename='"+this.file.fileApi.name+"'\r\n";a+="Content-Type: "+this.file.fileApi.type+"\r\n\r\n";a+=b.target.result+"\r\n";a+="--"+this.boundary+"--";this.request.sendAsBinary(a);this.fileReader=undefined},onIFrameLoad:function(a){this.responseText=a.target.contentWindow.document.body.innerText;document.body.removeChild(this.file.iframe);this.fireEvent("complete",this)}});Core.Object.extend("Anim.TimeManager",{clocks:undefined,timer:undefined,start:0,constructor:function(a){this.clocks=[];this.start=new Date().getTime();this.addEvents("tick")},add:function(a){this.clocks.push(a);if(this.clocks.length==1){this.timer=new Core.Timer({onTimeupdate:this.onTick,scope:this,interval:1/60})}},remove:function(b){var a=0;while((a<this.clocks.length)&&(this.clocks[a]!=b)){a++}if(a<this.clocks.length){this.clocks.splice(a,1)}if(this.clocks.length==0){this.timer.abort();this.timer=undefined}},onTick:function(){var b=(new Date().getTime())-this.start;b/=1000;for(var a=0;a<this.clocks.length;a++){this.clocks[a].update(b)}this.fireEvent("tick")}});Anim.TimeManager.current=new Anim.TimeManager();Core.Object.extend("Anim.AnimationManager",{clocks:undefined,start:0,constructor:function(a){this.addEvents("tick");this.onTick.scope=this;this.clocks=[];this.start=new Date().getTime()},add:function(a){this.clocks.push(a);if(this.clocks.length==1){if("webkitRequestAnimationFrame" in window){webkitRequestAnimationFrame(this.onTick)}else{if("mozRequestAnimationFrame" in window){mozRequestAnimationFrame(this.onTick)}else{if("msRequestAnimationFrame" in window){msRequestAnimationFrame(this.onTick)}else{setTimeout(this.onTick,1/60)}}}}},remove:function(b){var a=0;while((a<this.clocks.length)&&(this.clocks[a]!=b)){a++}if(a<this.clocks.length){this.clocks.splice(a,1)}},forceTick:function(){if(this.clocks.length>0){this.onTick()}},onTick:function(){var f=arguments.callee.scope;var d=(new Date().getTime())/1000;var g=(new Date().getTime())-f.start;g/=1000;for(var c=0;c<f.clocks.length;c++){f.clocks[c].update(g)}f.fireEvent("tick");if(f.clocks.length>0){if("webkitRequestAnimationFrame" in window){webkitRequestAnimationFrame(f.onTick)}else{if("mozRequestAnimationFrame" in window){mozRequestAnimationFrame(f.onTick)}else{if("msRequestAnimationFrame" in window){msRequestAnimationFrame(f.onTick)}else{var b=(new Date().getTime())/1000;var a=b-d;if(a<0){a=0}setTimeout(f.onTick,Math.max(1/60-a,0))}}}}}});Anim.AnimationManager.current=new Anim.AnimationManager();Core.Object.extend("Anim.EasingFunction",{mode:"in",constructor:function(a){},setMode:function(a){this.mode=a},getMode:function(){return this.mode},ease:function(a){if(this.mode=="in"){return this.easeInCore(a)}else{if(this.mode=="out"){return 1-this.easeInCore(1-a)}else{if(a<=0.5){return this.easeInCore(a*2)/2}else{return 0.5+((1-this.easeInCore(2-(a*2)))/2)}}}},easeInCore:function(a){return a}},{},{eases:{},register:function(a,b){this.eases[a]=b},parse:function(a){return new this.eases[a]()}});Anim.EasingFunction.extend("Anim.LinearEase",{constructor:function(a){}},{easeInCore:function(a){return a}},{constructor:function(){Anim.EasingFunction.register("linear",this)}});Anim.EasingFunction.extend("Anim.PowerEase",{power:2,constructor:function(a){this.autoConfig(a,"power")},setPower:function(a){this.power=a},getPower:function(){return this.power}},{easeInCore:function(a){return Math.pow(a,this.power)}},{constructor:function(){Anim.EasingFunction.register("power",this)}});Anim.EasingFunction.extend("Anim.ElasticEase",{oscillations:3,springiness:3,constructor:function(a){this.autoConfig(a,"oscillations","springiness")},setOscillations:function(a){this.oscillations=a},getOscillations:function(){return this.oscillations},setSpringiness:function(a){this.springiness=a},getSpringiness:function(){return this.springiness}},{easeInCore:function(a){return Math.sin(a*(this.oscillations*2+0.5)*Math.PI)*Math.pow(a,this.springiness)}},{constructor:function(){Anim.EasingFunction.register("elastic",this)}});Anim.EasingFunction.extend("Anim.BounceEase",{bounces:3,bounciness:2,constructor:function(a){this.autoConfig(a,"oscillations")},setBounces:function(a){this.bounces=a},getBounces:function(){return this.Bounces},setBounciness:function(a){this.bounciness=a},getBounciness:function(){return this.bounciness}},{easeInCore:function(a){var c=Math.exp((1/this.bounciness)*Math.log(a));var b=Math.floor(c*(this.bounces+0.5));var d=(c*(this.bounces+0.5))-b;return Math.sin(d*Math.PI)/Math.exp(this.bounces-b)}},{constructor:function(){Anim.EasingFunction.register("bounce",this)}});Core.Object.extend("Anim.Clock",{animation:true,parent:undefined,time:undefined,iteration:undefined,progress:undefined,isActive:false,globalTime:0,startTime:0,lastTick:0,beginTime:0,isPaused:false,speed:1,duration:"forever",pendingState:"none",autoReverse:false,repeat:1,target:undefined,ease:undefined,constructor:function(a){this.addEvents("complete","timeupdate")},setAnimation:function(a){this.animation=a},setRepeat:function(a){this.repeat=a},setSpeed:function(a){this.speed=a},setAutoReverse:function(a){this.autoReverse=a},setBeginTime:function(a){this.beginTime=a},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},setTarget:function(a){this.target=a},setDuration:function(a){if(a=="automatic"){this.duration="forever"}else{this.duration=a}},setParent:function(a){this.parent=a},getParent:function(){return this.parent},getGlobalTime:function(){return this.globalTime+(this.lastTick-this.startTime)*this.speed},getIsActive:function(){return this.isActive},getTime:function(){return this.time},getIteration:function(){return this.iteration},getProgress:function(){return this.progress},begin:function(){if(this.parent==undefined){if(this.animation){Anim.AnimationManager.current.add(this)}else{Anim.TimeManager.current.add(this)}}else{if(this.scope==undefined){this.scope=this.parent.scope}}this.pendingState="active";if((this.target!=undefined)&&(this.target.setAnimClock!=undefined)){this.target.setAnimClock(this)}},pause:function(){this.pendingState="paused"},resume:function(){this.pendingState="resumed"},stop:function(){this.pendingState="stopped"},onComplete:function(){if(this.parent==undefined){if(this.animation){Anim.AnimationManager.current.remove(this)}else{Anim.TimeManager.current.remove(this)}}this.fireEvent("complete")},onTimeUpdate:function(b){var a=this.getProgress();if(this.ease!=undefined){a=this.ease.ease(a)}this.fireEvent("timeupdate",this,a,b)},update:function(b){var d;do{d=this.pendingState;this.pendingState="none";if(d=="none"){if(this.isActive&&!this.isPaused){var h=b-this.lastTick;this.lastTick=b;var a=this.getGlobalTime();a-=this.beginTime;if(a>=0){if((this.duration!="forever")&&(this.duration!="automatic")){var c=a/this.duration;var g=Math.floor(c+1);var f=a%this.duration;if(this.autoReverse){if((g&1)==0){f=this.duration-f}c/=2;g=Math.floor(c+1)}if(this.repeat=="forever"){this.iteration=g;this.time=f;this.progress=f/this.duration;this.onTimeUpdate(h)}else{if(c>=this.repeat){this.pendingState="stopped";this.iteration=this.repeat;this.time=this.duration;if(this.autoReverse){this.progress=0}else{this.progress=1}this.onTimeUpdate(0)}else{this.iteration=g;this.time=f;this.progress=f/this.duration;this.onTimeUpdate(h)}}}else{this.time=a;this.progress=0;this.iteration=undefined;this.onTimeUpdate(h)}}}}else{if(d=="active"){if(!this.isActive){this.isActive=true;this.globalTime=0;this.startTime=b;this.lastTick=this.startTime;if(this.beginTime>0){this.time=undefined;this.progress=undefined;this.iteration=undefined}else{this.time=0;this.progress=0;this.iteration=1;this.onTimeUpdate(0)}}}else{if(d=="paused"){if(!this.isPaused&&this.isActive){this.isPaused=true;this.globalTime=this.getGlobalTime();this.startTime=0;this.lastTick=0}}else{if(d=="resumed"){if(this.isPaused&&this.isActive){this.isPaused=false;this.startTime=b;this.lastTick=b}}else{if(d=="stopped"){if(this.isActive){this.progress=undefined;this.time=undefined;this.iteration=undefined;this.isActive=false}}}}}}}while(this.pendingState!="none");if((this.parent==undefined)&&!this.isActive){this.onComplete()}}});Anim.Clock.extend("Anim.ClockGroup",{children:undefined,constructor:function(a){this.children=[]},appendChild:function(a){a.setParent(this);this.children.push(a)},setContent:function(b){this.children=[];if((b!=undefined)&&(typeof(b)=="object")){if(b.constructor==Array){for(var a=0;a<b.length;a++){this.appendChild(Anim.Clock.create(b[a]))}}else{this.appendChild(Anim.Clock.create(b))}}}},{begin:function(){Anim.ClockGroup.base.begin.call(this);for(var a=0;a<this.children.length;a++){this.children[a].begin()}},pause:function(){Anim.ClockGroup.base.pause.call(this);for(var a=0;a<this.children.length;a++){this.children[a].pause()}},resume:function(){Anim.ClockGroup.base.resume.call(this);for(var a=0;a<this.children.length;a++){this.children[a].resume()}},stop:function(){Anim.ClockGroup.base.stop.call(this);for(var a=0;a<this.children.length;a++){this.children[a].stop()}},onCompleted:function(){Anim.ClockGroup.base.onCompleted.call(this);for(var a=0;a<this.children.length;a++){this.children[a].onCompleted()}},update:function(b){do{Anim.ClockGroup.base.update.call(this,b);var d=true;for(var c=0;c<this.children.length;c++){var a=this.children[c];a.update(this.getGlobalTime());if(a.getIsActive()){d=false}}if(this.getIsActive()&&d){this.pendingState="stopped"}}while(this.pendingState!="none")}});Core.Object.extend("Ui.Matrix",{a:1,b:0,c:0,d:1,e:0,f:0,constructor:function(a){},isTranslateOnly:function(){return((this.a==1)&&(this.b==0)&&(this.c==0)&&(this.d==1))},translate:function(a,b){this.multiply(Ui.Matrix.createTranslate(a,b))},rotate:function(a){this.multiply(Ui.Matrix.createRotate(a))},scale:function(b,a){if(a===undefined){a=b}this.multiply(Ui.Matrix.createScale(b,a))},multiply:function(j){var h=j.a*this.a+j.b*this.c;var n=j.c*this.a+j.d*this.c;var l=j.e*this.a+j.f*this.c+this.e;var g=j.a*this.b+j.b*this.d;var m=j.c*this.b+j.d*this.d;var k=j.e*this.b+j.f*this.d+this.f;this.a=h;this.b=g;this.c=n;this.d=m;this.e=l;this.f=k},getDeterminant:function(){return((this.a*this.d)-(this.b*this.c))},inverse:function(){var c=this.getDeterminant();if(c==0){throw ("Matrix not invertible")}var f=1/c;var d=this.d*f;var b=-this.b*f;var a=-this.c*f;var j=this.a*f;var h=((this.c*this.f)-(this.e*this.d))*f;var g=((this.e*this.b)-(this.a*this.f))*f;this.a=d;this.b=b;this.c=a;this.d=j;this.e=h;this.f=g},setMatrix:function(h,g,m,l,k,j){this.a=h;this.b=g;this.c=m;this.d=l;this.e=k;this.f=j},getA:function(){return this.a},getB:function(){return this.b},getC:function(){return this.c},getD:function(){return this.d},getE:function(){return this.e},getF:function(){return this.f},clone:function(){return Ui.Matrix.createMatrix(this.a,this.b,this.c,this.d,this.e,this.f)}},{toString:function(){return"matrix("+this.a.toFixed(4)+", "+this.b.toFixed(4)+", "+this.c.toFixed(4)+", "+this.d.toFixed(4)+", "+this.e.toFixed(4)+", "+this.f.toFixed(4)+")"}},{createMatrix:function(h,g,n,m,l,k){var j=new Ui.Matrix();j.setMatrix(h,g,n,m,l,k);return j},createTranslate:function(a,b){return Ui.Matrix.createMatrix(1,0,0,1,a,b)},createScaleAt:function(b,a,d,c){return Ui.Matrix.createMatrix(b,0,0,a,d-(b*d),c-(a*c))},createScale:function(b,a){return Ui.Matrix.createScaleAt(b,a,0,0)},createRotateAt:function(g,f,d){g=(g%360)*Math.PI/180;var b=Math.sin(g);var c=Math.cos(g);var a=(f*(1-c))+(d*b);var h=(d*(1-c))-(f*b);return Ui.Matrix.createMatrix(c,b,-b,c,a,h)},createRotate:function(a){return Ui.Matrix.createRotateAt(a,0,0)}});Core.Object.extend("Ui.Point",{x:0,y:0,constructor:function(a){},matrixTransform:function(b){var a=this.x*b.a+this.y*b.c+b.e;var c=this.x*b.b+this.y*b.d+b.f;this.x=a;this.y=c},setPoint:function(a){this.x=a.x;this.y=a.y},getX:function(){return this.x},setX:function(a){this.x=a},getY:function(){return this.y},setY:function(a){this.y=a},clone:function(){return new Ui.Point({x:this.x,y:this.y})}},{toString:function(){return"point("+this.x.toFixed(4)+", "+this.y.toFixed(4)+")"}});Core.Object.extend("Ui.Color",{r:0,g:0,b:0,a:1,constructor:function(d){if((d.r!=undefined)&&(d.g!=undefined)&&(d.b!=undefined)){this.r=Math.min(Math.max(d.r,0),1);this.g=Math.min(Math.max(d.g,0),1);this.b=Math.min(Math.max(d.b,0),1);delete (d.r);delete (d.g);delete (d.b)}else{if((d.h!=undefined)&&(d.s!=undefined)&&(d.l!=undefined)){var g=(d.h!=undefined)?d.h:0;var f=(d.s!=undefined)?d.s:0;var a=(d.l!=undefined)?d.l:0;this.initFromHsl(g,f,a);delete (d.h);delete (d.s);delete (d.l)}else{if((d.y!=undefined)&&(d.u!=undefined)&&(d.v!=undefined)){var j=Math.max((d.y!=undefined)?d.y:0,0);var c=(d.u!=undefined)?d.u:0;var b=(d.v!=undefined)?d.v:0;this.initFromYuv(j,c,b);delete (d.y);delete (d.u);delete (d.v)}}}if(d.a!=undefined){this.a=Math.min(Math.max(d.a,0),1);delete (d.a)}},getCssRgba:function(){return"rgba("+Math.round(this.r*255)+","+Math.round(this.g*255)+","+Math.round(this.b*255)+","+this.a+")"},getCssRgb:function(){return"rgb("+Math.round(this.r*255)+","+Math.round(this.g*255)+","+Math.round(this.b*255)+")"},getCssHtml:function(){var b="#";var a=Math.round(this.r*255).toString(16);if(a.length==1){a="0"+a}b+=a;a=Math.round(this.g*255).toString(16);if(a.length==1){a="0"+a}b+=a;a=Math.round(this.b*255).toString(16);if(a.length==1){a="0"+a}b+=a;return b},getRgba:function(){return{r:this.r,g:this.g,b:this.b,a:this.a}},getRgb:function(){return this.getRgba()},getHsla:function(){var a=this.r;var j=this.g;var k=this.b;var d=Math.min(a,Math.min(j,k));var m=Math.max(a,Math.max(j,k));var f;var o;var c=m;var n=m-d;if(m!=0){o=n/m}else{return{h:0,s:0,l:c,a:this.a}}if(a==m){f=(j-k)/n}else{if(j==m){f=2+(k-a)/n}else{f=4+(a-j)/n}}f*=60;if(f<0){f+=360}return{h:f,s:o,l:c,a:this.a}},getHsl:function(){return this.getHsla()},getYuva:function(){var c=0.299*this.r+0.587*this.g+0.114*this.b;var b=0.492*(this.b-c);var a=0.877*(this.r-c);return{y:c,u:b,v:a,a:this.a}},getYuv:function(){return this.getYuva()},initFromHsl:function(g,d,a){if(d<=0){this.r=a;this.g=a;this.b=a;return}g/=60;var c=Math.floor(g);var k=g-c;var m=a*(1-d);var j=a*(1-d*k);var b=a*(1-d*(1-k));if(c==0){this.r=a;this.g=b;this.b=m}else{if(c==1){this.r=j;this.g=a;this.b=m}else{if(c==2){this.r=m;this.g=a;this.b=b}else{if(c==3){this.r=m;this.g=j;this.b=a}else{if(c==4){this.r=b;this.g=m;this.b=a}else{this.r=a;this.g=m;this.b=j}}}}}},initFromYuv:function(c,b,a){this.r=Math.max(0,Math.min(c+1.13983*a,1));this.g=Math.max(0,Math.min(c-0.39465*b-0.5806*a,1));this.b=Math.max(0,Math.min(c+2.03211*b,1))}},{toString:function(){return"color("+this.r.toFixed(4)+", "+this.g.toFixed(4)+", "+this.b.toFixed(4)+", "+this.a.toFixed(4)+")"}},{knownColor:{white:"#ffffff",black:"#000000",red:"#ff0000",green:"#008000",blue:"#0000ff",lightblue:"#add8e6",lightgreen:"#90ee90",orange:"#ffa500",purple:"#800080",lightgray:"#d3d3d3",darkgray:"#a9a9a9",pink:"#ffc0cb",brown:"#a52a2a"},parse:function(f){if(typeof(f)=="string"){if(f in Ui.Color.knownColor){f=Ui.Color.knownColor[f]}var h;if((h=f.match(/^rgba\((\d+),(\d+),(\d+),(\d+\.?\d*)\)$/))!=null){var k=parseInt(h[1])/255;var j=parseInt(h[2])/255;var c=parseInt(h[3])/255;var d=parseFloat(h[4]);return new Ui.Color({r:k,g:j,b:c,a:d})}else{if((h=f.match(/^rgb\((\d+),(\d+),(\d+)\)$/))!=null){var k=parseInt(h[1])/255;var j=parseInt(h[2])/255;var c=parseInt(h[3])/255;return new Ui.Color({r:k,g:j,b:c})}else{if(f.indexOf("#")==0){if(f.length==7){var k=parseInt(f.substr(1,2),16)/255;var j=parseInt(f.substr(3,2),16)/255;var c=parseInt(f.substr(5,2),16)/255;return new Ui.Color({r:k,g:j,b:c})}else{if(f.length==4){var k=parseInt(f.substr(1,1),16)/15;var j=parseInt(f.substr(2,1),16)/15;var c=parseInt(f.substr(3,1),16)/15;return new Ui.Color({r:k,g:j,b:c})}}}}}}throw ("Unknown color format ("+f+")")}});Core.Object.extend("Ui.LinearGradient",{orientation:"vertical",stops:undefined,image:undefined,constructor:function(a){if("stops" in a){this.stops=a.stops;delete (a.stops)}else{this.stops=[{offset:0,color:new Ui.Color({r:1,g:1,b:1,a:1})},{offset:1,color:new Ui.Color({r:0,g:0,b:0,a:1})}]}if(a.orientation!=undefined){this.orientation=a.orientation;delete (a.orientation)}for(var b=0;b<this.stops.length;b++){this.stops[b].color=Ui.Color.create(this.stops[b].color)}},getBackgroundImage:function(){if(this.image!=undefined){return this.image}if(navigator.isWebkit){this.image="-webkit-gradient(linear, 0% 0%, ";if(this.orientation=="vertical"){this.image+="0% 100%"}else{this.image+="100% 0%"}for(var d=0;d<this.stops.length;d++){var c=this.stops[d];this.image+=", color-stop("+c.offset+", "+c.color.getCssRgba()+")"}this.image+=")"}else{if(navigator.isGecko){this.image="-moz-linear-gradient(";if(this.orientation=="vertical"){this.image+="-90deg"}else{this.image+="0deg"}for(var d=0;d<this.stops.length;d++){var c=this.stops[d];this.image+=", "+c.color.getCssRgba()+" "+Math.round(c.offset*100)+"%"}this.image+=")"}else{if(navigator.supportCanvas){var a=document.createElement("canvas");var b=a.getContext("2d");if(this.orientation=="vertical"){a.setAttribute("width",1,null);a.setAttribute("height",100,null);var f=b.createLinearGradient(0,0,0,100);for(var d=0;d<this.stops.length;d++){var c=this.stops[d];f.addColorStop(c.offset,c.color.getCssRgba())}b.fillStyle=f;b.fillRect(0,0,1,100)}else{a.setAttribute("width",100,null);a.setAttribute("height",1,null);var f=b.createLinearGradient(0,0,100,0);for(var d=0;d<this.stops.length;d++){var c=this.stops[d];f.addColorStop(c.offset,c.color.getCssRgba())}b.fillStyle=f;b.fillRect(0,0,100,1)}this.image="url("+a.toDataURL()+")"}else{this.image="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAACCAYAAACddGYaAAAAAXNSR0IArs4c6QAAAAZiS0dEAO8AUQBRItXOlAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9gJDxcIBl8Z3A0AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAC0lEQVQI12NgwAUAABoAASRETuUAAAAASUVORK5CYII%3D)"}}}return this.image},getSVGGradient:function(){var d=document.createElementNS(svgNS,"linearGradient");d.setAttributeNS(null,"gradientUnits","objectBoundingBox");d.setAttributeNS(null,"x1",0);d.setAttributeNS(null,"y1",0);if(this.orientation=="vertical"){d.setAttributeNS(null,"x2",0);d.setAttributeNS(null,"y2",1)}else{d.setAttributeNS(null,"x2",1);d.setAttributeNS(null,"y2",0)}for(var c=0;c<this.stops.length;c++){var b=this.stops[c];var a=document.createElementNS(svgNS,"stop");a.setAttributeNS(null,"offset",b.offset);a.style.stopColor=b.color.getCssHtml();a.style.stopOpacity=b.color.getRgba().a;d.appendChild(a)}return d},getCanvasGradient:function(d,f,a){var g;if(this.orientation=="vertical"){g=d.createLinearGradient(0,0,0,a)}else{g=d.createLinearGradient(0,0,f,0)}for(var c=0;c<this.stops.length;c++){var b=this.stops[c];g.addColorStop(b.offset,b.color.getCssRgba())}return g},getVMLFill:function(){var c=document.createElement("vml:fill");c.type="gradient";if(this.orientation=="vertical"){c.angle=180}else{c.angle=270}c.color=this.stops[0].color.getCssHtml();c.opacity=this.stops[0].color.getRgba().a;c.color2=this.stops[this.stops.length-1].color.getCssHtml();c.opacity2=this.stops[this.stops.length-1].color.getRgba().a;c.method="None";if(this.stops.length>2){var a="";for(var b=1;b<this.stops.length-1;b++){if(a!=""){a+=","}a+=Math.round(this.stops[b].offset*100)+"% "+this.stops[b].color.getCssHtml()}c.colors=a}return c}});Core.Object.extend("Ui.Keyboard",{shiftKey:false,altKey:false,ctrlKey:false,altGraphKey:false,metaKey:false,elementCapture:undefined,constructor:function(a){},capture:function(a){if(this.elementCapture!=undefined){throw ("keyboard capture already done on element (type: "+this.elementCapture.type+", id: "+this.elementCapture.id+", newid: "+a.id+")")}this.elementCapture=a},release:function(){if(this.elementCapture!=undefined){this.elementCapture=undefined}else{throw ("keyboard capture release but no element capture the keyboard")}},getShiftKey:function(){return this.shiftKey},getAltKey:function(){return this.altKey},getCtrlKey:function(){return this.ctrlKey},getAltGraphKey:function(){return this.altGraphKey},getMetaKey:function(){return this.metaKey}});Ui.Keyboard.current=new Ui.Keyboard();Core.Object.extend("Ui.Element",{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0,parent:undefined,width:undefined,height:undefined,drawing:undefined,measureValid:false,measureConstraintWidth:0,measureConstraintHeight:0,measureWidth:0,measureHeight:0,arrangeValid:false,arrangeX:0,arrangeY:0,arrangeWidth:0,arrangeHeight:0,layoutValid:true,layoutNext:undefined,layoutX:0,layoutY:0,layoutWidth:0,layoutHeight:0,isLoaded:false,verticalAlign:"stretch",horizontalAlign:"stretch",clipToBounds:false,clipX:undefined,clipY:undefined,clipWidth:undefined,clipHeight:undefined,visible:undefined,parentVisible:undefined,focusable:false,hasFocus:false,keyboardRequired:false,selectable:false,transform:undefined,transformOriginX:0.5,transformOriginY:0.5,transformOriginAbsolute:false,animClock:undefined,opacity:1,parentOpacity:1,disabled:undefined,parentDisabled:undefined,style:undefined,parentStyle:undefined,mergeStyle:undefined,constructor:function(a){this.drawing=this.renderDrawing();this.drawing.style.position="absolute";this.drawing.style.left="-10000px";this.drawing.style.top="-10000px";this.drawing.style.outline="0px";var b=this.render();if(b!=undefined){this.drawing.appendChild(b)}this.connect(this.drawing,"focus",this.onFocus);this.connect(this.drawing,"blur",this.onBlur);this.addEvents("keypress","keydown","keyup","focus","blur","load","unload","enable","disable","visible","hidden")},getDrawing:function(){return this.drawing},getSelectable:function(){return this.selectable},setSelectable:function(a){this.selectable=a;this.getDrawing().selectable=a;if(a){this.getDrawing().style.cursor="text";if(navigator.isWebkit){this.getDrawing().style.removeProperty("-webkit-user-select")}else{if(navigator.isGecko){this.getDrawing().style.removeProperty("-moz-user-select")}else{if(navigator.isIE){this.disconnect(this.getDrawing(),"selectstart",this.onSelectStart)}else{if(navigator.isOpera){this.getDrawing().onmousedown=undefined}}}}}else{this.getDrawing().style.cursor="inherit";if(navigator.isWebkit){this.getDrawing().style.webkitUserSelect="none"}else{if(navigator.isGecko){this.getDrawing().style.MozUserSelect="none"}else{if(navigator.isIE){this.connect(this.getDrawing(),"selectstart",this.onSelectStart)}else{if(navigator.isOpera){this.getDrawing().onmousedown=function(b){b.preventDefault()}}}}}}},getLayoutX:function(){return this.layoutX},getLayoutY:function(){return this.layoutY},getLayoutWidth:function(){return this.layoutWidth},getLayoutHeight:function(){return this.layoutHeight},setId:function(a){this.drawing.setAttribute("id",a)},getId:function(){return this.drawing.getAttribute("id")},setFocusable:function(a){this.focusable=a;if(a&&!this.getIsDisabled()){this.drawing.setAttribute("tabindex",0)}else{this.drawing.setAttribute("tabindex",-1)}},getFocusable:function(){return this.focusable},setKeyboardRequired:function(a){this.keyboardRequired=a},getKeyboardRequired:function(){return this.keyboardRequired},setRole:function(a){if("setAttributeNS" in this.drawing){if(a===undefined){if(this.drawing.hasAttributeNS("http://www.w3.org/2005/07/aaa","role")){this.drawing.removeAttributeNS("http://www.w3.org/2005/07/aaa","role")}}else{this.drawing.setAttributeNS("http://www.w3.org/2005/07/aaa","role",a)}}},measure:function(c,j){if((this.measureValid)&&(this.measureConstraintWidth==c)&&(this.measureConstraintHeight==j)){return{width:this.measureWidth,height:this.measureHeight}}this.measureConstraintWidth=c;this.measureConstraintHeight=j;var d=this.getMarginLeft();var g=this.getMarginRight();var b=this.getMarginTop();var f=this.getMarginBottom();var h=Math.max(c-(d+g),0);var a=Math.max(j-(b+f),0);if(this.horizontalAlign!="stretch"){h=0}if(this.verticalAlign!="stretch"){a=0}if(this.width!=undefined){h=Math.max(this.width,h)}if(this.height!=undefined){a=Math.max(this.height,a)}var k=this.measureCore(h,a);if((this.width!=undefined)&&(k.width<this.width)){this.measureWidth=this.width+d+g}else{this.measureWidth=k.width+d+g}if((this.height!=undefined)&&(k.height<this.height)){this.measureHeight=this.height+b+f}else{this.measureHeight=k.height+b+f}this.measureValid=true;return{width:this.measureWidth,height:this.measureHeight}},measureCore:function(b,a){return{width:0,height:0}},invalidateMeasure:function(){if(this.measureValid){this.measureValid=false;if((this.parent!=undefined)&&(this.parent.measureValid)){this.parent.onChildInvalidateMeasure(this)}}this.invalidateArrange()},onChildInvalidateMeasure:function(a){this.invalidateMeasure()},arrange:function(b,j,c,a){if(isNaN(b)){b=0}if(isNaN(j)){j=0}if(isNaN(c)){c=0}if(isNaN(a)){a=0}if((!this.arrangeValid)||(this.arrangeX!=b)||(this.arrangeY!=j)||(this.arrangeWidth!=c)||(this.arrangeHeight!=a)){this.arrangeX=b;this.arrangeY=j;this.arrangeWidth=c;this.arrangeHeight=a;if(this.verticalAlign=="top"){a=this.measureHeight}else{if(this.verticalAlign=="bottom"){j+=a-this.measureHeight;a=this.measureHeight}else{if(this.verticalAlign=="center"){j+=(a-this.measureHeight)/2;a=this.measureHeight}}}if(this.horizontalAlign=="left"){c=this.measureWidth}else{if(this.horizontalAlign=="right"){b+=c-this.measureWidth;c=this.measureWidth}else{if(this.horizontalAlign=="center"){b+=(c-this.measureWidth)/2;c=this.measureWidth}}}var g=this.getMarginLeft();var f=this.getMarginRight();var d=this.getMarginTop();var h=this.getMarginBottom();b+=g;j+=d;c-=g+f;a-=d+h;this.layoutX=b;this.layoutY=j;this.layoutWidth=Math.max(c,0);this.layoutHeight=Math.max(a,0);this.drawing.style.left=Math.round(this.layoutX)+"px";this.drawing.style.top=Math.round(this.layoutY)+"px";if(this.transform!=undefined){this.updateTransform()}this.drawing.style.width=Math.round(this.layoutWidth)+"px";this.drawing.style.height=Math.round(this.layoutHeight)+"px";if(this.clipToBounds){this.clipX=0;this.clipY=0;this.clipWidth=this.layoutWidth;this.clipHeight=this.layoutHeight;this.updateClipRectangle()}this.arrangeCore(this.layoutWidth,this.layoutHeight)}this.arrangeValid=true},arrangeCore:function(b,a){},invalidateArrange:function(){if(this.arrangeValid){this.arrangeValid=false;if(this.parent!=undefined){this.parent.onChildInvalidateArrange(this)}}},onChildInvalidateArrange:function(a){this.invalidateArrange()},renderDrawing:function(){return document.createElement("div")},render:function(){return undefined},getWidth:function(){return this.width},setWidth:function(a){if(this.width!=a){this.width=a;this.invalidateMeasure()}},getHeight:function(){return this.height},setHeight:function(a){if(this.height!=a){this.height=a;this.invalidateMeasure()}},getVerticalAlign:function(){return this.verticalAlign},setVerticalAlign:function(a){this.verticalAlign=a;this.invalidateArrange()},getHorizontalAlign:function(){return this.horizontalAlign},setHorizontalAlign:function(a){this.horizontalAlign=a;this.invalidateArrange()},getClipToBounds:function(){return this.clipToBounds},setClipToBounds:function(a){if(this.clipToBounds!=a){this.clipToBounds=a;if(a){this.clipX=0;this.clipY=0;this.clipWidth=this.layoutWidth;this.clipHeight=this.layoutHeight}else{this.clipX=undefined;this.clipY=undefined;this.clipWidth=undefined;this.clipHeight=undefined}this.updateClipRectangle()}},setClipRectangle:function(b,d,c,a){this.clipX=b;this.clipY=d;this.clipWidth=c;this.clipHeight=a;this.updateClipRectangle()},updateClipRectangle:function(){if(this.clipX!=undefined){var b=Math.round(this.clipX);var d=Math.round(this.clipY);var c=Math.round(this.clipWidth);var a=Math.round(this.clipHeight);this.drawing.style.clip="rect("+d+"px "+(b+c)+"px "+(d+a)+"px "+b+"px)"}else{if("removeProperty" in this.drawing.style){this.drawing.style.removeProperty("clip")}else{if("removeAttribute" in this.drawing.style){this.drawing.style.removeAttribute("clip")}}}},setMargin:function(a){this.setMarginTop(a);this.setMarginBottom(a);this.setMarginLeft(a);this.setMarginRight(a)},getMarginTop:function(){return this.marginTop},setMarginTop:function(a){if(a!=this.marginTop){this.marginTop=a;this.invalidateMeasure()}},getMarginBottom:function(){return this.marginBottom},setMarginBottom:function(a){if(a!=this.marginBottom){this.marginBottom=a;this.invalidateMeasure()}},getMarginLeft:function(){return this.marginLeft},setMarginLeft:function(a){if(a!=this.marginLeft){this.marginLeft=a;this.invalidateMeasure()}},getMarginRight:function(){return this.marginRight},setMarginRight:function(a){if(a!=this.marginRight){this.marginRight=a;this.invalidateMeasure()}},getOpacity:function(){return this.opacity},setOpacity:function(a){if(this.opacity!=a){this.opacity=a;if(navigator.supportOpacity){this.drawing.style.opacity=this.opacity}else{this.onInternalSetOpacity(this.parentOpacity*this.opacity)}}},onInternalSetOpacity:function(a){this.onCumulOpacityChange(a)},onCumulOpacityChange:function(a){},setParentCumulOpacity:function(a){this.parentOpacity=a;this.onInternalSetOpacity(this.parentOpacity*this.opacity)},focus:function(){if(this.focusable){try{this.drawing.focus()}catch(a){}}},blur:function(){try{this.drawing.blur()}catch(a){}},setTransform:function(a){if(this.transform!=a){this.transform=a;this.updateTransform()}},setTransformOrigin:function(a,c,b){if((this.transformOriginX!=a)||(this.transformOriginY!=c)||(this.transformOriginAbsolute!=b)){this.transformOriginX=a;this.transformOriginY=c;if(b===undefined){this.transformOriginAbsolute=false}else{this.transformOriginAbsolute=b}this.updateTransform()}},transformToWindow:function(){return Ui.Element.transformToWindow(this.drawing)},transformFromWindow:function(){return Ui.Element.transformFromWindow(this.drawing)},transformToElement:function(b){var a=this.transformToWindow();a.multiply(b.transformFromWindow());return a},pointToWindow:function(a){return Ui.Element.pointToWindow(this.drawing,a)},pointFromWindow:function(a){return Ui.Element.pointFromWindow(this.drawing,a)},pointFromElement:function(b,a){return this.pointFromWindow(b.pointToWindow(a))},getIsLoaded:function(){return this.isLoaded},getMeasureWidth:function(){return this.measureWidth},getMeasureHeight:function(){return this.measureHeight},hide:function(){if((this.visible===undefined)||this.visible){var a=this.getIsVisible();this.visible=false;this.drawing.style.display="none";if(a){this.onInternalHidden()}}},show:function(){if((this.visible===undefined)||!this.visible){var a=this.getIsVisible();this.visible=true;this.drawing.style.display="block";if(this.getIsVisible()&&!a){this.onInternalVisible()}}},getIsVisible:function(){return((this.parentVisible===true)&&(this.visible!==false))},setParentVisible:function(b){var a=this.getIsVisible();this.parentVisible=b;if(a!=this.getIsVisible()){if(this.getIsVisible()){this.onInternalVisible()}else{this.onInternalHidden()}}},onInternalHidden:function(){this.onHidden();this.fireEvent("hidden",this)},onHidden:function(){},onInternalVisible:function(){this.onVisible();this.fireEvent("visible",this)},checkVisible:function(){if(this.getDrawing()===undefined){return}var b=false;var a=this.getDrawing();while(a!=undefined){if(a.style.display=="none"){b=false;break}if(a==document.body){b=true;break}a=a.parentNode}if(this.getIsVisible()!==b){console.log("checkVisible expect: "+this.getIsVisible()+", got: "+b+" (on "+this+")")}},onVisible:function(){},disable:function(){if((this.disabled===undefined)||!this.disabled){var a=this.getIsDisabled();this.disabled=true;if(!a){this.onInternalDisable()}}},enable:function(){if((this.disabled===undefined)||this.disabled){var a=this.getIsDisabled();this.disabled=false;if(a){this.onInternalEnable()}}},setEnable:function(a){if(a){this.enable()}else{this.disable()}},getIsDisabled:function(){if(this.disabled!=undefined){return this.disabled}else{if(this.parentDisabled!=undefined){return this.parentDisabled}else{return false}}},setParentDisabled:function(b){var a=this.getIsDisabled();this.parentDisabled=b;if(a!=this.getIsDisabled()){if(this.getIsDisabled()){this.onInternalDisable()}else{this.onInternalEnable()}}},onInternalDisable:function(){if(this.focusable){this.drawing.setAttribute("tabindex",-1);if(this.hasFocus){this.blur()}}this.onDisable();this.fireEvent("disable",this)},onDisable:function(){},onInternalEnable:function(){if(this.focusable){this.drawing.setAttribute("tabindex",0)}this.onEnable();this.fireEvent("enable",this)},onEnable:function(){},containSubStyle:function(a){for(var b in a){if((b.indexOf(".")!=-1)&&(typeof(a[b])=="object")){return true}}return false},fusionStyle:function(f,c){for(var d in c){if((d.indexOf(".")==-1)||(typeof(c[d])!="object")){continue}if(f[d]!=undefined){var a=f[d];f[d]={};for(var b in a){f[d][b]=a[b]}for(var b in c[d]){f[d][b]=c[d][b]}}else{f[d]=c[d]}}},mergeStyles:function(){this.mergeStyle=undefined;if(this.parentStyle!=undefined){if(this.mergeStyle!=undefined){var a=this.mergeStyle;this.mergeStyle={};this.fusionStyle(this.mergeStyle,a);this.fusionStyle(this.mergeStyle,this.parentStyle);var c=this;while(c!=undefined){if((this.parentStyle[c.classType]!=undefined)&&(this.containSubStyle(this.parentStyle[c.classType]))){this.fusionStyle(this.mergeStyle,this.parentStyle[c.classType]);break}c=c.__baseclass__}}else{var c=this;var b=false;while(c!=undefined){if((this.parentStyle[c.classType]!=undefined)&&(this.containSubStyle(this.parentStyle[c.classType]))){this.mergeStyle={};this.fusionStyle(this.mergeStyle,this.parentStyle[c.classType]);b=true;break}c=c.__baseclass__}if(!b){this.mergeStyle=this.parentStyle}}}if(this.style!=undefined){if(this.mergeStyle!=undefined){var a=this.mergeStyle;this.mergeStyle={};this.fusionStyle(this.mergeStyle,a);this.fusionStyle(this.mergeStyle,this.style);var c=this;while(c!=undefined){if((this.style[c.classType]!=undefined)&&(this.containSubStyle(this.style[c.classType]))){this.fusionStyle(this.mergeStyle,this.style[c.classType]);break}c=c.__baseclass__}}else{var c=this;var b=false;while(c!=undefined){if((this.style[c.classType]!=undefined)&&(this.containSubStyle(this.style[c.classType]))){this.mergeStyle={};this.fusionStyle(this.mergeStyle,this.style[c.classType]);b=true;break}c=c.__baseclass__}if(!b){this.mergeStyle=this.style}}}},getParent:function(){return this.parent},setParentStyle:function(a){if(this.parentStyle!=a){this.parentStyle=a}this.mergeStyles();this.onInternalStyleChange()},setStyle:function(a){this.style=a;this.mergeStyles();this.onInternalStyleChange()},getStyleProperty:function(a){if(this.mergeStyle!=undefined){var b=this;while(b!=undefined){if((this.mergeStyle[b.classType]!=undefined)&&(this.mergeStyle[b.classType][a]!=undefined)){return this.mergeStyle[b.classType][a]}b=b.__baseclass__}}var b=this;while(b!=undefined){if((b.constructor.style!=undefined)&&(a in b.constructor.style)){return b.constructor.style[a]}b=b.__baseclass__}return undefined},onInternalStyleChange:function(){this.onStyleChange()},onStyleChange:function(){},getHasFocus:function(){return this.hasFocus},onSelectStart:function(a){a.preventDefault()},onFocus:function(a){if(this.focusable&&!this.getIsDisabled()){a.preventDefault();a.stopPropagation();this.hasFocus=true;this.fireEvent("focus",this)}},onBlur:function(a){if(this.focusable){a.preventDefault();a.stopPropagation();this.hasFocus=false;this.fireEvent("blur",this)}},setIsLoaded:function(a){if(this.isLoaded!=a){this.isLoaded=a;if(a){this.onLoad()}else{this.onUnload()}}},updateTransform:function(){if(this.transform!=undefined){var b=new Ui.Matrix();var a=this.transformOriginX;var c=this.transformOriginY;if(!this.transformOriginAbsolute){a*=this.layoutWidth;c*=this.layoutHeight}b.translate(a,c);b.multiply(this.transform);b.translate(-a,-c);if(b.isTranslateOnly()){this.drawing.style.left=Math.round(this.layoutX+(isNaN(b.getE())?0:b.getE()))+"px";this.drawing.style.top=Math.round(this.layoutY+(isNaN(b.getF())?0:b.getF()))+"px";if(navigator.isIE&&("removeProperty" in this.drawing.style)){this.drawing.style.removeProperty("-ms-transform");this.drawing.style.removeProperty("-ms-transform-origin")}else{if(navigator.isGecko){this.drawing.style.removeProperty("-moz-transform");this.drawing.style.removeProperty("-moz-transform-origin")}else{if(navigator.isWebkit){this.drawing.style.removeProperty("-webkit-transform");this.drawing.style.removeProperty("-webkit-transform-origin")}else{if(navigator.isOpera){this.drawing.style.removeProperty("-o-transform");this.drawing.style.removeProperty("-o-transform-origin")}}}}}else{this.drawing.style.left=Math.round(this.layoutX)+"px";this.drawing.style.top=Math.round(this.layoutY)+"px";if(navigator.isIE){this.drawing.style.msTransform=b.toString();this.drawing.style.msTransformOrigin="0% 0%"}else{if(navigator.isGecko){this.drawing.style.MozTransform="matrix("+b.getA().toFixed(4)+", "+b.getB().toFixed(4)+", "+b.getC().toFixed(4)+", "+b.getD().toFixed(4)+", "+b.getE().toFixed(0)+"px, "+b.getF().toFixed(0)+"px)";this.drawing.style.MozTransformOrigin="0% 0%"}else{if(navigator.isWebkit){this.drawing.style.webkitTransform=b.toString();this.drawing.style.webkitTransformOrigin="0% 0%"}else{if(navigator.isOpera){this.drawing.style.OTransform=b.toString();this.drawing.style.OTransformOrigin="0% 0%"}}}}}}else{this.drawing.style.left=Math.round(this.layoutX)+"px";this.drawing.style.top=Math.round(this.layoutY)+"px";if(navigator.isIE&&("removeProperty" in this.drawing.style)){this.drawing.style.removeProperty("-ms-transform");this.drawing.style.removeProperty("-ms-transform-origin")}else{if(navigator.isGecko){this.drawing.style.removeProperty("-moz-transform");this.drawing.style.removeProperty("-moz-transform-origin")}else{if(navigator.isWebkit){this.drawing.style.removeProperty("-webkit-transform");this.drawing.style.removeProperty("-webkit-transform-origin")}else{if(navigator.isOpera){this.drawing.style.removeProperty("-o-transform");this.drawing.style.removeProperty("-o-transform-origin")}}}}}},setAnimClock:function(a){if(this.animClock!=undefined){this.animClock.stop()}this.animClock=a;if(a!=undefined){this.connect(a,"complete",function(){this.animClock=undefined})}},onLoad:function(){if(this.parent!=undefined){this.setParentStyle(this.parent.mergeStyle);this.setParentDisabled(this.getIsDisabled());this.setParentVisible(this.getIsVisible());if(!navigator.supportOpacity){this.setParentCumulOpacity(this.parentOpacity*this.opacity)}}this.fireEvent("load")},onUnload:function(){if(this.animClock!=undefined){this.animClock.stop();this.animClock=undefined}this.fireEvent("unload")}},{},{transformToWindow:function(h,k){if(k===undefined){k=window}if(navigator.isWebkit){var s=new Ui.Matrix();var r=h;while(r!=undefined){var j=k.getComputedStyle(r,null).getPropertyValue("-webkit-transform");if(j!="none"){var C=k.getComputedStyle(r,null).getPropertyValue("-webkit-transform-origin");var q=0;var p=0;if(C!="0px 0px"){var g=C.split(" ");q=new Number(g[0].replace(/px$/,""));p=new Number(g[1].replace(/px$/,""))}var t=new WebKitCSSMatrix(j);var m=Ui.Matrix.createMatrix(t.a,t.b,t.c,t.d,t.e,t.f);s.translate(r.offsetLeft-q,r.offsetTop-p);s.multiply(m);s.translate(q,p)}s.translate(r.offsetLeft,r.offsetTop);s.translate(-r.scrollLeft,-r.scrollTop);r=r.offsetParent}return s}else{if(navigator.isGecko){var s=new Ui.Matrix();var r=h;while(r!=undefined){var j=k.getComputedStyle(r,null).getPropertyValue("-moz-transform");if(j!="none"){var n=j.split(" ");var B=new Number(n[0].slice(7,n[0].length-1));var A=new Number(n[1].slice(0,n[1].length-1));var z=new Number(n[2].slice(0,n[2].length-1));var w=new Number(n[3].slice(0,n[3].length-1));var v=new Number(n[4].slice(0,n[4].length-3));var u=new Number(n[5].slice(0,n[5].length-3));var C=k.getComputedStyle(r,null).getPropertyValue("-moz-transform-origin");var q=0;var p=0;if(C!="0px 0px"){var g=C.split(" ");q=new Number(g[0].replace(/px$/,""));p=new Number(g[1].replace(/px$/,""))}var m=Ui.Matrix.createMatrix(B,A,z,w,v,u);s.translate(r.offsetLeft-q,r.offsetTop-p);s.multiply(m);s.translate(q,p)}s.translate(r.offsetLeft,r.offsetTop);s.translate(-r.scrollLeft,-r.scrollTop);r=r.offsetParent}return s}else{if(navigator.isOpera){var s=new Ui.Matrix();var r=h;while(r!=undefined){var j=k.getComputedStyle(r,null).getPropertyValue("-o-transform");if((j!="none")&&(j!="matrix(1, 0, 0, 1, 0, 0)")){var n=j.split(" ");var B=new Number(n[0].slice(7,n[0].length-1));var A=new Number(n[1].slice(0,n[1].length-1));var z=new Number(n[2].slice(0,n[2].length-1));var w=new Number(n[3].slice(0,n[3].length-1));var v=new Number(n[4].slice(0,n[4].length-1));var u=new Number(n[5].slice(0,n[5].length-1));var C=k.getComputedStyle(r,null).getPropertyValue("-o-transform-origin");var q=0;var p=0;if(C!="0px 0px"){var g=C.split(" ");q=new Number(g[0].replace(/px$/,""));p=new Number(g[1].replace(/px$/,""))}var m=Ui.Matrix.createMatrix(B,A,z,w,v,u);s.translate(r.offsetLeft-q,r.offsetTop-p);s.multiply(m);s.translate(q,p)}s.translate(r.offsetLeft,r.offsetTop);s.translate(-r.scrollLeft,-r.scrollTop);r=r.offsetParent}return s}else{if(navigator.isIE){var s=new Ui.Matrix();var r=h;while(r!=undefined){var j;try{j=k.getComputedStyle(r,null).getPropertyValue("-ms-transform")}catch(v){j="none"}if((j!="none")&&(j!="matrix(1, 0, 0, 1, 0, 0)")){var n=j.split(" ");var B=new Number(n[0].slice(7,n[0].length-1));var A=new Number(n[1].slice(0,n[1].length-1));var z=new Number(n[2].slice(0,n[2].length-1));var w=new Number(n[3].slice(0,n[3].length-1));var v=new Number(n[4].slice(0,n[4].length-1));var u=new Number(n[5].slice(0,n[5].length-1));var C=k.getComputedStyle(r,null).getPropertyValue("-ms-transform-origin");var q=0;var p=0;if(C!="0px 0px"){var g=C.split(" ");q=new Number(g[0].replace(/px$/,""));p=new Number(g[1].replace(/px$/,""))}var m=Ui.Matrix.createMatrix(B,A,z,w,v,u);s.translate(r.offsetLeft-q,r.offsetTop-p);s.multiply(m);s.translate(q,p)}s.translate(r.offsetLeft,r.offsetTop);s.translate(-r.scrollLeft,-r.scrollTop);r=r.offsetParent}return s}else{var o=document.createElementNS(svgNS,"svg");if(h.firstChild===undefined){h.appendChild(o)}else{h.insertBefore(o,h.firstChild)}var l=o.getScreenCTM();h.removeChild(o);return Ui.Matrix.createMatrix(l.a,l.b,l.c,l.d,l.e,l.f)}}}}},transformFromWindow:function(b,c){var a=Ui.Element.transformToWindow(b,c);a.inverse();return a},pointToWindow:function(b,a,c){if(navigator.isWebkit){if(c===undefined){c=window}return c.webkitConvertPointFromNodeToPage(b,new WebKitPoint(a.x,a.y))}else{a=new Ui.Point({point:a});a.matrixTransform(Ui.Element.transformToWindow(b,c));return a}},pointFromWindow:function(b,a,c){if(navigator.isWebkit){if(c===undefined){c=window}return c.webkitConvertPointFromPageToNode(b,new WebKitPoint(a.x,a.y))}else{a=new Ui.Point({point:a});a.matrixTransform(Ui.Element.transformFromWindow(b,c));return a}}});navigator.supportOpacity=!((navigator.userAgent.match(/MSIE 7/i)!=null)||(navigator.userAgent.match(/MSIE 8/i)!=null));Ui.Element.extend("Ui.SVGElement",{},{renderDrawing:function(){var a=document.createElementNS(svgNS,"svg");a.setAttribute("focusable",false);return a}});Ui.Element.extend("Ui.CanvasElement",{context:undefined,constructor:function(a){},updateCanvas:function(a){}},{renderDrawing:function(){var a=document.createElement("canvas");this.context=a.getContext("2d");return a},arrangeCore:function(b,a){this.getDrawing().setAttribute("width",b,null);this.getDrawing().setAttribute("height",a,null);this.updateCanvas(this.context)}});Ui.Element.extend("Ui.Shape",{shapeDrawing:undefined,vmlFill:undefined,vmlOpacity:1,svgPath:undefined,svgGradient:undefined,svgDefs:undefined,fill:undefined,path:undefined,vmlPath:undefined,scale:1,constructor:function(a){},setScale:function(a){if(this.scale!=a){this.scale=a;if(Ui.Shape.forceCanvas){this.updateCanvas()}else{if(navigator.supportSVG){this.svgPath.setAttribute("transform","scale( "+a.toFixed(4)+", "+a.toFixed(4)+" )")}else{if(navigator.supportVML){this.shapeDrawing.coordsize=(this.getLayoutWidth()*100/a)+" "+(this.getLayoutHeight()*100/a)}}}}},getFill:function(){return this.fill},setFill:function(b){if(this.fill!=b){if(typeof(b)=="string"){b=Ui.Color.create(b)}b=Ui.Element.create(b);this.fill=b;if(Ui.Shape.forceCanvas){this.updateCanvas()}else{if(navigator.supportSVG){if(this.svgGradient!=undefined){this.svgDefs.removeChild(this.svgGradient);this.svgGradient=undefined}if(Ui.Color.hasInstance(b)){this.svgPath.style.fill=b.getCssHtml();this.svgPath.style.opacity=b.getRgba().a}else{if(Ui.LinearGradient.hasInstance(b)){this.svgGradient=b.getSVGGradient();var a="grad"+Core.Util.generateId();this.svgGradient.setAttributeNS(null,"id",a);this.svgDefs.appendChild(this.svgGradient);this.svgPath.style.fill="url(#"+a+")";this.svgPath.style.opacity=1}}}else{if(navigator.supportVML){if(this.vmlFill!=undefined){this.shapeDrawing.removeChild(this.vmlFill);this.vmlFill=undefined}if(Ui.Color.hasInstance(b)){this.vmlFill=document.createElement("vml:fill");this.vmlFill.type="solid";this.vmlFill.color=b.getCssHtml();this.vmlFill.opacity=b.getRgba().a*this.vmlOpacity;this.shapeDrawing.appendChild(this.vmlFill)}else{if(Ui.LinearGradient.hasInstance(b)){this.vmlFill=b.getVMLFill();this.shapeDrawing.appendChild(this.vmlFill)}}}}}}},setPath:function(a){if(this.path!=a){this.path=a;if(Ui.Shape.forceCanvas){this.updateCanvas()}else{if(navigator.supportSVG){this.svgPath.setAttributeNS(null,"d",this.path,null)}else{if(navigator.supportVML){this.vmlPath=this.pathToVML(a);this.shapeDrawing.path=this.vmlPath}}}}},pathToVML:function(p){var o=0;var m=0;var h=new Ui.SvgParser({path:p});h.next();var a="";while(!h.isEnd()){var r=h.getCmd();if(h.isCmd()){h.next()}if(r=="m"){h.setCmd("l");o+=h.getCurrent();h.next();m+=h.getCurrent();h.next();a+="m "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="M"){h.setCmd("L");o=h.getCurrent();h.next();m=h.getCurrent();h.next();a+="m "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="l"){o+=h.getCurrent();h.next();m+=h.getCurrent();h.next();a+="l "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="L"){o=h.getCurrent();h.next();m=h.getCurrent();h.next();a+="l "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="h"){o+=h.getCurrent();h.next();a+="l "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="H"){o=h.getCurrent();h.next();a+="l "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="v"){m+=h.getCurrent();h.next();a+="l "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="V"){m=h.getCurrent();h.next();a+="l "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="c"){var v=o+h.getCurrent();h.next();var g=m+h.getCurrent();h.next();var u=o+h.getCurrent();h.next();var d=m+h.getCurrent();h.next();var t=o+h.getCurrent();h.next();var b=m+h.getCurrent();h.next();for(var s=0;s<1;s+=0.1){var q=(1-s);var k=q*q;var j=k*q;var n=s*s;var l=n*s;var f=j*o+3*k*s*v+3*q*n*u+l*t;var c=j*m+3*k*s*g+3*q*n*d+l*b;a+="l "+Math.round(f*100)+","+Math.round(c*100)+" "}o=t;m=b;a+="l "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="C"){var v=h.getCurrent();h.next();var g=h.getCurrent();h.next();var u=h.getCurrent();h.next();var d=h.getCurrent();h.next();var t=h.getCurrent();h.next();var b=h.getCurrent();h.next();for(var s=0;s<1;s+=0.1){var q=(1-s);var k=q*q;var j=k*q;var n=s*s;var l=n*s;var f=j*o+3*k*s*v+3*q*n*u+l*t;var c=j*m+3*k*s*g+3*q*n*d+l*b;a+="l "+Math.round(f*100)+","+Math.round(c*100)+" "}o=t;m=b;a+="l "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="q"){var v=o+h.getCurrent();h.next();var g=m+h.getCurrent();h.next();var u=o+h.getCurrent();h.next();var d=m+h.getCurrent();h.next();for(var s=0;s<1;s+=0.1){var q=(1-s);var k=q*q;var n=s*s;var f=k*o+2*q*s*v+n*u;var c=k*m+2*q*s*g+n*d;a+="l "+Math.round(f*100)+","+Math.round(c*100)+" "}o=u;m=d;a+="l "+Math.round(o*100)+","+Math.round(m*100)+" "}else{if(r=="Q"){var v=h.getCurrent();h.next();var g=h.getCurrent();h.next();var u=h.getCurrent();h.next();var d=h.getCurrent();h.next();for(var s=0;s<1;s+=0.1){var q=(1-s);var k=q*q;var n=s*s;var f=k*o+2*q*s*v+n*u;var c=k*m+2*q*s*g+n*d;a+="l "+Math.round(f*100)+","+Math.round(c*100)+" "}o=u;m=d}else{if(r=="z"){a+="x "}else{console.log("Invalid SVG path cmd: "+r);throw ("Invalid SVG path")}}}}}}}}}}}}}}a+="e";return a},pathToCanvas:function(n,m){var l=0;var j=0;m.beginPath();var c=new Ui.SvgParser({path:n});c.next();while(!c.isEnd()){var f=c.getCmd();if(c.isCmd()){c.next()}if(f=="m"){c.setCmd("l");l+=c.getCurrent();c.next();j+=c.getCurrent();c.next();m.moveTo(l,j)}else{if(f=="M"){c.setCmd("L");l=c.getCurrent();c.next();j=c.getCurrent();c.next();m.moveTo(l,j)}else{if(f=="l"){l+=c.getCurrent();c.next();j+=c.getCurrent();c.next();m.lineTo(l,j)}else{if(f=="L"){l=c.getCurrent();c.next();j=c.getCurrent();c.next();m.lineTo(l,j)}else{if(f=="c"){var d=l+c.getCurrent();c.next();var k=j+c.getCurrent();c.next();var b=l+c.getCurrent();c.next();var h=j+c.getCurrent();c.next();var a=l+c.getCurrent();c.next();var g=j+c.getCurrent();c.next();m.bezierCurveTo(d,k,b,h,a,g);l=a;j=g}else{if(f=="C"){var d=c.getCurrent();c.next();var k=c.getCurrent();c.next();var b=c.getCurrent();c.next();var h=c.getCurrent();c.next();var a=c.getCurrent();c.next();var g=c.getCurrent();c.next();m.bezierCurveTo(d,k,b,h,a,g);l=a;j=g}else{if(f=="q"){var d=l+c.getCurrent();c.next();var k=j+c.getCurrent();c.next();var b=l+c.getCurrent();c.next();var h=j+c.getCurrent();c.next();m.quadraticCurveTo(d,k,b,h);l=b;j=h}else{if(f=="Q"){var d=c.getCurrent();c.next();var k=c.getCurrent();c.next();var b=c.getCurrent();c.next();var h=c.getCurrent();c.next();m.quadraticCurveTo(d,k,b,h);l=b;j=h}else{if(f=="z"){}else{console.log("Invalid SVG path cmd: "+f);throw ("Invalid SVG path")}}}}}}}}}}m.closePath()},updateCanvas:function(){var a=this.shapeDrawing.getContext("2d");a.save();a.clearRect(0,0,this.getLayoutWidth(),this.getLayoutHeight());if(this.path===undefined){return}if(this.scale!=1){a.scale(this.scale,this.scale)}this.pathToCanvas(this.path,a);var b=this.fill;if(typeof(b)=="string"){b=Ui.Color.create(b)}if(Ui.Color.hasInstance(b)){a.fillStyle=b.getCssRgba()}else{if(Ui.LinearGradient.hasInstance(b)){a.fillStyle=b.getCanvasGradient(a,this.getLayoutWidth(),this.getLayoutHeight())}}a.fill();a.restore()}},{render:function(){if(Ui.Shape.forceCanvas){this.shapeDrawing=document.createElement("canvas")}else{if(navigator.supportSVG){this.shapeDrawing=document.createElementNS(svgNS,"svg");this.shapeDrawing.setAttribute("focusable",false);this.svgDefs=document.createElementNS(svgNS,"defs");this.shapeDrawing.appendChild(this.svgDefs);this.svgPath=document.createElementNS(svgNS,"path");this.svgPath.style.fillOpacity="1";this.svgPath.style.stroke="none";this.shapeDrawing.appendChild(this.svgPath)}else{if(navigator.supportVML){this.shapeDrawing=document.createElement("vml:shape");this.shapeDrawing.stroked=false;this.vmlFill=document.createElement("vml:fill");this.vmlFill.type="solid";this.vmlFill.color="#000000";this.shapeDrawing.appendChild(this.vmlFill)}}}this.shapeDrawing.style.display="block";this.shapeDrawing.style.position="absolute";this.shapeDrawing.style.left="0px";this.shapeDrawing.style.top="0px";return this.shapeDrawing},arrangeCore:function(b,a){b=Math.round(b);a=Math.round(a);this.shapeDrawing.style.width=b+"px";this.shapeDrawing.style.height=a+"px";if(!Ui.Shape.forceCanvas&&!navigator.supportSVG&&navigator.supportVML){this.shapeDrawing.coordorigin="0 0";this.shapeDrawing.coordsize=(b*100/this.scale)+" "+(a*100/this.scale)}if(Ui.Shape.forceCanvas){this.shapeDrawing.setAttribute("width",b,null);this.shapeDrawing.setAttribute("height",a,null);this.updateCanvas()}},onVisible:function(){if(!Ui.Shape.forceCanvas&&!navigator.supportSVG&&navigator.supportVML){var b=this.getLayoutWidth();var a=this.getLayoutHeight();this.shapeDrawing.style.width=b+"px";this.shapeDrawing.style.height=a+"px";this.shapeDrawing.path=this.vmlPath;this.shapeDrawing.coordorigin="0 0";this.shapeDrawing.coordsize=(b*100/this.scale)+" "+(a*100/this.scale);if(this.vmlFill!=undefined){this.shapeDrawing.removeChild(this.vmlFill);this.vmlFill=undefined}if(Ui.Color.hasInstance(this.fill)){this.vmlFill=document.createElement("vml:fill");this.vmlFill.type="solid";this.vmlFill.color=this.fill.getCssHtml();this.vmlFill.opacity=this.fill.getRgba().a*this.vmlOpacity;this.shapeDrawing.appendChild(this.vmlFill)}else{if(Ui.LinearGradient.hasInstance(this.fill)){this.vmlFill=this.fill.getVMLFill();this.shapeDrawing.appendChild(this.vmlFill)}}}},onCumulOpacityChange:function(a){this.vmlOpacity=a;if(Ui.Color.hasInstance(this.fill)){this.shapeDrawing.removeChild(this.vmlFill);this.vmlFill=document.createElement("vml:fill");this.vmlFill.type="solid";this.vmlFill.color=this.fill.getCssHtml();this.vmlFill.opacity=this.fill.getRgba().a*this.vmlOpacity;this.shapeDrawing.appendChild(this.vmlFill)}}},{forceCanvas:(navigator.userAgent.match(/ Firefox\/3\.5\./)!=null)||(navigator.userAgent.match(/ Firefox\/3\.6\./)!=null)});Core.Object.extend("Ui.SvgParser",{path:undefined,pos:0,cmd:undefined,current:undefined,value:false,end:false,constructor:function(a){this.path=a.path;delete a.path},isEnd:function(){return this.end},next:function(){this.end=this.pos>=this.path.length;if(!this.end){while((this.pos<this.path.length)&&((this.path.charAt(this.pos)==" ")||(this.path.charAt(this.pos)==",")||(this.path.charAt(this.pos)==";"))){this.pos++}this.current="";var a=undefined;while((this.pos<this.path.length)&&(this.path.charAt(this.pos)!=" ")&&(this.path.charAt(this.pos)!=",")&&(this.path.charAt(this.pos)!=";")){var f=this.path.charAt(this.pos);var d=(f!="e")&&((f>="a")&&(f<="z"))||((f>="A")&&(f<="Z"));if((a===undefined)||(a==d)){a=d;this.current+=f;this.pos++}else{break}}var b=new Number(this.current);this.value=!isNaN(b);if(this.value){this.current=b}else{this.cmd=this.current}}},setCmd:function(a){this.cmd=a},getCmd:function(){return this.cmd},getCurrent:function(){return this.current},isCmd:function(){return !this.value},isValue:function(){return this.value}});Ui.Element.extend("Ui.Container",{children:undefined,constructor:function(a){this.children=[]},appendChild:function(a){a.parent=this;this.children.push(a);this.getDrawing().appendChild(a.getDrawing());a.getDrawing().style.zIndex=this.children.length;this.invalidateMeasure();a.setIsLoaded(this.isLoaded);a.setParentVisible(this.getIsVisible())},prependChild:function(b){b.parent=this;this.children.unshift(b);this.invalidateMeasure();if(this.getDrawing().firstChild!=undefined){this.getDrawing().insertBefore(b.getDrawing(),this.getDrawing().firstChild)}else{this.getDrawing().appendChild(b.getDrawing())}for(var a=0;a<this.children.length;a++){this.children[a].getDrawing().style.zIndex=a+1}b.setIsLoaded(this.isLoaded);b.setParentVisible(this.getIsVisible())},removeChild:function(b){b.parent=undefined;this.getDrawing().removeChild(b.getDrawing());var a=0;while((a<this.children.length)&&(this.children[a]!=b)){a++}if(a<this.children.length){this.children.splice(a,1)}for(var a=0;a<this.children.length;a++){this.children[a].getDrawing().style.zIndex=a+1}this.invalidateMeasure();b.setIsLoaded(false);b.setParentVisible(false)},insertChildAt:function(b,a){this.appendChild(b);this.moveChildAt(b,a)},moveChildAt:function(c,a){if(a<0){a=this.children.length+a}if(a<0){a=0}if(a>=this.children.length){a=this.children.length}var b=0;while((b<this.children.length)&&(this.children[b]!=c)){b++}if(b<this.children.length){this.children.splice(b,1);this.children.splice(a,0,c);for(var b=0;b<this.children.length;b++){this.children[b].getDrawing().style.zIndex=b+1}}this.invalidateMeasure()},getChildren:function(){return this.children},getFirstChild:function(){if(this.children.length>0){return this.children[0]}else{return undefined}},getLastChild:function(){if(this.children.length>0){return this.children[this.children.length-1]}else{return undefined}},getChildPosition:function(b){for(var a=0;a<this.children.length;a++){if(this.children[a]===b){return a}}return -1},hasChild:function(a){return this.getChildPosition(a)!==-1},clear:function(){while(this.getFirstChild()!=null){this.removeChild(this.getFirstChild())}}},{get:function(a){if(this.name==a){return this}else{for(var c=0;c<this.children.length;c++){var d=this.children[c];var b=d.get(a);if(b!=undefined){return b}}}return undefined},setIsLoaded:function(a){if(a!=this.isLoaded){for(var b=0;b<this.children.length;b++){this.children[b].setIsLoaded(a)}Ui.Container.base.setIsLoaded.call(this,a)}},onInternalStyleChange:function(){this.onStyleChange();if(this.children!=undefined){for(var a=0;a<this.children.length;a++){this.children[a].setParentStyle(this.mergeStyle)}}},onInternalDisable:function(){Ui.Container.base.onInternalDisable.call(this);for(var a=0;a<this.children.length;a++){this.children[a].setParentDisabled(true)}},onInternalEnable:function(){Ui.Container.base.onInternalEnable.call(this);for(var a=0;a<this.children.length;a++){this.children[a].setParentDisabled(false)}},onInternalVisible:function(){Ui.Container.base.onInternalVisible.call(this);for(var a=0;a<this.children.length;a++){this.children[a].setParentVisible(true)}},onInternalHidden:function(){Ui.Container.base.onInternalHidden.call(this);for(var a=0;a<this.children.length;a++){this.children[a].setParentVisible(false)}},onInternalSetOpacity:function(b){if(this.children===undefined){return}Ui.Container.base.onInternalSetOpacity.call(this);for(var a=0;a<this.children.length;a++){this.children[a].setParentCumulOpacity(b)}}});Ui.Container.extend("Ui.LBox",{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,constructor:function(a){},setContent:function(b){while(this.getFirstChild()!=undefined){this.removeChild(this.getFirstChild())}if((b!=undefined)&&(typeof(b)=="object")){if(b.constructor==Array){for(var a=0;a<b.length;a++){this.append(b[a])}}else{this.append(b)}}},setPadding:function(a){this.setPaddingTop(a);this.setPaddingBottom(a);this.setPaddingLeft(a);this.setPaddingRight(a)},getPaddingTop:function(){return this.paddingTop},setPaddingTop:function(a){if(this.paddingTop!=a){this.paddingTop=a;this.invalidateMeasure()}},getPaddingBottom:function(){return this.paddingBottom},setPaddingBottom:function(a){if(this.paddingBottom!=a){this.paddingBottom=a;this.invalidateMeasure()}},getPaddingLeft:function(){return this.paddingLeft},setPaddingLeft:function(a){if(this.paddingLeft!=a){this.paddingLeft=a;this.invalidateMeasure()}},getPaddingRight:function(){return this.paddingRight},setPaddingRight:function(a){if(this.paddingRight!=a){this.paddingRight=a;this.invalidateMeasure()}},append:function(a){this.appendChild(Ui.Element.create(a))},prepend:function(a){this.prependChild(Ui.Element.create(a))},remove:function(a){this.removeChild(a)}},{measureCore:function(d,n){var g=this.getPaddingLeft();var l=this.getPaddingRight();var k=this.getPaddingTop();var b=this.getPaddingBottom();var j=Math.max(d-(g+l),0);var a=Math.max(n-(k+b),0);var c=0;var m=0;for(var h=0;h<this.getChildren().length;h++){var f=this.getChildren()[h];var o=f.measure(j,a);if(o.width>c){c=o.width}if(o.height>m){m=o.height}}c+=g+l;m+=k+b;return{width:c,height:m}},arrangeCore:function(f,a){var h=this.getPaddingLeft();var d=this.getPaddingRight();var g=this.getPaddingTop();var b=this.getPaddingBottom();f-=h+d;a-=g+b;for(var c=0;c<this.getChildren().length;c++){this.getChildren()[c].arrange(h,g,f,a)}}});Ui.Container.extend("Ui.Box",{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,uniform:false,spacing:0,star:0,vertical:true,constructor:function(a){},setContent:function(b){while(this.getFirstChild()!=undefined){this.removeChild(this.getFirstChild())}if((b!=undefined)&&(typeof(b)=="object")){if(b.constructor==Array){for(var a=0;a<b.length;a++){this.append(b[a])}}else{this.append(b)}}},getOrientation:function(){if(this.vertical){return"vertical"}else{return"horizontal"}},setOrientation:function(b){var a=true;if(b!="vertical"){a=false}if(this.vertical!=a){this.vertical=a;this.invalidateMeasure()}},setPadding:function(a){this.setPaddingTop(a);this.setPaddingBottom(a);this.setPaddingLeft(a);this.setPaddingRight(a)},getPaddingTop:function(){return this.paddingTop},setPaddingTop:function(a){if(this.paddingTop!=a){this.paddingTop=a;this.invalidateMeasure()}},getPaddingBottom:function(){return this.paddingBottom},setPaddingBottom:function(a){if(this.paddingBottom!=a){this.paddingBottom=a;this.invalidateMeasure()}},getPaddingLeft:function(){return this.paddingLeft},setPaddingLeft:function(a){if(this.paddingLeft!=a){this.paddingLeft=a;this.invalidateMeasure()}},getPaddingRight:function(){return this.paddingRight},setPaddingRight:function(a){if(this.paddingRight!=a){this.paddingRight=a;this.invalidateMeasure()}},getUniform:function(){return this.uniform},setUniform:function(a){if(this.uniform!=a){this.uniform=a;this.invalidateMeasure()}},getSpacing:function(){return this.spacing},setSpacing:function(a){if(this.spacing!=a){this.spacing=a;this.invalidateMeasure()}},append:function(b,a){b=Ui.Element.create(b);if(a){Ui.Box.setResizable(b,true)}this.appendChild(b)},prepend:function(b,a){b=Ui.Element.create(b);if(a){Ui.Box.setResizable(b,true)}this.prependChild(b)},insertAt:function(c,a,b){c=Ui.Element.create(c);if(b){Ui.Box.setResizable(c,true)}this.insertChildAt(c,a)},remove:function(a){this.removeChild(a)},measureUniform:function(b,n){var d=this.vertical?n:b;var l=this.vertical?b:n;d-=this.spacing*(this.getChildren().length-1);var k=d/this.getChildren().length;var f=0;var j=0;var m=0;var h=true;while(h){for(var g=0;g<this.getChildren().length;g++){var c=this.getChildren()[g];if(Ui.Box.getResizable(c)){f++}var o;if(this.vertical){o=c.measure(l,k)}else{o=c.measure(k,l)}if((this.vertical?o.width:o.height)>m){m=this.vertical?o.width:o.height}if((this.vertical?o.height:o.width)>j){j=this.vertical?o.height:o.width}}if((m>l)||(j>k)){if(j>k){k=j}l=m;m=0;j=0;f=0}else{h=false}}if((f>0)&&(j*this.getChildren().length<d)){j=d/this.getChildren().length}this.uniformSize=j;var a=this.uniformSize*this.getChildren().length;a+=this.spacing*(this.getChildren().length-1);if(this.vertical){return{width:m,height:a}}else{return{width:a,height:m}}},measureNonUniformVertical:function(d,o){var m=d;var a=o;a-=this.spacing*(this.getChildren().length-1);var h=0;var b=0;var n=0;var k=true;var l=0;while(k){for(var j=0;j<this.getChildren().length;j++){var g=this.getChildren()[j];var p=g.measure(m,0);if(p.width>b){b=p.width}if(!Ui.Box.getResizable(g)){n+=p.height}else{g.boxStarDone=false;h++}}if(b>m){m=b;b=0;n=0;h=0}else{k=false}}if(h>0){var c=a-n;var f=true;l=c/h;do{f=true;for(var j=0;j<this.getChildren().length;j++){var g=this.getChildren()[j];if(Ui.Box.getResizable(g)){if(!g.boxStarDone){if(g.getMeasureHeight()>l){g.boxStarDone=true;f=false;c-=g.getMeasureHeight();n+=g.getMeasureHeight();h--;l=c/h;break}else{g.measure(m,l)}}}}}while(!f)}n+=this.spacing*(this.getChildren().length-1);if(h>0){n+=l*h;this.star=l}else{this.star=0}return{width:b,height:n}},measureNonUniformHorizontal:function(d,o){var m=d;var a=o;m-=this.spacing*(this.getChildren().length-1);var h;var c;var n;var k=true;while(k){h=0;c=0;n=0;for(var j=0;j<this.getChildren().length;j++){var g=this.getChildren()[j];if(!Ui.Box.getResizable(g)){var p=g.measure(0,a);if(p.height>n){n=p.height}c+=p.width}else{g.boxStarDone=false;h++}}if(h>0){var b=m-c;var f=true;var l=b/h;do{f=true;for(var j=0;j<this.getChildren().length;j++){var g=this.getChildren()[j];if(Ui.Box.getResizable(g)){if(!g.boxStarDone){var p=g.measure(l,a);if(p.height>n){n=p.height}if(p.width>l){g.boxStarDone=true;f=false;b-=p.width;c+=p.width;h--;l=b/h;break}}}}}while(!f)}if(n>a){a=n}else{k=false}}c+=this.spacing*(this.getChildren().length-1);if(h>0){c+=l*h;this.star=l}else{this.star=0}return{width:c,height:n}}},{measureCore:function(c,j){var d=this.getPaddingLeft();var h=this.getPaddingRight();var g=this.getPaddingTop();var b=this.getPaddingBottom();var f=Math.max(0,c-(d+h));var a=Math.max(0,j-(g+b));var k;if(this.uniform){k=this.measureUniform(f,a)}else{if(this.vertical){k=this.measureNonUniformVertical(f,a)}else{k=this.measureNonUniformHorizontal(f,a)}}k.width+=d+h;k.height+=g+b;return k},arrangeCore:function(b,k){var d=this.paddingLeft;var j=this.paddingRight;var h=this.paddingTop;var a=this.paddingBottom;b-=d+j;k-=h+a;var f=this.vertical?h:d;for(var g=0;g<this.getChildren().length;g++){var c=this.getChildren()[g];if(g!=0){f+=this.spacing}if(this.uniform){if(this.vertical){c.arrange(d,f,b,this.uniformSize)}else{c.arrange(f,h,this.uniformSize,k)}f+=this.uniformSize}else{if((Ui.Box.getResizable(c))&&((this.vertical?c.getMeasureHeight():c.getMeasureWidth())<this.star)){if(this.vertical){c.arrange(d,f,b,this.star)}else{c.arrange(f,h,this.star,k)}f+=this.star}else{if(this.vertical){c.arrange(d,f,b,c.getMeasureHeight());f+=c.getMeasureHeight()}else{c.arrange(f,h,c.getMeasureWidth(),k);f+=c.getMeasureWidth()}}}}}},{getResizable:function(a){return a["Ui.Box.resizable"]?true:false},setResizable:function(b,a){if(Ui.Box.getResizable(b)!=a){b["Ui.Box.resizable"]=a;b.invalidateMeasure()}}});Ui.Box.extend("Ui.VBox",{constructor:function(a){this.setOrientation("vertical")}});Ui.Box.extend("Ui.HBox",{constructor:function(a){this.setOrientation("horizontal")}});Ui.Container.extend("Ui.Flow",{uniform:false,uniformWidth:undefined,uniformHeight:undefined,constructor:function(a){},setContent:function(b){while(this.getFirstChild()!=undefined){this.removeChild(this.getFirstChild())}if((b!=undefined)&&(typeof(b)=="object")){if(b.constructor==Array){for(var a=0;a<b.length;a++){this.appendChild(Ui.Element.create(b[a]))}}else{this.appendChild(Ui.Element.create(b))}}},getUniform:function(){return this.uniform},setUniform:function(a){if(this.uniform!=a){this.uniform=a;this.invalidateMeasure()}},append:function(a){this.appendChild(a)},remove:function(a){this.removeChild(a)},measureChildrenNonUniform:function(g,a){var c={pos:0,y:0,width:0,height:0};var b={lineX:0,lineY:0,lineCount:0,lineHeight:0,minWidth:0};for(var f=0;f<this.getChildren().length;f++){var h=this.getChildren()[f];var d=h.measure(g,a);if((b.lineX!=0)&&(b.lineX+d.width>g)){c.width=b.lineX;c.height=b.lineHeight;b.lineX=0;b.lineY+=b.lineHeight;b.lineHeight=0;b.lineCount++;c={pos:b.lineCount,y:b.lineY,width:0,height:0}}h.flowLine=c;h.flowLineX=b.lineX;b.lineX+=d.width;if(d.height>b.lineHeight){b.lineHeight=d.height}if(b.lineX>b.minWidth){b.minWidth=b.lineX}}b.lineY+=b.lineHeight;c.width=b.lineX;c.height=b.lineHeight;return{width:b.minWidth,height:b.lineY}},measureChildrenUniform:function(a,j){var g=0;var h=0;for(var d=0;d<this.getChildren().length;d++){var b=this.getChildren()[d];var k=b.measure(a,j);if(k.width>g){g=k.width}if(k.height>h){h=k.height}}var c=Math.max(Math.floor(a/g),1);var f=Math.ceil(this.getChildren().length/c);for(var d=0;d<this.getChildren().length;d++){this.getChildren()[d].measure(g,h)}this.uniformWidth=g;this.uniformHeight=h;return{width:g*c,height:f*h}}},{measureCore:function(b,a){if(this.getChildren().length==0){return{width:0,height:0}}if(this.uniform){return this.measureChildrenUniform(b,a)}else{return this.measureChildrenNonUniform(b,a)}},arrangeCore:function(d,b){if(this.uniform){var a=0;var g=0;for(var c=0;c<this.getChildren().length;c++){var f=this.getChildren()[c];if(a+this.uniformWidth>d){a=0;g+=this.uniformHeight}f.arrange(a,g,this.uniformWidth,this.uniformHeight);a+=this.uniformWidth}}else{for(var c=0;c<this.getChildren().length;c++){var f=this.getChildren()[c];f.arrange(f.flowLineX,f.flowLine.y,f.getMeasureWidth(),f.flowLine.height)}}}});Ui.Container.extend("Ui.Grid",{cols:undefined,rows:undefined,constructor:function(a){this.cols=[{auto:true,star:false,absolute:false,actualWidth:0,offset:0,width:0}];this.rows=[{auto:true,star:false,absolute:false,actualHeight:0,offset:0,height:0}]},setCols:function(c){this.cols=[];c=c.split(",");for(var b=0;b<c.length;b++){var a=c[b];if(a=="auto"){this.cols.push({auto:true,star:false,absolute:false,actualWidth:0,offset:0,width:0})}else{if(a=="*"){this.cols.push({auto:false,star:true,absolute:false,actualWidth:0,offset:0,width:1})}else{if(a.match(/^[0-9]+\.?[0-9]*\*$/)){this.cols.push({auto:false,star:true,absolute:false,actualWidth:0,offset:0,width:new Number(a.slice(0,a.length-1))})}else{if(a.match(/^[0-9]+$/)){this.cols.push({auto:false,star:false,absolute:true,actualWidth:0,offset:0,width:new Number(a)})}}}}}this.invalidateMeasure()},setRows:function(b){this.rows=[];b=b.split(",");for(var a=0;a<b.length;a++){var c=b[a];if(c=="auto"){this.rows.push({auto:true,star:false,absolute:false,actualHeight:0,offset:0,height:0})}else{if(c=="*"){this.rows.push({auto:false,star:true,absolute:false,actualHeight:0,offset:0,height:1})}else{if(c.match(/^[0-9]+\.?[0-9]*\*$/)){this.rows.push({auto:false,star:true,absolute:false,actualHeight:0,offset:0,height:new Number(c.slice(0,c.length-1))})}else{if(c.match(/^[0-9]+$/)){this.rows.push({auto:false,star:false,absolute:true,actualHeight:0,offset:0,height:new Number(c)})}}}}}},setContent:function(b){while(this.getFirstChild()!=undefined){this.removeChild(this.getFirstChild())}if((b!=undefined)&&(typeof(b)=="object")){if(b.constructor==Array){for(var a=0;a<b.length;a++){this.appendChild(Ui.Element.create(b[a]))}}else{this.appendChild(Ui.Element.create(b))}}},attach:function(f,a,d,c,b){if(c===undefined){c=1}if(b===undefined){b=1}Ui.Grid.setCol(f,a);Ui.Grid.setRow(f,d);Ui.Grid.setColSpan(f,c);Ui.Grid.setRowSpan(f,b);this.appendChild(f)},detach:function(a){this.removeChild(a)},getColMin:function(h){var c=this.cols[h];var j=0;for(var l=0;l<this.getChildren().length;l++){var b=this.getChildren()[l];var m=Ui.Grid.getCol(b);var k=Ui.Grid.getColSpan(b);if((k==1)&&(m==h)){if(b.getMeasureWidth()>j){j=b.getMeasureWidth()}}else{if((m<=h)&&(m+k>h)){var d=true;var a=false;var g=0;for(var f=m;f<h;f++){var n=this.cols[f];g+=n.actualWidth;if(n.star){a=true;break}}if(!a){for(var f=h+1;f<m+k;f++){var n=this.cols[f];if(n.star){a=true;break}if(n.auto){d=false;break}}}if(!a&&d){if((b.getMeasureWidth()-g)>j){j=b.getMeasureWidth()-g}}}}}return j},getRowMin:function(a){var n=this.rows[a];var j=0;for(var k=0;k<this.getChildren().length;k++){var c=this.getChildren()[k];var h=Ui.Grid.getRow(c);var l=Ui.Grid.getRowSpan(c);if((l==1)&&(h==a)){if(c.getMeasureHeight()>j){j=c.getMeasureHeight()}}else{if((h<=a)&&(h+l>a)){var d=true;var b=false;var g=0;for(var f=h;f<a;f++){var m=this.rows[f];g+=m.actualHeight;if(m.star){b=true;break}}if(!b){for(var f=a+1;f<h+l;f++){var m=this.rows[f];if(m.star){b=true;break}if(m.auto){d=false;break}}}if(!b&&d){if((c.getMeasureHeight()-g)>j){j=c.getMeasureHeight()-g}}}}}return j}},{measureCore:function(t,s){for(var u=0;u<this.getChildren().length;u++){var m=this.getChildren()[u];var h=(t*Ui.Grid.getColSpan(m))/this.cols.length;var j=(s*Ui.Grid.getRowSpan(m))/this.rows.length;m.measure(h,j)}var d=0;var D=0;var c=0;var E=0;var B=0;for(var k=0;k<this.cols.length;k++){var l=this.cols[k];l.offset=B;if(l.absolute){l.actualWidth+=l.width}else{if(l.star){l.actualWidth=0;d+=l.width}else{if(l.auto){l.actualWidth=this.getColMin(k)}}}B+=l.actualWidth}var C=0;if(d>0){C=(t-B)/d}B=0;for(var u=0;u<this.cols.length;u++){var l=this.cols[u];l.offset=B;if(l.star){l.actualWidth=C*l.width}B+=l.actualWidth}for(var u=0;u<this.getChildren().length;u++){var m=this.getChildren()[u];var l=Ui.Grid.getCol(m);var o=Ui.Grid.getColSpan(m);var z=this.cols[l].offset;var a=0;for(var q=l;q<l+o;q++){a+=this.cols[q].actualWidth}m.measure(a,s)}B=0;for(var k=0;k<this.cols.length;k++){var l=this.cols[k];l.offset=B;if(l.absolute){l.actualWidth=l.width}else{if(l.star){l.actualWidth=Math.max(this.getColMin(k),C*l.width);D+=l.actualWidth}else{if(l.auto){l.actualWidth=this.getColMin(k)}}}B+=l.actualWidth}for(var u=0;u<this.getChildren().length;u++){var m=this.getChildren()[u];var l=Ui.Grid.getCol(m);var o=Ui.Grid.getColSpan(m);var z=this.cols[l].offset;var a=0;for(var q=l;q<l+o;q++){a+=this.cols[q].actualWidth}m.measure(a,s)}var A=0;for(var w=0;w<this.rows.length;w++){var n=this.rows[w];n.offset=A;if(n.absolute){n.actualHeight=n.height}else{if(n.star){n.actualHeight=0;c+=n.height}else{if(n.auto){n.actualHeight=this.getRowMin(w)}}}A+=n.actualHeight}var r=0;if(c>0){r=(s-A)/c}A=0;for(var u=0;u<this.rows.length;u++){var n=this.rows[u];n.offset=A;if(n.star){n.actualHeight=r*n.height}A+=n.actualHeight}for(var u=0;u<this.getChildren().length;u++){var m=this.getChildren()[u];var l=Ui.Grid.getCol(m);var o=Ui.Grid.getColSpan(m);var z=this.cols[l].offset;var a=0;for(var q=l;q<l+o;q++){a+=this.cols[q].actualWidth}var n=Ui.Grid.getRow(m);var f=Ui.Grid.getRowSpan(m);var v=this.rows[n].offset;var b=0;for(var p=n;p<n+f;p++){b+=this.rows[p].actualHeight}m.measure(a,b)}A=0;for(var w=0;w<this.rows.length;w++){var n=this.rows[w];n.offset=A;if(n.absolute){n.actualHeight=n.height}else{if(n.star){var g=this.getRowMin(w);n.actualHeight=Math.max(g,r*n.height);E+=n.actualHeight}else{if(n.auto){n.actualHeight=this.getRowMin(w)}}}A+=n.actualHeight}return{width:B,height:A}},arrangeCore:function(a,n){for(var f=0;f<this.getChildren().length;f++){var b=this.getChildren()[f];var d=Ui.Grid.getCol(b);var g=Ui.Grid.getColSpan(b);var p=Ui.Grid.getRow(b);var h=Ui.Grid.getRowSpan(b);var m=this.cols[d].offset;var l=this.rows[p].offset;var o=0;var c=0;for(var k=d;k<d+g;k++){o+=this.cols[k].actualWidth}for(var j=p;j<p+h;j++){c+=this.rows[j].actualHeight}b.arrange(m,l,o,c)}}},{getCol:function(a){return(a["Ui.Grid.col"]!=undefined)?a["Ui.Grid.col"]:0},setCol:function(b,a){if(Ui.Grid.getCol(b)!=a){b["Ui.Grid.col"]=a;b.invalidateMeasure()}},getRow:function(a){return(a["Ui.Grid.row"]!=undefined)?a["Ui.Grid.row"]:0},setRow:function(b,a){if(Ui.Grid.getRow(b)!=a){b["Ui.Grid.row"]=a;b.invalidateMeasure()}},getColSpan:function(a){return(a["Ui.Grid.colSpan"]!=undefined)?a["Ui.Grid.colSpan"]:1},setColSpan:function(b,a){if(Ui.Grid.getColSpan(b)!=a){b["Ui.Grid.colSpan"]=a;b.invalidateMeasure()}},getRowSpan:function(a){return(a["Ui.Grid.rowSpan"]!=undefined)?a["Ui.Grid.rowSpan"]:1},setRowSpan:function(b,a){if(Ui.Grid.getRowSpan(b)!=a){b["Ui.Grid.rowSpan"]=a;b.invalidateMeasure()}}});Ui.Container.extend("Ui.Fixed",{constructor:function(a){this.addEvents("resize")},setPosition:function(b,a,c){if(a!=undefined){b.fixedX=a}if(c!=undefined){b.fixedY=c}this.onChildInvalidateArrange(b)},append:function(c,a,b){c.fixedX=a;c.fixedY=b;this.appendChild(c)},remove:function(a){delete (a.fixedX);delete (a.fixedY);this.removeChild(a)}},{measureCore:function(c,a){for(var b=0;b<this.getChildren().length;b++){this.getChildren()[b].measure(c,a)}return{width:0,height:0}},arrangeCore:function(c,a){this.fireEvent("resize",this,c,a);for(var b=0;b<this.getChildren().length;b++){var d=this.getChildren()[b];d.arrange((d.fixedX===undefined)?0:d.fixedX,(d.fixedY===undefined)?0:d.fixedY,d.getMeasureWidth(),d.getMeasureHeight())}},onChildInvalidateMeasure:function(a){a.measure(this.getLayoutWidth(),this.getLayoutHeight())},onChildInvalidateArrange:function(a){a.arrange((a.fixedX===undefined)?0:a.fixedX,(a.fixedY===undefined)?0:a.fixedY,a.getMeasureWidth(),a.getMeasureHeight())}});Ui.Container.extend("Ui.Fold",{headerBox:undefined,header:undefined,contentBox:undefined,content:undefined,backgroundBox:undefined,background:undefined,offset:0,position:"bottom",isFolded:true,over:true,mode:"extend",clock:undefined,contentSize:0,animDuration:2,constructor:function(a){this.addEvents("fold","unfold","positionchange");this.backgroundBox=new Ui.LBox();this.appendChild(this.backgroundBox);this.headerBox=new Ui.Pressable();this.appendChild(this.headerBox);this.connect(this.headerBox,"press",this.onHeaderPress);this.contentBox=new Ui.LBox();this.appendChild(this.contentBox);this.contentBox.hide()},setHeaderActive:function(a){this.headerBox.setLock(!a)},getIsFolded:function(){return this.isFolded},fold:function(){if(!this.isFolded){this.isFolded=true;this.startAnimation();this.fireEvent("fold",this)}},unfold:function(){if(this.isFolded){this.isFolded=false;this.startAnimation();this.fireEvent("unfold",this)}},getOver:function(){return this.over},setOver:function(a){if(this.over!=a){this.over=a;this.stopAnimation();this.setTransform(Ui.Matrix.createTranslate(0,0));this.invalidateMeasure()}},getMode:function(){return this.mode},setMode:function(a){if(this.mode!=a){this.mode=a;this.stopAnimation();this.invalidateMeasure()}},getHeader:function(){return this.header},setHeader:function(a){if(a!=this.header){if(this.header!=undefined){this.headerBox.removeChild(this.header)}this.header=a;if(this.header!=undefined){this.headerBox.appendChild(this.header)}}},getContent:function(){return this.content},setContent:function(a){if(this.content!=a){if(this.content!=undefined){this.contentBox.removeChild(this.content)}this.content=a;if(this.content!=undefined){this.contentBox.appendChild(this.content)}}},getBackground:function(){return this.background},setBackground:function(a){if(this.background!=a){if(this.background!=undefined){this.backgroundBox.removeChild(this.background)}this.background=a;if(this.background!=undefined){this.backgroundBox.appendChild(this.background)}}},getPosition:function(){return this.position},setPosition:function(a){if(this.position!=a){this.position=a;this.fireEvent("positionchange",this,a);this.invalidateMeasure()}},getOffset:function(){return this.offset},setOffset:function(a){this.offset=a;if(!this.over){this.invalidateMeasure()}else{if(this.position=="right"){if(this.mode=="slide"){this.setTransform(Ui.Matrix.createTranslate(-this.offset*this.contentSize,0))}else{this.setTransform(Ui.Matrix.createTranslate(0,0))}this.contentBox.setClipRectangle(0,0,Math.round(this.contentSize*this.offset),this.getLayoutHeight());this.backgroundBox.setClipRectangle(0,0,Math.round(this.getLayoutWidth()+this.contentSize*this.offset),this.getLayoutHeight())}else{if(this.position=="left"){if(this.mode=="slide"){this.setTransform(Ui.Matrix.createTranslate(-this.contentSize+(this.offset*this.contentSize),0))}else{this.setTransform(Ui.Matrix.createTranslate(-this.contentSize,0))}this.contentBox.setClipRectangle(Math.round(this.contentSize*(1-this.offset)),0,this.contentSize,this.getLayoutHeight());this.backgroundBox.setClipRectangle(Math.round(this.contentSize*(1-this.offset)),0,Math.round(this.getLayoutWidth()+this.contentSize*this.offset),this.getLayoutHeight())}else{if(this.position=="top"){if(this.mode=="slide"){this.setTransform(Ui.Matrix.createTranslate(0,-this.contentSize+(this.offset*this.contentSize)))}else{this.setTransform(Ui.Matrix.createTranslate(0,-this.contentSize))}this.contentBox.setClipRectangle(0,Math.round(this.contentSize*(1-this.offset)),this.getLayoutWidth(),Math.round(this.contentSize*this.offset));this.backgroundBox.setClipRectangle(0,Math.round(this.contentSize*(1-this.offset)),this.getLayoutWidth(),Math.round(this.getLayoutHeight()+this.contentSize*this.offset))}else{if(this.mode=="slide"){this.setTransform(Ui.Matrix.createTranslate(0,-this.offset*this.contentSize))}else{this.setTransform(Ui.Matrix.createTranslate(0,0))}this.contentBox.setClipRectangle(0,0,this.getLayoutWidth(),Math.round(this.contentSize*this.offset));this.backgroundBox.setClipRectangle(0,0,this.getLayoutWidth(),Math.round(this.getLayoutHeight()+this.contentSize*this.offset))}}}}},onHeaderPress:function(){if(this.isFolded){this.unfold()}else{this.fold()}},setAnimDuration:function(a){this.animDuration=a},startAnimation:function(){if(this.clock!=undefined){this.clock.stop()}if(!this.isFolded){this.contentBox.show()}this.clock=new Anim.Clock({duration:this.animDuration,scope:this,target:this,onTimeupdate:this.onClockTick});this.clock.begin()},stopAnimation:function(){if(this.clock!=undefined){this.clock.stop();this.clock=undefined}},onClockTick:function(b,a){if(this.content===undefined){if(this.clock!=undefined){this.clock.stop();this.clock=undefined}return}var d=this.getOffset();if(d>1){this.setOffset(1)}else{var c;if(this.isFolded){c=0}else{c=1}this.setOffset(c-((c-d)*(1-a)))}if((a==1)&&this.isFolded){this.contentBox.hide()}}},{measureCore:function(c,a){this.backgroundBox.measure(c,a);var b=this.headerBox.measure(c,a);var d={width:0,height:0};if((this.position=="left")||(this.position=="right")){d=this.contentBox.measure(c-b.width,a);if(d.height>b.height){b.height=d.height}if(!this.over){b.width+=d.width*this.offset}this.contentSize=d.width}else{d=this.contentBox.measure(c,a-b.height);if(d.width>b.width){b.width=d.width}if(!this.over){b.height+=d.height*this.offset}this.contentSize=d.height}return b},arrangeCore:function(b,a){if(this.position=="left"){if(!this.over){this.setTransform(Ui.Matrix.createTranslate(-this.contentSize+(this.offset*this.contentSize),0))}this.contentBox.arrange(0,0,this.contentBox.getMeasureWidth(),a);this.headerBox.arrange(this.contentBox.getMeasureWidth(),0,this.headerBox.getMeasureWidth(),a);this.backgroundBox.arrange(0,0,this.headerBox.getMeasureWidth()+this.contentBox.getMeasureWidth(),a);this.contentBox.setClipRectangle(Math.round(this.contentSize*(1-this.offset)),0,Math.round(this.contentSize*this.offset),Math.round(a));this.backgroundBox.setClipRectangle(Math.round(this.contentSize*(1-this.offset)),0,Math.round(this.headerBox.getMeasureWidth()+this.contentSize*this.offset),Math.round(a))}else{if(this.position=="right"){this.headerBox.arrange(0,0,this.headerBox.getMeasureWidth(),a);this.contentBox.arrange(this.headerBox.getMeasureWidth(),0,this.contentBox.getMeasureWidth(),a);this.backgroundBox.arrange(0,0,this.headerBox.getMeasureWidth()+this.contentBox.getMeasureWidth(),a);this.contentBox.setClipRectangle(0,0,Math.round(this.contentSize*this.offset),Math.round(a));this.backgroundBox.setClipRectangle(0,0,Math.round(this.headerBox.getMeasureWidth()+this.contentSize*this.offset),Math.round(a))}else{if(this.position=="top"){if(!this.over){this.setTransform(Ui.Matrix.createTranslate(0,-this.contentSize+(this.offset*this.contentSize)))}this.contentBox.arrange(0,0,b,this.contentBox.getMeasureHeight());this.headerBox.arrange(0,this.contentBox.getMeasureHeight(),b,this.headerBox.getMeasureHeight());this.backgroundBox.arrange(0,0,b,this.headerBox.getMeasureHeight()+this.contentBox.getMeasureHeight());this.contentBox.setClipRectangle(0,Math.round(this.contentSize*(1-this.offset)),Math.round(b),Math.round(this.contentSize*this.offset));this.backgroundBox.setClipRectangle(0,Math.round(this.contentSize*(1-this.offset)),Math.round(b),Math.round(this.headerBox.getMeasureHeight()+this.contentSize*this.offset))}else{this.headerBox.arrange(0,0,b,this.headerBox.getMeasureHeight());this.contentBox.arrange(0,this.headerBox.getMeasureHeight(),b,this.contentBox.getMeasureHeight());this.backgroundBox.arrange(0,0,b,this.headerBox.getMeasureHeight()+this.contentBox.getMeasureHeight());this.contentBox.setClipRectangle(0,0,Math.round(b),Math.round(this.contentSize*this.offset));this.backgroundBox.setClipRectangle(0,0,Math.round(b),Math.round(this.headerBox.getMeasureHeight()+this.contentSize*this.offset))}}}this.setOffset(this.offset)}});Ui.Container.extend("Ui.Accordeonable",{current:-1,currentPage:undefined,clock:undefined,headersSize:0,contentSize:0,orientation:"horizontal",constructor:function(a){this.addEvents("change");this.setClipToBounds(true)},getOrientation:function(){return this.orientation},setOrientation:function(a){if(this.orientation!=a){this.orientation=a;for(var b=0;b<this.getChildren().length;b++){this.getChildren()[b].setOrientation(a)}this.invalidateMeasure()}},getPages:function(){return this.getChildren()},getCurrentPage:function(){return this.currentPage},setCurrentPage:function(b){for(var a=0;a<this.getChildren().length;a++){if(this.getChildren()[a]==b){this.setCurrentPosition(a);return}}},getCurrentPosition:function(){return this.current},setCurrentPosition:function(b){if(this.getChildren().length==0){if(this.currentPage!=undefined){this.currentPage.unselect()}this.currentPage=undefined;this.current=-1}else{this.current=b;var a=this.getChildren()[this.current];if(a!=this.currentPage){if(this.currentPage!=undefined){this.currentPage.unselect()}this.currentPage=a;this.fireEvent("change",this,this.currentPage,this.current);this.disconnect(this.currentPage,"select",this.onPageSelect);this.currentPage.select();this.connect(this.currentPage,"select",this.onPageSelect)}if(this.clock!=undefined){this.clock.stop()}this.clock=new Anim.Clock({scope:this,duration:2,target:this,onTimeupdate:this.onClockTick});this.clock.begin()}},appendPage:function(a){a=Ui.AccordeonPage.create(a);this.appendChild(a);a.setOffset(1);a.setOrientation(this.orientation);this.connect(a,"select",this.onPageSelect);this.connect(a,"close",this.onPageClose);a.select()},removePage:function(b){var c=-1;for(var a=0;a<this.getChildren().length;a++){if(this.getChildren()[a]==b){c=a;break}}if(c!=-1){this.disconnect(b,"select",this.onPageSelect);this.disconnect(b,"close",this.onPageClose);this.removeChild(b);if((this.current==c)&&(this.current==0)){this.setCurrentPosition(0)}else{if(this.current>=c){this.setCurrentPosition(this.current-1)}else{this.setCurrentPosition(this.current)}}}},onClockTick:function(c,a){for(var b=0;b<this.getChildren().length;b++){var g=this.getChildren()[b];if(b==this.current){g.showContent()}var f=g.getOffset();if(f>1){g.setOffset(1)}else{var d;if(b<=this.current){d=0}else{d=1}g.setOffset(d-((d-f)*(1-a)))}if((a==1)&&(b!=this.current)){g.hideContent()}}},onPageSelect:function(a){this.setCurrentPage(a)},onPageClose:function(a){this.removePage(a)},measureHorizontal:function(a,j){var c=0;var g=0;var h=0;for(var d=0;d<this.getChildren().length;d++){var b=this.getChildren()[d];var k=b.measure(a,j);c+=b.getHeader().getMeasureWidth();if(b.getHeader().getMeasureHeight()>h){h=b.getHeader().getMeasureHeight()}}for(var d=0;d<this.getChildren().length;d++){var b=this.getChildren()[d];var k=b.measure((a-c)+b.getHeader().getMeasureWidth(),j);var f=b.getContent();if((f!=undefined)&&(f.getMeasureWidth()>g)){g=f.getMeasureWidth();if(f.getMeasureHeight()>h){h=f.getMeasureHeight()}}}this.headersSize=c;return{width:c+g,height:h}},measureVertical:function(b,j){var d=0;var h=0;var a=0;for(var f=0;f<this.getChildren().length;f++){var c=this.getChildren()[f];var k=c.measure(b,j);d+=c.getHeader().getMeasureHeight();if(c.getHeader().getMeasureWidth()>a){a=c.getHeader().getMeasureWidth()}}for(var f=0;f<this.getChildren().length;f++){var c=this.getChildren()[f];var k=c.measure(b,(j-d)+c.getHeader().getMeasureHeight());var g=c.getContent();if((g!=undefined)&&(g.getMeasureHeight()>h)){h=g.getMeasureHeight();if(g.getMeasureWidth()>a){a=g.getMeasureWidth()}}}this.headersSize=d;return{width:a,height:d+h}}},{measureCore:function(b,a){if(this.orientation=="horizontal"){return this.measureHorizontal(b,a)}else{return this.measureVertical(b,a)}},arrangeCore:function(d,b){if(this.orientation=="horizontal"){var a=0;this.contentSize=d-this.headersSize;for(var c=0;c<this.getChildren().length;c++){var g=this.getChildren()[c];g.arrange(a,0,this.contentSize+g.getHeader().getMeasureWidth(),b);a+=g.getHeader().getMeasureWidth()}}else{var f=0;this.contentSize=b-this.headersSize;for(var c=0;c<this.getChildren().length;c++){var g=this.getChildren()[c];g.arrange(0,f,d,this.contentSize+g.getHeader().getMeasureHeight());f+=g.getHeader().getMeasureHeight()}}}});Ui.Container.extend("Ui.AccordeonPage",{headerBox:undefined,header:undefined,content:undefined,offset:0,orientation:"horizontal",isSelected:false,constructor:function(a){this.addEvents("select","unselect","close","orientationchange");this.headerBox=new Ui.Pressable();this.appendChild(this.headerBox);this.connect(this.headerBox,"press",this.onHeaderPress)},close:function(){this.fireEvent("close",this)},select:function(){if(!this.isSelected){this.isSelected=true;this.fireEvent("select",this)}},getIsSelected:function(){return this.isSelected},getHeader:function(){return this.header},setHeader:function(a){a=Ui.Element.create(a);if(a!=this.header){if(this.header!=undefined){this.headerBox.removeChild(this.header)}this.header=a;if(this.header!=undefined){this.headerBox.appendChild(this.header)}}},getContent:function(){return this.content},setContent:function(a){a=Ui.Element.create(a);if(this.content!=a){if(this.content!=undefined){this.removeChild(this.content)}this.content=a;if(this.content!=undefined){this.appendChild(this.content,true)}}},getOrientation:function(){return this.orientation},setOrientation:function(a){if(this.orientation!=a){this.orientation=a;this.fireEvent("orientationchange",this,a);this.invalidateMeasure()}},unselect:function(){if(this.isSelected){this.isSelected=false;this.fireEvent("unselect",this)}},showContent:function(){if(this.content!=undefined){this.content.show()}},hideContent:function(){if(this.content!=undefined){this.content.hide()}},getOffset:function(){return this.offset},setOffset:function(a){this.offset=a;if(this.orientation=="horizontal"){this.setTransform(Ui.Matrix.createTranslate(this.offset*(this.getLayoutWidth()-this.headerBox.getMeasureWidth()),0))}else{this.setTransform(Ui.Matrix.createTranslate(0,this.offset*(this.getLayoutHeight()-this.headerBox.getMeasureHeight())))}},onHeaderPress:function(){this.select()}},{measureCore:function(c,a){var b=this.headerBox.measure(c,a);var d={width:0,height:0};if(this.content!=undefined){if(this.orientation=="horizontal"){d=this.content.measure(c-b.width,a);if(d.height>b.height){b.height=d.height}b.width+=d.width}else{d=this.content.measure(c,a-b.height);if(d.width>b.width){b.width=d.width}b.height+=d.height}}return b},arrangeCore:function(b,a){if(this.orientation=="horizontal"){this.headerBox.arrange(0,0,this.headerBox.getMeasureWidth(),a);if(this.content!=undefined){this.content.arrange(this.headerBox.getMeasureWidth(),0,b-this.headerBox.getMeasureWidth(),a)}}else{this.headerBox.arrange(0,0,b,this.headerBox.getMeasureHeight());if(this.content!=undefined){this.content.arrange(0,this.headerBox.getMeasureHeight(),b,a-this.headerBox.getMeasureHeight())}}this.setOffset(this.offset)}});Ui.Element.extend("Ui.Spacer",{constructor:function(a){}});Ui.Shape.extend("Ui.Rectangle",{radiusTopLeft:0,radiusTopRight:0,radiusBottomLeft:0,radiusBottomRight:0,constructor:function(a){},setRadius:function(a){this.setRadiusTopLeft(a);this.setRadiusTopRight(a);this.setRadiusBottomLeft(a);this.setRadiusBottomRight(a)},getRadiusTopLeft:function(){return this.radiusTopLeft},setRadiusTopLeft:function(a){if(this.radiusTopLeft!=a){this.radiusTopLeft=a;this.invalidateArrange()}},getRadiusTopRight:function(){return this.radiusTopRight},setRadiusTopRight:function(a){if(this.radiusTopRight!=a){this.radiusTopRight=a;this.invalidateArrange()}},getRadiusBottomLeft:function(){return this.radiusBottomLeft},setRadiusBottomLeft:function(a){if(this.radiusBottomLeft!=a){this.radiusBottomLeft=a;this.invalidateArrange()}},getRadiusBottomRight:function(){return this.radiusBottomRight},setRadiusBottomRight:function(a){if(this.radiusBottomRight!=a){this.radiusBottomRight=a;this.invalidateArrange()}},genPath:function(d,b){var a=this.radiusTopLeft;var c=this.radiusTopLeft;var h=d-a;var g=b-a;var f="";if(this.radiusTopLeft>0){f+="M0,"+this.radiusTopLeft+" Q0,0 "+this.radiusTopLeft+",0 "}else{f+="M0,0 "}if(this.radiusTopRight>0){f+="L"+(d-this.radiusTopRight)+",0 Q"+d+",0 "+d+","+this.radiusTopRight+" "}else{f+="L"+d+",0 "}if(this.radiusBottomRight>0){f+="L"+d+","+(b-this.radiusBottomRight)+" Q"+d+","+b+" "+(d-this.radiusBottomRight)+","+b+" "}else{f+="L"+d+","+b+" "}if(this.radiusBottomLeft>0){f+="L"+this.radiusBottomLeft+","+b+" Q0,"+b+" 0,"+(b-this.radiusBottomLeft)+" "}else{f+="L0,"+b+" "}f+="z";return f}},{arrangeCore:function(b,a){Ui.Rectangle.base.arrangeCore.call(this,b,a);this.setPath(this.genPath(b,a))}});Ui.Shape.extend("Ui.Frame",{radiusTopLeft:0,radiusTopRight:0,radiusBottomLeft:0,radiusBottomRight:0,frameWidth:10,constructor:function(a){},getFrameWidth:function(){return this.frameWidth},setFrameWidth:function(a){if(a!=this.frameWidth){this.frameWidth=a;this.invalidateArrange()}},setRadius:function(a){this.setRadiusTopLeft(a);this.setRadiusTopRight(a);this.setRadiusBottomLeft(a);this.setRadiusBottomRight(a)},getRadiusTopLeft:function(){return this.radiusTopLeft},setRadiusTopLeft:function(a){if(this.radiusTopLeft!=a){this.radiusTopLeft=a;this.invalidateArrange()}},getRadiusTopRight:function(){return this.radiusTopRight},setRadiusTopRight:function(a){if(this.radiusTopRight!=a){this.radiusTopRight=a;this.invalidateArrange()}},getRadiusBottomLeft:function(){return this.radiusBottomLeft},setRadiusBottomLeft:function(a){if(this.radiusBottomLeft!=a){this.radiusBottomLeft=a;this.invalidateArrange()}},getRadiusBottomRight:function(){return this.radiusBottomRight},setRadiusBottomRight:function(a){if(this.radiusBottomRight!=a){this.radiusBottomRight=a;this.invalidateArrange()}},genPath:function(d,b){var a=this.radiusTopLeft;var c=this.radiusTopLeft;var h=d-a;var g=b-a;var f="";if(this.radiusTopLeft>0){f+="M0,"+this.radiusTopLeft+" Q0,0 "+this.radiusTopLeft+",0 "}else{f+="M0,0 "}if(this.radiusTopRight>0){f+="L"+(d-this.radiusTopRight)+",0 Q"+d+",0 "+d+","+this.radiusTopRight+" "}else{f+="L"+d+",0 "}if(this.radiusBottomRight>0){f+="L"+d+","+(b-this.radiusBottomRight)+" Q"+d+","+b+" "+(d-this.radiusBottomRight)+","+b+" "}else{f+="L"+d+","+b+" "}if(this.radiusBottomLeft>0){f+="L"+this.radiusBottomLeft+","+b+" Q0,"+b+" 0,"+(b-this.radiusBottomLeft)+" "}else{f+="L0,"+b+" "}if(this.radiusTopLeft>this.frameWidth){f+="M"+this.radiusTopLeft+","+this.frameWidth+" ";f+="Q"+this.frameWidth+","+this.frameWidth+" "+this.frameWidth+","+this.radiusTopLeft+" "}else{f+="M"+this.frameWidth+","+(this.frameWidth)+" "}if(this.radiusBottomLeft>this.frameWidth){f+="L"+this.frameWidth+","+(b-this.radiusBottomLeft)+" ";f+="Q"+this.frameWidth+","+(b-this.frameWidth)+" "+this.radiusBottomLeft+","+(b-this.frameWidth)+" "}else{f+="L"+this.frameWidth+","+(b-this.frameWidth)+" "}if(this.radiusBottomRight>this.frameWidth){f+="L"+(d-this.radiusBottomRight)+","+(b-this.frameWidth)+" ";f+="Q"+(d-this.frameWidth)+","+(b-this.frameWidth)+" "+(d-this.frameWidth)+","+(b-this.radiusBottomRight)+" "}else{f+="L"+(d-this.frameWidth)+","+(b-this.frameWidth)+" "}if(this.radiusTopRight>this.frameWidth){f+="L"+(d-this.frameWidth)+","+this.radiusTopRight+" ";f+="Q"+(d-this.frameWidth)+","+this.frameWidth+" "+(d-this.radiusTopRight)+","+this.frameWidth+" "}else{f+="L"+(d-this.frameWidth)+","+(this.frameWidth)+" "}f+="z";return f}},{arrangeCore:function(b,a){Ui.Frame.base.arrangeCore.call(this,b,a);this.setPath(this.genPath(b,a))}});Ui.LBox.extend("Ui.Shadow",{radiusTopLeft:0,radiusTopRight:0,radiusBottomLeft:0,radiusBottomRight:0,shadowWidth:0,inner:false,color:undefined,constructor:function(a){this.color=Ui.Color.create("black");this.setShadowWidth(4)},getColor:function(){return this.color},setColor:function(a){if(this.color!=a){this.color=Ui.Color.create(a);this.updateOpacityColor()}},getInner:function(){return this.inner},setInner:function(a){if(this.inner!=a){this.inner=a;this.updateWidth();this.updateRadius();this.updateOpacityColor()}},setShadowWidth:function(a){if(this.shadowWidth!=a){this.shadowWidth=a;this.updateWidth();this.updateOpacityColor();this.updateRadius()}},getShadowWidth:function(){return this.shadowWidth},setRadius:function(a){this.radiusTopLeft=a;this.radiusTopRight=a;this.radiusBottomLeft=a;this.radiusBottomRight=a;this.updateRadius()},getRadiusTopLeft:function(){return this.radiusTopLeft},setRadiusTopLeft:function(a){if(this.radiusTopLeft!=a){this.radiusTopLeft=a;this.updateRadius()}},getRadiusTopRight:function(){return this.radiusTopRight},setRadiusTopRight:function(a){if(this.radiusTopRight!=a){this.radiusTopRight=a;this.updateRadius()}},getRadiusBottomLeft:function(){return this.radiusBottomLeft},setRadiusBottomLeft:function(a){if(this.radiusBottomLeft!=a){this.radiusBottomLeft=a;this.updateRadius()}},getRadiusBottomRight:function(){return this.radiusBottomRight},setRadiusBottomRight:function(a){if(this.radiusBottomRight!=a){this.radiusBottomRight=a;this.updateRadius()}},updateWidth:function(){while(this.getFirstChild()!=undefined){this.remove(this.getFirstChild())}for(var a=0;a<this.shadowWidth;a++){if(this.inner){this.append(new Ui.Frame({fill:"black",frameWidth:this.shadowWidth-a}))}else{this.append(new Ui.Rectangle({fill:"black",margin:a}))}}},updateOpacityColor:function(){var g=this.color.getRgba();var c=g.a;for(var f=0;f<this.getChildren().length;f++){var d;if(this.inner){if(this.shadowWidth==1){d=1}else{var b=(f+1)/this.shadowWidth;d=b*b}}else{d=(f+1)/(this.shadowWidth+1)}g.a=c*d;this.getChildren()[f].setFill(new Ui.Color(g))}},updateRadius:function(){for(var a=0;a<this.getChildren().length;a++){var b=this.getChildren()[a];b.setRadiusTopLeft(this.radiusTopLeft);b.setRadiusTopRight(this.radiusTopRight);b.setRadiusBottomLeft(this.radiusBottomLeft);b.setRadiusBottomRight(this.radiusBottomRight)}}});Ui.Shape.extend("Ui.Icon",{constructor:function(a){this.setWidth(24);this.setHeight(24)},setIcon:function(a){this.setPath(Ui.Icon.icons[a])}},{arrangeCore:function(b,a){Ui.Icon.base.arrangeCore.call(this,b,a);var c=Math.min(b,a)/48;this.setScale(c)}},{icons:{},constructor:function(){this.register("check","m 9.1916229,24 7.0000001,-7 7,7 14,-14 7,7 -21,21 z");this.register("home","M 25.78125 8.4375 C 25.324787 8.4375 24.892151 8.63045 24.53125 8.96875 C 24.53125 8.96875 6.032579 23.87715 5.6875 24.21875 C 4.081261 25.55365 4.524131 25.86215 4.96875 26.46875 C 7.1319435 26.472745 6.9387918 26.465628 8.875 26.46875 L 8.875 38.40625 C 8.875 40.46895 10.593558 42.1875 12.65625 42.1875 L 37.3125 42.1875 C 39.375192 42.1875 41.09375 40.46895 41.09375 38.40625 L 41.09375 26.5 C 42.834133 26.49218 44.96875 26.46875 44.96875 26.46875 C 45.304525 25.79985 45.215875 24.96585 44.65625 24.40625 L 39.96875 20.3125 C 40.040347 20.078087 40.09375 19.817094 40.09375 19.5625 L 40.09375 11.875 C 40.09375 10.4883 38.949133 9.34375 37.5625 9.34375 L 33.25 9.34375 C 31.863368 9.34375 30.71875 10.4883 30.71875 11.875 L 30.71875 12.1875 L 27.03125 8.96875 C 26.681485 8.61895 26.237713 8.4375 25.78125 8.4375 z M 33.71875 12.34375 L 37.09375 12.34375 L 37.09375 17.78125 L 33.71875 14.8125 L 33.71875 12.34375 z M 12.875 26.46875 C 23.518938 26.483067 32.947599 26.505366 37.09375 26.5 L 37.09375 38.1875 L 12.875 38.1875 L 12.875 26.46875 z");this.register("search","M 16.5625 2.78125 C 9.268416 2.78125 3.3125 8.73725 3.3125 16.03125 C 3.3125 23.32535 9.268416 29.28125 16.5625 29.28125 C 19.232656 29.28125 21.727527 28.494751 23.8125 27.125 L 26.53125 29.84375 C 26.040794 31.243763 26.345911 32.877161 27.46875 34 L 36.96875 43.5 C 38.531721 45.062971 41.062029 45.062971 42.625 43.5 L 44.3125 41.8125 C 45.875471 40.249529 45.875471 37.750471 44.3125 36.1875 L 34.78125 26.65625 C 33.730308 25.605308 32.270922 25.293885 30.9375 25.65625 L 28 22.71875 C 29.155313 20.754051 29.8125 18.465809 29.8125 16.03125 C 29.8125 8.73725 23.856584 2.78125 16.5625 2.78125 z M 16.5625 6.78125 C 21.694823 6.78125 25.8125 10.89895 25.8125 16.03125 C 25.8125 21.16365 21.694823 25.28125 16.5625 25.28125 C 11.430177 25.28125 7.3125 21.16365 7.3125 16.03125 C 7.3125 10.89895 11.430177 6.78125 16.5625 6.78125 z");this.register("close","m 9,4 -5,5 15,15 -15,15 5,5 15,-15 15,15 5,-5 -15,-15 15,-15 -5,-5 -15,15 -15,-15 z");this.register("arrowleft","m 30,4 5,5 -15,15 15,15 -5,5 -20,-20 z");this.register("arrowright","m 18,4 -5,5 15,15 -15,15 5,5 20,-20 z");this.register("arrowtop","m 44,31 -5,5 -15,-15 -15,15 -5,-5 20,-20 z");this.register("arrowbottom","m 4,16 5,-5 15,15 15,-15 5,5 -20,20 z");this.register("refresh","M 23.9375 8.65625 C 18.315047 8.5110846 12.782031 11.461344 9.78125 16.8125 C 5.4164779 24.596 8.033743 34.59995 15.59375 39.09375 C 23.153757 43.58765 32.885228 40.9086 37.25 33.125 L 33.3125 30.78125 C 30.176679 36.37325 23.306402 38.25985 17.875 35.03125 C 12.443598 31.80275 10.582928 24.7169 13.71875 19.125 C 16.854571 13.533 23.724848 11.6464 29.15625 14.875 C 31.524806 16.282891 33.334721 18.493178 34.21875 21.125 L 25.9375 18.5 L 24.78125 22.125 L 39.25 26.6875 L 43.8125 12.21875 L 40.1875 11.0625 L 37.9375 18.21875 C 36.578889 15.137923 34.328741 12.531134 31.4375 10.8125 C 29.074997 9.4081875 26.493161 8.7222343 23.9375 8.65625 z M 36.84375 21.78125 L 36.78125 21.9375 L 36.5 21.84375 L 36.84375 21.78125 z");this.register("deny","M 24.375 4.5625 C 13.844791 4.5625 5.3125 13.094791 5.3125 23.625 C 5.3125 34.155209 13.844791 42.6875 24.375 42.6875 C 34.905209 42.6875 43.4375 34.155209 43.4375 23.625 C 43.4375 13.094791 34.905209 4.5625 24.375 4.5625 z M 12.875 20.46875 L 36.375 20.46875 L 36.375 27.8125 L 12.875 27.8125 L 12.875 20.46875 z");this.register("warning","M 24.71875 4.4375 C 23.303716 4.4375 21.840759 5.2267 20.8125 6.9375 L 4.21875 34.59375 C 2.3252709 37.74415 3.3675561 42.27165 7.125 42.28125 L 42.34375 42.375 C 46.101193 42.385 45.807964 37.35645 44 34.15625 L 28.625 6.9375 C 27.64318 5.1996 26.133784 4.4375 24.71875 4.4375 z M 22.15625 13.25 L 27.46875 13.25 L 27.46875 20.125 C 27.46874 22.170821 27.369577 24.007046 27.15625 25.6875 C 26.942909 27.343595 26.663738 29.000155 26.34375 30.65625 L 23.25 30.65625 C 22.929998 29.000155 22.682075 27.343595 22.46875 25.6875 C 22.255413 24.007046 22.156245 22.170821 22.15625 20.125 L 22.15625 13.25 z M 24.8125 32.96875 C 26.596301 32.96875 28.03125 34.403699 28.03125 36.1875 C 28.03125 37.971301 26.596301 39.40625 24.8125 39.40625 C 23.028699 39.40625 21.59375 37.971301 21.59375 36.1875 C 21.59375 34.403699 23.028699 32.96875 24.8125 32.96875 z");this.register("trash","m 22.83704,5 c -2.219688,0 -4.069448,1.8498 -4.069448,4.0695 l 0,0.7683 -10.3016789,0 c -2.4744975,0 -4.5247706,2.0503 -4.5247706,4.5248 l 0,1.1383 c 0,2.4745 2.0502731,4.5248 4.5247706,4.5248 l 1.1098496,0 0,18.3552 c 0,2.5298 2.2334483,4.6101 4.9231783,4.6101 l 18.042167,0 c 2.68973,0 4.923178,-2.0803 4.923178,-4.6101 l 0,-18.3552 2.162783,0 c 2.474498,0 4.524771,-2.0503 4.524771,-4.5248 l 0,-1.1383 c 0,-2.4745 -2.050273,-4.5248 -4.524771,-4.5248 l -9.504864,0 0,-0.7683 c 0,-2.2197 -1.849759,-4.0695 -4.069447,-4.0695 l -3.215718,0 z m 0.512238,2.8743 1.96358,0 c 1.045729,0 1.906664,0.8325 1.906664,1.8782 l 0,3.6995 c 3.933365,0.01 7.770635,0.028 12.407547,0.028 0.519514,0 0.882188,0.3627 0.882188,0.8822 l 0,1.1383 c 0,0.5196 -0.362674,0.8822 -0.882188,0.8822 -2.402264,0.1282 -4.712702,0.1729 -5.037008,0.2846 l 0,21.0586 c 0,1.5373 -1.22319,2.7889 -2.760395,2.7889 l -16.53391,0 c -1.537205,0 -2.782608,-1.2516 -2.788852,-2.7889 l -0.08537,-21.2294 c -3.1146968,-0.069 -0.416025,0.056 -3.9556179,-0.1138 -0.5195134,0 -0.882188,-0.3626 -0.882188,-0.8822 l 0,-1.1383 c 0,-0.5195 0.3626746,-0.8822 0.882188,-0.8822 5.0671389,-0.025 9.0192139,-0.032 13.0051589,-0.028 l 0,-3.6995 c 0,-1.0457 0.832477,-1.8782 1.878206,-1.8782 z m -5.890739,14.1434 c -0.573322,0 -1.024476,0.4796 -1.024476,1.053 l 0,13.3751 c 0,0.5733 0.451154,1.0245 1.024476,1.0245 l 0.825273,0 c 0.573322,0 1.052934,-0.4512 1.052934,-1.0245 l 0,-13.3751 c 0,-0.5734 -0.479612,-1.053 -1.052934,-1.053 l -0.825273,0 z m 5.463874,0 c -0.573322,0 -1.024476,0.4796 -1.024476,1.053 l 0,13.3751 c 0,0.5733 0.451154,1.0245 1.024476,1.0245 l 0.825273,0 c 0.573321,0 1.052934,-0.4512 1.052934,-1.0245 l 0,-13.3751 c 0,-0.5734 -0.479613,-1.053 -1.052934,-1.053 l -0.825273,0 z m 5.463874,0 c -0.573322,0 -1.024476,0.4796 -1.024476,1.053 l 0,13.3751 c 0,0.5733 0.451154,1.0245 1.024476,1.0245 l 0.825273,0 c 0.573321,0 1.052934,-0.4512 1.052934,-1.0245 l 0,-13.3751 c 0,-0.5734 -0.479613,-1.053 -1.052934,-1.053 l -0.825273,0 z");this.register("new","M 10.15625 5.65625 L 10.15625 9.65625 L 6.15625 9.65625 L 6.15625 13.65625 L 10.15625 13.65625 L 10.15625 17.65625 L 14.15625 17.65625 L 14.15625 13.65625 L 18.15625 13.65625 L 18.15625 9.65625 L 14.15625 9.65625 L 14.15625 5.65625 L 10.15625 5.65625 z M 22.15625 9.65625 L 22.15625 13.65625 L 35.28125 13.65625 C 35.991645 13.65625 36.5 14.1645 36.5 14.875 L 36.5 36.28125 C 36.5 36.99165 35.991645 37.5 35.28125 37.5 L 15.375 37.5 C 14.664605 37.5 14.15625 36.99165 14.15625 36.28125 L 14.15625 21.78125 L 10.15625 21.78125 L 10.15625 36.28125 C 10.15625 39.13855 12.517793 41.5 15.375 41.5 L 35.28125 41.5 C 38.138457 41.5 40.5 39.13855 40.5 36.28125 L 40.5 14.875 C 40.5 12.0177 38.138457 9.65625 35.28125 9.65625 L 22.15625 9.65625 z");this.register("star","m 23.757651,5 c -0.895163,0.015 -1.74266,0.4185 -2.31531,0.9115 -0.572649,0.493 -0.946681,1.0773 -1.269993,1.663 -0.646625,1.1715 -1.083333,2.481 -1.483178,3.7912 -0.399846,1.3103 -0.765223,2.611 -1.141013,3.6092 -0.375791,0.9982 -0.863354,1.6089 -0.826872,1.5814 0.03648,-0.027 -0.685072,0.2726 -1.748242,0.3583 -1.06317,0.086 -2.414188,0.078 -3.783891,0.1006 -1.3697035,0.023 -2.7488538,0.081 -4.0533165,0.3792 -0.6522312,0.1491 -1.3169807,0.3473 -1.9488982,0.7617 -0.6319175,0.4143 -1.2532513,1.1176 -1.515172,1.9737 -0.2619206,0.8562 -0.1215574,1.7731 0.1703706,2.47 0.2919279,0.697 0.7110554,1.2299 1.168227,1.7184 0.9143429,0.977 2.0261479,1.7874 3.1486997,2.5726 1.1225519,0.7851 2.2542114,1.524 3.0874544,2.1899 0.833242,0.6658 1.270874,1.3422 1.256012,1.299 -0.01486,-0.043 0.0533,0.7481 -0.193748,1.7857 -0.247047,1.0376 -0.682895,2.3074 -1.084578,3.6171 -0.401682,1.3097 -0.782999,2.6265 -0.902518,3.9592 -0.05976,0.6664 -0.06144,1.3623 0.137342,2.0913 0.198782,0.729 0.677406,1.5266 1.410693,2.0402 0.733287,0.5137 1.633944,0.686 2.387015,0.6237 0.753071,-0.062 1.403865,-0.2966 2.009725,-0.5804 1.21172,-0.5677 2.294997,-1.3744 3.388618,-2.1994 1.093621,-0.825 2.163213,-1.6885 3.053976,-2.2752 0.890762,-0.5867 1.655952,-0.8101 1.610285,-0.8093 -0.04567,8e-4 0.735345,0.2228 1.645831,0.7784 0.910486,0.5555 2.002164,1.3506 3.123614,2.1374 1.121449,0.7867 2.247516,1.5467 3.478111,2.0722 0.615298,0.2627 1.273355,0.4794 2.028127,0.5156 0.754772,0.036 1.657048,-0.1634 2.372165,-0.7021 0.715116,-0.5387 1.156065,-1.3508 1.329561,-2.0863 0.173495,-0.7354 0.146882,-1.4277 0.06415,-2.0916 -0.165459,-1.3279 -0.585097,-2.6199 -1.031754,-3.915 -0.446657,-1.295 -0.909557,-2.5637 -1.192279,-3.5922 -0.282722,-1.0284 -0.280534,-1.8404 -0.293896,-1.7967 -0.01336,0.044 0.412582,-0.6301 1.22234,-1.3244 0.809758,-0.6942 1.934952,-1.4839 3.029729,-2.3074 1.094777,-0.8234 2.169097,-1.642 3.049166,-2.6499 0.440034,-0.504 0.844908,-1.0649 1.112601,-1.7715 0.267692,-0.7066 0.350663,-1.6199 0.05934,-2.4664 -0.291321,-0.8466 -0.925793,-1.5268 -1.571637,-1.919 -0.645845,-0.3923 -1.315122,-0.5827 -1.972111,-0.7092 -1.313979,-0.253 -2.684905,-0.2499 -4.054575,-0.2253 -1.36967,0.025 -2.710455,0.093 -3.775949,0.044 -1.065494,-0.049 -1.807185,-0.3328 -1.769776,-0.3066 0.03741,0.026 -0.491907,-0.5811 -0.901934,-1.5658 -0.410028,-0.9846 -0.807845,-2.2763 -1.252686,-3.5719 -0.444841,-1.2957 -0.916948,-2.588 -1.603632,-3.7364 -0.343341,-0.5743 -0.739843,-1.1242 -1.329171,-1.5972 -0.589329,-0.4729 -1.431866,-0.8609 -2.327028,-0.8454 z m 0.04936,4.3522 c 0.05431,0.074 0.08677,0.06 0.149451,0.1649 0.375374,0.6278 0.800845,1.7333 1.223209,2.9635 0.422363,1.2302 0.846512,2.5796 1.362005,3.8175 0.515492,1.2379 1.017518,2.4514 2.291932,3.3441 1.274414,0.8927 2.575612,0.9499 3.915164,1.0114 1.339553,0.062 2.761636,-0.01 4.062098,-0.033 1.300462,-0.023 2.481817,0.024 3.2001,0.1626 0.109478,0.021 0.11064,0.032 0.193553,0.056 -0.05034,0.069 -0.03632,0.075 -0.10848,0.1574 -0.481088,0.551 -1.414422,1.3188 -2.453881,2.1007 -1.039458,0.7818 -2.180578,1.6122 -3.198616,2.485 -1.018038,0.8728 -2.008492,1.7049 -2.463696,3.1928 -0.455204,1.4879 -0.117336,2.7405 0.238105,4.0335 0.355441,1.293 0.845322,2.6325 1.269409,3.8621 0.424088,1.2295 0.770322,2.3592 0.860769,3.0851 0.01369,0.1099 -0.0028,0.1157 4.2e-4,0.2015 -0.08154,-0.027 -0.09172,-0.013 -0.193553,-0.056 -0.672702,-0.2873 -1.662942,-0.9319 -2.727726,-1.6789 -1.064785,-0.7469 -2.217014,-1.5875 -3.361689,-2.286 -1.144675,-0.6985 -2.25533,-1.3689 -3.811076,-1.3421 -1.555745,0.027 -2.628887,0.7492 -3.748765,1.4868 -1.119878,0.7376 -2.232995,1.6052 -3.271356,2.3885 -1.038361,0.7833 -2.033963,1.4685 -2.696346,1.7788 -0.09936,0.046 -0.101178,0.031 -0.18122,0.061 1.62e-4,-0.086 -0.01038,-0.09 -4.2e-4,-0.2015 0.06534,-0.7285 0.345562,-1.8772 0.726948,-3.1207 0.381386,-1.2435 0.841916,-2.5908 1.152507,-3.8953 0.310591,-1.3045 0.61475,-2.5709 0.10845,-4.0422 -0.5063,-1.4713 -1.534069,-2.2887 -2.581632,-3.1259 -1.047564,-0.8371 -2.227509,-1.6172 -3.29334,-2.3627 -1.0658309,-0.7455 -2.0109424,-1.4596 -2.5107659,-1.9936 -0.083457,-0.089 -0.06133,-0.1166 -0.1172617,-0.1892 0.080022,-0.026 0.076516,-0.037 0.18122,-0.061 0.7130816,-0.163 1.9269849,-0.2149 3.2274786,-0.2365 1.300494,-0.022 2.709163,-0.014 4.045793,-0.1212 1.336631,-0.1077 2.631554,-0.2164 3.874389,-1.1526 1.242836,-0.9362 1.70468,-2.1508 2.177128,-3.4058 0.472448,-1.255 0.853548,-2.6111 1.233189,-3.8552 0.379642,-1.244 0.76455,-2.3964 1.118026,-3.0368 0.0519,-0.094 0.06183,-0.087 0.10848,-0.1574 z");this.register("exit","m 20.089945,9 0,21.7148 -1.697743,0 -2.29084,3.9589 0,1.3567 3.988583,0 0,6.4425 24.398557,0 -0.04449,-18.0228 -6.22011,0 -3.143419,-3.1434 -2.86911,4.9672 7.517512,13.026 -2.921005,0 -6.479593,-11.2319 -1.186195,0 -1.779294,6.6502 -9.756458,0 1.623605,-2.8024 5.819772,0 1.386367,-5.1896 3.640137,-6.2943 -4.574267,0 -1.586536,2.7505 -1.749639,-1.0157 2.483597,-4.2999 10.171627,0 3.721689,3.7291 5.849424,0 0.04449,0.01 -0.02966,-12.6033 -24.317006,0 z m 15.123992,1.6903 c 1.497414,0 2.70601,1.216 2.70601,2.7134 0,1.4974 -1.208596,2.7134 -2.70601,2.7134 -1.497413,0 -2.713422,-1.216 -2.713422,-2.7134 0,-1.4974 1.216009,-2.7134 2.713422,-2.7134 z m -25.7256143,6.0051 0,4.7967 -6.4721792,0.1186 0,5.0265 6.3535598,0 0,5.1526 7.6064777,-7.6065 -7.4878583,-7.4879 z");this.register("loading","M 24 2.5 C 22.08477 2.5 20.5 4.0848 20.5 6 C 20.5 7.9152 22.08477 9.5 24 9.5 C 25.91523 9.5 27.5 7.9152 27.5 6 C 27.5 4.0848 25.91523 2.5 24 2.5 z M 11.28125 7.78125 C 10.382381 7.78125 9.4896359 8.1354 8.8125 8.8125 C 7.4582279 10.1668 7.4582281 12.3957 8.8125 13.75 C 10.166772 15.1043 12.395728 15.1043 13.75 13.75 C 15.104272 12.3957 15.104272 10.1668 13.75 8.8125 C 13.072864 8.1354 12.180119 7.78125 11.28125 7.78125 z M 36.71875 7.78125 C 35.819881 7.78125 34.927136 8.1354 34.25 8.8125 C 32.895728 10.1668 32.895728 12.3957 34.25 13.75 C 35.604272 15.1043 37.833228 15.1043 39.1875 13.75 C 40.541772 12.3957 40.541772 10.1668 39.1875 8.8125 C 38.510364 8.1354 37.617619 7.78125 36.71875 7.78125 z M 6 20.5 C 4.08477 20.5 2.5 22.0848 2.5 24 C 2.5 25.9152 4.08477 27.5 6 27.5 C 7.91523 27.5 9.5 25.9152 9.5 24 C 9.5 22.0848 7.91523 20.5 6 20.5 z M 42 20.5 C 40.08477 20.5 38.5 22.0848 38.5 24 C 38.5 25.9152 40.08477 27.5 42 27.5 C 43.91523 27.5 45.5 25.9152 45.5 24 C 45.5 22.0848 43.91523 20.5 42 20.5 z M 11.28125 33.25 C 10.382381 33.25 9.4896359 33.5729 8.8125 34.25 C 7.4582279 35.6043 7.4582281 37.8332 8.8125 39.1875 C 10.166772 40.5418 12.395728 40.5418 13.75 39.1875 C 15.104272 37.8332 15.104272 35.6043 13.75 34.25 C 13.072864 33.5729 12.180119 33.25 11.28125 33.25 z M 36.71875 33.25 C 35.819881 33.25 34.927136 33.5729 34.25 34.25 C 32.895728 35.6043 32.895728 37.8332 34.25 39.1875 C 35.604272 40.5418 37.833228 40.5418 39.1875 39.1875 C 40.541772 37.8332 40.541772 35.6043 39.1875 34.25 C 38.510364 33.5729 37.617619 33.25 36.71875 33.25 z M 24 38.5 C 22.08477 38.5 20.5 40.0848 20.5 42 C 20.5 43.9152 22.08477 45.5 24 45.5 C 25.91523 45.5 27.5 43.9152 27.5 42 C 27.5 40.0848 25.91523 38.5 24 38.5 z");this.register("edit","m 8.9095805,3.1557733 -4.59375,4.59375 L 16.28125,20.09375 20.875,15.5 z M 19.517767,9.65625 l 4.027443,4 11.73604,0 c 0.710395,0 1.21875,0.50825 1.21875,1.21875 l 0,21.40625 C 36.5,36.99165 35.991645,37.5 35.28125,37.5 l -19.90625,0 c -0.710395,0 -1.21875,-0.50835 -1.21875,-1.21875 l 0,-14.5 -4,-4.15625 0,18.65625 c 0,2.8573 2.361543,5.21875 5.21875,5.21875 l 19.90625,0 C 38.138457,41.5 40.5,39.13855 40.5,36.28125 l 0,-21.40625 c 0,-2.8573 -2.361543,-5.21875 -5.21875,-5.21875 z m 1.700983,6.3125 -4.59375,4.59375 4.790179,2.321429 c 0.144661,-0.521597 0.402425,-1.027425 0.8125,-1.4375 0.359131,-0.359131 0.800227,-0.625707 1.25,-0.78125 z M 23.75,21.1875 c 0,0 -0.491533,0.163286 -0.75,0.34375 -0.258467,0.180464 -0.564407,0.503889 -0.75,0.78125 -0.185651,0.277304 -0.375,0.84375 -0.375,0.84375 l 3.03125,1.125 z");this.register("upload","M 21.0625 5.90625 L 21.0625 19.25 L 17.75 15.90625 L 14.40625 19.25 L 24.40625 29.25 L 34.40625 19.25 L 31.0625 15.90625 L 27.75 19.25 L 27.75 5.90625 L 21.0625 5.90625 z M 6.96875 29.25 L 6.96875 39.25 L 41.96875 39.25 L 41.96875 29.25 L 36.96875 29.25 L 36.96875 34.25 L 11.96875 34.25 L 11.96875 29.25 L 6.96875 29.25 z");this.register("lock","m 18,5.3622 c -2.735406,0 -5,2.2646 -5,5 l 0,10 -1,0 c -1.662,0 -3,1.338 -3,3 l 0,17.0938 c 0,1.662 1.338,3 3,3 l 23.90625,0 c 1.662,0 3,-1.338 3,-3 l 0,-17.0938 c 0,-1.662 -1.338,-3 -3,-3 l -0.90625,0 0,-10 c 0,-2.7354 -2.264594,-5 -5,-5 l -12,0 z m 0,4 12,0 c 0.588594,0 1,0.4114 1,1 l 0,10 -14,0 0,-10 c 0,-0.5886 0.411406,-1 1,-1 z m 6.21875,15.2188 c 2.08518,0 3.78125,1.696 3.78125,3.7812 0,1.2414 -0.606288,2.3119 -1.53125,3 l 2.375,7.0625 -8.40625,0 2.21875,-6.625 c -1.299069,-0.5968 -2.21875,-1.9143 -2.21875,-3.4375 0,-2.0852 1.696069,-3.7812 3.78125,-3.7812 z");this.register("savecloud","M 21.9375 3.8125 L 21.9375 17.1875 L 18.625 13.8125 L 15.28125 17.1875 L 25.28125 27.1875 L 35.28125 17.1875 L 31.9375 13.8125 L 28.625 17.1875 L 28.625 3.8125 L 21.9375 3.8125 z M 15.1875 20.28125 C 13.209285 21.36075 11.604359 23.011 10.59375 25.0625 C 6.8454548 26.2652 4.09375 29.6762 4.09375 33.8125 C 4.09375 38.9391 8.2797172 43.125 13.40625 43.125 C 20.743081 43.095 27.938701 43.03125 35.28125 43.03125 C 39.54139 43.03125 43.03125 39.54135 43.03125 35.28125 C 43.03125 31.64315 40.426505 28.72105 37.03125 27.90625 C 36.146814 25.82585 34.408457 24.2103 32.25 23.5625 L 28.15625 27.6875 L 29.09375 27.40625 C 29.429018 27.30195 29.779124 27.25 30.15625 27.25 C 31.886675 27.25 33.262207 28.4157 33.625 30 L 33.96875 31.46875 L 35.46875 31.5625 C 37.488443 31.6695 39.03125 33.23065 39.03125 35.28125 C 39.03125 37.40205 37.40213 39.03125 35.28125 39.03125 C 27.926002 39.03125 20.719684 39.095 13.40625 39.125 C 13.39551 39.125 13.38572 39.1251 13.375 39.125 C 10.404867 39.108 8.09375 36.7874 8.09375 33.8125 C 8.09375 31.1963 9.8983864 29.1112 12.34375 28.625 L 13.4375 28.40625 L 13.8125 27.375 C 14.559974 25.4264 16.147884 23.91675 18.125 23.21875 L 15.1875 20.28125 z");this.register("calendar","M 14.1875 5.5625 C 13.0795 5.5625 12.1875 6.4545 12.1875 7.5625 L 12.1875 10.5625 C 12.1875 11.6705 13.0795 12.5625 14.1875 12.5625 C 15.2955 12.5625 16.1875 11.6705 16.1875 10.5625 L 16.1875 7.5625 C 16.1875 6.4545 15.2955 5.5625 14.1875 5.5625 z M 34.1875 5.5625 C 33.0795 5.5625 32.1875 6.4545 32.1875 7.5625 L 32.1875 10.5625 C 32.1875 11.6705 33.0795 12.5625 34.1875 12.5625 C 35.2955 12.5625 36.1875 11.6705 36.1875 10.5625 L 36.1875 7.5625 C 36.1875 6.4545 35.2955 5.5625 34.1875 5.5625 z M 7.1875 7.5625 C 5.5255 7.5625 4.1875 8.9005 4.1875 10.5625 L 4.1875 39.5625 C 4.1875 41.2245 5.5255 42.5625 7.1875 42.5625 L 41.1875 42.5625 C 42.8495 42.5625 44.1875 41.2245 44.1875 39.5625 L 44.1875 10.5625 C 44.1875 8.9005 42.8495 7.5625 41.1875 7.5625 L 37.1875 7.5625 L 37.1875 10.5625 C 37.1875 12.2245 35.8495 13.5625 34.1875 13.5625 C 32.5255 13.5625 31.1875 12.2245 31.1875 10.5625 L 31.1875 7.5625 L 17.1875 7.5625 L 17.1875 10.5625 C 17.1875 12.2245 15.8495 13.5625 14.1875 13.5625 C 12.5255 13.5625 11.1875 12.2245 11.1875 10.5625 L 11.1875 7.5625 L 7.1875 7.5625 z M 10.8125 16 L 37.3125 16 C 39.184739 16 40.71875 17.53405 40.71875 19.40625 L 40.71875 36.125 C 40.71875 37.9972 39.184739 39.53125 37.3125 39.53125 L 10.8125 39.53125 C 8.9402615 39.53125 7.40625 37.9972 7.40625 36.125 L 7.40625 19.40625 C 7.40625 17.53405 8.9402615 16 10.8125 16 z M 10.8125 18 C 10.013667 18 9.40625 18.60745 9.40625 19.40625 L 9.40625 22.71875 L 17.5 22.71875 L 17.5 18 L 10.8125 18 z M 20 18 L 20 22.71875 L 28.3125 22.71875 L 28.3125 18 L 20 18 z M 30.8125 18 L 30.8125 22.71875 L 38.71875 22.71875 L 38.71875 19.40625 C 38.71875 18.60745 38.111333 18 37.3125 18 L 30.8125 18 z M 9.40625 25.40625 L 9.40625 30.15625 L 17.5 30.15625 L 17.5 25.40625 L 9.40625 25.40625 z M 20 25.40625 L 20 30.15625 L 28.3125 30.15625 L 28.3125 25.40625 L 20 25.40625 z M 30.8125 25.40625 L 30.8125 30.15625 L 38.71875 30.15625 L 38.71875 25.40625 L 30.8125 25.40625 z M 9.40625 32.8125 L 9.40625 36.125 C 9.40625 36.9238 10.013667 37.53125 10.8125 37.53125 L 17.5 37.53125 L 17.5 32.8125 L 9.40625 32.8125 z M 20 32.8125 L 20 37.53125 L 28.3125 37.53125 L 28.3125 32.8125 L 20 32.8125 z M 30.8125 32.8125 L 30.8125 37.53125 L 37.3125 37.53125 C 38.111333 37.53125 38.71875 36.9238 38.71875 36.125 L 38.71875 32.8125 L 30.8125 32.8125 z");this.register("phone","m 40.384499,14.35 c -1.119892,-3.9826 -6.075567,-6.426 -9.848629,-4.5362 -4.937864,1.8134 -9.401496,4.7793 -13.051821,8.5578 -2.728309,2.8266 -5.416044,5.8169 -7.164639,9.3668 -1.9606824,4.1618 -2.6965691,9.234 -0.7883623,13.5432 0.8953303,1.7539 2.2878593,3.5559 4.3483553,3.9039 1.538971,0.022 3.047187,-3.1414 4.749325,-5.6577 1.159581,-1.9264 1.891977,-3.1072 0.219874,-4.4568 -1.532716,-1.0108 -3.627001,-2.4014 -3.109132,-4.5295 0.895495,-3.426 3.681076,-5.8349 5.893522,-8.4361 1.553362,-1.6278 3.28975,-3.3638 5.537441,-3.9042 2.196492,0.034 2.908148,3.5456 5.280678,2.8274 2.909013,-1.2741 4.150319,-1.5616 6.601629,-2.6387 2.101818,-0.6214 2.154604,-2.3569 1.331759,-4.0399 z");this.register("mail","m 3.9898475,12.1511 19.9999995,13.4062 20,-13.4062 -39.9999995,0 z m 0,0.9375 0,24.7812 15.4687495,-12.375 -15.4687495,-12.4062 z m 39.9999995,0 -15.46875,12.4062 15.46875,12.375 0,-24.7812 z m -23.8125,12.9687 -16.1874995,12.0938 0,0.062 39.9999995,0 0,-0.062 -16.21875,-12.0625 -3.78125,3.0312 -3.8125,-3.0625 z");this.register("plus","m 18.928571,4.4336 0,15 -14.9999996,0 0,10 14.9999996,0 0,15 10,0 0,-15 15,0 0,-10 -15,0 0,-15 z");this.register("eye","M 24.15625 10.40625 C 11.735751 10.40625 2.0024346 23.625025 1.59375 24.1875 L 0.90625 25.125 L 1.59375 26.09375 C 2.0024345 26.656226 11.735751 39.875 24.15625 39.875 C 36.576276 39.875 46.31054 26.655751 46.71875 26.09375 L 47.4375 25.125 L 46.71875 24.1875 C 46.31054 23.625025 36.576276 10.40625 24.15625 10.40625 z M 24.15625 13.6875 C 33.120256 13.6875 40.944331 22.21152 43.34375 25.125 C 40.948128 28.038954 33.140667 36.59375 24.15625 36.59375 C 15.193194 36.59375 7.3984708 28.038005 5 25.125 C 7.3946735 22.210571 15.171835 13.6875 24.15625 13.6875 z M 24.8125 15.1875 C 19.396945 15.1875 15 19.557753 15 24.9375 C 15 30.318383 19.396945 34.6875 24.8125 34.6875 C 30.229761 34.6875 34.625 30.318383 34.625 24.9375 C 34.625 23.144819 34.101438 21.474944 33.25 20.03125 C 33.134618 22.135405 31.391099 23.8125 29.25 23.8125 C 27.035579 23.8125 25.25 22.01328 25.25 19.8125 C 25.25 17.87204 26.649913 16.261489 28.5 15.90625 C 27.361528 15.448132 26.115803 15.1875 24.8125 15.1875 z");this.register("map","M 32 5 L 16 13 L 16 45 L 32 37 L 32 5 z M 35 5 L 35 37 L 47 45 L 47 13 L 35 5 z M 1 6 L 1 38 L 13 45 L 13 13 L 1 6 z M 24.625 12.625 L 26.3125 14.3125 L 28 12.625 L 29.6875 14.3125 L 28 16 L 29.6875 17.6875 L 28 19.375 L 26.3125 17.6875 L 24.625 19.375 L 22.9375 17.6875 L 24.625 16 L 22.9375 14.3125 L 24.625 12.625 z")},getNames:function(){var b=[];for(var a in Ui.Icon.icons){b.push(a)}return b},register:function(b,a){if(Ui.Icon.icons[b]!=undefined){throw ("Icon '"+b+"' is already registered. To change it, use override")}Ui.Icon.icons[b]=a},override:function(b,a){Ui.Icon.icons[b]=a},parse:function(a){return new Ui.Icon({icon:a})}});Ui.LBox.extend("Ui.ButtonGraphic",{allcontent:undefined,contentBox:undefined,content:undefined,text:undefined,textBox:undefined,text1:undefined,text2:undefined,icon:undefined,iconBox:undefined,icon1:undefined,icon2:undefined,iconSize:24,orientation:"vertical",rect1:undefined,rect2:undefined,lightShadow:undefined,darkShadow:undefined,isDown:false,isEnable:true,color:undefined,radius:4,spacing:3,constructor:function(a){this.setPadding(3);this.color=new Ui.Color({r:0.31,g:0.66,b:1});this.lightShadow=new Ui.Rectangle({fill:new Ui.Color({r:1,g:1,b:1,a:0.2}),radius:4,marginTop:1});this.append(this.lightShadow);this.darkShadow=new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.4}),radius:4,marginBottom:1});this.append(this.darkShadow);this.allcontent=new Ui.LBox();this.append(this.allcontent);this.rect2=new Ui.Rectangle({radius:4,marginTop:1,marginBottom:2,marginLeft:1,marginRight:1});this.allcontent.append(this.rect2);this.rect1=new Ui.Rectangle({radius:3,marginTop:2,marginBottom:2,marginLeft:1,marginRight:1});this.allcontent.append(this.rect1);this.contentBox=new Ui.Box({verticalAlign:"center",horizontalAlign:"center"});this.allcontent.append(this.contentBox);this.iconBox=new Ui.LBox({verticalAlign:"center",horizontalAlign:"center"});this.contentBox.append(this.iconBox);this.updateColors()},setIconSize:function(a){this.iconSize=a;if(this.icon1!=undefined){this.icon1.setWidth(a);this.icon1.setHeight(a);this.icon2.setWidth(a);this.icon2.setHeight(a)}},getContent:function(){return this.content},getText:function(){return this.text},setText:function(a){if(this.text!=a){this.text=a;if(this.text===undefined){if(this.textBox!=undefined){this.contentBox.remove(this.textBox);this.textBox=undefined;this.text1=undefined;this.text2=undefined}}else{if(this.textBox===undefined){this.textBox=new Ui.LBox({verticalAlign:"center",horizontalAlign:"center",height:24});this.contentBox.append(this.textBox);this.text1=new Ui.Label({text:this.text,color:this.getContentLightColor(),verticalAlign:"center"});this.text2=new Ui.Label({text:this.text,color:this.getContentColor(),verticalAlign:"center"});this.textBox.append(this.text1);this.textBox.append(this.text2)}else{this.text1.setText(this.text);this.text2.setText(this.text)}}this.updateSizes()}},getIcon:function(){return this.icon},setIcon:function(a){if(a===undefined){if(this.icon!=undefined){this.iconBox.remove(this.icon1);this.iconBox.remove(this.icon2);this.icon1=undefined;this.icon2=undefined;this.icon=undefined}if(this.content!=undefined){this.iconBox.remove(this.content);this.content=undefined}}else{if(typeof(a)=="string"){if(this.content!=undefined){this.iconBox.remove(this.content);this.content=undefined}if(this.icon!=a){this.icon=a;if(this.icon1!=undefined){this.iconBox.remove(this.icon1)}if(this.icon2!=undefined){this.iconBox.remove(this.icon2)}this.icon1=new Ui.Icon({icon:a,width:this.iconSize,height:this.iconSize,fill:this.getContentLightColor()});this.icon2=new Ui.Icon({icon:a,width:this.iconSize,height:this.iconSize,fill:this.getContentColor()});this.iconBox.append(this.icon1);this.iconBox.append(this.icon2)}}else{if(this.icon1!=undefined){this.iconBox.remove(this.icon1)}if(this.icon2!=undefined){this.iconBox.remove(this.icon2)}this.icon1=undefined;this.icon2=undefined;this.icon=undefined;if(this.content!=a){if(this.content!=undefined){this.iconBox.remove(this.content)}this.content=a;this.iconBox.append(this.content)}}}this.updateSizes()},getOrientation:function(){return this.orientation},setOrientation:function(a){if(this.orientation!=a){this.orientation=a;this.contentBox.setOrientation(this.orientation);this.updateSizes()}},getIsDown:function(){return this.isDown},setIsDown:function(a){if(this.isDown!=a){this.isDown=a;this.updateColors()}},getIsEnable:function(){return this.isEnable},setIsEnable:function(a){if(this.isEnable!=a){this.isEnable=a;if(this.isEnable){this.contentBox.setOpacity(1)}else{this.contentBox.setOpacity(0.2)}}},setRadius:function(a){if(this.radius!=a){this.radius=a;this.lightShadow.setRadius(this.radius);this.darkShadow.setRadius(this.radius);this.rect2.setRadius(this.radius);this.rect1.setRadius(this.radius-1)}},setSpacing:function(a){if(this.spacing!=a){this.spacing=a;this.updateSizes()}},setColor:function(a){if(this.color!=a){this.color=Ui.Color.create(a);this.updateColors()}},updateSizes:function(){var a=this.spacing;if(this.orientation=="vertical"){if(this.text!=undefined){if(this.icon!=undefined){this.textBox.setMarginLeft(a+2);this.textBox.setMarginRight(a+2);this.textBox.setMarginTop(a);this.textBox.setMarginBottom(a+1);this.text1.setMargin(0);this.text1.setMarginTop(2);this.text2.setMargin(1);this.text1.setFontWeight("normal");this.text2.setFontWeight("normal");this.iconBox.setMarginLeft(a+2);this.iconBox.setMarginRight(a+2);this.iconBox.setMarginTop(a+1);this.iconBox.setMarginBottom(0);this.icon1.setMarginTop(2);this.icon1.setMarginBottom(0);this.icon2.setMarginTop(1);this.icon2.setMarginBottom(1)}else{if(this.content!=undefined){this.textBox.setMarginLeft(a+2);this.textBox.setMarginRight(a+2);this.textBox.setMarginTop(a+1);this.textBox.setMarginBottom(a+1);this.text1.setMargin(0);this.text1.setMarginTop(2);this.text2.setMargin(1);this.text1.setFontWeight("normal");this.text2.setFontWeight("normal");this.iconBox.setMarginLeft(a+2);this.iconBox.setMarginRight(a+2);this.iconBox.setMarginTop(a+2);this.iconBox.setMarginBottom(0)}else{this.textBox.setMarginLeft(a+4);this.textBox.setMarginRight(a+4);this.textBox.setMarginTop(a+1);this.textBox.setMarginBottom(a+1);this.text1.setMargin(0);this.text1.setMarginTop(2);this.text2.setMargin(1);this.text1.setFontWeight("bold");this.text2.setFontWeight("bold");this.iconBox.setMargin(0)}}}else{if(this.icon!=undefined){this.iconBox.setMarginLeft(a+2);this.iconBox.setMarginRight(a+2);this.iconBox.setMarginTop(a+1);this.iconBox.setMarginBottom(a+1);this.icon1.setMarginTop(2);this.icon1.setMarginBottom(0);this.icon2.setMarginTop(1);this.icon2.setMarginBottom(1)}else{if(this.content!=undefined){this.iconBox.setMargin(a+2)}}}}else{if(this.text!=undefined){if(this.icon!=undefined){this.textBox.setMarginLeft(a+2);this.textBox.setMarginRight(a+2);this.textBox.setMarginTop(a+1);this.textBox.setMarginBottom(a+1);this.text1.setMargin(0);this.text1.setMarginTop(2);this.text2.setMargin(1);this.text1.setFontWeight("bold");this.text2.setFontWeight("bold");this.iconBox.setMarginLeft(a+2);this.iconBox.setMarginRight(0);this.iconBox.setMarginTop(a+1);this.iconBox.setMarginBottom(a+1);this.icon1.setMarginTop(2);this.icon1.setMarginBottom(0);this.icon2.setMarginTop(1);this.icon2.setMarginBottom(1)}else{if(this.content!=undefined){this.textBox.setMarginLeft(a+2);this.textBox.setMarginRight(a+2);this.textBox.setMarginTop(a+1);this.textBox.setMarginBottom(a+1);this.text1.setMargin(0);this.text1.setMarginTop(2);this.text2.setMargin(1);this.text1.setFontWeight("bold");this.text2.setFontWeight("bold");this.iconBox.setMarginLeft(a+2);this.iconBox.setMarginRight(0);this.iconBox.setMarginTop(a+2);this.iconBox.setMarginBottom(0)}else{this.textBox.setMarginLeft(a+4);this.textBox.setMarginRight(a+4);this.textBox.setMarginTop(a+1);this.textBox.setMarginBottom(a+1);this.text1.setMargin(0);this.text1.setMarginTop(2);this.text2.setMargin(1);this.text1.setFontWeight("bold");this.text2.setFontWeight("bold");this.iconBox.setMargin(0)}}}else{if(this.icon!=undefined){this.iconBox.setMarginLeft(a+2);this.iconBox.setMarginRight(a+2);this.iconBox.setMarginTop(a+1);this.iconBox.setMarginBottom(a+1);this.icon1.setMarginTop(2);this.icon1.setMarginBottom(0);this.icon2.setMarginTop(1);this.icon2.setMarginBottom(1)}else{if(this.content!=undefined){this.iconBox.setMargin(a+2)}}}}},getGradient:function(){var b=this.color.getYuv();var a=0;if(this.getIsDown()){a=-0.2}return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:b.y+0.1+a,u:b.u,v:b.v})},{offset:1,color:new Ui.Color({y:b.y-0.1+a,u:b.u,v:b.v})}]})},getContentColor:function(){var b=this.color.getYuv();var a=0;if(this.getIsDown()){a=0.2}if(b.y<0.4){return new Ui.Color({y:b.y+(0.6+a),u:b.u,v:b.v})}else{return new Ui.Color({y:b.y-(0.6+a),u:b.u,v:b.v})}},getContentLightColor:function(){var b=this.color.getYuv();var a=0;if(this.getIsDown()){a=-0.2}if(b.y<0.4){return new Ui.Color({y:b.y+0.1+a,u:b.u,v:b.v})}else{return new Ui.Color({y:b.y+0.1+a,u:b.u,v:b.v})}},getLightColor:function(){var b=this.color.getYuv();var a=0;if(this.getIsDown()){a=-0.3}if(b.y<0.4){return new Ui.Color({y:b.y-0.2+a,u:b.u,v:b.v})}else{return new Ui.Color({y:b.y+0.3+a,u:b.u,v:b.v})}},updateColors:function(){this.rect1.setFill(this.getGradient());if(this.icon1!=undefined){this.icon1.setFill(this.getContentLightColor())}if(this.text1!=undefined){this.text1.setColor(this.getContentLightColor())}if(this.icon2!=undefined){this.icon2.setFill(this.getContentColor())}if(this.text2!=undefined){this.text2.setColor(this.getContentColor())}this.rect2.setFill(this.getLightColor())}},{setContent:function(a){this.content=Ui.Element.create(a);this.contentBox.setContent(this.content)}});Ui.Element.extend("Ui.Label",{text:"",orientation:"horizontal",fontSize:undefined,fontFamily:undefined,fontWeight:undefined,color:undefined,labelDrawing:undefined,textMeasureValid:false,textWidth:0,textHeight:0,constructor:function(a){this.setSelectable(false)},getText:function(){return this.text},setText:function(a){if(this.text!=a){this.text=a;if("textContent" in this.labelDrawing){this.labelDrawing.textContent=this.text}else{this.labelDrawing.innerText=this.text}this.textMeasureValid=false;this.invalidateMeasure()}},setFontSize:function(a){if(this.fontSize!=a){this.fontSize=a;this.labelDrawing.style.fontSize=this.getFontSize()+"px";this.textMeasureValid=false;this.invalidateMeasure()}},getFontSize:function(){if(this.fontSize!=undefined){return this.fontSize}else{return this.getStyleProperty("fontSize")}},setFontFamily:function(a){if(this.fontFamily!=a){this.fontFamily=a;this.labelDrawing.style.fontFamily=this.getFontFamily();this.textMeasureValid=false;this.invalidateMeasure()}},getFontFamily:function(){if(this.fontFamily!=undefined){return this.fontFamily}else{return this.getStyleProperty("fontFamily")}},setFontWeight:function(a){if(this.fontWeight!=a){this.fontWeight=a;this.labelDrawing.style.fontWeight=this.getFontWeight();this.textMeasureValid=false;this.invalidateMeasure()}},getFontWeight:function(){if(this.fontWeight!=undefined){return this.fontWeight}else{return this.getStyleProperty("fontWeight")}},setColor:function(a){if(this.color!=a){this.color=Ui.Color.create(a);if(navigator.supportRgba){this.labelDrawing.style.color=this.getColor().getCssRgba()}else{this.labelDrawing.style.color=this.getColor().getCssHtml()}}},getColor:function(){if(this.color!=undefined){return this.color}else{return Ui.Color.create(this.getStyleProperty("color"))}},getOrientation:function(){return this.orientation},setOrientation:function(a){if(this.orientation!=a){this.orientation=a;this.invalidateMeasure()}}},{verticalAlign:"center",horizontalAlign:"center",onStyleChange:function(){this.labelDrawing.style.fontSize=this.getFontSize()+"px";this.labelDrawing.style.fontFamily=this.getFontFamily();this.labelDrawing.style.fontWeight=this.getFontWeight();if(navigator.supportRgba){this.labelDrawing.style.color=this.getColor().getCssRgba()}else{this.labelDrawing.style.color=this.getColor().getCssHtml()}this.textMeasureValid=false;this.invalidateMeasure()},render:function(){this.labelDrawing=document.createElement("div");this.labelDrawing.style.whiteSpace="nowrap";this.labelDrawing.style.display="inline";this.labelDrawing.style.position="absolute";this.labelDrawing.style.left="0px";this.labelDrawing.style.top="0px";return this.labelDrawing},measureCore:function(c,a){if(!this.textMeasureValid){this.textMeasureValid=true;var b=Ui.Label.measureText(this.text,this.getFontSize(),this.getFontFamily(),this.getFontWeight());this.textWidth=b.width;this.textHeight=b.height}if(this.orientation=="vertical"){return{width:this.textHeight,height:this.textWidth}}else{return{width:this.textWidth,height:this.textHeight}}},arrangeCore:function(c,a){var b;if(this.orientation=="vertical"){b=Ui.Matrix.createTranslate(this.labelDrawing.offsetHeight,0);b.rotate(90);if(navigator.isIE){this.labelDrawing.style.msTransform=b.toString();this.labelDrawing.style.msTransformOrigin="0% 0%"}else{if(navigator.isGecko){this.labelDrawing.style.MozTransform="matrix("+b.svgMatrix.a.toFixed(4)+", "+b.svgMatrix.b.toFixed(4)+", "+b.svgMatrix.c.toFixed(4)+", "+b.svgMatrix.d.toFixed(4)+", "+b.svgMatrix.e.toFixed(0)+"px, "+b.svgMatrix.f.toFixed(0)+"px)";this.labelDrawing.style.MozTransformOrigin="0% 0%"}else{if(navigator.isWebkit){this.labelDrawing.style.webkitTransform=b.toString();this.labelDrawing.style.webkitTransformOrigin="0% 0%"}else{if(navigator.isOpera){this.labelDrawing.style.OTransform=b.toString();this.labelDrawing.style.OTransformOrigin="0% 0%"}}}}}else{if(navigator.isIE&&("removeProperty" in this.labelDrawing)){this.labelDrawing.style.removeProperty("-ms-transform")}else{if(navigator.isGecko){this.labelDrawing.style.removeProperty("-moz-transform")}else{if(navigator.isWebkit){this.labelDrawing.style.removeProperty("-webkit-transform")}else{if(navigator.isOpera){this.labelDrawing.style.removeProperty("-o-transform")}}}}}},onCumulOpacityChange:function(a){if(navigator.isIE){if(a<1){this.labelDrawing.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+(Math.round(a*100))+")"}else{this.labelDrawing.style.filter=""}}}},{measureBox:undefined,measureContext:undefined,measureTextCanvas:function(d,c,a,b){if(Ui.Label.measureBox===undefined){this.createMeasureCanvas()}Ui.Label.measureContext.font=b+" "+c+"px "+a;return{width:Ui.Label.measureContext.measureText(d).width,height:c}},createMeasureCanvas:function(){var b=window;if(navigator.isIE||navigator.isGecko){b=Ui.App.getRootWindow()}if(b.document.body===undefined){var a=b.document.createElement("body");b.document.body=a}Ui.Label.measureBox=b.document.createElement("canvas");Ui.Label.measureBox.style.visibility="hidden";b.document.body.appendChild(Ui.Label.measureBox);Ui.Label.measureContext=Ui.Label.measureBox.getContext("2d")},measureTextHtml:function(d,c,a,b){if(Ui.Label.measureBox===undefined){this.createMeasureHtml()}Ui.Label.measureBox.style.fontSize=c+"px";Ui.Label.measureBox.style.fontFamily=a;Ui.Label.measureBox.style.fontWeight=b;Ui.Label.measureBox.style.fontWeight=b;if("textContent" in Ui.Label.measureBox){Ui.Label.measureBox.textContent=d}else{Ui.Label.measureBox.innerText=d}return{width:Ui.Label.measureBox.offsetWidth,height:Ui.Label.measureBox.offsetHeight}},createMeasureHtml:function(){var b=window;if(navigator.isIE||navigator.isGecko){b=Ui.App.getRootWindow()}if(b.document.body===undefined){var a=b.document.createElement("body");b.document.body=a}Ui.Label.measureBox=b.document.createElement("div");Ui.Label.measureBox.style.whiteSpace="nowrap";Ui.Label.measureBox.style.display="inline";Ui.Label.measureBox.style.visibility="hidden";b.document.body.appendChild(Ui.Label.measureBox)},measureText:function(d,c,a,b){if((d==="")||(d===undefined)){return{width:0,height:0}}if(navigator.supportCanvas){return Ui.Label.measureTextCanvas(d,c,a,b)}else{return Ui.Label.measureTextHtml(d,c,a,b)}},style:{color:new Ui.Color({r:0,g:0,b:0}),fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal"}});Ui.Element.extend("Ui.Text",{text:"",fontSize:undefined,fontFamily:undefined,fontWeight:undefined,color:undefined,textAlign:undefined,interLine:1,measureDrawing:undefined,textDrawing:undefined,line:undefined,word:undefined,words:undefined,flowRender:false,offsetX:0,offsetY:0,spaceWidth:undefined,maxWidth:undefined,maxLineWidth:0,lineHeight:undefined,textMeasureValid:false,lineCount:0,constructor:function(a){this.setSelectable(false);this.words=[]},getText:function(){return this.text},setText:function(a){if(this.text!=a){this.text=a;this.splitText();this.textMeasureValid=false;this.invalidateMeasure()}},getTextAlign:function(){if(this.textAlign!==undefined){return this.textAlign}else{return this.getStyleProperty("textAlign")}},setTextAlign:function(a){if(this.textAlign!=a){this.textAlign=a;this.invalidateMeasure()}},setFontSize:function(a){if(this.fontSize!=a){this.fontSize=a;this.textDrawing.style.fontSize=this.getFontSize()+"px";this.textMeasureValid=false;this.invalidateMeasure()}},getFontSize:function(){if(this.fontSize!==undefined){return this.fontSize}else{return this.getStyleProperty("fontSize")}},setFontFamily:function(a){if(this.fontFamily!=a){this.fontFamily=a;this.textDrawing.style.fontFamily=this.getFontFamily();this.textMeasureValid=false;this.invalidateMeasure()}},getFontFamily:function(){if(this.fontFamily!==undefined){return this.fontFamily}else{return this.getStyleProperty("fontFamily")}},setFontWeight:function(a){if(this.fontWeight!=a){this.fontWeight=a;this.textDrawing.style.fontWeight=this.getFontWeight();this.textMeasureValid=false;this.invalidateMeasure()}},getFontWeight:function(){if(this.fontWeight!==undefined){return this.fontWeight}else{return this.getStyleProperty("fontWeight")}},setInterLine:function(a){if(this.interLine!=a){this.interLine=a;this.invalidateMeasure()}},getInterLine:function(){if(this.interLine!==undefined){return this.interLine}else{return this.getStyleProperty("interLine")}},setColor:function(a){if(this.color!=a){this.color=Ui.Color.create(a);if(navigator.supportRgba){this.textDrawing.style.color=this.color.getCssRgba()}else{this.textDrawing.style.color=this.color.getCssHtml()}}},getColor:function(){if(this.color!==undefined){return this.color}else{return Ui.Color.create(this.getStyleProperty("color"))}},addWord:function(b){if(b.size>this.maxWidth){this.maxWidth=b.size}var a=this.offsetX+b.size;if(this.line!=""){a+=this.spaceWidth}if(a>this.maxWidth){this.flushLine(this.offsetX)}if(this.line!=""){this.line+=" ";this.offsetX+=this.spaceWidth}this.line+=b.word;this.offsetX+=b.size},newLine:function(){this.flushLine(this.offsetX)},flushLine:function(a){if(this.flowRender&&(this.line!="")){var b=document.createElement("div");b.style.whiteSpace="nowrap";b.style.display="inline";b.style.position="absolute";var c=this.getTextAlign();if(c=="left"){b.style.left="0px"}else{if(c=="right"){b.style.left=(this.maxWidth-a)+"px"}else{b.style.left=((this.maxWidth-a)/2)+"px"}}b.style.top=this.offsetY+"px";if("textContent" in b){b.textContent=this.line}else{b.innerText=this.line}this.textDrawing.appendChild(b)}if(this.offsetX>this.maxLineWidth){this.maxLineWidth=this.offsetX}this.offsetX=0;this.offsetY+=this.lineHeight*this.getInterLine();this.line="";this.lineCount++},updateFlow:function(d,c){this.flowRender=c;this.maxWidth=d;this.maxLineWidth=0;this.lineCount=0;this.lineHeight=this.getFontSize();this.offsetX=0;this.offsetY=0;this.line="";var a=0;var f="";var b=0;for(b=0;b<this.words.length;b++){var f=this.words[b];if(f.type=="word"){this.addWord(f)}else{if(f.type=="newline"){this.newLine()}}}},splitText:function(){var a="";var b=[];for(i=0;i<this.text.length;i++){if((this.text.charAt(i)==" ")||(this.text.charAt(i)=="\n")){if(a!=""){b.push({type:"word",word:a});a=""}if(this.text.charAt(i)=="\n"){b.push({type:"newline"})}}else{a+=this.text.charAt(i)}}if(a!=""){b.push({type:"word",word:a})}b.push({type:"newline"});this.words=b},updateMeasure:function(){if(!this.textMeasureValid){this.spaceWidth=Ui.Label.measureText(". .",this.getFontSize(),this.getFontFamily(),this.getFontWeight()).width;this.spaceWidth-=Ui.Label.measureText("..",this.getFontSize(),this.getFontFamily(),this.getFontWeight()).width;for(var a=0;a<this.words.length;a++){var b=this.words[a];if(b.type=="word"){b.size=Ui.Label.measureText(b.word,this.getFontSize(),this.getFontFamily(),this.getFontWeight()).width}}this.textMeasureValid=true}}},{onStyleChange:function(){this.textDrawing.style.fontSize=this.getFontSize()+"px";this.textDrawing.style.fontFamily=this.getFontFamily();this.textDrawing.style.fontWeight=this.getFontWeight();if(navigator.supportRgba){this.textDrawing.style.color=this.getColor().getCssRgba()}else{this.textDrawing.style.color=this.getColor().getCssHtml()}this.textMeasureValid=false;this.invalidateMeasure()},render:function(){this.textDrawing=document.createElement("div");this.textDrawing.style.position="absolute";this.textDrawing.style.left="0px";this.textDrawing.style.top="0px";return this.textDrawing},measureCore:function(b,a){if(this.getWidth()!=undefined){b=this.getWidth()}this.updateMeasure();this.updateFlow(b,false);if(this.getWidth()==undefined){return{width:this.maxLineWidth,height:this.offsetY}}else{return{width:this.maxWidth,height:this.offsetY}}},arrangeCore:function(b,a){while(this.textDrawing.hasChildNodes()){this.textDrawing.removeChild(this.textDrawing.firstChild)}this.updateFlow(b,true)}},{style:{color:new Ui.Color({r:0,g:0,b:0}),fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal",textAlign:"left",interLine:1}});Ui.Element.extend("Ui.CompactLabel",{text:"",fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal",color:undefined,textDrawing:undefined,maxLine:undefined,textAlign:"left",isMeasureValid:false,isArrangeValid:false,lastMeasureWidth:0,lastMeasureHeight:0,superCompact:false,constructor:function(a){this.setColor("black")},getSuperCompact:function(){return this.superCompact},setSuperCompact:function(a){if(a!=this.superCompact){this.superCompact=a;this.invalidateMeasure()}},getMaxLine:function(){return this.maxLine},setMaxLine:function(a){if(this.maxLine!=a){this.maxLine=a;this.isMeasureValid=false;this.invalidateMeasure()}},getTextAlign:function(){return this.textAlign},setTextAlign:function(a){if(this.textAlign!=a){this.textAlign=a;this.isMeasureValid=false;this.invalidateArrange()}},getText:function(){return this.text},setText:function(a){if(this.text!=a){this.text=a;this.isMeasureValid=false;this.invalidateMeasure()}},setFontSize:function(a){if(this.fontSize!=a){this.fontSize=a;this.isMeasureValid=false;this.textDrawing.style.fontSize=this.getFontSize()+"px";this.invalidateMeasure()}},getFontSize:function(){return this.fontSize},setFontFamily:function(a){if(this.fontFamily!=a){this.fontFamily=a;this.isMeasureValid=false;this.textDrawing.style.fontFamily=this.getFontFamily();this.invalidateMeasure()}},getFontFamily:function(){return this.fontFamily},setFontWeight:function(a){if(this.fontWeight!=a){this.fontWeight=a;this.isMeasureValid=false;this.textDrawing.style.fontWeight=this.getFontWeight();this.invalidateMeasure()}},getFontWeight:function(){return this.fontWeight},setColor:function(a){if(this.color!=a){this.color=Ui.Color.create(a);if(navigator.supportRgba){this.textDrawing.style.color=this.color.getCssRgba()}else{this.textDrawing.style.color=this.color.getCssHtml()}}},getColor:function(){return this.color},flushLine:function(h,b,f,d){var c=Ui.Label.measureText(b,this.fontSize,this.fontFamily,this.fontWeight);if(d){var a;if(this.textAlign=="left"){a=0}else{if(this.textAlign=="right"){a=f-c.width}else{a=(f-c.width)/2}}var g=document.createElement("div");g.style.whiteSpace="nowrap";g.style.display="inline";g.style.position="absolute";g.style.left=a+"px";g.style.top=h+"px";if("textContent" in g){g.textContent=b}else{g.innerText=b}this.textDrawing.appendChild(g)}return c.height},updateFlow:function(g,f){if(this.text===undefined){return 0}var h=(Ui.Label.measureText("...",this.fontSize,this.fontFamily,this.fontWeight)).width;var j=0;var b="";var a=0;for(var d=0;d<this.text.length;d++){var c=Ui.Label.measureText(b+this.text.charAt(d),this.fontSize,this.fontFamily,this.fontWeight);if((this.maxLine!=undefined)&&(a+1>=this.maxLine)&&(c.width+h>g)){j+=this.flushLine(j,b+"...",g,f);return j}else{if(c.width>g){j+=this.flushLine(j,b,g,f);a++;b=this.text.charAt(d)}else{b+=this.text.charAt(d)}}}if(b!=""){j+=this.flushLine(j,b,g,f)}return j},updateFlowWords:function(d,f){if(this.text===undefined){return 0}var o=(Ui.Label.measureText("...",this.fontSize,this.fontFamily,this.fontWeight)).width;var m=[];var j=[];var c=this.text.split(" ");for(var h=0;h<c.length;h++){var b=c[h];while(true){var l=(Ui.Label.measureText(b,this.fontSize,this.fontFamily,this.fontWeight)).width;if(l<d){m.push(b);j.push(l);break}else{var a="";for(var g=0;g<b.length;g++){if((Ui.Label.measureText(a+b.charAt(g),this.fontSize,this.fontFamily,this.fontWeight)).width<d){a+=b.charAt(g)}else{m.push(a);j.push((Ui.Label.measureText(a,this.fontSize,this.fontFamily,this.fontWeight)).width);b=b.substr(a.length,b.length-a.length);break}}}if(b.length==0){break}}}var r=(Ui.Label.measureText(". .",this.fontSize,this.fontFamily,this.fontWeight)).width-(Ui.Label.measureText("..",this.fontSize,this.fontFamily,this.fontWeight)).width;var n=0;var p=0;var s="";var q=0;for(var h=0;h<m.length;h++){if(s!=""){if(p+r>d){if((this.maxLine!=undefined)&&(q+1>=this.maxLine)){var k;while(true){k=(Ui.Label.measureText(s,this.fontSize,this.fontFamily,this.fontWeight)).width;if(k+o>d){if(s.length<=1){s="...";break}s=s.substr(0,s.length-1)}else{s+="...";break}}n+=this.flushLine(n,s,d,f);return n}n+=this.flushLine(n,s,d,f);p=0;q++;s=""}else{s+=" ";p+=r}}if(p+j[h]>d){if((this.maxLine!=undefined)&&(q+1>=this.maxLine)){var k;while(true){k=(Ui.Label.measureText(s,this.fontSize,this.fontFamily,this.fontWeight)).width;if(k+o>d){if(s.length<=1){s="...";break}s=s.substr(0,s.length-1)}else{s+="...";break}}n+=this.flushLine(n,s,d,f);return n}n+=this.flushLine(n,s,d,f);q++;p=j[h];s=m[h]}else{s+=m[h];p+=j[h]}}if(s!=""){n+=this.flushLine(n,s,d,f)}return n}},{render:function(){this.textDrawing=document.createElement("div");this.textDrawing.style.fontFamily=this.fontFamily;this.textDrawing.style.fontWeight=this.fontWeight;this.textDrawing.style.fontSize=this.fontSize+"px";this.textDrawing.style.color=this.color;this.textDrawing.style.position="absolute";this.textDrawing.style.left="0px";this.textDrawing.style.top="0px";return this.textDrawing},measureCore:function(b,a){if(this.getWidth()!=undefined){b=this.getWidth()}if(!this.isMeasureValid||(this.lastMeasureWidth!=b)){this.lastMeasureWidth=b;var c;if(this.superCompact){c=this.updateFlow(b,false)}else{c=this.updateFlowWords(b,false)}this.lastMeasureHeight=c;this.isMeasureValid=true;this.isArrangeValid=false}return{width:this.lastMeasureWidth,height:this.lastMeasureHeight}},arrangeCore:function(b,a){if(!this.isArrangeValid){this.isArrangeValid=true;while(this.textDrawing.hasChildNodes()){this.textDrawing.removeChild(this.textDrawing.firstChild)}if(this.superCompact){this.updateFlow(b,true)}else{this.updateFlowWords(b,true)}}}});Ui.Element.extend("Ui.Html",{htmlDrawing:undefined,html:undefined,constructor:function(a){},getHtml:function(){return this.htmlDrawing.innerHTML},setHtml:function(a){this.htmlDrawing.innerHTML=a;this.html=this.htmlDrawing.innerHTML;this.invalidateMeasure()},onSubtreeModified:function(a){this.html=this.htmlDrawing.innerHTML;this.invalidateMeasure()},onKeyPress:function(a){if(this.htmlDrawing.innerHTML!=this.html){this.html=this.htmlDrawing.innerHTML;this.invalidateMeasure()}}},{render:function(){this.htmlDrawing=document.createElement("div");this.htmlDrawing.style.display="block";this.htmlDrawing.style.position="absolute";this.htmlDrawing.style.left="0px";this.htmlDrawing.style.top="0px";this.connect(this.htmlDrawing,"DOMSubtreeModified",this.onSubtreeModified);this.connect(this.htmlDrawing,"keypress",this.onKeyPress);return this.htmlDrawing},measureCore:function(c,b){var f=document.createElement("div");f.style.display="block";f.style.visibility="hidden";f.style.position="absolute";f.style.left="0px";f.style.top="0px";f.innerHTML=this.htmlDrawing.innerHTML;document.body.appendChild(f);var d=f.clientWidth;var a=f.clientHeight;document.body.removeChild(f);return{width:d,height:a}},arrangeCore:function(b,a){this.htmlDrawing.style.width=b+"px";this.htmlDrawing.style.height=a+"px"}});Ui.Element.extend("Ui.ContentEditable",{html:undefined,screenX:0,screenY:0,startTime:undefined,allowSelect:false,timer:undefined,hasHtmlFocus:false,constructor:function(a){this.setSelectable(true);this.setFocusable(true);this.getDrawing().setAttribute("contenteditable","true");this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"focus",this.onHtmlFocus);this.connect(this.getDrawing(),"blur",this.onHtmlBlur);this.connect(this.getDrawing(),"keypress",this.onHtmlKeyPress);this.connect(this.getDrawing(),"touchstart",this.onTouchStart)},getHtml:function(){return this.getDrawing().innerHTML},setHtml:function(a){this.getDrawing().innerHTML=a;this.html=this.getDrawing().innerHTML;this.invalidateMeasure()},onSubtreeModified:function(a){this.html=this.getDrawing().innerHTML;this.invalidateMeasure()},onKeyPress:function(a){if(this.getDrawing().innerHTML!=this.html){this.html=this.getDrawing().innerHTML;this.invalidateMeasure()}},onTouchStart:function(a){if(a.targetTouches.length==1){a.stopPropagation();this.connect(this.getDrawing(),"touchmove",this.onTouchMove,true);this.connect(this.getDrawing(),"touchend",this.onTouchEnd,true);if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.timer=new Core.DelayedTask({delay:0.25,scope:this,callback:this.onTimer})}},onTouchMove:function(a){if(!this.allowSelect){if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.disconnect(this.getDrawing(),"touchmove",this.onTouchMove,true);this.disconnect(this.getDrawing(),"touchend",this.onTouchEnd,true)}else{if(this.hasHtmlFocus){a.stopPropagation()}}},onTouchEnd:function(a){a.stopPropagation();if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.disconnect(this.getDrawing(),"touchmove",this.onTouchMove,true);this.disconnect(this.getDrawing(),"touchend",this.onTouchEnd,true);this.allowSelect=false},onHtmlKeyPress:function(a){},onHtmlFocus:function(a){this.hasHtmlFocus=true;this.setSelectable(true);if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.timer=new Core.DelayedTask({delay:0.25,scope:this,callback:this.onTimer})},onHtmlBlur:function(a){this.hasHtmlFocus=false;if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.allowSelect=false},onTimer:function(a){this.allowSelect=true;this.timer=undefined},onMouseDown:function(b){this.setSelectable(true);b.stopPropagation();if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.allowSelect=false;this.timer=new Core.DelayedTask({delay:0.25,scope:this,callback:this.onTimer});this.screenX=b.screenX;this.screenY=b.screenY;var a=(new Date().getTime())/1000;this.startTime=a;this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true)},onMouseMove:function(f){if(!this.allowSelect){var b=f.screenX-this.screenX;var a=f.screenY-this.screenY;var g=Math.sqrt(b*b+a*a);f.stopPropagation();f.preventDefault();if(g>10){if(this.timer!=undefined){this.timer.abort();this.timer=undefined}var d=window.getSelection();d.removeAllRanges();this.setSelectable(false);this.disconnect(window,"mousemove",this.onMouseMove,true);this.disconnect(window,"mouseup",this.onMouseUp,true);var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,0,f.target);this.getDrawing().offsetParent.dispatchEvent(c)}}else{f.stopPropagation()}},onMouseUp:function(a){if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.disconnect(window,"mousemove",this.onMouseMove,true);this.disconnect(window,"mouseup",this.onMouseUp,true)},onHtmlSelectStart:function(a){a.stopPropagation()}},{renderDrawing:function(){var a=document.createElement("div");a.style.display="block";a.style.position="absolute";a.style.left="0px";a.style.top="0px";this.connect(a,"DOMSubtreeModified",this.onSubtreeModified);this.connect(a,"keypress",this.onKeyPress);return a},measureCore:function(c,b){var f=document.createElement("div");f.style.display="block";f.style.visibility="hidden";f.style.position="absolute";f.style.left="0px";f.style.top="0px";if(this.getWidth()!=undefined){f.style.width=this.getWidth()+"px"}f.innerHTML=this.getDrawing().innerHTML;document.body.appendChild(f);var d=f.clientWidth;var a=f.clientHeight;document.body.removeChild(f);return{width:d,height:a}}});Ui.Element.extend("Ui.Image",{src:undefined,loaddone:false,naturalWidth:undefined,naturalHeight:undefined,imageDrawing:undefined,setSrcLock:false,constructor:function(a){this.addEvents("ready","error");this.connect(this.imageDrawing,"load",this.onImageLoad);this.connect(this.imageDrawing,"error",this.onImageError)},getSrc:function(){return this.src},setSrc:function(a){if(a==undefined){throw ("Image src cant be undefined")}this.setSrcLock=true;this.loaddone=false;this.naturalWidth=undefined;this.naturalHeight=undefined;this.src=a;this.imageDrawing.setAttribute("src",a);this.setSrcLock=false},getNaturalWidth:function(){return this.naturalWidth},getNaturalHeight:function(){return this.naturalHeight},getIsReady:function(){return this.loaddone},onImageError:function(a){this.fireEvent("error",this)},onImageLoad:function(a){if((a.target!=undefined)&&(a.target.naturalWidth!=undefined)&&(a.target.naturalHeight!=undefined)){this.loaddone=true;this.naturalWidth=a.target.naturalWidth;this.naturalHeight=a.target.naturalHeight;this.fireEvent("ready",this);this.invalidateMeasure()}else{if(this.setSrcLock){new Core.DelayedTask({delay:0,scope:this,callback:this.onImageDelayReady})}else{this.onImageDelayReady()}}},onAppReady:function(){this.disconnect(Ui.App.current,"ready",this.onAppReady);this.onImageDelayReady()},onImageDelayReady:function(){if(!Ui.App.current.getIsReady()){this.connect(Ui.App.current,"ready",this.onAppReady)}else{this.loaddone=true;if(document.body===undefined){var a=document.createElement("body");document.body=a}var b=document.createElement("img");b.setAttribute("src",this.src);document.body.appendChild(b);this.naturalWidth=b.width;this.naturalHeight=b.height;document.body.removeChild(b);this.fireEvent("ready",this);this.invalidateMeasure()}}},{render:function(){this.imageDrawing=document.createElement("img");this.imageDrawing.style.position="absolute";this.imageDrawing.style.top="0px";this.imageDrawing.style.left="0px";this.imageDrawing.style.width="0px";this.imageDrawing.style.height="0px";this.imageDrawing.setAttribute("draggable",false);if(navigator.isWebkit){this.imageDrawing.style.webkitUserSelect="none"}else{if(navigator.isGecko){this.imageDrawing.style.MozUserSelect="none"}else{if(navigator.isIE){this.connect(this.imageDrawing,"selectstart",function(a){a.preventDefault()});if("attachEvent" in this.imageDrawing){this.imageDrawing.attachEvent("ondragstart",function(a){a.defaultPrevented=true;a.returnValue=false;return false})}}else{if(navigator.isOpera){this.imageDrawing.onmousedown=function(a){a.preventDefault()}}}}}return this.imageDrawing},measureCore:function(d,a){if(!this.loaddone){return{width:0,height:0}}var c;if(this.getWidth()===undefined){if(this.getHeight()===undefined){c={width:this.naturalWidth,height:this.naturalHeight}}else{var b=this.getHeight()-(this.getMarginTop()+this.getMarginBottom());c={width:(this.naturalWidth*b)/this.naturalHeight,height:b}}}else{if(this.getHeight()===undefined){var f=this.getWidth()-(this.getMarginLeft()+this.getMarginRight());c={width:f,height:(this.naturalHeight*f)/this.naturalWidth}}else{c={width:0,height:0}}}return c},arrangeCore:function(b,a){if(this.imageDrawing!=undefined){this.imageDrawing.style.width=b+"px";this.imageDrawing.style.height=a+"px"}}});Ui.Element.extend("Ui.Audio",{src:undefined,oggSrc:undefined,mp3Src:undefined,wavSrc:undefined,loaddone:false,audioDrawing:undefined,playing:false,paused:false,constructor:function(a){this.addEvents("ready","ended","timeupdate");this.connect(this,"unload",this.onAudioUnload);if((a.oggSrc!=undefined)||(a.mp3Src!=undefined)||(a.wavSrc!=undefined)){if((a.oggSrc!=undefined)&&(Ui.Audio.supportOgg)){this.setSrc(a.oggSrc)}else{if((a.mp3Src!=undefined)&&(Ui.Audio.supportMp3)){this.setSrc(a.mp3Src)}else{if((a.wavSrc!=undefined)&&(Ui.Audio.supportWav)){this.setSrc(a.wavSrc)}}}delete (a.oggSrc);delete (a.mp3Src);delete (a.wavSrc)}},setSrc:function(a){this.loaddone=false;this.src=a;if(Ui.Audio.htmlAudio){this.audioDrawing.setAttribute("src",a)}},play:function(){if(Ui.Audio.htmlAudio){if(!this.canplaythrough){try{this.audioDrawing.load()}catch(a){}}else{try{this.audioDrawing.play()}catch(a){}}}this.playing=true;this.paused=false},pause:function(){if(!this.playing||this.paused){return}this.paused=true;if(Ui.Audio.htmlAudio){this.audioDrawing.pause()}},stop:function(){if(!this.playing){return}if(!this.paused){this.paused=false;this.audioDrawing.pause()}this.playing=false;if(Ui.Audio.htmlAudio){this.audioDrawing.currentTime=0}this.onEnded()},resume:function(){if(!this.playing||!this.paused){return}this.paused=false;if(Ui.Audio.htmlAudio){this.audioDrawing.play()}},setVolume:function(a){if(Ui.Audio.htmlAudio){this.audioDrawing.volume=a}},getVolume:function(){if(Ui.Audio.htmlAudio){return this.audioDrawing.volume}return 1},getDuration:function(){return this.audioDrawing.duration},onReady:function(){this.fireEvent("ready");this.canplaythrough=true;if(this.playing&&!this.paused){this.audioDrawing.play()}},onTimeupdate:function(){this.checkBuffering();this.fireEvent("timeupdate",this.audioDrawing.currentTime)},onEnded:function(){this.playing=false;this.paused=false;this.fireEvent("ended")},onWaiting:function(){if(this.playing&&!this.paused){this.audioDrawing.pause()}},getCurrentBufferSize:function(){var d=this.audioDrawing.buffered;var c=0;var f=this.audioDrawing.currentTime;for(var b=0;b<d.length;b++){var g=d.start(b);var a=d.end(b);if((g<=f)&&(a>=f)){c=a-f;break}}return c},checkBuffering:function(){if(this.playing&&!this.paused){var a=this.getCurrentBufferSize();var c=this.audioDrawing.currentTime;var b=this.audioDrawing.duration;if(c>=b){return}if(this.audioDrawing.paused){if((a>5)||(c+a>=b)){this.audioDrawing.play()}}else{if((a<1)&&(c+a<b)){this.audioDrawing.pause()}}}},onAudioUnload:function(){this.playing=false;this.paused=false;this.audioDrawing.pause()}},{verticalAlign:"top",horizontalAlign:"left",render:function(){var a;if(Ui.Audio.htmlAudio){this.audioDrawing=document.createElement("audio");this.audioDrawing.style.display="none";this.connect(this.audioDrawing,"canplaythrough",this.onReady);this.connect(this.audioDrawing,"ended",this.onEnded);this.connect(this.audioDrawing,"timeupdate",this.onTimeupdate);this.connect(this.audioDrawing,"progress",this.checkBuffering);this.connect(this.audioDrawing,"waiting",this.onWaiting);this.audioDrawing.setAttribute("preload","auto");this.audioDrawing.load();a=this.audioDrawing}return a}});Ui.Audio.htmlAudio=false;Ui.Audio.flashAudio=false;Ui.Audio.supportOgg=false;Ui.Audio.supportMp3=false;Ui.Audio.supportWav=false;Ui.Audio.audioTest=document.createElement("audio");if(Ui.Audio.audioTest.play!=undefined){Ui.Audio.htmlAudio=true;Ui.Audio.supportWav=!!Ui.Audio.audioTest.canPlayType&&""!=Ui.Audio.audioTest.canPlayType("audio/wav");Ui.Audio.supportMp3=!!Ui.Audio.audioTest.canPlayType&&""!=Ui.Audio.audioTest.canPlayType("audio/mpeg");Ui.Audio.supportOgg=!!Ui.Audio.audioTest.canPlayType&&""!=Ui.Audio.audioTest.canPlayType('audio/ogg; codecs="vorbis"')}Ui.Audio.audioTest=undefined;Ui.Element.extend("Ui.Video",{src:undefined,oggSrc:undefined,mp3Src:undefined,webmSrc:undefined,loaddone:false,videoDrawing:undefined,playing:false,paused:false,naturalWidth:undefined,naturalHeight:undefined,canplaythrough:false,constructor:function(a){this.addEvents("ready","ended","timeupdate");this.connect(this,"unload",this.onVideoUnload);if((a.oggSrc!=undefined)||(a.mp4Src!=undefined)||(a.webmSrc!=undefined)){if((a.oggSrc!=undefined)&&(Ui.Video.supportOgg)){this.setSrc(a.oggSrc)}else{if((a.mp4Src!=undefined)&&(Ui.Video.supportMp4)){this.setSrc(a.mp4Src)}else{if((a.webmSrc!=undefined)&&(Ui.Video.supportWebm)){this.setSrc(a.webmSrc)}}}delete (a.oggSrc);delete (a.mp4Src);delete (a.webmSrc)}},setSrc:function(a){this.loaddone=false;this.src=a;if(Ui.Video.htmlVideo){this.videoDrawing.setAttribute("src",a)}},play:function(){if(Ui.Video.htmlVideo){if(!this.canplaythrough){try{this.videoDrawing.load()}catch(a){}}else{try{this.videoDrawing.play()}catch(a){}}}this.playing=true;this.paused=false},pause:function(){if(!this.playing||this.paused){return}this.paused=true;if(Ui.Video.htmlVideo){this.videoDrawing.pause()}},stop:function(){if(!this.playing){return}if(!this.paused){this.paused=false;this.videoDrawing.pause()}this.playing=false;if(Ui.Video.htmlVideo){this.videoDrawing.currentTime=0}this.onEnded()},resume:function(){if(!this.playing||!this.paused){return}this.paused=false;if(Ui.Video.htmlVideo){this.videoDrawing.play()}},setVolume:function(a){if(Ui.Video.htmlVideo){this.videoDrawing.volume=a}},getVolume:function(){if(Ui.Video.htmlVideo){return this.videoDrawing.volume}return 1},getDuration:function(){return this.videoDrawing.duration},getNaturalWidth:function(){return this.naturalWidth},getNaturalHeight:function(){return this.naturalHeight},onReady:function(){this.naturalWidth=this.videoDrawing.videoWidth;this.naturalHeight=this.videoDrawing.videoHeight;this.fireEvent("ready");this.canplaythrough=true;if(this.playing&&!this.paused){this.videoDrawing.play()}},onTimeupdate:function(){this.checkBuffering();this.fireEvent("timeupdate",this.videoDrawing.currentTime)},onEnded:function(){this.playing=false;this.paused=false;this.fireEvent("ended")},onWaiting:function(){if(this.playing&&!this.paused){this.videoDrawing.pause()}},getCurrentBufferSize:function(){var d=this.videoDrawing.buffered;var c=0;var f=this.videoDrawing.currentTime;for(var b=0;b<d.length;b++){var g=d.start(b);var a=d.end(b);if((g<=f)&&(a>=f)){c=a-f;break}}return c},checkBuffering:function(){if(this.playing&&!this.paused){var a=this.getCurrentBufferSize();var c=this.videoDrawing.currentTime;var b=this.videoDrawing.duration;if(c>=b){return}if(this.videoDrawing.paused){if((a>5)||(c+a>=b)){this.videoDrawing.play()}}else{if((a<1)&&(c+a<b)){this.videoDrawing.pause()}}}},onVideoUnload:function(){this.playing=false;this.paused=false;this.videoDrawing.pause()}},{render:function(){var a;if(Ui.Video.htmlVideo){this.videoDrawing=document.createElement("video");this.connect(this.videoDrawing,"canplaythrough",this.onReady);this.connect(this.videoDrawing,"ended",this.onEnded);this.connect(this.videoDrawing,"timeupdate",this.onTimeupdate);this.connect(this.videoDrawing,"progress",this.checkBuffering);this.connect(this.videoDrawing,"waiting",this.onWaiting);this.videoDrawing.setAttribute("preload","auto");this.videoDrawing.load();this.videoDrawing.style.position="absolute";this.videoDrawing.style.left="0px";this.videoDrawing.style.top="0px";a=this.videoDrawing}return a},arrangeCore:function(b,a){if(Ui.Video.htmlVideo){this.videoDrawing.setAttribute("width",b);this.videoDrawing.setAttribute("height",a)}}});Ui.Video.htmlVideo=false;Ui.Video.flashVideo=false;Ui.Video.supportOgg=false;Ui.Video.supportMp4=false;Ui.Video.supportWebm=false;Ui.Video.videoTest=document.createElement("video");if(Ui.Video.videoTest.play!=undefined){Ui.Video.htmlVideo=true;Ui.Video.supportMp4=!!Ui.Video.videoTest.canPlayType&&""!=Ui.Video.videoTest.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');Ui.Video.supportOgg=!!Ui.Video.videoTest.canPlayType&&""!=Ui.Video.videoTest.canPlayType('video/ogg; codecs="theora, vorbis"');Ui.Video.supportWebm=!!Ui.Video.videoTest.canPlayType&&""!=Ui.Video.videoTest.canPlayType('video/webm; codecs="vp8, vorbis"')}Ui.Video.videoTest=undefined;Ui.LBox.extend("Ui.Pressable",{isDown:false,lock:false,constructor:function(a){this.getDrawing().style.cursor="pointer";this.setFocusable(true);this.setRole("button");this.addEvents("press","down","up");this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"fingerdown",this.onFingerDown);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.connect(this.getDrawing(),"keyup",this.onKeyUp)},getIsDown:function(){return this.isDown},setLock:function(a){this.lock=a;if(a){this.getDrawing().style.cursor=""}else{this.getDrawing().style.cursor="pointer"}},getLock:function(){return this.lock},onMouseDown:function(a){if((a.button!=0)||this.getIsDisabled()||this.lock){return}a.preventDefault();a.stopPropagation();this.mouseStartX=a.screenX;this.mouseStartY=a.screenY;this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true);this.onDown()},onMouseMove:function(d){var b=d.screenX-this.mouseStartX;var a=d.screenY-this.mouseStartY;var f=Math.sqrt(b*b+a*a);d.preventDefault();d.stopPropagation();if(f>10){this.onUp();if("createEvent" in document){var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,d.target);this.getDrawing().offsetParent.dispatchEvent(c)}}},onMouseUp:function(a){if(!this.isDown){return}a.preventDefault();a.stopPropagation();if(a.button==0){this.onUp();this.fireEvent("press",this);this.focus()}},onFingerDown:function(a){if(this.getIsDisabled()||this.isDown||this.lock){return}this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);a.finger.capture(this.getDrawing());a.preventDefault();a.stopPropagation();this.touchStartX=a.finger.getX();this.touchStartY=a.finger.getY();this.onDown()},onFingerMove:function(c){c.preventDefault();c.stopPropagation();var b=c.finger.getX()-this.touchStartX;var a=c.finger.getY()-this.touchStartY;var d=Math.sqrt(b*b+a*a);if(d>10){this.disconnect(c.finger,"fingermove",this.onFingerMove);this.disconnect(c.finger,"fingerup",this.onFingerUp);this.onUp();c.finger.release()}},onFingerUp:function(a){this.disconnect(a.finger,"fingermove",this.onFingerMove);this.disconnect(a.finger,"fingerup",this.onFingerUp);a.preventDefault();a.stopPropagation();this.onUp();this.fireEvent("press",this);this.focus()},onKeyDown:function(b){var a=b.which;if((a==13)&&!this.getIsDisabled()&&!this.lock){b.preventDefault();b.stopPropagation();this.onDown()}},onKeyUp:function(b){var a=b.which;if((a==13)&&!this.getIsDisabled()&&!this.lock){b.preventDefault();b.stopPropagation();this.onUp();this.fireEvent("press",this)}},onDown:function(){this.isDown=true;this.fireEvent("down",this)},onUp:function(){this.disconnect(window,"mousemove",this.onMouseMove,true);this.disconnect(window,"mouseup",this.onMouseUp,true);this.isDown=false;this.fireEvent("up",this)}},{onDisable:function(){Ui.Pressable.base.onDisable.call(this);this.getDrawing().style.cursor=""},onEnable:function(){Ui.Pressable.base.onEnable.call(this);if(this.lock){this.getDrawing().style.cursor=""}else{this.getDrawing().style.cursor="pointer"}}});Ui.LBox.extend("Ui.Togglable",{isDown:false,isToggled:false,constructor:function(a){this.getDrawing().style.cursor="pointer";this.setFocusable(true);this.setRole("button");this.addEvents("down","up","toggle","untoggle");this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"fingerdown",this.onFingerDown);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.connect(this.getDrawing(),"keyup",this.onKeyUp)},onMouseDown:function(a){if((a.button!=0)||this.getIsDisabled()){return}a.preventDefault();a.stopPropagation();this.mouseStartX=a.screenX;this.mouseStartY=a.screenY;this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true);this.onDown()},onMouseMove:function(d){var b=d.screenX-this.mouseStartX;var a=d.screenY-this.mouseStartY;var f=Math.sqrt(b*b+a*a);d.preventDefault();d.stopPropagation();if(f>10){this.onUp();this.disconnect(this.getDrawing(),"mousedown",this.onMouseDown);var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,d.target);d.target.dispatchEvent(c);this.connect(this.getDrawing(),"mousedown",this.onMouseDown)}},getIsDown:function(){return this.isDown},getIsToggled:function(){return this.isToggled},onMouseUp:function(a){if(!this.isDown){return}a.preventDefault();a.stopPropagation();if(a.button==0){this.onUp();if(!this.isToggled){this.onToggle()}else{this.onUntoggle()}}},onFingerDown:function(a){if(this.getIsDisabled()||this.isDown){return}this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);a.finger.capture(this.getDrawing());a.preventDefault();a.stopPropagation();this.touchStartX=a.finger.getX();this.touchStartY=a.finger.getY();this.onDown()},onFingerMove:function(c){c.preventDefault();c.stopPropagation();var b=c.finger.getX()-this.touchStartX;var a=c.finger.getY()-this.touchStartY;var d=Math.sqrt(b*b+a*a);if(d>10){this.disconnect(c.finger,"fingermove",this.onFingerMove);this.disconnect(c.finger,"fingerup",this.onFingerUp);this.onUp();c.finger.release()}},onFingerUp:function(a){this.disconnect(a.finger,"fingermove",this.onFingerMove);this.disconnect(a.finger,"fingerup",this.onFingerUp);a.preventDefault();a.stopPropagation();this.onUp();if(!this.isToggled){this.onToggle()}else{this.onUntoggle()}},onKeyDown:function(b){var a=b.which;if((a==13)&&!this.getIsDisabled()){b.preventDefault();b.stopPropagation();this.onDown()}},onKeyUp:function(b){var a=b.which;if((a==13)&&!this.getIsDisabled()){b.preventDefault();b.stopPropagation();this.onUp();if(!this.isToggled){this.onToggle()}else{this.onUntoggle()}}},onDown:function(){this.isDown=true;this.focus();this.fireEvent("down",this)},onUp:function(){this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);this.isDown=false;this.fireEvent("up",this)},onToggle:function(){if(!this.isToggled){this.isToggled=true;this.fireEvent("toggle",this)}},onUntoggle:function(){if(this.isToggled){this.isToggled=false;this.fireEvent("untoggle",this)}},toggle:function(){this.onToggle()},untoggle:function(){this.onUntoggle()}});Ui.LBox.extend("Ui.Selectable",{isDown:false,isSelected:false,lastTime:undefined,button:undefined,menuTimer:undefined,menuPosX:undefined,menuPosY:undefined,constructor:function(a){this.setFocusable(true);this.addEvents("down","up","select","unselect","activate","menu");this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"fingerdown",this.onFingerDown);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.connect(this.getDrawing(),"keyup",this.onKeyUp)},onKeyDown:function(a){console.log(this+".onKeyDown key: "+a.which);if(((a.which==13)||(a.which==32))&&!this.getIsDisabled()){a.preventDefault();a.stopPropagation();this.onDown()}},onKeyUp:function(a){if(((a.which==13)||(a.which==32))&&!this.getIsDisabled()){a.preventDefault();a.stopPropagation();this.onUp();this.onSelect();if(a.which==13){this.fireEvent("activate",this)}}},onMouseDown:function(a){if(this.getIsDisabled()){return}if((a.button!=0)&&(a.button!=2)){return}this.button=a.button;a.preventDefault();a.stopPropagation();this.mouseStartX=a.screenX;this.mouseStartY=a.screenY;this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true);this.onDown()},onMouseMove:function(d){var b=d.screenX-this.mouseStartX;var a=d.screenY-this.mouseStartY;var f=Math.sqrt(b*b+a*a);if(f>10){this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);this.disconnect(this.getDrawing(),"mousedown",this.onMouseDown);this.onUp();var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,d.target);d.target.dispatchEvent(c);this.connect(this.getDrawing(),"mousedown",this.onMouseDown)}d.preventDefault();d.stopPropagation()},onMouseUp:function(b){if(!this.isDown){return}b.preventDefault();b.stopPropagation();if(this.button!=b.button){return}this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);this.onUp();if(b.button==0){var a=(new Date().getTime())/1000;if((this.isSelected)&&(this.lastTime!=undefined)&&(a-this.lastTime<0.25)){this.fireEvent("activate",this)}this.lastTime=a;this.onSelect()}else{if(b.button==2){this.fireEvent("menu",this,b.clientX,b.clientY)}}},onFingerDown:function(a){if(this.getIsDisabled()||this.isDown){return}this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);a.finger.capture(this.getDrawing());a.preventDefault();a.stopPropagation();this.touchStartX=a.finger.getX();this.touchStartY=a.finger.getY();this.onDown();if(this.menuTimer!=undefined){this.menuTimer.abort()}this.menuTimer=new Core.DelayedTask({delay:0.5,scope:this,callback:this.onMenuTimer});this.menuPosX=a.finger.getX();this.menuPosY=a.finger.getY()},onFingerMove:function(c){c.preventDefault();c.stopPropagation();var b=c.finger.getX()-this.touchStartX;var a=c.finger.getY()-this.touchStartY;var d=Math.sqrt(b*b+a*a);if(d>10){this.onUp();if(this.menuTimer!=undefined){this.menuTimer.abort();this.menuTimer=undefined}this.disconnect(c.finger,"fingermove",this.onFingerMove);this.disconnect(c.finger,"fingerup",this.onFingerUp);this.onUp();this.disconnect(this.getDrawing(),"fingerdown",this.onFingerDown);c.finger.release();this.connect(this.getDrawing(),"fingerdown",this.onFingerDown)}},onFingerUp:function(b){b.preventDefault();b.stopPropagation();this.onUp();this.disconnect(b.finger,"fingermove",this.onFingerMove);this.disconnect(b.finger,"fingerup",this.onFingerUp);if(this.menuTimer!=undefined){this.menuTimer.abort();this.menuTimer=undefined;var a=(new Date().getTime())/1000;if((this.isSelected)&&(this.lastTime!=undefined)&&(a-this.lastTime<0.25)){this.fireEvent("activate",this)}this.lastTime=a;this.onSelect()}},onMenuTimer:function(){this.fireEvent("menu",this,this.menuPosX,this.menuPosY);this.menuTimer=undefined},getIsSelected:function(){return this.isSelected},select:function(){this.onSelect()},unselect:function(){this.onUnselect()},onDown:function(){if(!this.isDown){this.focus();this.isDown=true;this.fireEvent("down",this)}},onUp:function(){if(this.isDown){this.isDown=false;this.fireEvent("up",this)}},onSelect:function(){if(!this.isSelected){this.isSelected=true;this.fireEvent("select",this)}},onUnselect:function(){if(this.isSelected){this.isSelected=false;this.fireEvent("unselect",this)}}},{});Ui.LBox.extend("Ui.Linkable",{link:undefined,isDown:false,mouseStartX:undefined,mouseStartY:undefined,openWindow:true,target:undefined,constructor:function(a){this.addEvents("down","up","link");this.getDrawing().style.cursor="pointer";this.setFocusable(true);this.setRole("button");this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"fingerdown",this.onFingerDown);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.connect(this.getDrawing(),"keyup",this.onKeyUp)},setSrc:function(a){this.link=a},setOpenWindow:function(a){this.openWindow=a},setTarget:function(a){this.target=a},getIsDown:function(){return this.isDown},onMouseDown:function(a){if((a.button!=0)||this.getIsDisabled()){return}a.preventDefault();a.stopPropagation();this.mouseStartX=a.screenX;this.mouseStartY=a.screenY;this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true);this.onDown()},onMouseMove:function(d){var b=d.screenX-this.mouseStartX;var a=d.screenY-this.mouseStartY;var f=Math.sqrt(b*b+a*a);d.preventDefault();d.stopPropagation();if(f>10){this.disconnect(window,"mousemove",this.onMouseMove,true);this.disconnect(window,"mouseup",this.onMouseUp,true);this.onUp();if("createEvent" in document){this.disconnect(this.getDrawing(),"mousedown",this.onMouseDown);var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,d.target);d.target.dispatchEvent(c);this.connect(this.getDrawing(),"mousedown",this.onMouseDown)}}},onMouseUp:function(a){if(!this.isDown){return}a.preventDefault();a.stopPropagation();if(a.button==0){this.disconnect(window,"mousemove",this.onMouseMove,true);this.disconnect(window,"mouseup",this.onMouseUp,true);this.onUp();this.fireEvent("link",this);this.focus();if(this.openWindow){window.open(this.link,this.target)}else{window.location=this.link}}},onFingerDown:function(a){if(this.getIsDisabled()||this.isDown){return}this.getDrawing().setAttribute("href",this.link);this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);a.finger.capture(this.getDrawing());a.preventDefault();a.stopPropagation();this.touchStartX=a.finger.getX();this.touchStartY=a.finger.getY();this.onDown()},onFingerMove:function(c){c.preventDefault();c.stopPropagation();var b=c.finger.getX()-this.touchStartX;var a=c.finger.getY()-this.touchStartY;var d=Math.sqrt(b*b+a*a);if(d>10){this.disconnect(c.finger,"fingermove",this.onFingerMove);this.disconnect(c.finger,"fingerup",this.onFingerUp);this.onUp();this.disconnect(this.getDrawing(),"fingerdown",this.onFingerDown);c.finger.release();this.connect(this.getDrawing(),"fingerdown",this.onFingerDown)}},onFingerUp:function(a){this.disconnect(a.finger,"fingermove",this.onFingerMove);this.disconnect(a.finger,"fingerup",this.onFingerUp);a.preventDefault();a.stopPropagation();this.onUp();this.fireEvent("link",this);this.focus();if(this.openWindow){window.open(this.link,this.target)}else{window.location=this.link}},onKeyDown:function(b){var a=b.which;if((a==13)&&!this.getIsDisabled()){b.preventDefault();b.stopPropagation();this.onDown()}},onKeyUp:function(b){var a=b.which;if((a==13)&&!this.getIsDisabled()){b.preventDefault();b.stopPropagation();this.onUp();this.fireEvent("link",this);if(this.openWindow){window.open(this.link,this.target)}else{window.location=this.link}}},onDown:function(){this.isDown=true;this.focus();this.fireEvent("down",this)},onUp:function(){this.disconnect(window,"mousemove",this.onMouseMove,true);this.disconnect(window,"mouseup",this.onMouseUp,true);this.isDown=false;this.fireEvent("up",this)}});Ui.LBox.extend("Ui.Uploadable",{isDown:false,content:undefined,input:undefined,constructor:function(a){this.getDrawing().style.cursor="pointer";this.setFocusable(true);this.setRole("button");this.addEvents("file","down","up");if(navigator.isOpera||navigator.isFirefox3||navigator.isIE7||navigator.isIE8){this.input=new Ui.UploadableWrapper()}else{this.input=new Ui.UploadableFileWrapper()}this.append(this.input);this.connect(this.input,"file",this.onFile);this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"touchstart",this.onTouchStart);this.connect(this.getDrawing(),"touchmove",this.onTouchMove);this.connect(this.getDrawing(),"touchend",this.onTouchEnd);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.connect(this.getDrawing(),"keyup",this.onKeyUp)},setDirectoryMode:function(a){this.input.setDirectoryMode(a)},onMouseDown:function(a){if((a.button!=0)||this.getIsDisabled()){return}a.preventDefault();a.stopPropagation();this.mouseStartX=a.screenX;this.mouseStartY=a.screenY;if("attachEvent" in this.getDrawing()){this.connect(this.getDrawing(),"mousemove",this.onMouseMove,true);this.connect(this.getDrawing(),"mouseup",this.onMouseUp,true)}else{this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true)}this.onDown()},onMouseMove:function(d){var b=d.screenX-this.mouseStartX;var a=d.screenY-this.mouseStartY;var f=Math.sqrt(b*b+a*a);d.preventDefault();d.stopPropagation();if(f>10){this.onUp();if("createEvent" in document){this.disconnect(this.getDrawing(),"mousedown",this.onMouseDown);var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,d.target);d.target.dispatchEvent(c);this.connect(this.getDrawing(),"mousedown",this.onMouseDown)}}},getIsDown:function(){return this.isDown},onMouseUp:function(a){if(!this.isDown){return}a.preventDefault();a.stopPropagation();if(a.button==0){this.onUp();this.onPress()}},onTouchStart:function(a){if(this.getIsDisabled()){return}if(this.isDown){this.onUp();return}if(a.targetTouches.length!=1){return}a.preventDefault();a.stopPropagation();this.touchStartX=a.targetTouches[0].screenX;this.touchStartY=a.targetTouches[0].screenY;this.onDown()},onTouchMove:function(d){if(!this.isDown){return}var c=d.targetTouches[0].screenX-this.touchStartX;var a=d.targetTouches[0].screenY-this.touchStartY;var f=Math.sqrt(c*c+a*a);if(f>10){this.onUp();this.disconnect(this.getDrawing(),"touchstart",this.onTouchStart);var b=document.createEvent("TouchEvent");b.initTouchEvent("touchstart",true,true,window,0,0,0,0,0,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,d.touches,d.targetTouches,d.changedTouches,d.scale,d.rotation);d.target.dispatchEvent(b);this.connect(this.getDrawing(),"touchstart",this.onTouchStart)}d.preventDefault();d.stopPropagation()},onTouchEnd:function(a){if(!this.isDown){return}a.preventDefault();a.stopPropagation();this.onUp();this.onPress();this.focus()},onKeyDown:function(b){var a=b.which;if((a==13)&&!this.getIsDisabled()){b.preventDefault();b.stopPropagation();this.onDown()}},onKeyUp:function(b){var a=b.which;if((a==13)&&!this.getIsDisabled()){b.preventDefault();b.stopPropagation();this.onUp();this.onPress()}},onDown:function(){this.isDown=true;this.focus();this.fireEvent("down",this)},onUp:function(){if("attachEvent" in this.getDrawing()){this.disconnect(this.getDrawing(),"mousemove",this.onMouseMove);this.disconnect(this.getDrawing(),"mouseup",this.onMouseUp)}else{this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp)}this.isDown=false;this.fireEvent("up",this)},onPress:function(){if(Ui.UploadableFileWrapper.hasInstance(this.input)){this.input.select()}},onFile:function(a,b){this.fireEvent("file",this,b)}},{setContent:function(a){a=Ui.Element.create(a);if(this.content!=a){if(this.content!=undefined){this.remove(this.content)}if(a!=undefined){if(Ui.UploadableWrapper.hasInstance(this.input)){this.prepend(a)}else{this.append(a)}}this.content=a}}});Ui.Element.extend("Ui.UploadableFileWrapper",{formDrawing:undefined,inputDrawing:undefined,iframeDrawing:undefined,directoryMode:false,constructor:function(a){this.setVerticalAlign("top");this.setHorizontalAlign("left");this.setClipToBounds(true);this.addEvents("file")},select:function(){this.inputDrawing.click()},setDirectoryMode:function(a){this.directoryMode=a;if(this.inputDrawing!=undefined){if(this.directoryMode){this.inputDrawing.setAttribute("webkitdirectory","")}else{this.inputDrawing.removeAttribute("webkitdirectory")}}},createInput:function(){this.formDrawing=document.createElement("form");this.formDrawing.method="POST";this.formDrawing.enctype="multipart/form-data";this.formDrawing.encoding="multipart/form-data";this.inputDrawing=document.createElement("input");this.inputDrawing.type="file";this.inputDrawing.setAttribute("name","file");if(this.directoryMode){this.inputDrawing.setAttribute("webkitdirectory","")}this.connect(this.inputDrawing,"change",this.onChange);this.formDrawing.appendChild(this.inputDrawing);if(navigator.supportFileAPI){this.getDrawing().appendChild(this.formDrawing)}else{this.iframeDrawing=document.createElement("iframe");this.iframeDrawing.style.position="absolute";this.iframeDrawing.style.top="0px";this.iframeDrawing.style.left="0px";this.iframeDrawing.style.width="0px";this.iframeDrawing.style.height="0px";this.iframeDrawing.style.clip="rect(0px 0px 0px 0px)";document.body.appendChild(this.iframeDrawing);this.iframeDrawing.contentWindow.document.write("<!DOCTYPE html><html><body></body></html>");this.iframeDrawing.contentWindow.document.body.appendChild(this.formDrawing)}},onChange:function(b){b.preventDefault();b.stopPropagation();if(navigator.supportFileAPI){for(var a=0;a<this.inputDrawing.files.length;a++){this.fireEvent("file",this,new Core.File({fileApi:this.inputDrawing.files[a]}))}}else{this.disconnect(this.inputDrawing,"change",this.onChange);this.fireEvent("file",this,new Core.File({iframe:this.iframeDrawing,form:this.formDrawing,fileInput:this.inputDrawing}));this.createInput()}}},{onLoad:function(){Ui.UploadableFileWrapper.base.onLoad.call(this);this.createInput()},onUnload:function(){this.disconnect(this.inputDrawing,"change",this.onChange);if(this.iframeDrawing!=undefined){document.body.removeChild(this.iframeDrawing)}Ui.UploadableFileWrapper.base.onUnload.call(this)}});Ui.Element.extend("Ui.UploadableWrapper",{formDrawing:undefined,inputDrawing:undefined,directoryMode:false,constructor:function(a){this.setClipToBounds(true);this.setOpacity(0);this.addEvents("file")},setDirectoryMode:function(a){},createInput:function(){this.formDrawing=document.createElement("form");this.formDrawing.method="POST";this.formDrawing.enctype="multipart/form-data";this.formDrawing.encoding="multipart/form-data";this.formDrawing.style.display="block";this.formDrawing.style.position="absolute";this.formDrawing.style.left="0px";this.formDrawing.style.top="0px";this.formDrawing.style.width=this.getLayoutWidth()+"px";this.formDrawing.style.height=this.getLayoutHeight()+"px";this.inputDrawing=document.createElement("input");this.inputDrawing.type="file";this.inputDrawing.name="file";this.inputDrawing.style.fontSize="200px";this.inputDrawing.style.display="block";this.inputDrawing.style.cursor="pointer";this.inputDrawing.style.position="absolute";this.inputDrawing.style.left="0px";this.inputDrawing.style.top="0px";this.inputDrawing.style.width=this.getLayoutWidth()+"px";this.inputDrawing.style.height=this.getLayoutHeight()+"px";if(navigator.isIE7||navigator.isIE8){this.inputDrawing.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=0)"}this.formDrawing.appendChild(this.inputDrawing);this.connect(this.inputDrawing,"change",this.onChange);return this.formDrawing},onChange:function(c){if(!navigator.isOpera&&navigator.supportFileAPI){for(var b=0;b<this.inputDrawing.files.length;b++){this.fireEvent("file",this,new Core.File({fileApi:this.inputDrawing.files[b]}))}}else{this.getDrawing().removeChild(this.formDrawing);var a=document.createElement("iframe");a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.width="0px";a.style.height="0px";a.style.clip="rect(0px 0px 0px 0px)";document.body.appendChild(a);a.contentWindow.document.write("<!DOCTYPE html><html><body></body></html>");a.contentWindow.document.body.appendChild(this.formDrawing);this.disconnect(this.inputDrawing,"change",this.onChange);this.fireEvent("file",this,new Core.File({iframe:a,form:this.formDrawing,fileInput:this.inputDrawing}));this.getDrawing().appendChild(this.createInput())}}},{render:function(){return this.createInput()},arrangeCore:function(b,a){this.formDrawing.style.width=b+"px";this.formDrawing.style.height=a+"px";this.inputDrawing.style.width=b+"px";this.inputDrawing.style.height=a+"px"}});navigator.supportFormData=true;try{new FormData()}catch(err){navigator.supportFormData=false}Ui.Uploadable.testInput=document.createElement("input");navigator.supportFileAPI="files" in Ui.Uploadable.testInput;navigator.supportUploadDirectory="webkitdirectory" in Ui.Uploadable.testInput;delete (Ui.Uploadable.testInput);Ui.LBox.extend("Ui.Movable",{moveHorizontal:true,moveVertical:true,mouseStart:undefined,mouseLast:undefined,contentBox:undefined,posX:0,posY:0,isMoving:false,measureSpeedTimer:undefined,speedX:0,speedY:0,speedComputed:false,lastPosX:undefined,lastPosY:undefined,startPosX:undefined,startPosY:undefined,lastTime:undefined,inertiaClock:undefined,inertia:false,touchId:undefined,touchStart:undefined,touchLast:undefined,isDown:false,lock:false,isInMoveEvent:false,cumulMove:0,catcher:undefined,window:undefined,iframe:undefined,directionLock:false,directionRelease:false,constructor:function(a){this.addEvents("down","up","move");this.setFocusable(true);this.contentBox=new Ui.LBox();this.appendChild(this.contentBox);this.contentBox.getDrawing().style.cursor="move";this.connect(this.contentBox.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.contentBox.getDrawing(),"fingerdown",this.onFingerDown);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},setDirectionRelease:function(a){this.directionRelease=a},getDirectionRelease:function(){return this.directionRelease},setLock:function(a){this.lock=a;if(a){this.stopInertia()}},getLock:function(){return this.lock},getIsDown:function(){return this.isDown},getInertia:function(){return this.inertia},setInertia:function(a){this.inertia=a},getMoveHorizontal:function(){return this.moveHorizontal},setMoveHorizontal:function(a){this.moveHorizontal=a},getMoveVertical:function(){return this.moveVertical},setMoveVertical:function(a){this.moveVertical=a},setPosition:function(a,b){if((a!=undefined)&&(this.moveHorizontal)){this.posX=a}if((b!=undefined)&&(this.moveVertical)){this.posY=b}this.contentBox.setTransform(Ui.Matrix.createTranslate(this.posX,this.posY));if(!this.isInMoveEvent){this.isInMoveEvent=true;this.fireEvent("move",this);this.isInMoveEvent=false}},getPositionX:function(){return this.posX},getPositionY:function(){return this.posY},onDown:function(){this.cumulMove=0;this.isDown=true;this.focus();this.fireEvent("down",this)},onUp:function(a){this.isDown=false;this.fireEvent("up",this,this.speedX,this.speedY,(this.posX-this.startPosX),(this.posY-this.startPosY),this.cumulMove,a)},onKeyDown:function(b){if(this.getIsDisabled()){return}var a=b.which;if(((a==37)||(a==39))&&this.moveHorizontal){b.preventDefault();b.stopPropagation();if(a==37){this.setPosition(this.posX-10,undefined)}if(a==39){this.setPosition(this.posX+10,undefined)}}if(((a==38)||(a==40))&&this.moveVertical){b.preventDefault();b.stopPropagation();if(a==38){this.setPosition(undefined,this.posY-10)}if(a==40){this.setPosition(undefined,this.posY+10)}}},onMouseDown:function(b){if(this.lock||this.getIsDisabled()){return}if(b.button!=0){return}this.directionLock=false;b.preventDefault();b.stopPropagation();this.onDown();this.window=window;this.iframe=undefined;if(navigator.isWebkit||navigator.isFirefox3){var a=Ui.App.getRootWindow();if(a!=window){this.window=a;this.iframe=Ui.App.getWindowIFrame()}}this.connect(this.window,"mouseup",this.onMouseUp,true);this.connect(this.window,"mousemove",this.onMouseMove,true);this.catcher=document.createElement("div");this.catcher.style.position="absolute";this.catcher.style.left="0px";this.catcher.style.right="0px";this.catcher.style.top="0px";this.catcher.style.bottom="0px";this.catcher.style.zIndex=1000;this.window.document.body.appendChild(this.catcher);this.mouseStart=this.pointFromWindow({x:b.clientX,y:b.clientY});this.mouseLast=this.mouseStart;this.startPosX=this.posX;this.startPosY=this.posY;this.startComputeInertia()},onMouseMove:function(a){a.preventDefault();a.stopPropagation();var j={x:a.clientX,y:a.clientY};if(this.iframe!=undefined){j=Ui.Element.pointFromWindow(this.iframe,{x:a.clientX,y:a.clientY},this.window)}var l=this.pointFromWindow(j);var g=l.x-this.mouseStart.x;var d=l.y-this.mouseStart.y;if(!this.directionLock){var k=Math.sqrt(g*g+d*d);if(k>10){var b=Math.abs(g)>Math.abs(d);if((this.directionRelease)&&((b&&!this.moveHorizontal)||(!b&&!this.moveVertical))){if("createEvent" in document){this.window.document.body.removeChild(this.catcher);this.disconnect(this.window,"mousemove",this.onMouseMove,true);this.disconnect(this.window,"mouseup",this.onMouseUp,true);this.stopComputeInertia();var h=document.createEvent("MouseEvents");h.initMouseEvent("mousedown",true,true,window,1,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,a.target);this.getDrawing().offsetParent.dispatchEvent(h);this.onUp(true);return}}this.directionLock=true}}var f=l.x-this.mouseLast.x;var c=l.y-this.mouseLast.y;this.mouseLast=l;this.cumulMove+=Math.sqrt(f*f+c*c);this.setPosition(this.startPosX+g,this.startPosY+d);this.hasMoved=true},onMouseUp:function(a){a.preventDefault();a.stopPropagation();if(a.button!=0){return}this.window.document.body.removeChild(this.catcher);this.disconnect(this.window,"mousemove",this.onMouseMove,true);this.disconnect(this.window,"mouseup",this.onMouseUp,true);this.stopComputeInertia();if(this.inertia){this.startInertia()}this.onUp(false)},onFingerDown:function(a){if(this.isMoving||this.lock||this.getIsDisabled()){return}this.directionLock=false;this.isMoving=true;this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);a.finger.capture(this.getDrawing());a.preventDefault();a.stopPropagation();this.stopInertia();this.onDown();this.touchStart=this.pointFromWindow({x:a.finger.getX(),y:a.finger.getY()});this.touchLast=this.touchStart;this.startPosX=this.posX;this.startPosY=this.posY;this.startComputeInertia()},onFingerMove:function(h){h.preventDefault();h.stopPropagation();var g=this.pointFromWindow({x:h.finger.getX(),y:h.finger.getY()});var f=g.x-this.touchStart.x;var b=g.y-this.touchStart.y;if(!this.directionLock){var j=Math.sqrt(f*f+b*b);if(j>10){var d=Math.abs(f)>Math.abs(b);if((this.directionRelease)&&((d&&!this.moveHorizontal)||(!d&&!this.moveVertical))){this.isMoving=false;this.stopComputeInertia();this.disconnect(h.finger,"fingermove",this.onFingerMove);this.disconnect(h.finger,"fingerup",this.onFingerUp);h.finger.release();this.onUp(true);return}this.directionLock=true}}posX=this.startPosX+f;posY=this.startPosY+b;var c=g.x-this.touchLast.x;var a=g.y-this.touchLast.y;this.touchLast=g;this.cumulMove+=Math.sqrt(c*c+a*a);this.setPosition(posX,posY);this.hasMoved=true},onFingerUp:function(a){this.disconnect(a.finger,"fingermove",this.onFingerMove);this.disconnect(a.finger,"fingerup",this.onFingerUp);a.preventDefault();a.stopPropagation();this.isMoving=false;this.stopComputeInertia();if(this.inertia){this.startInertia()}this.onUp(false)},measureSpeed:function(){if(!this.hasMoved){return}var d=(new Date().getTime())/1000;var a=d-this.lastTime;if(a<0.025){return}var c=this.posX-this.lastPosX;var b=this.posY-this.lastPosY;this.speedX=c/a;this.speedY=b/a;this.lastTime=d;this.lastPosX=this.posX;this.lastPosY=this.posY;this.speedComputed=true},startComputeInertia:function(){if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort()}this.lastPosX=this.posX;this.lastPosY=this.posY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false;this.hasMoved=false;this.measureSpeedTimer=new Core.Timer({interval:0.025,scope:this,onTimeupdate:this.measureSpeed})},stopComputeInertia:function(){if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort();this.measureSpeedTimer=undefined}if(!this.speedComputed){var d=(new Date().getTime())/1000;var a=d-this.lastTime;var c=this.posX-this.lastPosX;var b=this.posY-this.lastPosY;this.speedX=c/a;this.speedY=b/a}},startInertia:function(){if(this.inertiaClock===undefined){this.inertiaClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:function(d,c,h){if(h==0){return}var b=this.posX;var a=this.posY;var g=this.posX+(this.speedX*h);var f=this.posY+(this.speedY*h);this.setPosition(g,f);if((this.posX==b)&&(this.posY==a)){this.stopInertia();return}this.speedX-=this.speedX*h*3;this.speedY-=this.speedY*h*3;if(Math.abs(this.speedX)<0.1){this.speedX=0}if(Math.abs(this.speedY)<0.1){this.speedY=0}if((this.speedX==0)&&(this.speedY==0)){this.stopInertia()}}});this.inertiaClock.begin()}},stopInertia:function(){if(this.inertiaClock!=undefined){this.inertiaClock.stop();this.inertiaClock=undefined}}},{arrangeCore:function(b,a){this.getDrawing().style.width="0px";this.getDrawing().style.height="0px";Ui.Movable.base.arrangeCore.call(this,b,a)},setContent:function(a){this.contentBox.setContent(a)}});Ui.LBox.extend("Ui.Transformable",{mouseStart:undefined,contentBox:undefined,speedComputed:false,lastTranslateX:undefined,lastTranslateY:undefined,lastAngle:0,isDown:false,finger1:undefined,finger2:undefined,angle:0,scale:1,translateX:0,translateY:0,startAngle:0,startScale:0,startTranslateX:0,startTranslateY:0,speedX:0,speedY:0,speedAngle:0,constructor:function(a){this.addEvents("down","up","transform");this.setFocusable(true);this.contentBox=new Ui.LBox();this.appendChild(this.contentBox);this.contentBox.getDrawing().style.cursor="move";this.connect(this.contentBox.getDrawing(),"fingerdown",this.onFingerDown)},getIsDown:function(){return this.isDown},getAngle:function(){return this.angle},setAngle:function(a){this.setContentTransform(undefined,undefined,undefined,a)},getScale:function(){return this.scale},setScale:function(a){this.setContentTransform(undefined,undefined,a,undefined)},getTranslateX:function(){return this.translateX},setTranslateX:function(a){this.setContentTransform(a,undefined,undefined,undefined)},getTranslateY:function(){return this.translateY},setTranslateY:function(a){this.setContentTransform(undefined,a,undefined,undefined)},setContentTransform:function(f,b,d,c){if(f===undefined){f=this.translateX}if(b===undefined){b=this.translateY}if(d===undefined){d=this.scale}if(c===undefined){c=this.angle}this.translateX=f;this.translateY=b;this.scale=d;this.angle=c;var a=new Ui.Matrix();a.translate(this.getLayoutWidth()/2,this.getLayoutHeight()/2);a.translate(this.translateX,this.translateY);a.scale(this.scale,this.scale);a.rotate(this.angle);a.translate(-this.getLayoutWidth()/2,-this.getLayoutHeight()/2);this.contentBox.setTransformOrigin(0,0);this.contentBox.setTransform(a);this.fireEvent("transform",this)},onDown:function(){this.isDown=true;this.focus();this.fireEvent("down",this)},onUp:function(){this.isDown=false;this.fireEvent("up",this)},onFingerDown:function(a){if(this.finger1===undefined){var b=new Ui.Point({x:a.finger.getX(),y:a.finger.getY()});this.finger1={finger:a.finger,start:b};this.startAngle=this.angle;this.startScale=this.scale;this.startTranslateX=this.translateX;this.startTranslateY=this.translateY;this.startComputeInertia();a.preventDefault();a.stopPropagation();this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);a.finger.capture(this.getDrawing())}else{if(this.finger2===undefined){this.finger1.start=new Ui.Point({x:this.finger1.finger.getX(),y:this.finger1.finger.getY()});var b=new Ui.Point({x:a.finger.getX(),y:a.finger.getY()});this.finger2={finger:a.finger,start:b};this.startAngle=this.angle;this.startScale=this.scale;this.startTranslateX=this.translateX;this.startTranslateY=this.translateY;a.preventDefault();a.stopPropagation();this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);a.finger.capture(this.getDrawing())}}},onFingerMove:function(b){b.preventDefault();b.stopPropagation();if((this.finger1!=undefined)&&(this.finger2!=undefined)){var m=this.pointFromWindow({x:this.finger1.finger.getX(),y:this.finger1.finger.getY()});var k=this.pointFromWindow({x:this.finger2.finger.getX(),y:this.finger2.finger.getY()});var d=this.pointFromWindow({x:this.finger1.start.x,y:this.finger1.start.y});var c=this.pointFromWindow({x:this.finger2.start.x,y:this.finger2.start.y});var h={x:c.x-d.x,y:c.y-d.y};var j={x:k.x-m.x,y:k.y-m.y};h.norm=Math.sqrt((h.x*h.x)+(h.y*h.y));j.norm=Math.sqrt((j.x*j.x)+(j.y*j.y));var g=j.norm/h.norm;h.x/=h.norm;h.y/=h.norm;j.x/=j.norm;j.y/=j.norm;var n={x:(h.x*j.x+h.y*j.y),y:(h.y*j.x-h.x*j.y)};var f=-(Math.atan2(n.y,n.x)*180)/Math.PI;var l=new Ui.Matrix();l.translate(m.x-d.x,m.y-d.y);l.translate(d.x,d.y);l.scale(g,g);l.rotate(f);l.translate(-d.x,-d.y);l.translate(this.getLayoutWidth()/2,this.getLayoutHeight()/2);l.translate(this.startTranslateX,this.startTranslateY);l.scale(this.startScale,this.startScale);l.rotate(this.startAngle);l.translate(-this.getLayoutWidth()/2,-this.getLayoutHeight()/2);var a=new Ui.Point({x:this.getLayoutWidth()/2,y:this.getLayoutHeight()/2});a.matrixTransform(l);this.setContentTransform(a.x-this.getLayoutWidth()/2,a.y-this.getLayoutHeight()/2,this.startScale*g,this.startAngle+f)}else{if(this.finger1!=undefined){var m=this.pointFromWindow({x:this.finger1.finger.getX(),y:this.finger1.finger.getY()});var d=this.pointFromWindow({x:this.finger1.start.x,y:this.finger1.start.y});this.setContentTransform(this.startTranslateX+(m.x-d.x),this.startTranslateY+(m.y-d.y),this.startScale,this.startAngle)}}},onFingerUp:function(a){a.preventDefault();a.stopPropagation();this.disconnect(a.finger,"fingermove",this.onFingerMove);this.disconnect(a.finger,"fingerup",this.onFingerUp);if((this.finger1!=undefined)&&(this.finger1.finger==a.finger)){this.finger1=undefined;if(this.finger2!=undefined){this.finger1=this.finger2;this.finger2=undefined;this.finger1.start=new Ui.Point({x:this.finger1.finger.getX(),y:this.finger1.finger.getY()});this.startAngle=this.angle;this.startScale=this.scale;this.startTranslateX=this.translateX;this.startTranslateY=this.translateY}else{this.stopComputeInertia();this.startInertia()}}if((this.finger2!=undefined)&&(this.finger2.finger==a.finger)){this.finger2=undefined;this.finger1.start=new Ui.Point({x:this.finger1.finger.getX(),y:this.finger1.finger.getY()});this.startAngle=this.angle;this.startScale=this.scale;this.startTranslateX=this.translateX;this.startTranslateY=this.translateY}},measureSpeed:function(){var d=(new Date().getTime())/1000;var c=d-this.lastTime;if(c<0.025){return}var f=this.angle-this.lastAngle;var b=this.translateX-this.lastTranslateX;var a=this.translateY-this.lastTranslateY;this.speedX=b/c;this.speedY=a/c;this.speedAngle=f/c;this.lastTime=d;this.lastAngle=this.angle;this.lastTranslateX=this.translateX;this.lastTranslateY=this.translateY;this.speedComputed=true},startComputeInertia:function(){this.stopInertia();if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort()}this.lastTranslateX=this.translateX;this.lastTranslateY=this.translateY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedAngle=0;this.speedComputed=false;this.measureSpeedTimer=new Core.Timer({interval:0.025,scope:this,onTimeupdate:this.measureSpeed})},stopComputeInertia:function(){if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort();this.measureSpeedTimer=undefined}if(!this.speedComputed){var d=(new Date().getTime())/1000;var c=d-this.lastTime;var f=this.angle-this.lastAngle;var b=this.translateX-this.lastTranslateX;var a=this.translateY-this.lastTranslateY;this.speedX=b/c;this.speedY=a/c;this.speedAngle=f/c}},startInertia:function(){if(this.inertiaClock===undefined){this.inertiaClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:function(b,a,j){if(j==0){return}var h=this.translateX;var g=this.translateY;var f=this.translateX+(this.speedX*j);var c=this.translateY+(this.speedY*j);var d=this.angle+(this.speedAngle*j);this.setContentTransform(f,c,undefined,d);if((this.translateX==h)&&(this.translateY==g)){this.stopInertia();return}this.speedX-=this.speedX*j*3;this.speedY-=this.speedY*j*3;this.speedAngle-=this.speedAngle*j*3;if(Math.abs(this.speedX)<0.1){this.speedX=0}if(Math.abs(this.speedY)<0.1){this.speedY=0}if((this.speedX==0)&&(this.speedY==0)){this.stopInertia()}}});this.inertiaClock.begin()}},stopInertia:function(){if(this.inertiaClock!=undefined){this.inertiaClock.stop();this.inertiaClock=undefined}}},{setContent:function(a){this.contentBox.setContent(a)}});Ui.Container.extend("Ui.Scrollable",{viewWidth:0,viewHeight:0,contentWidth:0,contentHeight:0,horizontalBarWidth:0,verticalBarHeight:0,offsetX:0,offsetY:0,mouseButton:0,measureSpeedTimer:undefined,speedX:0,speedY:0,speedComputed:false,isMoving:false,hasMoved:false,mouseStart:undefined,touchStart:undefined,verticalFingerStart:undefined,horizontalFingerStart:undefined,touchId:undefined,catcher:undefined,window:undefined,iframe:undefined,scrollHorizontal:true,scrollVertical:true,contentBox:undefined,scrollbarHorizontalBox:undefined,scrollbarHorizontal:undefined,scrollbarVerticalBox:undefined,scrollbarVertical:undefined,showShadows:false,topShadowBox:undefined,bottomShadowBox:undefined,leftShadowBox:undefined,rightShadowBox:undefined,lock:false,overScroll:true,showScrollbar:true,showClock:undefined,nextShow:true,hideTimeout:undefined,directionLock:false,directionRelease:false,constructor:function(a){this.scrollbarHorizontalBox=new Ui.LBox();this.appendChild(this.scrollbarHorizontalBox);this.scrollbarVerticalBox=new Ui.LBox();this.appendChild(this.scrollbarVerticalBox);this.topShadowBox=new Ui.LBox();this.appendChild(this.topShadowBox);this.bottomShadowBox=new Ui.LBox();this.appendChild(this.bottomShadowBox);this.leftShadowBox=new Ui.LBox();this.appendChild(this.leftShadowBox);this.rightShadowBox=new Ui.LBox();this.appendChild(this.rightShadowBox);this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"mousedown",this.onMouseDownCtrl,true);this.connect(this.getDrawing(),"mousewheel",this.onMouseWheel);this.connect(this.getDrawing(),"DOMMouseScroll",this.onMouseWheel);this.connect(this.getDrawing(),"fingerdown",this.onFingerDown);this.connect(this.getDrawing(),"fingerdown",this.onFingerDownCapture,true);this.connect(this.scrollbarHorizontalBox.getDrawing(),"mousedown",this.onHorizontalMouseDown);this.connect(this.scrollbarVerticalBox.getDrawing(),"mousedown",this.onVerticalMouseDown);this.connect(this.scrollbarHorizontalBox.getDrawing(),"fingerdown",this.onHorizontalFingerDown);this.connect(this.scrollbarVerticalBox.getDrawing(),"fingerdown",this.onVerticalFingerDown)},setDirectionRelease:function(a){this.directionRelease=a},getDirectionRelease:function(){return this.directionRelease},setShowShadows:function(a){this.showShadows=a;if(this.showShadows){this.topShadowBox.show();this.bottomShadowBox.show();this.leftShadowBox.show();this.rightShadowBox.show()}else{this.topShadowBox.hide();this.bottomShadowBox.hide();this.leftShadowBox.hide();this.rightShadowBox.hide()}},setTopShadow:function(a){this.topShadowBox.setContent(a)},setBottomShadow:function(a){this.bottomShadowBox.setContent(a)},setLeftShadow:function(a){this.leftShadowBox.setContent(a)},setRightShadow:function(a){this.rightShadowBox.setContent(a)},setShowScrollbar:function(a){if(this.showScrollbar!=a){this.showScrollbar=a;if(this.showClock!=undefined){this.showClock.abort();this.showClock=undefined}if(this.hideTimeout!=undefined){this.hideTimeout.abort();this.hideTimeout=undefined}this.invalidateMeasure();if(a){this.scrollbarHorizontalBox.setOpacity(1);this.scrollbarVerticalBox.setOpacity(1)}else{this.scrollbarHorizontalBox.setOpacity(0);this.scrollbarVerticalBox.setOpacity(0)}}},getShowScrollbar:function(){return this.showScrollbar},setOverScroll:function(a){if(a!=this.overScroll){this.overScroll=a;if(!this.overScroll){this.disconnect(this.getDrawing(),"fingerdown",this.onFingerDown)}else{this.connect(this.getDrawing(),"fingerdown",this.onFingerDown)}}},setLock:function(a){this.lock=a;if(a){this.stopInertia()}},getLock:function(){return this.lock},setContent:function(b){var a=new Ui.ScrollableContent();a.setContent(Ui.Element.create(b));this.setScrollingContent(a)},getContent:function(){return this.contentBox.getFirstChild()},setScrollingContent:function(a){if(this.contentBox!=undefined){this.disconnect(this.contentBox,"scroll",this.onContentBoxScroll);this.removeChild(this.contentBox)}this.contentBox=a;this.prependChild(this.contentBox);this.connect(this.contentBox,"scroll",this.onContentBoxScroll)},getScrollHorizontal:function(){return this.scrollHorizontal},setScrollHorizontal:function(a){if(a!=this.scrollHorizontal){this.scrollHorizontal=a;this.invalidateMeasure()}},getScrollVertical:function(){return this.scrollVertical},setScrollVertical:function(a){if(a!=this.scrollVertical){this.scrollVertical=a;this.invalidateMeasure()}},setScrollbarVertical:function(a){if(this.scrollbarVertical!=a){if(this.scrollbarVertical!=undefined){this.scrollbarVerticalBox.remove(this.scrollbarVertical)}this.scrollbarVertical=a;if(this.scrollbarVertical!=undefined){this.scrollbarVerticalBox.append(this.scrollbarVertical)}}},setScrollbarHorizontal:function(a){if(this.scrollbarHorizontal!=a){if(this.scrollbarHorizontal!=undefined){this.scrollbarHorizontalBox.remove(this.scrollbarHorizontal)}this.scrollbarHorizontal=a;if(this.scrollbarHorizontal!=undefined){this.scrollbarHorizontalBox.append(this.scrollbarHorizontal)}}},setOffsetX:function(a,b){this.setOffset(a,undefined,b)},setOffsetY:function(a,b){this.setOffset(undefined,a,b)},setOffset:function(a,d,c,b){if(c===undefined){c=false}if(a===undefined){a=this.offsetX}else{if(!c){a*=this.contentWidth-this.viewWidth}}if(d===undefined){d=this.offsetY}else{if(!c){d*=this.contentHeight-this.viewHeight}}if(a<0){a=0}else{if(this.viewWidth+a>this.contentWidth){a=this.contentWidth-this.viewWidth}}if(d<0){d=0}else{if(this.viewHeight+d>this.contentHeight){d=this.contentHeight-this.viewHeight}}this.contentBox.setOffset(a,d)},onContentBoxScroll:function(b,a,c){this.offsetX=a;this.offsetY=c;this.updateOffset()},onMouseDownCtrl:function(a){if(a.button==0){this.stopInertia()}if(a.ctrlKey){this.onMouseDown(a)}},onMouseDown:function(b){if(this.lock||this.getIsDisabled()){return}if((this.viewWidth>=this.contentWidth)&&(this.viewHeight>=this.contentHeight)){return}if(!((b.button==1)||((b.button==0)&&(b.ctrlKey||!this.showScrollbar)))){return}this.directionLock=false;this.mouseButton=b.button;b.preventDefault();b.stopPropagation();this.stopInertia();this.window=window;this.iframe=undefined;if(navigator.isWebkit||navigator.isFirefox3){var a=Ui.App.getRootWindow();if(a!=window){this.window=a;this.iframe=Ui.App.getWindowIFrame()}}this.connect(this.window,"mouseup",this.onMouseUp,true);this.connect(this.window,"mousemove",this.onMouseMove,true);this.catcher=document.createElement("div");this.catcher.style.position="absolute";this.catcher.style.left="0px";this.catcher.style.right="0px";this.catcher.style.top="0px";this.catcher.style.bottom="0px";this.catcher.style.zIndex=1000;this.window.document.body.appendChild(this.catcher);this.mouseStart=this.pointFromWindow({x:b.clientX,y:b.clientY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.startComputeInertia();this.showScrollbars()},onMouseMove:function(h){h.preventDefault();h.stopPropagation();this.hasMoved=true;var c={x:h.clientX,y:h.clientY};if(this.iframe!=undefined){c=Ui.Element.pointFromWindow(this.iframe,{x:h.clientX,y:h.clientY},this.window)}var b=this.pointFromWindow(c);var f=b.x-this.mouseStart.x;var a=b.y-this.mouseStart.y;if(!this.directionLock){var j=Math.sqrt(f*f+a*a);if(j>10){var d=Math.abs(f)>Math.abs(a);if((this.directionRelease)&&((d&&!this.scrollHorizontal)||(!d&&!this.scrollVertical))){if("createEvent" in document){this.window.document.body.removeChild(this.catcher);this.disconnect(this.window,"mousemove",this.onMouseMove,true);this.disconnect(this.window,"mouseup",this.onMouseUp,true);this.stopComputeInertia();var g=document.createEvent("MouseEvents");g.initMouseEvent("mousedown",true,true,window,1,h.screenX,h.screenY,h.clientX,h.clientY,h.ctrlKey,h.altKey,h.shiftKey,h.metaKey,0,h.target);this.getDrawing().offsetParent.dispatchEvent(g);this.hideScrollbars();return}}this.directionLock=true}}offsetX=this.startOffsetX-f;offsetY=this.startOffsetY-a;this.setOffset(offsetX,offsetY,true)},onMouseUp:function(a){a.preventDefault();a.stopPropagation();if(a.button!=this.mouseButton){return}this.window.document.body.removeChild(this.catcher);this.disconnect(this.window,"mousemove",this.onMouseMove,true);this.disconnect(this.window,"mouseup",this.onMouseUp,true);this.stopComputeInertia();this.startInertia();this.hideScrollbars()},onMouseWheel:function(c){c.preventDefault();c.stopPropagation();this.stopInertia();this.showScrollbars();this.hideTimeoutScrollbars();var b=0;var a=0;if((c.wheelDeltaX!=undefined)&&(c.wheelDelaY!=undefined)){b=-c.wheelDeltaX/12;a=-c.wheelDeltaY/12}else{if(c.wheelDelta!=undefined){a=-c.wheelDelta/4}else{if(c.detail!=undefined){a=c.detail*10}}}this.setOffset(this.offsetX+b,this.offsetY+a,true)},onFingerDownCapture:function(a){this.stopInertia()},onFingerDown:function(a){if(this.lock||this.getIsDisabled()||this.isMoving){return}if((this.viewWidth>=this.contentWidth)&&(this.viewHeight>=this.contentHeight)){return}this.directionLock=false;a.finger.capture(this.getDrawing());this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);this.isMoving=true;a.preventDefault();a.stopPropagation();this.stopInertia();this.touchStart=this.pointFromWindow({x:a.finger.getX(),y:a.finger.getY()});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.startComputeInertia();this.showScrollbars()},onFingerMove:function(f){f.preventDefault();f.stopPropagation();this.hasMoved=true;var d=this.pointFromWindow({x:f.finger.getX(),y:f.finger.getY()});var c=d.x-this.touchStart.x;var a=d.y-this.touchStart.y;if(!this.directionLock){var g=Math.sqrt(c*c+a*a);if(g>10){var b=Math.abs(c)>Math.abs(a);if((this.directionRelease)&&((b&&!this.scrollHorizontal)||(!b&&!this.scrollVertical))){this.isMoving=false;this.stopComputeInertia();this.disconnect(f.finger,"fingermove",this.onFingerMove);this.disconnect(f.finger,"fingerup",this.onFingerUp);f.finger.release();this.hideScrollbars();return}this.directionLock=true}}offsetX=this.startOffsetX-c;offsetY=this.startOffsetY-a;this.setOffset(offsetX,offsetY,true)},onFingerUp:function(a){a.preventDefault();a.stopPropagation();this.isMoving=false;this.stopComputeInertia();this.startInertia();this.disconnect(a.finger,"fingermove",this.onFingerMove);this.disconnect(a.finger,"fingerup",this.onFingerUp);this.hideScrollbars()},onKeyDown:function(a,b){if(b==37){this.setOffset(this.offsetX-10,undefined,true)}else{if(b==39){this.setOffset(this.offsetX+10,undefined,true)}else{if(b==38){this.setOffset(undefined,this.offsetY-10,true)}else{if(b==40){this.setOffset(undefined,this.offsetY+10,true)}else{if(b==36){this.setOffset(0,0,true)}else{if(b==35){this.setOffset(1,1,false)}}}}}}},measureSpeed:function(){if(!this.hasMoved){return}var d=(new Date().getTime())/1000;var c=d-this.lastTime;if(c<0.025){return}var b=this.offsetX-this.lastOffsetX;var a=this.offsetY-this.lastOffsetY;this.speedX=b/c;this.speedY=a/c;this.lastTime=d;this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.speedComputed=true},startComputeInertia:function(){if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort()}this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false;this.hasMoved=false;this.measureSpeedTimer=new Core.Timer({interval:0.025,scope:this,onTimeupdate:this.measureSpeed})},stopComputeInertia:function(){if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort();this.measureSpeedTimer=undefined}if(!this.speedComputed){var d=(new Date().getTime())/1000;var c=d-this.lastTime;var b=this.offsetX-this.lastOffsetX;var a=this.offsetY-this.lastOffsetY;this.speedX=b/c;this.speedY=a/c}else{}},startInertia:function(){if(this.inertiaClock===undefined){this.inertiaClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:function(c,b,h){if(h==0){return}var g=this.offsetX;var d=this.offsetY;var a=this.offsetX+(this.speedX*h);var f=this.offsetY+(this.speedY*h);this.setOffset(a,f,true);this.speedX-=this.speedX*h*3;this.speedY-=this.speedY*h*3;if(Math.abs(this.speedX)<0.1){this.speedX=0}if(Math.abs(this.speedY)<0.1){this.speedY=0}if((this.speedX==0)&&(this.speedY==0)){this.stopInertia()}}});this.inertiaClock.begin()}},stopInertia:function(){if(this.inertiaClock!=undefined){this.inertiaClock.stop();this.inertiaClock=undefined}},onVerticalMouseDown:function(b){if(this.lock||this.getIsDisabled()){return}if(b.button!=0){return}b.preventDefault();b.stopPropagation();this.stopInertia();this.window=window;this.iframe=undefined;if(navigator.isWebkit||navigator.isFirefox3){var a=Ui.App.getRootWindow();if(a!=window){this.window=a;this.iframe=Ui.App.getWindowIFrame()}}this.connect(this.window,"mouseup",this.onVerticalMouseUp,true);this.connect(this.window,"mousemove",this.onVerticalMouseMove,true);this.catcher=document.createElement("div");this.catcher.style.position="absolute";this.catcher.style.left="0px";this.catcher.style.right="0px";this.catcher.style.top="0px";this.catcher.style.bottom="0px";this.catcher.style.zIndex=1000;this.window.document.body.appendChild(this.catcher);this.mouseStart=this.pointFromWindow({x:b.clientX,y:b.clientY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false},onVerticalMouseMove:function(d){d.preventDefault();d.stopPropagation();var c={x:d.clientX,y:d.clientY};if(this.iframe!=undefined){c=Ui.Element.pointFromWindow(this.iframe,{x:d.clientX,y:d.clientY},this.window)}var b=this.pointFromWindow(c);var a=b.y-this.mouseStart.y;offsetY=this.startOffsetY+a*this.contentHeight/this.viewHeight;this.setOffset(undefined,offsetY,true)},onVerticalMouseUp:function(a){a.preventDefault();a.stopPropagation();if(a.button!=0){return}this.window.document.body.removeChild(this.catcher);this.disconnect(this.window,"mousemove",this.onVerticalMouseMove,true);this.disconnect(this.window,"mouseup",this.onVerticalMouseUp,true)},onVerticalFingerDown:function(a){if(this.lock||this.getIsDisabled()||this.isVerticalMoving||!this.showScrollbar){return}this.isVerticalMoving=true;this.connect(a.finger,"fingermove",this.onVerticalFingerMove);this.connect(a.finger,"fingerup",this.onVerticalFingerUp);a.finger.capture(this.getDrawing());a.preventDefault();a.stopPropagation();this.stopInertia();this.verticalFingerStart=this.pointFromWindow({x:a.finger.getX(),y:a.finger.getY()});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY},onVerticalFingerMove:function(c){c.preventDefault();c.stopPropagation();var b=this.pointFromWindow({x:c.finger.getX(),y:c.finger.getY()});var a=b.y-this.verticalFingerStart.y;offsetY=this.startOffsetY+a*this.contentHeight/this.viewHeight;this.setOffset(this.startOffsetX,offsetY,true)},onVerticalFingerUp:function(a){a.preventDefault();a.stopPropagation();this.isVerticalMoving=false;this.disconnect(a.finger,"fingermove",this.onVerticalFingerMove);this.disconnect(a.finger,"fingerup",this.onVerticalFingerUp)},onHorizontalMouseDown:function(b){if(this.lock||this.getIsDisabled()){return}if(b.button!=0){return}b.preventDefault();b.stopPropagation();this.stopInertia();this.window=window;this.iframe=undefined;if(navigator.isWebkit||navigator.isFirefox3){var a=Ui.App.getRootWindow();if(a!=window){this.window=a;this.iframe=Ui.App.getWindowIFrame()}}this.connect(this.window,"mouseup",this.onHorizontalMouseUp,true);this.connect(this.window,"mousemove",this.onHorizontalMouseMove,true);this.catcher=document.createElement("div");this.catcher.style.position="absolute";this.catcher.style.left="0px";this.catcher.style.right="0px";this.catcher.style.top="0px";this.catcher.style.bottom="0px";this.catcher.style.zIndex=1000;this.window.document.body.appendChild(this.catcher);this.mouseStart=this.pointFromWindow({x:b.clientX,y:b.clientY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false},onHorizontalMouseMove:function(d){d.preventDefault();d.stopPropagation();var b={x:d.clientX,y:d.clientY};if(this.iframe!=undefined){b=Ui.Element.pointFromWindow(this.iframe,{x:d.clientX,y:d.clientY},this.window)}var a=this.pointFromWindow(b);var c=a.x-this.mouseStart.x;offsetX=this.startOffsetX+c*this.contentWidth/this.viewWidth;this.setOffset(offsetX,this.startOffsetY,true)},onHorizontalMouseUp:function(a){a.preventDefault();a.stopPropagation();if(a.button!=0){return}this.window.document.body.removeChild(this.catcher);this.disconnect(this.window,"mousemove",this.onHorizontalMouseMove,true);this.disconnect(this.window,"mouseup",this.onHorizontalMouseUp,true)},onHorizontalFingerDown:function(a){if(this.lock||this.getIsDisabled()||this.isHorizontalMoving||!this.showScrollbar){return}this.isHorizontalMoving=true;this.connect(a.finger,"fingermove",this.onHorizontalFingerMove);this.connect(a.finger,"fingerup",this.onHorizontalFingerUp);a.finger.capture(this.getDrawing());a.preventDefault();a.stopPropagation();this.stopInertia();this.horizontalFingerStart=this.pointFromWindow({x:a.finger.getX(),y:a.finger.getY()});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY},onHorizontalFingerMove:function(c){c.preventDefault();c.stopPropagation();var b=this.pointFromWindow({x:c.finger.getX(),y:c.finger.getY()});var a=b.x-this.horizontalFingerStart.x;offsetX=this.startOffsetX+a*this.contentWidth/this.viewWidth;this.setOffset(offsetX,undefined,true)},onHorizontalFingerUp:function(a){a.preventDefault();a.stopPropagation();this.isHorizontalMoving=false;this.disconnect(a.finger,"fingermove",this.onHorizontalFingerMove);this.disconnect(a.finger,"fingerup",this.onHorizontalFingerUp)},updateOffset:function(){if(this.contentBox===undefined){return}if(this.scrollbarHorizontalNeeded){var b=this.offsetX/(this.contentWidth-this.viewWidth);this.scrollbarHorizontalBox.setTransform(Ui.Matrix.createTranslate((this.viewWidth-this.scrollbarHorizontalWidth)*b,0));if(b>0){this.leftShadowBox.show();this.leftShadowBox.setOpacity(1)}else{this.leftShadowBox.hide();this.leftShadowBox.setOpacity(0)}if(b<1){this.rightShadowBox.show();this.rightShadowBox.setOpacity(1)}else{this.rightShadowBox.hide();this.rightShadowBox.setOpacity(0)}}else{this.leftShadowBox.setOpacity(0);this.leftShadowBox.hide();this.rightShadowBox.setOpacity(0);this.rightShadowBox.hide()}if(this.scrollbarVerticalNeeded){var a=this.offsetY/(this.contentHeight-this.viewHeight);this.scrollbarVerticalBox.setTransform(Ui.Matrix.createTranslate(0,(this.viewHeight-this.scrollbarVerticalHeight)*a));if(a>0){this.topShadowBox.show();this.topShadowBox.setOpacity(1)}else{this.topShadowBox.setOpacity(0);this.topShadowBox.hide()}if(a<1){this.bottomShadowBox.show();this.bottomShadowBox.setOpacity(1)}else{this.bottomShadowBox.setOpacity(0);this.bottomShadowBox.hide()}}else{this.topShadowBox.setOpacity(0);this.topShadowBox.hide();this.bottomShadowBox.setOpacity(0);this.bottomShadowBox.hide()}},showScrollbars:function(){if(this.showScrollbar){return}this.nextShow=true;if(this.hideTimeout!=undefined){this.hideTimeout.abort()}if(this.showClock===undefined){this.showClock=new Anim.Clock({duration:"forever",scope:this,onTimeupdate:this.onShowTick});this.showClock.begin()}},hideTimeoutScrollbars:function(){if(this.showScrollbar){return}if(this.hideTimeout!=undefined){this.hideTimeout.abort();this.hideTimeout=new Core.DelayedTask({delay:1,scope:this,callback:this.hideScrollbars})}else{this.hideTimeout=new Core.DelayedTask({delay:1,scope:this,callback:this.hideScrollbars})}},hideScrollbars:function(){if(this.showScrollbar){return}this.nextShow=false;if(this.hideTimeout!=undefined){this.hideTimeout.abort();this.hideTimeout=undefined}if(this.showClock===undefined){this.showClock=new Anim.Clock({duration:"forever",scope:this,onTimeupdate:this.onShowTick});this.showClock.begin()}},onShowTick:function(b,a,f){if(f==0){return}if(!this.nextShow){f=-f}f*=5;var c=this.scrollbarVerticalBox.getOpacity();c=Math.max(0,Math.min(c+f,1));this.scrollbarVerticalBox.setOpacity(c);var d=this.scrollbarHorizontalBox.getOpacity();d=Math.max(0,Math.min(d+f,1));this.scrollbarHorizontalBox.setOpacity(d);if((this.nextShow&&(d==1)&&(c==1))||(!this.nextShow&&(d==0)&&(c==0))){this.showClock.stop();this.showClock=undefined}}},{measureCoreWithScrollbar:function(d,a){this.scrollbarVerticalBox.measure(d,a);this.scrollbarHorizontalBox.measure(d,a);this.contentBox.measure(d,a);var b=d;var f=a;this.scrollbarVerticalNeeded=false;this.scrollbarHorizontalNeeded=false;var c=this.scrollbarVerticalBox.getMeasureWidth()*2+this.scrollbarHorizontalBox.getMeasureWidth();var g=this.scrollbarHorizontalBox.getMeasureHeight()*2+this.scrollbarVerticalBox.getMeasureHeight();if((this.contentBox.getMeasureHeight()>a)&&this.scrollVertical){b=d-this.scrollbarVerticalBox.getMeasureWidth();this.scrollbarVerticalNeeded=true}if((this.contentBox.getMeasureWidth()>b)&&this.scrollHorizontal){f=a-this.scrollbarHorizontalBox.getMeasureHeight();this.scrollbarHorizontalNeeded=true;if((this.contentBox.getMeasureHeight()>f)&&this.scrollVertical){b=d-this.scrollbarVerticalBox.getMeasureWidth();this.scrollbarVerticalNeeded=true}}if(this.scrollbarHorizontalNeeded||this.scrollbarVerticalNeeded){this.scrollbarVerticalNeeded=false;this.scrollbarHorizontalNeeded=false;this.contentBox.measure(b,f);var b=d;var f=a;if(this.scrollVertical){if(this.contentBox.getMeasureHeight()>a){b=d-this.scrollbarVerticalBox.getMeasureWidth();this.scrollbarVerticalNeeded=true}}else{g=this.contentBox.getMeasureHeight()}if(this.scrollHorizontal){if(this.contentBox.getMeasureWidth()>b){f=a-this.scrollbarHorizontalBox.getMeasureHeight();this.scrollbarHorizontalNeeded=true;if((this.contentBox.getMeasureHeight()>f)&&this.scrollVertical){b=d-this.scrollbarVerticalBox.getMeasureWidth();this.scrollbarVerticalNeeded=true}}}else{c=this.contentBox.getMeasureWidth();if(this.scrollbarVerticalNeeded){c+=this.scrollbarVerticalBox.getMeasureWidth()}}if(!this.scrollVertical&&this.scrollbarHorizontalNeeded){g+=this.scrollbarHorizontalBox.getMeasureHeight()}var h;var j;if(this.contentBox.getMeasureWidth()<=b){h=this.contentBox.getMeasureWidth()}else{h=b}if(this.scrollbarVerticalNeeded){h+=this.scrollbarVerticalBox.getMeasureWidth()}h=Math.max(h,c);if(this.contentBox.getMeasureHeight()<=f){j=this.contentBox.getMeasureHeight()}else{j=f}if(this.scrollbarHorizontalNeeded){j+=this.scrollbarHorizontalBox.getMeasureHeight()}j=Math.max(j,g);return{width:h,height:j}}else{return{width:this.contentBox.getMeasureWidth(),height:this.contentBox.getMeasureHeight()}}},measureCoreWithoutScrollbar:function(d,a){this.topShadowBox.measure(d,a);this.bottomShadowBox.measure(d,a);this.leftShadowBox.measure(d,a);this.rightShadowBox.measure(d,a);this.scrollbarVerticalBox.measure(d,a);this.scrollbarHorizontalBox.measure(d,a);this.contentBox.measure(d,a);var b=d;var f=a;this.scrollbarVerticalNeeded=false;this.scrollbarHorizontalNeeded=false;var c=this.scrollbarVerticalBox.getMeasureWidth()*2+this.scrollbarHorizontalBox.getMeasureWidth();var g=this.scrollbarHorizontalBox.getMeasureHeight()*2+this.scrollbarVerticalBox.getMeasureHeight();var h;var j;if((this.contentBox.getMeasureHeight()>a)&&this.scrollVertical){this.scrollbarVerticalNeeded=true;j=a}else{j=this.contentBox.getMeasureHeight()}if((this.contentBox.getMeasureWidth()>b)&&this.scrollHorizontal){this.scrollbarHorizontalNeeded=true;h=d}else{h=this.contentBox.getMeasureWidth()}return{width:Math.max(h,c),height:Math.max(j,g)}},arrangeCoreWithScrollbar:function(c,a){var b=c;if(this.contentBox.getMeasureHeight()>a){this.scrollbarVerticalNeeded=true;b=c-this.scrollbarVerticalBox.getMeasureWidth()}else{this.scrollbarVerticalNeeded=false}if(this.contentBox.getMeasureWidth()>b){this.scrollbarHorizontalNeeded=true}else{this.scrollbarHorizontalNeeded=false}if(this.scrollbarVerticalNeeded){this.scrollbarVerticalBox.show()}else{this.scrollbarVerticalBox.hide();this.offsetY=0}if(this.scrollbarHorizontalNeeded){this.scrollbarHorizontalBox.show()}else{this.scrollbarHorizontalBox.hide();this.offsetX=0}if(!this.scrollbarVerticalNeeded&&!this.scrollbarHorizontalNeeded){this.contentWidth=c;this.contentHeight=a;this.viewWidth=c;this.viewHeight=a}else{this.contentWidth=c;this.contentHeight=a;this.viewWidth=c;this.viewHeight=a;if(this.scrollbarVerticalNeeded){this.contentHeight=this.contentBox.getMeasureHeight();this.viewWidth-=this.scrollbarVerticalBox.getMeasureWidth();if(!this.scrollbarHorizontalNeeded){this.contentWidth-=this.scrollbarVerticalBox.getMeasureWidth()}}if(this.scrollbarHorizontalNeeded){this.contentWidth=this.contentBox.getMeasureWidth();this.viewHeight-=this.scrollbarHorizontalBox.getMeasureHeight()}else{if(!this.scrollbarVerticalNeeded){this.contentHeight-=this.scrollbarHorizontalBox.getMeasureHeight()}}if(this.scrollbarVerticalNeeded){this.scrollbarVerticalHeight=Math.max((this.viewHeight/this.contentHeight)*this.viewHeight,this.scrollbarVerticalBox.getMeasureHeight());this.scrollbarVerticalBox.arrange(c-this.scrollbarVerticalBox.getMeasureWidth(),0,this.scrollbarVerticalBox.getMeasureWidth(),this.scrollbarVerticalHeight)}if(this.scrollbarHorizontalNeeded){this.scrollbarHorizontalWidth=Math.max((this.viewWidth/this.contentWidth)*this.viewWidth,this.scrollbarHorizontalBox.getMeasureWidth());this.scrollbarHorizontalBox.arrange(0,a-this.scrollbarHorizontalBox.getMeasureHeight(),this.scrollbarHorizontalWidth,this.scrollbarHorizontalBox.getMeasureHeight())}}this.contentBox.arrange(0,0,this.viewWidth,this.viewHeight);this.updateOffset()},arrangeCoreWithoutScrollbar:function(c,a){var b=c;if(this.contentBox.getMeasureHeight()>a){this.scrollbarVerticalNeeded=true}else{this.scrollbarVerticalNeeded=false}if(this.contentBox.getMeasureWidth()>b){this.scrollbarHorizontalNeeded=true}else{this.scrollbarHorizontalNeeded=false}if(this.scrollbarVerticalNeeded){this.scrollbarVerticalBox.show()}else{this.scrollbarVerticalBox.hide();this.offsetY=0}if(this.scrollbarHorizontalNeeded){this.scrollbarHorizontalBox.show()}else{this.scrollbarHorizontalBox.hide();this.offsetX=0}this.viewWidth=c;this.viewHeight=a;this.contentWidth=c;this.contentHeight=a;if(this.scrollbarVerticalNeeded){this.contentHeight=this.contentBox.getMeasureHeight();this.scrollbarVerticalHeight=Math.max((this.viewHeight/this.contentHeight)*this.viewHeight,this.scrollbarVerticalBox.getMeasureHeight());this.scrollbarVerticalBox.arrange(c-this.scrollbarVerticalBox.getMeasureWidth(),0,this.scrollbarVerticalBox.getMeasureWidth(),this.scrollbarVerticalHeight)}if(this.scrollbarHorizontalNeeded){this.contentWidth=this.contentBox.getMeasureWidth();this.scrollbarHorizontalWidth=Math.max((this.viewWidth/this.contentWidth)*this.viewWidth,this.scrollbarHorizontalBox.getMeasureWidth());this.scrollbarHorizontalBox.arrange(0,a-this.scrollbarHorizontalBox.getMeasureHeight(),this.scrollbarHorizontalWidth,this.scrollbarHorizontalBox.getMeasureHeight())}this.contentBox.arrange(0,0,this.viewWidth,this.viewHeight);this.topShadowBox.arrange(0,0,this.viewWidth,this.topShadowBox.getMeasureHeight());this.bottomShadowBox.arrange(0,this.viewHeight-this.bottomShadowBox.getMeasureHeight(),c,this.bottomShadowBox.getMeasureHeight());this.leftShadowBox.arrange(0,0,this.leftShadowBox.getMeasureWidth(),this.viewHeight);this.rightShadowBox.arrange(this.viewWidth-this.rightShadowBox.getMeasureWidth(),0,this.rightShadowBox.getMeasureWidth(),this.viewHeight);this.updateOffset()},measureCore:function(b,a){if(this.contentBox===undefined){return{width:0,height:0}}if(this.showScrollbar){return this.measureCoreWithScrollbar(b,a)}else{return this.measureCoreWithoutScrollbar(b,a)}},arrangeCore:function(b,a){if(this.contentBox===undefined){return}if(this.showScrollbar){this.arrangeCoreWithScrollbar(b,a)}else{this.arrangeCoreWithoutScrollbar(b,a)}}});Ui.Container.extend("Ui.ScrollableContent",{viewWidth:0,viewHeight:0,content:undefined,contentWidth:0,contentHeight:0,constructor:function(a){this.getDrawing().style.overflow="hidden";this.addEvents("scroll");this.connect(this.getDrawing(),"scroll",function(){this.fireEvent("scroll",this,this.getDrawing().scrollLeft,this.getDrawing().scrollTop)})},setContent:function(a){if(this.content!=a){if(this.content!=undefined){this.removeChild(this.content)}this.content=a;if(this.content!=undefined){this.appendChild(this.content)}}},setOffset:function(a,b){this.getDrawing().scrollLeft=a;this.getDrawing().scrollTop=b},getOffsetX:function(){return this.getDrawing().scrollLeft},getOffsetY:function(){return this.getDrawing().scrollLeft}},{measureCore:function(c,a){var b;if(this.content!=undefined){b=this.content.measure(c,a)}else{b={width:0,height:0}}this.contentWidth=b.width;this.contentHeight=b.height;return b},arrangeCore:function(b,a){if(this.content!=undefined){this.content.arrange(0,0,Math.max(b,this.contentWidth),Math.max(a,this.contentHeight))}}});Ui.Container.extend("Ui.Scrollable2",{viewWidth:0,viewHeight:0,horizontalBarWidth:0,verticalBarHeight:0,offsetX:0,offsetY:0,mouseButton:0,measureSpeedTimer:undefined,speedX:0,speedY:0,speedComputed:false,isMoving:false,hasMoved:false,mouseStart:undefined,touchStart:undefined,touchId:undefined,scrollHorizontal:true,scrollVertical:true,contentBox:undefined,scrollbarHorizontalBox:undefined,scrollbarHorizontal:undefined,scrollbarVerticalBox:undefined,scrollbarVertical:undefined,constructor:function(a){this.contentBox=new Ui.ScrollableContent2();this.appendChild(this.contentBox);this.connect(this.contentBox,"scroll",function(c,b,d){this.setOffset(b,d,true)});this.scrollbarHorizontalBox=new Ui.LBox();this.scrollbarHorizontalBox.getDrawing().style.cursor="move";this.scrollbarHorizontalBox.hide();this.appendChild(this.scrollbarHorizontalBox);this.scrollbarVerticalBox=new Ui.LBox();this.scrollbarVerticalBox.getDrawing().style.cursor="move";this.scrollbarVerticalBox.hide();this.appendChild(this.scrollbarVerticalBox);this.connect(this.contentBox.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.contentBox.getDrawing(),"mousedown",this.onMouseDownCtrl,true);this.connect(this.contentBox.getDrawing(),"mousewheel",this.onMouseWheel);this.connect(this.contentBox.getDrawing(),"DOMMouseScroll",this.onMouseWheel);this.connect(this.contentBox.getDrawing(),"touchstart",this.onTouchStart);this.connect(this.contentBox.getDrawing(),"touchmove",this.onTouchMove);this.connect(this.contentBox.getDrawing(),"touchend",this.onTouchEnd);this.connect(this.scrollbarHorizontalBox.getDrawing(),"mousedown",this.onHorizontalMouseDown);this.connect(this.scrollbarVerticalBox.getDrawing(),"mousedown",this.onVerticalMouseDown)},setContent:function(a){this.contentBox.setContent(a)},getScrollHorizontal:function(){return this.scrollHorizontal},setScrollHorizontal:function(a){if(a!=this.scrollHorizontal){this.scrollHorizontal=a;this.invalidateMeasure()}},getScrollVertical:function(){return this.scrollVertical},setScrollVertical:function(a){if(a!=this.scrollVertical){this.scrollVertical=a;this.invalidateMeasure()}},setScrollbarVertical:function(a){if(this.scrollbarVertical!=a){if(this.scrollbarVertical!=undefined){this.scrollbarVerticalBox.removeChild(this.scrollbarVertical)}this.scrollbarVertical=a;if(this.scrollbarVertical!=undefined){this.scrollbarVerticalBox.appendChild(this.scrollbarVertical)}}},setScrollbarHorizontal:function(a){if(this.scrollbarHorizontal!=a){if(this.scrollbarHorizontal!=undefined){this.scrollbarHorizontalBox.removeChild(this.scrollbarHorizontal)}this.scrollbarHorizontal=a;if(this.scrollbarHorizontal!=undefined){this.scrollbarHorizontalBox.appendChild(this.scrollbarHorizontal)}}},setOffsetX:function(a,b){this.setOffset(a,undefined,b)},setOffsetY:function(a,b){this.setOffset(undefined,a,b)},setOffset:function(a,c,b){if(b===undefined){b=false}if(a===undefined){a=this.offsetX}else{if(!b){a*=this.contentWidth-this.viewWidth}}if(c===undefined){c=this.offsetY}else{if(!b){c*=this.contentHeight-this.viewHeight}}if(a<0){a=0}else{if(a>this.contentWidth-this.viewWidth){a=this.contentWidth-this.viewWidth}}if(c<0){c=0}else{if(c>this.contentHeight-this.viewHeight){c=this.contentHeight-this.viewHeight}}if(!this.scrollVertical){c=0}if(!this.scrollHorizontal){a=0}this.offsetX=a;this.offsetY=c;this.updateOffset()},onMouseDownCtrl:function(a){if(a.ctrlKey){this.onMouseDown(a)}},onMouseDown:function(a){if((this.viewWidth>=this.contentWidth)&&(this.viewHeight>=this.contentHeight)){return}this.focus();this.mouseButton=a.button;a.preventDefault();a.stopPropagation();this.stopInertia();this.connect(window,"mouseup",this.onMouseUp,true);this.connect(window,"mousemove",this.onMouseMove,true);this.mouseStart=this.pointFromWindow({x:a.clientX,y:a.clientY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.startComputeInertia()},onMouseMove:function(d){d.preventDefault();d.stopPropagation();this.hasMoved=true;var b=this.pointFromWindow({x:d.clientX,y:d.clientY});var c=b.x-this.mouseStart.x;var a=b.y-this.mouseStart.y;offsetX=this.startOffsetX-c;offsetY=this.startOffsetY-a;this.setOffset(offsetX,offsetY,true)},onMouseUp:function(a){a.preventDefault();a.stopPropagation();if(a.button!=this.mouseButton){return}this.disconnect(window,"mousemove",this.onMouseMove);this.disconnect(window,"mouseup",this.onMouseUp);this.stopComputeInertia();this.startInertia()},onMouseWheel:function(c){c.preventDefault();c.stopPropagation();var b=0;var a=0;if((c.wheelDeltaX!=undefined)&&(c.wheelDelaY!=undefined)){b=-c.wheelDeltaX/12;a=-c.wheelDeltaY/12}else{if(c.wheelDelta!=undefined){a=-c.wheelDelta/8}else{if(c.detail!=undefined){a=c.detail*10/3}}}if(!this.scrollVertical&&(b==0)){b=a}this.setOffset(this.offsetX+b,this.offsetY+a,true)},onTouchStart:function(a){if((this.viewWidth>=this.contentWidth)&&(this.viewHeight>=this.contentHeight)){return}if(a.targetTouches.length!=1){return}if(this.isMoving){return}this.touchId=a.targetTouches[0].identifier;this.isMoving=true;a.preventDefault();a.stopPropagation();this.stopInertia();this.touchStart=this.pointFromWindow({x:a.targetTouches[0].clientX,y:a.targetTouches[0].clientY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.startComputeInertia()},onTouchMove:function(d){if(!this.isMoving){return}if(d.targetTouches[0].identifier!=this.touchId){return}d.preventDefault();d.stopPropagation();var c=this.pointFromWindow({x:d.targetTouches[0].clientX,y:d.targetTouches[0].clientY});var b=c.x-this.touchStart.x;var a=c.y-this.touchStart.y;offsetX=this.startOffsetX-b;offsetY=this.startOffsetY-a;this.setOffset(offsetX,offsetY,true);this.hasMoved=true},onTouchEnd:function(a){if(!this.isMoving){return}a.preventDefault();a.stopPropagation();this.isMoving=false;this.stopComputeInertia();this.startInertia()},onKeyDown:function(a,b){if(b==37){this.setOffset(this.offsetX-10,undefined,true)}else{if(b==39){this.setOffset(this.offsetX+10,undefined,true)}else{if(b==38){this.setOffset(undefined,this.offsetY-10,true)}else{if(b==40){this.setOffset(undefined,this.offsetY+10,true)}else{if(b==36){this.setOffset(0,0,true)}else{if(b==35){this.setOffset(1,1,false)}else{console.log("key: "+b)}}}}}}},measureSpeed:function(){if(!this.hasMoved){return}var d=(new Date().getTime())/1000;var c=d-this.lastTime;if(c<0.025){return}var b=this.offsetX-this.lastOffsetX;var a=this.offsetY-this.lastOffsetY;this.speedX=b/c;this.speedY=a/c;this.lastTime=d;this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.speedComputed=true},startComputeInertia:function(){if(this.scrollbarHorizontalNeeded){this.scrollbarHorizontalBox.show()}if(this.scrollbarVerticalNeeded){}this.scrollbarVerticalBox.show();if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort()}this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false;this.hasMoved=false;this.measureSpeedTimer=new Core.Timer({interval:0.025,scope:this,callback:this.measureSpeed})},stopComputeInertia:function(){if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort();this.measureSpeedTimer=undefined}if(!this.speedComputed){var d=(new Date().getTime())/1000;var c=d-this.lastTime;var b=this.offsetX-this.lastOffsetX;var a=this.offsetY-this.lastOffsetY;this.speedX=b/c;this.speedY=a/c}else{}},startInertia:function(){if(this.inertiaClock===undefined){this.inertiaClock=new Anim.Clock({duration:"forever",target:this,callback:function(c,b,h){if(h==0){return}var g=this.offsetX;var d=this.offsetY;var a=this.offsetX+(this.speedX*h);var f=this.offsetY+(this.speedY*h);this.setOffset(a,f,true);if((this.offsetX==g)&&(this.offsetY==d)){this.stopInertia();return}this.speedX-=this.speedX*h*3;this.speedY-=this.speedY*h*3;if(Math.abs(this.speedX)<0.1){this.speedX=0}if(Math.abs(this.speedY)<0.1){this.speedY=0}if((this.speedX==0)&&(this.speedY==0)){this.stopInertia()}}});this.inertiaClock.begin()}},stopInertia:function(){this.scrollbarHorizontalBox.hide();this.scrollbarVerticalBox.hide();if(this.inertiaClock!=undefined){this.inertiaClock.stop();this.inertiaClock=undefined}},onVerticalMouseDown:function(a){if(a.button!=0){return}a.preventDefault();a.stopPropagation();this.stopInertia();this.connect(window,"mouseup",this.onVerticalMouseUp,true);this.connect(window,"mousemove",this.onVerticalMouseMove,true);this.mouseStart=this.pointFromWindow({x:a.clientX,y:a.clientY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false;this.measureSpeedTimer=new Core.Timer({interval:0.025,scope:this,callback:this.measureSpeed})},onVerticalMouseMove:function(c){c.preventDefault();c.stopPropagation();var b=this.pointFromWindow({x:c.clientX,y:c.clientY});var a=b.y-this.mouseStart.y;offsetY=this.startOffsetY+a*this.contentHeight/this.viewHeight;this.setOffset(this.startOffsetX,offsetY,true)},onVerticalMouseUp:function(f){f.preventDefault();f.stopPropagation();if(f.button!=0){return}if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort();this.measureSpeedTimer=undefined}this.disconnect(window,"mousemove",this.onVerticalMouseMove);this.disconnect(window,"mouseup",this.onVerticalMouseUp);if(!this.speedComputed){var d=(new Date().getTime())/1000;var c=d-this.lastTime;var b=this.offsetX-this.lastOffsetX;var a=this.offsetY-this.lastOffsetY;this.speedX=b/c;this.speedY=a/c}this.startInertia()},onHorizontalMouseDown:function(a){if(a.button!=0){return}a.preventDefault();a.stopPropagation();this.stopInertia();this.connect(window,"mouseup",this.onHorizontalMouseUp,true);this.connect(window,"mousemove",this.onHorizontalMouseMove,true);this.mouseStart=this.pointFromWindow({x:a.clientX,y:a.clientY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;this.lastTime=(new Date().getTime())/1000;this.speedX=0;this.speedY=0;this.speedComputed=false;this.measureSpeedTimer=new Core.Timer({interval:0.025,scope:this,callback:this.measureSpeed})},onHorizontalMouseMove:function(c){c.preventDefault();c.stopPropagation();var a=this.pointFromWindow({x:c.clientX,y:c.clientY});var b=a.x-this.mouseStart.x;offsetX=this.startOffsetX+b*this.contentWidth/this.viewWidth;this.setOffset(offsetX,this.startOffsetY,true)},onHorizontalMouseUp:function(f){f.preventDefault();f.stopPropagation();if(f.button!=0){return}if(this.measureSpeedTimer!=undefined){this.measureSpeedTimer.abort();this.measureSpeedTimer=undefined}this.disconnect(window,"mousemove",this.onHorizontalMouseMove);this.disconnect(window,"mouseup",this.onHorizontalMouseUp);if(!this.speedComputed){var d=(new Date().getTime())/1000;var c=d-this.lastTime;var b=this.offsetX-this.lastOffsetX;var a=this.offsetY-this.lastOffsetY;this.speedX=b/c;this.speedY=a/c}this.startInertia()},updateOffset:function(){if(this.scrollbarHorizontalNeeded){var b=this.offsetX/(this.contentWidth-this.viewWidth);this.scrollbarHorizontalBox.setTransform(Ui.Matrix.createTranslate((this.viewWidth-this.scrollbarHorizontalWidth)*b,0))}if(this.scrollbarVerticalNeeded){var a=this.offsetY/(this.contentHeight-this.viewHeight);this.scrollbarVerticalBox.setTransform(Ui.Matrix.createTranslate(0,(this.viewHeight-this.scrollbarVerticalHeight)*a))}this.contentBox.getDrawing().scrollLeft=this.offsetX;this.contentBox.getDrawing().scrollTop=this.offsetY}},{measureCore:function(f,a){this.scrollbarVerticalBox.measure(f,a);this.scrollbarHorizontalBox.measure(f,a);this.contentBox.measure(f,a);var b=f;var g=a;this.scrollbarVerticalNeeded=false;this.scrollbarHorizontalNeeded=false;var d=this.scrollbarVerticalBox.getMeasureWidth()+this.scrollbarHorizontalBox.getMeasureWidth();var h=this.scrollbarHorizontalBox.getMeasureHeight()+this.scrollbarVerticalBox.getMeasureHeight();var c=this.contentBox.measure(b,g);if((c.width>f)&&this.scrollHorizontal){this.scrollbarHorizontalNeeded=true}if((c.height>a)&&this.scrollVertical){this.scrollbarVerticalNeeded=true}if(!this.scrollHorizontal){d=c.width}if(!this.scrollVertical){h=c.height}return{width:Math.max(d,Math.min(c.width,f)),height:Math.max(h,Math.min(c.height,a))}},arrangeCore:function(b,a){this.contentWidth=this.contentBox.getMeasureWidth();this.contentHeight=this.contentBox.getMeasureHeight();this.viewWidth=b;this.viewHeight=a;if(this.scrollbarVerticalNeeded){this.scrollbarVerticalHeight=Math.max((this.viewHeight/this.contentHeight)*this.viewHeight,this.scrollbarVerticalBox.getMeasureHeight());this.scrollbarVerticalBox.arrange(b-this.scrollbarVerticalBox.getMeasureWidth(),0,this.scrollbarVerticalBox.getMeasureWidth(),this.scrollbarVerticalHeight)}if(this.scrollbarHorizontalNeeded){this.scrollbarHorizontalWidth=Math.max((this.viewWidth/this.contentWidth)*this.viewWidth,this.scrollbarHorizontalBox.getMeasureWidth());this.scrollbarHorizontalBox.arrange(0,a-this.scrollbarHorizontalBox.getMeasureHeight(),this.scrollbarHorizontalWidth,this.scrollbarHorizontalBox.getMeasureHeight())}this.contentBox.arrange(0,0,this.viewWidth,this.viewHeight);this.updateOffset()}});Ui.Container.extend("Ui.ScrollableContent2",{viewWidth:0,viewHeight:0,content:undefined,contentWidth:0,contentHeight:0,constructor:function(a){this.getDrawing().style.overflow="hidden";this.addEvents("scroll");this.connect(this.getDrawing(),"scroll",function(){this.fireEvent("scroll",this,this.getDrawing().scrollLeft,this.getDrawing().scrollTop)})},setContent:function(a){if(this.content!=a){if(this.content!=undefined){this.removeChild(this.content)}this.content=a;if(this.content!=undefined){this.appendChild(this.content)}}},setOffset:function(a,b){this.getDrawing().scrollLeft=a;this.getDrawing().scrollTop=b},getOffsetX:function(){return this.getDrawing().scrollLeft},getOffsetY:function(){return this.getDrawing().scrollLeft}},{measureCore:function(c,a){var b;if(this.content!=undefined){b=this.content.measure(c,a)}else{b={width:0,height:0}}this.contentWidth=b.width;this.contentHeight=b.height;return b},arrangeCore:function(b,a){if(this.content!=undefined){this.content.arrange(0,0,Math.max(b,this.contentWidth),Math.max(a,this.contentHeight))}}});Ui.LBox.extend("Ui.Draggable",{icon:undefined,downloadUrl:undefined,downloadMimetype:undefined,downloadFilename:undefined,allowedMode:"copyMove",mimetype:undefined,data:undefined,lastPress:undefined,isDown:false,isDrag:false,timer:undefined,dragDelta:undefined,clock:undefined,screenX:undefined,screenY:undefined,lock:false,constructor:function(a){this.addEvents("dragstart","dragend","press","activate","menu");this.getDrawing().setAttribute("draggable",true);this.connect(this.getDrawing(),"dragstart",this.onDragStart,true);this.connect(this.getDrawing(),"dragend",this.onDragEnd,true);this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"fingerdown",this.onFingerDown)},setLock:function(a){this.lock=a},getLock:function(){return this.lock},setMimetype:function(a){if(a===undefined){this.mimetype="application/era-framework"}else{this.mimetype=a}},setData:function(a){this.data=a},setAllowedMode:function(a){this.allowedMode=a},setIcon:function(a){this.icon=a},setDownloadUrl:function(c,a,b){var d=new Core.Uri({uri:c});this.downloadUrl=d.toString();if(b===undefined){}if(a===undefined){}this.downloadMimetype=a;this.downloadFilename=b},getDragDelta:function(){return this.dragDelta},onDragStart:function(a){if(!this.dragAllowed){this.setTransform(new Ui.Matrix());if(this.clock!=undefined){this.clock.stop();this.clock=undefined}if(this.timer!=undefined){this.timer.abort();this.timer=undefined}a.stopPropagation();a.preventDefault();return}if(this.clock!=undefined){this.clock.stop();this.clock=undefined;this.setTransform(new Ui.Matrix())}if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.isDown=false;this.isDrag=true;this.dragDelta=this.pointFromWindow({x:a.clientX,y:a.clientY});this.disconnect(window,"mouseup",this.onMouseUp,true);a.stopPropagation();a.dataTransfer.effectAllowed=this.allowedMode;if(this.downloadUrl!=undefined){try{a.dataTransfer.setData("DownloadURL",this.downloadMimetype+":"+this.downloadFilename+":"+this.downloadUrl)}catch(b){}}a.dataTransfer.setData("Text",this.mimetype+":"+this.dragDelta.x+":"+this.dragDelta.y+":"+this.data);this.fireEvent("dragstart",this);if(this.icon!=undefined){if(a.dataTransfer.setDragImage!=undefined){a.dataTransfer.setDragImage(this.icon.drawing.childNodes[0],0,0)}}return false},onDragEnd:function(a){this.isDrag=false;this.isDown=false;a.stopPropagation();this.fireEvent("dragend",this,a.dataTransfer.dropEffect)},onMouseDown:function(a){if(this.lock||this.isDown||(a.button!=0)){return}this.isDown=true;this.dragAllowed=false;this.setTransform(new Ui.Matrix());if(this.clock!=undefined){this.clock.stop();this.clock=undefined}if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.timer=new Core.DelayedTask({delay:0.25,scope:this,callback:this.onTimer});this.screenX=a.screenX;this.screenY=a.screenY;this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true);a.stopPropagation();if(!navigator.supportDrag&&(a.button==0)){new Core.DragDataTransfer({draggable:this.getDrawing(),x:a.clientX,y:a.clientY,event:a,mouse:true})}},onMouseMove:function(d){var b=d.screenX-this.screenX;var a=d.screenY-this.screenY;var f=Math.sqrt(b*b+a*a);d.preventDefault();d.stopPropagation();if(f>10){this.disconnect(window,"mousemove",this.onMouseMove,true);this.disconnect(window,"mouseup",this.onMouseUp,true);this.isDrag=false;this.isDown=false;this.dragAllowed=false;this.setTransform(new Ui.Matrix());if(this.clock!=undefined){this.clock.stop();this.clock=undefined}if(this.timer!=undefined){this.timer.abort();this.timer=undefined}var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,d.target);this.getDrawing().offsetParent.dispatchEvent(c)}},onMouseUp:function(b){this.disconnect(window,"mousemove",this.onMouseMove,true);this.disconnect(window,"mouseup",this.onMouseUp,true);this.isDown=false;this.dragAllowed=false;this.setTransform(new Ui.Matrix());if(this.clock!=undefined){this.clock.stop();this.clock=undefined}if(this.timer!=undefined){this.timer.abort();this.timer=undefined}if(!this.isDrag){this.isDrag=false;this.fireEvent("press",this);var a=(new Date().getTime())/1000;if((this.lastPress!=undefined)&&((a-this.lastPress)<0.25)){this.fireEvent("activate",this)}this.lastPress=a}},onFingerDown:function(a){if(this.lock||this.isDown){return}this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);a.finger.capture(this.getDrawing());a.preventDefault();a.stopPropagation();this.screenX=a.finger.getX();this.screenY=a.finger.getY();this.isDown=true;this.dragAllowed=false;this.setTransform(new Ui.Matrix());if(this.clock!=undefined){this.clock.stop();this.clock=undefined}if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.timer=new Core.DelayedTask({delay:0.25,scope:this,callback:this.onTimer})},onFingerMove:function(c){c.preventDefault();c.stopPropagation();var b=c.finger.getX()-this.screenX;var a=c.finger.getY()-this.screenY;var d=Math.sqrt(b*b+a*a);if(d>10){this.setTransform(new Ui.Matrix());if(this.clock!=undefined){this.clock.stop();this.clock=undefined}if(this.timer!=undefined){this.timer.abort();this.timer=undefined}this.disconnect(c.finger,"fingermove",this.onFingerMove);this.disconnect(c.finger,"fingerup",this.onFingerUp);if(this.dragAllowed){if(navigator.supportDrag){c.finger.release()}else{new Core.DragDataTransfer({draggable:this.getDrawing(),x:c.finger.getX(),y:c.finger.getY(),event:c,finger:c.finger})}}else{c.finger.release()}this.dragAllowed=false;this.isDown=false}},onFingerUp:function(b){b.preventDefault();b.stopPropagation();this.disconnect(b.finger,"fingermove",this.onFingerMove);this.disconnect(b.finger,"fingerup",this.onFingerUp);this.dragAllowed=false;this.isDown=false;this.setTransform(new Ui.Matrix());if(this.clock!=undefined){this.clock.stop();this.clock=undefined}if(this.timer!=undefined){this.timer.abort();this.timer=undefined}if(!this.isDrag){this.isDrag=false;this.fireEvent("press",this);var a=(new Date().getTime())/1000;if((this.lastPress!=undefined)&&((a-this.lastPress)<0.25)){this.fireEvent("activate",this)}this.lastPress=a}},onTimer:function(){this.timer=undefined;this.dragAllowed=true;this.disconnect(window,"mousemove",this.onMouseMove,true);this.clock=new Anim.Clock({duration:"forever"});this.connect(this.clock,"timeupdate",this.onAnim);this.clock.begin()},onAnim:function(b){var a=(b.getGlobalTime()%0.8)/0.8;var d=new Anim.ElasticEase({mode:"inout"});a=d.ease(a);var c=1+(a/12);this.setTransform(Ui.Matrix.createScale(c,c))}});Ui.LBox.extend("Ui.DropBox",{allowedMimetypes:undefined,allowFiles:false,allowText:false,allowedMode:"all",constructor:function(a){this.allowedMimetypes=[];this.connect(this.drawing,"dragenter",this.onDragEnter);this.connect(this.drawing,"dragover",this.onDragOver);this.connect(this.drawing,"drop",this.onDrop);this.addEvents("drop","dropfile")},setAllowedMode:function(a){this.allowedMode=a},addMimetype:function(a){this.allowedMimetypes.push(a);if(a.toLowerCase()=="files"){this.allowFiles=true}else{this.allowText=true}},onDragEnter:function(f){if(f.dataTransfer.types!=undefined){var a=false;var b=false;for(var c=0;c<f.dataTransfer.types.length;c++){var d=f.dataTransfer.types[c].toLowerCase();if((d=="text")||(d=="text/plain")){b=true}else{if(d.toLowerCase()=="files"){a=true}}}if(!(a&&this.allowFiles)&&!(b&&this.allowText)){return}}f.preventDefault();f.stopPropagation();return false},onDragOver:function(f){if(f.dataTransfer===undefined){return}if(f.dataTransfer.types!=undefined){var a=false;var b=false;for(var c=0;c<f.dataTransfer.types.length;c++){var d=f.dataTransfer.types[c].toLowerCase();if((d=="text")||(d=="text/plain")){b=true}else{if(d.toLowerCase()=="files"){a=true}}}if(!(a&&this.allowFiles)&&!(b&&this.allowText)){return}}var h="all";if(f.dataTransfer.effectAllowed!=undefined){h=f.dataTransfer.effectAllowed}if(h=="uninitialized"){h="all"}var g="copy";if(((this.allowedMode=="all")||(this.allowedMode=="copy")||(this.allowedMode=="copyLink")||(this.allowedMode=="copyMove"))&&((h=="copy")||(h=="copyLink")||(h=="copyMove")||(h=="all"))){g="copy"}else{if(((this.allowedMode=="all")||(this.allowedMode=="copyMove")||(this.allowedMode=="linkMove")||(this.allowedMode=="move"))&&((h=="all")||(h=="copyMove")||(h=="linkMove")||(h=="move"))){g="move"}else{if(((this.allowedMode=="all")||(this.allowedMode=="copyLink")||(this.allowedMode=="link")||(this.allowedMode=="linkMove"))&&((h=="all")||(h=="copyLink")||(h=="link")||(h=="linkMove"))){g="link"}else{g="none"}}}f.dataTransfer.dropEffect=g;f.preventDefault();f.stopPropagation();return false},onDrop:function(a){var k=this.pointFromWindow({x:a.clientX,y:a.clientY});if((a.dataTransfer.files!=undefined)&&(a.dataTransfer.files.length>0)){a.preventDefault();a.stopPropagation();for(var d=0;d<a.dataTransfer.files.length;d++){this.fireEvent("dropfile",this,new Core.File({fileApi:a.dataTransfer.files[d]}))}}else{if("types" in a.dataTransfer){for(var d=0;d<a.dataTransfer.types.length;d++){var h=a.dataTransfer.types[d];for(var b=0;b<this.allowedMimetypes.length;b++){if(this.allowedMimetypes[b]==h){var c=a.dataTransfer.getData(h);a.preventDefault();a.stopPropagation();this.fireEvent("drop",this,h,c,k.x,k.y);return}}}}var c=a.dataTransfer.getData("Text");if(c!=undefined){var f=c.split(":");if(f.length==4){var h=f[0];var j=new Number(f[1]);var g=new Number(f[2]);var c=f[3];for(var d=0;d<this.allowedMimetypes.length;d++){if(this.allowedMimetypes[d]==h){a.preventDefault();a.stopPropagation();this.fireEvent("drop",this,h,c,k.x,k.y,j,g);return}}}}}return false}},{});Ui.Element.extend("Ui.IFrame",{iframeDrawing:undefined,isReady:false,constructor:function(a){this.connect(this.iframeDrawing,"load",this.onIFrameLoad);this.addEvents("ready")},getSrc:function(){return this.iframeDrawing.getAttribute("src")},setSrc:function(a){this.iframeDrawing.setAttribute("src",a)},getIFrame:function(){return this.iframeDrawing},onIFrameLoad:function(){if(!this.isReady){this.isReady=true;this.fireEvent("ready",this)}}},{render:function(){this.iframeDrawing=document.createElement("iframe");this.iframeDrawing.style.position="absolute";this.iframeDrawing.style.border="0px";this.iframeDrawing.style.margin="0px";this.iframeDrawing.style.padding="0px";this.iframeDrawing.style.left="0px";this.iframeDrawing.style.top="0px";if(navigator.isIE){this.iframeDrawing.frameBorder="0"}return this.iframeDrawing},arrangeCore:function(d,b){var a=d;var g=b;if(navigator.isChrome){var c=this.transformFromWindow();a=(d*c.getA());g=(b*c.getD())}try{this.iframeDrawing.contentWindow.innerWidth=a;this.iframeDrawing.contentWindow.innerHeight=g}catch(f){}this.iframeDrawing.style.width=a+"px";this.iframeDrawing.style.height=g+"px"},onVisible:function(){if(navigator.isIE7||navigator.isIE8){var a=this.iframeDrawing.contentWindow;if(a.document.body!=undefined){a.document.body.clientWidth;a.document.body.clientHeight}}}});Ui.LBox.extend("Ui.MouseOverable",{task:undefined,isOver:false,constructor:function(a){this.addEvents("enter","leave","move");this.connect(this.getDrawing(),"mouseover",this.onMouseOver);this.connect(this.getDrawing(),"mouseout",this.onMouseOut);this.connect(this.getDrawing(),"mousemove",this.onMouseMove,true)},getIsOver:function(){return this.isOver},onMouseOver:function(a){if(this.task!=undefined){this.task.abort();this.task=undefined}else{this.isOver=true;this.fireEvent("enter",this)}},onMouseOut:function(a){this.task=new Core.DelayedTask({delay:0,scope:this,callback:function(){this.isOver=false;this.fireEvent("leave",this);this.task=undefined}})},onMouseMove:function(a){if(this.isOver){this.fireEvent("move",this)}}});Ui.Container.extend("Ui.Carouselable",{movable:undefined,box:undefined,alignClock:undefined,speed:0,animNext:0,animStart:0,ease:undefined,autoPlay:undefined,autoTask:undefined,pos:0,constructor:function(a){this.setClipToBounds(true);this.setFocusable(true);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.addEvents("change");this.movable=new Ui.Movable({inertia:false,moveVertical:false,directionRelease:true});this.movable.setFocusable(false);this.connect(this.movable,"move",this.onMove);this.connect(this.movable,"down",this.onDown);this.connect(this.movable,"up",this.onUp);this.appendChild(this.movable);this.box=new Ui.CarouselableBox();this.movable.setContent(this.box);this.ease=Anim.EasingFunction.create({type:Anim.PowerEase,mode:"out"})},setAutoPlay:function(a){if(this.autoPlay!=a){if(this.autoTask!=undefined){this.autoTask.abort();this.autoTask=undefined}this.autoPlay=a;if(this.autoPlay!=undefined){this.autoTask=new Core.DelayedTask({delay:this.autoPlay,scope:this,callback:this.onAutoPlay})}}},getLock:function(){return this.movable.getLock()},setLock:function(a){this.movable.setLock(a)},getCurrent:function(){return this.box.getChildren()[this.getCurrentPosition()]},getCurrentPosition:function(){return Math.min(this.box.getChildren().length-1,Math.max(0,Math.round(-this.movable.getPositionX()/this.getLayoutWidth())))},setCurrentAt:function(a){a=Math.min(this.box.getChildren().length-1,Math.max(0,a));if(a<this.getCurrentPosition()){this.startAnimation(1,a)}else{this.startAnimation(-1,a)}},setCurrent:function(b){for(var a=0;a<this.box.getChildren().length;a++){if(this.box.getChildren()[a]==b){this.setCurrentAt(a);break}}},next:function(){if(this.alignClock===undefined){var a=this.getCurrentPosition();if(a<this.getChildren().length){this.startAnimation(-1,a+1)}}else{var b=-this.movable.getPositionX()/this.getLayoutWidth();if(this.animNext>b){this.startAnimation(-1*(this.animNext+1-this.getCurrentPosition()),Math.min(this.animNext+1,this.box.getChildren().length-1))}else{this.startAnimation(-1,Math.min(Math.ceil(b),this.box.getChildren().length-1))}}},previous:function(){if(this.alignClock===undefined){var a=this.getCurrentPosition();if(a>0){this.startAnimation(1,this.getCurrentPosition()-1)}}else{var b=-this.movable.getPositionX()/this.getLayoutWidth();if(this.animNext<b){this.startAnimation(1*(this.getCurrentPosition()-(this.animNext-1)),Math.max(this.animNext-1,0))}else{this.startAnimation(1,Math.floor(b))}}},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},append:function(a){this.box.append(a)},remove:function(a){this.box.remove(a)},getLogicalChildren:function(){return this.box.getChildren()},onKeyDown:function(b){if(this.getIsDisabled()){return}var a=b.which;if((a==32)||(a==37)||(a==39)){b.stopPropagation();b.preventDefault()}if(a==32){this.next()}else{if(a==37){this.previous()}else{if(a==39){this.next()}}}},onMove:function(b){if(this.box.getChildren().length<2){b.setPosition(0,0)}else{var a=undefined;if(b.getPositionX()>0){a=0}if(b.getPositionX()<-(this.getLayoutWidth()*(this.box.getChildren().length-1))){a=-(this.getLayoutWidth()*(this.box.getChildren().length-1))}b.setPosition(a,0)}this.updateShow()},onDown:function(a){this.focus();this.stopAnimation()},onUp:function(g,f,d,b,a){if(Math.abs(f)<100){var c=(-this.movable.getPositionX()/this.getLayoutWidth())%1;if(c>0.5){f=-400}else{f=400}}if(f!=0){this.startAnimation(f/this.getLayoutWidth())}},onChange:function(){var b=this.getCurrentPosition();this.pos=-b;for(var a=0;a<this.box.getChildren().length;a++){if(a==b){this.box.getChildren()[a].show()}else{this.box.getChildren()[a].hide()}}this.fireEvent("change",this,this.getCurrentPosition())},updateShow:function(){var b=Math.floor(-this.movable.getPositionX()/this.getLayoutWidth());for(var a=0;a<this.box.getChildren().length;a++){if((a==b-1)||(a==b)||(a==b+1)){this.box.getChildren()[a].show()}else{this.box.getChildren()[a].hide()}}},onAlignTick:function(b,a,d){if(d==0){return}var c=-(b.getTime()*this.speed)/(this.animNext-this.animStart);if(c>=1){this.alignClock.stop();this.alignClock=undefined;c=1}c=this.ease.ease(c);this.pos=-(this.animStart+c*(this.animNext-this.animStart));this.movable.setPosition(this.pos*this.getLayoutWidth(),undefined);if(c>=1){this.onChange()}else{this.updateShow()}},startAnimation:function(b,a){this.stopAnimation();this.speed=b;this.animStart=-this.movable.getPositionX()/this.getLayoutWidth();if(a===undefined){if(this.speed<0){this.animNext=Math.ceil(this.animStart)}else{this.animNext=Math.floor(this.animStart)}}else{this.animNext=a}if(this.animStart!=this.animNext){this.alignClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:this.onAlignTick});this.alignClock.begin()}},stopAnimation:function(){if(this.alignClock!=undefined){this.alignClock.stop();this.alignClock=undefined}},onAutoPlay:function(){this.autoTask=new Core.DelayedTask({delay:this.autoPlay,scope:this,callback:this.onAutoPlay});if(this.getCurrentPosition()>=this.getLogicalChildren().length-1){this.setCurrentAt(0)}else{this.next()}}},{measureCore:function(b,a){this.movable.measure(b,a);return{width:this.box.getElementWidth(),height:this.box.getElementHeight()}},arrangeCore:function(c,a){var b=this.movable.arrange(0,0,c*this.box.getChildren().length,a);this.movable.setPosition(this.pos*c,undefined);return b}});Ui.Container.extend("Ui.CarouselableBox",{elementWidth:0,elementHeight:0,constructor:function(){},append:function(a){this.appendChild(a)},remove:function(a){this.removeChild(a)},getElementWidth:function(){return this.elementWidth},getElementHeight:function(){return this.elementHeight}},{measureCore:function(f,a){var d=0;var g=0;for(var c=0;c<this.getChildren().length;c++){var b=this.getChildren()[c].measure(f,a);if(b.width>d){d=b.width}if(b.height>g){g=b.height}}this.elementWidth=d;this.elementHeight=g;return{width:d*this.getChildren().length,height:g}},arrangeCore:function(d,b){var a=0;d/=this.getChildren().length;for(var c=0;c<this.getChildren().length;c++){this.getChildren()[c].arrange(a,0,d,b);a+=d}}});Ui.Rectangle.extend("Ui.Separator",{constructor:function(a){this.setMargin(3);this.setHeight(1)}},{onStyleChange:function(){this.setFill(this.getStyleProperty("color"))}},{style:{color:new Ui.Color({r:0,g:0,b:0})}});Ui.Container.extend("Ui.Popup",{background:undefined,shadow:undefined,contentBox:undefined,posX:undefined,posY:undefined,attachedElement:undefined,lbox:undefined,autoHide:true,expandable:false,constructor:function(a){this.setHorizontalAlign("stretch");this.setVerticalAlign("stretch");this.shadow=new Ui.Rectangle();this.appendChild(this.shadow);this.background=new Ui.PopupBackground({radius:8,fill:"black"});this.appendChild(this.background);this.contentBox=new Ui.LBox({paddingLeft:15,paddingRight:15,paddingTop:11,paddingBottom:11});this.appendChild(this.contentBox);this.connect(this.shadow.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.shadow.getDrawing(),"touchstart",this.onTouchStart);this.connect(window,"resize",this.onWindowResize);this.connect(this.getDrawing(),"keyup",this.onKeyUp)},setExpandable:function(a){if(this.expandable!=a){this.expandable=a;this.invalidateMeasure()}},setAutoHide:function(a){this.autoHide=a},setContent:function(a){a=Ui.Element.create(a);if(this.content!=a){if(this.content!=undefined){this.contentBox.remove(this.content)}this.content=a;if(this.content!=undefined){this.contentBox.append(this.content)}}},onKeyUp:function(b){var a=b.which;if((a==27)&&(this.autoHide)){b.preventDefault();b.stopPropagation();this.hide()}},onWindowResize:function(){if(this.visible&&this.autoHide&&(this.posX!=undefined)){this.hide()}},onMouseDown:function(a){a.preventDefault();a.stopPropagation();if(this.autoHide){this.hide()}},onContentMouseDown:function(a){a.preventDefault();a.stopPropagation()},onTouchStart:function(a){a.preventDefault();a.stopPropagation();if(this.autoHide){this.hide()}},onContentTouchStart:function(a){a.preventDefault();a.stopPropagation()}},{visible:false,onStyleChange:function(){this.background.setFill(this.getStyleProperty("color"));this.shadow.setFill(this.getStyleProperty("shadowColor"))},show:function(d,c){var b=this.getIsVisible();Ui.Popup.base.show.call(this);this.attachedElement=undefined;this.posX=undefined;this.posY=undefined;if(!b){if((typeof(d)=="object")&&(Ui.Element.hasInstance(d))){this.attachedElement=d;var a=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth(),y:this.attachedElement.getLayoutHeight()/2});this.posX=a.x;this.posY=a.y;this.background.setArrowBorder("left")}else{if((d!=undefined)&&(c!=undefined)){this.posX=d;this.posY=c;this.background.setArrowBorder("left")}else{this.posX=undefined;this.posY=undefined;this.background.setArrowBorder("none")}}this.invalidateArrange();Ui.App.current.appendDialog(this)}},onHidden:function(){Ui.App.current.removeDialog(this)},measureCore:function(d,a){var b=Math.max(d-80,0);var f=Math.max(a-80,0);if(!this.expandable){b=0;f=0}this.background.measure(b,f);var c=this.contentBox.measure(b,f);if((this.posX!=undefined)||(this.attachedElement!=undefined)){return{width:c.width,height:c.height}}else{return{width:Math.max(d,c.width+80),height:Math.max(a,c.height+80)}}},arrangeCore:function(d,c){var b=0;var f=0;this.shadow.arrange(0,0,d,c);if((this.posX===undefined)&&(this.attachedElement===undefined)){this.setCenter(d,c)}else{if(this.attachedElement!=undefined){var a=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth(),y:this.attachedElement.getLayoutHeight()/2});if(this.contentBox.getMeasureWidth()+a.x+10<d){this.setLeft(a.x,a.y,d,c)}else{a=this.attachedElement.pointToWindow({x:0,y:this.attachedElement.getLayoutHeight()/2});if(this.contentBox.getMeasureWidth()+10<a.x){this.setRight(a.x,a.y,d,c)}else{a=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth()/2,y:0});if(this.contentBox.getMeasureHeight()+10<a.y){this.setTop(a.x,a.y,d,c)}else{a=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth()/2,y:this.attachedElement.getLayoutHeight()});if(this.contentBox.getMeasureHeight()+10+a.y<c){this.setBottom(a.x,a.y,d,c)}else{this.setCenter(d,c)}}}}}else{this.setLeft(this.posX,this.posY,d,c)}}},setLeft:function(b,h,f,a){var d=b+10;var c=h-30;this.background.setArrowBorder("left");if(c+this.contentBox.getMeasureHeight()>a){c=a-this.contentBox.getMeasureHeight();var g=h-c;if(g>this.contentBox.getMeasureHeight()-18){g=this.contentBox.getMeasureHeight()-18}this.background.setArrowOffset(g)}else{this.background.setArrowOffset(30)}this.shadow.setOpacity(0);this.background.arrange(d-10,c,this.contentBox.getMeasureWidth()+10,this.contentBox.getMeasureHeight());this.contentBox.arrange(d,c,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},setRight:function(b,h,f,a){var d=b-(10+this.contentBox.getMeasureWidth());var c=h-30;this.background.setArrowBorder("right");if(c+this.contentBox.getMeasureHeight()>a){c=a-this.contentBox.getMeasureHeight();var g=h-c;if(g>this.contentBox.getMeasureHeight()-18){g=this.contentBox.getMeasureHeight()-18}this.background.setArrowOffset(g)}else{this.background.setArrowOffset(30)}this.shadow.setOpacity(0);this.background.arrange(d,c,this.contentBox.getMeasureWidth()+10,this.contentBox.getMeasureHeight());this.contentBox.arrange(d,c,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},setTop:function(b,h,f,a){var c=h-(this.contentBox.getMeasureHeight());var d=b-30;this.background.setArrowBorder("bottom");if(d+this.contentBox.getMeasureWidth()>f){d=f-this.contentBox.getMeasureWidth();var g=b-d;if(g>this.contentBox.getMeasureWidth()-18){g=this.contentBox.getMeasureWidth()-18}this.background.setArrowOffset(g)}else{this.background.setArrowOffset(30)}this.shadow.setOpacity(0);this.background.arrange(d,c-10,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight()+10);this.contentBox.arrange(d,c-10,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},setBottom:function(b,h,f,a){var c=h+10;var d=b-30;this.background.setArrowBorder("top");if(d+this.contentBox.getMeasureWidth()>f){d=f-this.contentBox.getMeasureWidth();var g=b-d;if(g>this.contentBox.getMeasureWidth()-18){g=this.contentBox.getMeasureWidth()-18}this.background.setArrowOffset(g)}else{this.background.setArrowOffset(30)}this.shadow.setOpacity(0);this.background.arrange(d,c-10,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight()+10);this.contentBox.arrange(d,c,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},setCenter:function(b,a){this.background.setArrowBorder("none");if(this.expandable){this.background.arrange(40,40,b-80,a-80);this.shadow.setOpacity(1);this.contentBox.arrange(40,40,b-80,a-80)}else{x=(b-this.contentBox.getMeasureWidth())/2;y=(a-this.contentBox.getMeasureHeight())/2;this.background.arrange(x,y,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight());this.shadow.setOpacity(1);this.contentBox.arrange(x,y,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())}}},{style:{color:new Ui.Color({r:0.1,g:0.15,b:0.2}),shadowColor:new Ui.Color({r:1,g:1,b:1,a:0.5})}});Ui.Fixed.extend("Ui.PopupBackground",{darkShadow:undefined,lightShadow:undefined,background:undefined,radius:8,fill:"black",arrowBorder:"left",arrowOffset:30,arrowSize:10,constructor:function(a){this.darkShadow=new Ui.Shape({fill:"#010002",opacity:0.8});this.append(this.darkShadow);this.lightShadow=new Ui.Shape({fill:"#5f625b"});this.append(this.lightShadow);var b=(new Ui.Color({r:0.5,g:0.5,b:0.5})).getYuv();var c=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:0.25,u:b.u,v:b.v})},{offset:1,color:new Ui.Color({y:0.16,u:b.u,v:b.v})}]});this.background=new Ui.Shape({fill:c});this.append(this.background);this.connect(this,"resize",this.onResize)},setArrowBorder:function(a){if(this.arrowBorder!=a){this.arrowBorder=a;this.invalidateArrange()}},setArrowOffset:function(a){if(this.arrowOffset!=a){this.arrowOffset=a;this.invalidateArrange()}},setRadius:function(a){if(this.radius!=a){this.radius=a;this.invalidateArrange()}},setFill:function(c){if(this.fill!=c){this.fill=Ui.Color.create(c);var a=this.fill.getYuv();var b=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]});this.background.setFill(b);this.darkShadow.setFill(new Ui.Color({y:a.y-0.9,u:a.u,v:a.v}));this.lightShadow.setFill(new Ui.Color({y:a.y+0.3,u:a.u,v:a.v}))}},genPath:function(f,b,a,g,d,c){if(g=="none"){var j=f-a;var h=b-a;return"M"+a+",0 L"+j+",0 Q"+f+",0 "+f+","+a+" L"+f+","+h+" Q"+f+","+b+" "+j+","+b+" L"+a+","+b+" Q0,"+b+" 0,"+h+" L0,"+a+" Q0,0 "+a+",0 z"}else{if(g=="left"){var j=f-this.radius;var h=b-this.radius;return"M"+(a+d)+",0 L"+j+",0 Q"+f+",0 "+f+","+a+" L"+f+","+h+" Q"+f+","+b+" "+j+","+b+" L"+(a+d)+","+b+" Q"+d+","+b+" "+d+","+h+" L"+d+","+(c+d)+" L0,"+c+" L"+d+","+(c-d)+" L"+d+","+a+" Q"+d+",0 "+(a+d)+",0 z"}else{if(g=="right"){var j=f-(this.radius+d);var h=b-this.radius;return"M"+a+",0 L"+j+",0 Q"+(f-d)+",0 "+(f-d)+","+a+" L"+(f-d)+","+(c-d)+" L"+f+","+c+" L"+(f-d)+","+(c+d)+" L "+(f-d)+","+h+" Q"+(f-d)+","+b+" "+j+","+b+" L"+a+","+b+" Q0,"+b+" 0,"+h+" L0,"+a+" Q0,0 "+a+",0 z"}else{if(g=="top"){var j=f-this.radius;var h=b-this.radius;return"M"+a+","+d+" L"+(c-d)+","+d+" L"+c+",0 L"+(c+d)+","+d+" L"+j+","+d+" Q"+f+","+d+" "+f+","+(d+a)+" L"+f+","+h+" Q"+f+","+b+" "+j+","+b+" L"+a+","+b+" Q0,"+b+" 0,"+h+" L0,"+(d+a)+" Q0,"+d+" "+a+","+d+" z"}else{if(g=="bottom"){var j=f-this.radius;var h=b-(this.radius+d);return"M"+a+",0 L"+j+",0 Q"+f+",0 "+f+","+a+" L"+f+","+h+" Q"+f+","+(b-d)+" "+j+","+(b-d)+" L "+(c+d)+","+(b-d)+" L"+c+","+b+" L"+(c-d)+","+(b-d)+" L"+a+","+(b-d)+" Q0,"+(b-d)+" 0,"+h+" L0,"+a+" Q0,0 "+a+",0 z"}}}}}},onResize:function(b,c,a){this.darkShadow.setWidth(c);this.darkShadow.setHeight(a);this.darkShadow.setPath(this.genPath(c,a,this.radius,this.arrowBorder,this.arrowSize,this.arrowOffset));if(this.arrowBorder=="none"){this.lightShadow.setWidth(c-2);this.lightShadow.setHeight(a-2);this.setPosition(this.lightShadow,1,1);this.lightShadow.setPath(this.genPath(c-2,a-2,this.radius-1,this.arrowBorder));this.background.setWidth(c-4);this.background.setHeight(a-4);this.setPosition(this.background,2,2);this.background.setPath(this.genPath(c-4,a-4,this.radius-1.4,this.arrowBorder))}else{if(this.arrowBorder=="left"){this.lightShadow.setWidth(c-3);this.lightShadow.setHeight(a-2);this.setPosition(this.lightShadow,2,1);this.lightShadow.setPath(this.genPath(c-2,a-2,this.radius-1,this.arrowBorder,this.arrowSize-1,this.arrowOffset-1));this.background.setWidth(c-4.7);this.background.setHeight(a-3.7);this.setPosition(this.background,3.2,2);this.background.setPath(this.genPath(c-4.7,a-3.7,this.radius-1.4,this.arrowBorder,this.arrowSize-1.3,this.arrowOffset-2))}else{if(this.arrowBorder=="right"){this.lightShadow.setWidth(c-3);this.lightShadow.setHeight(a-2);this.setPosition(this.lightShadow,1,1);this.lightShadow.setPath(this.genPath(c-3,a-2,this.radius-1,this.arrowBorder,this.arrowSize-1,this.arrowOffset-1));this.background.setWidth(c-5.7);this.background.setHeight(a-3.7);this.setPosition(this.background,2.2,2);this.background.setPath(this.genPath(c-5.7,a-3.7,this.radius-1.4,this.arrowBorder,this.arrowSize-1.3,this.arrowOffset-2))}else{if(this.arrowBorder=="top"){this.lightShadow.setWidth(c-2);this.lightShadow.setHeight(a-3);this.setPosition(this.lightShadow,1,2);this.lightShadow.setPath(this.genPath(c-2,a-3,this.radius-1,this.arrowBorder,this.arrowSize-1,this.arrowOffset-1));this.background.setWidth(c-4);this.background.setHeight(a-5);this.setPosition(this.background,2,3);this.background.setPath(this.genPath(c-4,a-5,this.radius-1.4,this.arrowBorder,this.arrowSize-1.3,this.arrowOffset-2))}else{if(this.arrowBorder=="bottom"){this.lightShadow.setWidth(c-2);this.lightShadow.setHeight(a-3);this.setPosition(this.lightShadow,1,1);this.lightShadow.setPath(this.genPath(c-2,a-3,this.radius-1,this.arrowBorder,this.arrowSize-1,this.arrowOffset-1));this.background.setWidth(c-4);this.background.setHeight(a-5);this.setPosition(this.background,2,2);this.background.setPath(this.genPath(c-4,a-5,this.radius-1.4,this.arrowBorder,this.arrowSize-1.3,this.arrowOffset-2))}}}}}}});Ui.LBox.extend("Ui.Dialog",{lbox:undefined,vbox:undefined,titleLabel:undefined,contentBox:undefined,actionButtons:undefined,cancelBox:undefined,constructor:function(b){this.addEvents("close");this.append(new Ui.Rectangle({fill:"#ffffff",opacity:0.5}));this.lbox=new Ui.LBox({verticalAlign:"center",horizontalAlign:"center",margin:20});this.append(this.lbox);this.lbox.append(new Ui.Shadow({shadowWidth:5,radius:6,inner:false,opacity:0.3}));this.lbox.append(new Ui.Rectangle({radius:3,fill:"#f8f8f8",margin:3}));this.vbox=new Ui.VBox({margin:3});this.lbox.append(this.vbox);this.contentBox=new Ui.LBox({margin:10});this.vbox.append(this.contentBox,true);this.vbox.append(new Ui.Rectangle({height:1,fill:"#d8d8d8"}));lbox=new Ui.LBox({height:32});this.vbox.append(lbox);lbox.append(new Ui.Rectangle({radiusBottomLeft:3,radiusBottomRight:3,fill:"#e8e8e8"}));var a=new Ui.HBox({margin:5,spacing:30});lbox.append(a);this.cancelBox=new Ui.LBox();a.append(this.cancelBox);this.actionButtons=new Ui.HBox({uniform:true,horizontalAlign:"right"});a.append(this.actionButtons,true)},open:function(){Ui.App.current.appendDialog(this)},close:function(){Ui.App.current.removeDialog(this);this.fireEvent("close",this)},setTitle:function(a){this.title=a;if(((this.title=="")||(this.title===undefined))&&(this.titleLabel!==undefined)){this.vbox.remove(this.titleLabel);this.titleLabel=undefined}else{if(this.titleLabel===undefined){this.titleLabel=new Ui.Label({horizontalAlign:"left",margin:10,fontWeight:"bold",fontSize:18,color:"#666666"});this.vbox.prepend(this.titleLabel)}this.titleLabel.setText(this.title)}},setCancelButton:function(b){var a=this.cancelBox.getFirstChild();if((a!=undefined)&&Ui.Pressable.hasInstance(a)){this.disconnect(a,"press",this.onCancelPress)}this.cancelBox.setContent(b);var c=this.cancelBox.getFirstChild();if((c!=undefined)&&Ui.Pressable.hasInstance(c)){this.connect(c,"press",this.onCancelPress)}},setActionButtons:function(a){this.actionButtons.setContent(a)},onCancelPress:function(){this.close()}},{setContent:function(a){this.contentBox.setContent(a)}});Ui.Element.extend("Ui.Entry",{fontSize:14,fontFamily:"Sans-serif",fontWeight:"normal",color:"black",value:"",passwordMode:false,isDown:false,mouseStartX:undefined,mouseStartY:undefined,touchStartX:undefined,touchStartY:undefined,constructor:function(a){this.addEvents("press","down","up","change","validate");this.setSelectable(true);this.setFocusable(true);this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"fingerdown",this.onFingerDown);this.connect(this.getDrawing(),"touchstart",this.onTouchStart);this.connect(this.getDrawing(),"touchmove",this.onTouchMove);this.connect(this.getDrawing(),"touchend",this.onTouchEnd);this.connect(this.getDrawing(),"change",this.onChange);this.connect(this.getDrawing(),"paste",this.onPaste);this.connect(this.getDrawing(),"keyup",this.onKeyUp);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},setPasswordMode:function(a){if(this.passwordMode!=a){this.passwordMode=a;try{if(this.passwordMode){this.entryDrawing.setAttribute("type","password")}else{this.entryDrawing.setAttribute("type","text")}}catch(b){var c=this.entryDrawing.cloneNode(false);if(this.passwordMode){c.setAttribute("type","password")}else{c.setAttribute("type","text")}this.entryDrawing.parentNode.replaceChild(c,this.entryDrawing);this.entryDrawing=c;this.drawing=this.entryDrawing;this.invalidateArrange()}}},setFontSize:function(a){if(this.fontSize!=a){this.fontSize=a;this.entryDrawing.style.fontSize=this.fontSize+"px";this.invalidateMeasure()}},getFontSize:function(){return this.fontSize},setFontFamily:function(a){if(this.fontFamily!=a){this.fontFamily=a;this.entryDrawing.style.fontFamily=this.fontFamily;this.invalidateMeasure()}},getFontFamily:function(){return this.fontFamily},setFontWeight:function(a){if(this.fontWeight!=a){this.fontWeight=a;this.entryDrawing.style.fontWeight=this.fontWeight;this.invalidateMeasure()}},getFontWeight:function(){return this.fontWeight},setColor:function(a){if(this.color!=a){this.color=a;this.entryDrawing.style.color=this.color}},getColor:function(){return this.color},getValue:function(){return this.value},setValue:function(a){if(a===undefined){a=""}this.value=a;this.entryDrawing.value=this.value},getIsDown:function(){return this.isDown},onMouseDown:function(a){if(this.getHasFocus()){a.stopPropagation();return}if((a.button!=0)||this.getIsDisabled()){return}a.preventDefault();a.stopPropagation();this.mouseStartX=a.screenX;this.mouseStartY=a.screenY;this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true);this.onDown()},onMouseMove:function(d){var b=d.screenX-this.mouseStartX;var a=d.screenY-this.mouseStartY;var f=Math.sqrt(b*b+a*a);d.preventDefault();d.stopPropagation();if(f>10){this.onUp();if("createEvent" in document){this.disconnect(this.getDrawing(),"mousedown",this.onMouseDown);var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,d.target);d.target.dispatchEvent(c);this.connect(this.getDrawing(),"mousedown",this.onMouseDown)}}},onMouseUp:function(a){if(!this.isDown){return}a.preventDefault();a.stopPropagation();if(a.button==0){this.onUp();this.fireEvent("press",this);this.entryDrawing.focus()}},onTouchStart:function(a){if(this.getHasFocus()){a.stopPropagation()}},onTouchMove:function(a){if(this.getHasFocus()){a.stopPropagation()}},onTouchEnd:function(a){if(this.getHasFocus()){a.stopPropagation()}},onFingerDown:function(a){if(this.getHasFocus()){a.stopPropagation();return}if(this.getIsDisabled()||this.isDown){return}this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);a.finger.capture(this.getDrawing());a.preventDefault();a.stopPropagation();this.touchStartX=a.finger.getX();this.touchStartY=a.finger.getY();this.onDown()},onFingerMove:function(c){c.preventDefault();c.stopPropagation();var b=c.finger.getX()-this.touchStartX;var a=c.finger.getY()-this.touchStartY;var d=Math.sqrt(b*b+a*a);if(d>10){this.disconnect(c.finger,"fingermove",this.onFingerMove);this.disconnect(c.finger,"fingerup",this.onFingerUp);this.onUp();this.disconnect(this.getDrawing(),"fingerdown",this.onFingerDown);c.finger.release();this.connect(this.getDrawing(),"fingerdown",this.onFingerDown)}},onFingerUp:function(a){this.disconnect(a.finger,"fingermove",this.onFingerMove);this.disconnect(a.finger,"fingerup",this.onFingerUp);a.preventDefault();a.stopPropagation();this.onUp();this.fireEvent("press",this);this.entryDrawing.focus()},onDown:function(){this.isDown=true;this.fireEvent("down",this)},onUp:function(){this.disconnect(window,"mousemove",this.onMouseMove,true);this.disconnect(window,"mouseup",this.onMouseUp,true);this.isDown=false;this.fireEvent("up",this)},onPaste:function(a){a.stopPropagation();new Core.DelayedTask({delay:0,scope:this,callback:this.onAfterPaste})},onAfterPaste:function(){if(this.entryDrawing.value!=this.value){this.value=this.entryDrawing.value;this.fireEvent("change",this,this.value)}},onChange:function(a){a.preventDefault();a.stopPropagation();if(this.entryDrawing.value!=this.value){this.value=this.entryDrawing.value;this.fireEvent("change",this,this.value)}},onKeyDown:function(a){if(this.getHasFocus()){a.stopPropagation()}},onKeyUp:function(a){if(this.entryDrawing.value!=this.value){this.value=this.entryDrawing.value;this.fireEvent("change",this,this.value)}if(a.which==13){a.preventDefault();a.stopPropagation();this.fireEvent("validate",this)}else{if(this.getHasFocus()){a.stopPropagation()}}}},{renderDrawing:function(){this.entryDrawing=document.createElement("input");this.entryDrawing.setAttribute("type","text");this.entryDrawing.style.border="0px";this.entryDrawing.style.margin="0px";this.entryDrawing.style.padding="0px";this.entryDrawing.style.outline="none";if(!navigator.isIE7&&!navigator.isIE8){this.entryDrawing.style.background="none"}if(navigator.isWebkit){this.entryDrawing.style.webkitAppearance="none"}this.entryDrawing.style.fontSize=this.fontSize+"px";this.entryDrawing.style.fontFamily=this.fontFamily;this.entryDrawing.style.fontWeight=this.fontWeight;this.entryDrawing.style.color=this.color;return this.entryDrawing},measureCore:function(b,a){return{width:8,height:(this.fontSize*3/2)}},arrangeCore:function(b,a){this.entryDrawing.style.width=b+"px";this.entryDrawing.style.height=a+"px"},onDisable:function(){Ui.Entry.base.onDisable.call(this);this.entryDrawing.blur()},onEnable:function(){Ui.Entry.base.onEnable.call(this)}});Ui.Element.extend("Ui.TextArea",{textareaDrawing:undefined,fontSize:14,fontFamily:"sans-serif",fontWeight:"normal",color:"black",value:"",isDown:false,mouseStartX:undefined,mouseStartY:undefined,touchStartX:undefined,touchStartY:undefined,constructor:function(a){this.addEvents("down","up","change","scroll");this.setSelectable(true);this.setFocusable(true);this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"fingerdown",this.onFingerDown);this.connect(this.getDrawing(),"touchstart",this.onTouchStart);this.connect(this.getDrawing(),"touchmove",this.onTouchMove);this.connect(this.getDrawing(),"touchend",this.onTouchEnd);this.connect(this.textareaDrawing,"keyup",this.onKeyUp);this.connect(this.textareaDrawing,"scroll",function(){if((this.getMeasureWidth()!=this.textareaDrawing.scrollWidth)||(this.getMeasureHeight()!=this.textareaDrawing.scrollHeight)){this.invalidateMeasure()}this.fireEvent("scroll",this,this.textareaDrawing.scrollLeft,this.textareaDrawing.scrollTop)})},setFontSize:function(a){if(this.fontSize!=a){this.fontSize=a;this.textareaDrawing.style.fontSize=this.fontSize+"px";this.invalidateMeasure()}},getFontSize:function(){return this.fontSize},setFontFamily:function(a){if(this.fontFamily!=a){this.fontFamily=a;this.textareaDrawing.style.fontFamily=this.fontFamily;this.invalidateMeasure()}},getFontFamily:function(){return this.fontFamily},setFontWeight:function(a){if(this.fontWeight!=a){this.fontWeight=a;this.textareaDrawing.style.fontWeight=this.fontWeight;this.invalidateMeasure()}},getFontWeight:function(){return this.fontWeight},setColor:function(a){if(this.color!=a){this.color=a;this.textareaDrawing.style.color=this.color;this.invalidateMeasure()}},getColor:function(){return this.color},getValue:function(){return this.textareaDrawing.value},setValue:function(a){if(a===undefined){this.textareaDrawing.value=""}else{this.textareaDrawing.value=a}},setOffset:function(a,b){this.textareaDrawing.scrollLeft=a;this.textareaDrawing.scrollTop=b},getOffsetX:function(){return this.textareaDrawing.scrollLeft},getOffsetY:function(){return this.textareaDrawing.scrollTop},onMouseDown:function(a){if(this.getHasFocus()){a.stopPropagation();return}if((a.button!=0)||this.getIsDisabled()){return}a.preventDefault();a.stopPropagation();this.mouseStartX=a.screenX;this.mouseStartY=a.screenY;this.connect(window,"mousemove",this.onMouseMove,true);this.connect(window,"mouseup",this.onMouseUp,true);this.onDown()},onMouseMove:function(d){var b=d.screenX-this.mouseStartX;var a=d.screenY-this.mouseStartY;var f=Math.sqrt(b*b+a*a);d.preventDefault();d.stopPropagation();if(f>10){this.onUp();if("createEvent" in document){this.disconnect(this.getDrawing(),"mousedown",this.onMouseDown);var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,d.target);d.target.dispatchEvent(c);this.connect(this.getDrawing(),"mousedown",this.onMouseDown)}}},onMouseUp:function(a){if(!this.isDown){return}a.preventDefault();a.stopPropagation();if(a.button==0){this.onUp();this.getDrawing().focus()}},onTouchStart:function(a){if(this.getHasFocus()){a.stopPropagation()}},onTouchMove:function(a){if(this.getHasFocus()){a.stopPropagation()}},onTouchEnd:function(a){if(this.getHasFocus()){a.stopPropagation()}},onFingerDown:function(a){if(this.getHasFocus()){a.stopPropagation();return}if(this.getIsDisabled()||this.isDown){return}this.connect(a.finger,"fingermove",this.onFingerMove);this.connect(a.finger,"fingerup",this.onFingerUp);a.finger.capture(this.getDrawing());a.preventDefault();a.stopPropagation();this.touchStartX=a.finger.getX();this.touchStartY=a.finger.getY();this.onDown()},onFingerMove:function(c){c.preventDefault();c.stopPropagation();var b=c.finger.getX()-this.touchStartX;var a=c.finger.getY()-this.touchStartY;var d=Math.sqrt(b*b+a*a);if(d>10){this.disconnect(c.finger,"fingermove",this.onFingerMove);this.disconnect(c.finger,"fingerup",this.onFingerUp);this.onUp();this.disconnect(this.getDrawing(),"fingerdown",this.onFingerDown);c.finger.release();this.connect(this.getDrawing(),"fingerdown",this.onFingerDown)}},onFingerUp:function(a){this.disconnect(a.finger,"fingermove",this.onFingerMove);this.disconnect(a.finger,"fingerup",this.onFingerUp);a.preventDefault();a.stopPropagation();this.onUp();this.getDrawing().focus()},onDown:function(){this.isDown=true;this.fireEvent("down",this)},onUp:function(){this.disconnect(window,"mousemove",this.onMouseMove,true);this.disconnect(window,"mouseup",this.onMouseUp,true);this.isDown=false;this.fireEvent("up",this)},onKeyUp:function(a){if(this.textareaDrawing.value!=this.value){this.value=this.textareaDrawing.value;this.fireEvent("change",this,this.value)}this.invalidateMeasure()}},{renderDrawing:function(){this.textareaDrawing=document.createElement("textarea");this.textareaDrawing.setAttribute("rows",1);this.textareaDrawing.setAttribute("cols",1);this.textareaDrawing.style.display="block";this.textareaDrawing.style.resize="none";this.textareaDrawing.style.overflow="hidden";this.textareaDrawing.style.border="0px";this.textareaDrawing.style.margin="0px";this.textareaDrawing.style.padding="0px";this.textareaDrawing.style.outline="none";if(!navigator.isIE7&&!navigator.isIE8){this.textareaDrawing.style.background="none"}if(navigator.isWebkit){this.textareaDrawing.style.webkitAppearance="none"}this.textareaDrawing.style.fontSize=this.fontSize+"px";this.textareaDrawing.style.fontFamily=this.fontFamily;this.textareaDrawing.style.fontWeight=this.fontWeight;this.textareaDrawing.style.color=this.color;return this.textareaDrawing},measureCore:function(c,a){this.textareaDrawing.style.width=c+"px";this.textareaDrawing.style.height="0px";var b={width:this.textareaDrawing.scrollWidth,height:this.textareaDrawing.scrollHeight};this.textareaDrawing.style.width=this.getLayoutWidth()+"px";this.textareaDrawing.style.height=this.getLayoutHeight()+"px";return b},arrangeCore:function(b,a){this.textareaDrawing.style.width=b+"px";this.textareaDrawing.style.height=a+"px"}},{});Ui.Pressable.extend("Ui.Button",{graphic:undefined,constructor:function(a){this.graphic=new Ui.ButtonGraphic();this.append(this.graphic);this.connect(this,"down",function(){this.graphic.setIsDown(true)});this.connect(this,"up",function(){this.graphic.setIsDown(false)});this.connect(this,"focus",function(){this.graphic.setColor(this.getStyleProperty("focusColor"))});this.connect(this,"blur",function(){this.graphic.setColor(this.getStyleProperty("color"))})},getText:function(){return this.graphic.getText()},setText:function(a){this.graphic.setText(a)},getIcon:function(){return this.graphic.getIcon()},setIcon:function(a){this.graphic.setIcon(a)},getOrientation:function(){return this.graphic.getOrientation()},setOrientation:function(a){this.graphic.setOrientation(a)}},{setContent:function(a){this.graphic.setContent(a)},onStyleChange:function(){this.graphic.setRadius(this.getStyleProperty("radius"));this.graphic.setSpacing(this.getStyleProperty("spacing"));this.graphic.setIconSize(this.getStyleProperty("iconSize"));if(this.getHasFocus()){this.graphic.setColor(this.getStyleProperty("focusColor"))}else{this.graphic.setColor(this.getStyleProperty("color"))}},onDisable:function(){Ui.Button.base.onDisable.call(this);this.graphic.setIsEnable(false)},onEnable:function(){Ui.Button.base.onEnable.call(this);this.graphic.setIsEnable(true)}},{style:{color:new Ui.Color({r:0.31,g:0.66,b:1}),focusColor:"#f6caa2",radius:4,spacing:3,iconSize:24}});Ui.Pressable.extend("Ui.Combo",{field:undefined,data:undefined,position:-1,dialog:undefined,graphic:undefined,current:undefined,placeHolder:undefined,constructor:function(a){this.addEvents("change");this.graphic=new Ui.ButtonGraphic();this.append(this.graphic);var c=new Ui.HBox({margin:5,spacing:4});this.graphic.setContent(c);this.transitionbox=new Ui.TransitionBox({duration:0.25});c.append(this.transitionbox);this.placeHolder=new Ui.Label({horizontalAlign:"left"});this.transitionbox.append(this.placeHolder);this.transitionbox.setCurrent(this.placeHolder);c.append(new Ui.Rectangle({margin:2,width:1,fill:"black"}));var b=new Ui.VBox();c.append(b);b.append(new Ui.Icon({icon:"arrowtop",width:10,height:10,fill:"black"}));b.append(new Ui.Icon({icon:"arrowbottom",width:10,height:10,fill:"black"}));this.dialog=new Ui.ComboDialog();this.connect(this.dialog,"item",this.onItemPress);this.connect(this,"press",this.onPress);this.connect(this,"down",function(){this.graphic.setIsDown(true)});this.connect(this,"up",function(){this.graphic.setIsDown(false)});this.connect(this,"focus",function(){this.graphic.setColor(this.getStyleProperty("focusColor"))});this.connect(this,"blur",function(){this.graphic.setColor(this.getStyleProperty("color"))})},setPlaceHolder:function(a){this.placeHolder.setText(a)},setField:function(a){this.field=a;if(this.data!=undefined){this.setData(this.data)}},setData:function(b){this.data=b;if(this.field===undefined){return}for(var a=0;a<b.length;a++){this.dialog.appendItem(new Ui.Label({text:b[a][this.field],horizontalAlign:"left"}));this.transitionbox.append(new Ui.Label({text:b[a][this.field],horizontalAlign:"left"}))}},getData:function(){return this.data},open:function(){this.dialog.show(this)},close:function(){this.dialog.hide(this)},getPosition:function(){return this.position},setCurrentAt:function(a){if(a==-1){this.position=-1;this.current=undefined;this.transitionbox.setCurrentAt(0);this.fireEvent("change",this,this.current,this.position)}else{if((a>=0)&&(a<this.data.length)){this.transitionbox.setCurrentAt(a+1);this.current=this.data[a];this.position=a;this.fireEvent("change",this,this.current,this.position)}}},getCurrent:function(){return this.current},setCurrent:function(c){if(c===undefined){this.setCurrentAt(-1)}var a=-1;for(var b=0;b<this.data.length;b++){if(this.data[b]==c){a=b;break}}if(a!=-1){this.setCurrentAt(a)}},onPress:function(){this.open()},onItemPress:function(b,c,a){this.setCurrentAt(a)}},{onStyleChange:function(){this.graphic.setRadius(this.getStyleProperty("radius"));this.graphic.setSpacing(this.getStyleProperty("spacing"));if(this.getHasFocus()){this.graphic.setColor(this.getStyleProperty("focusColor"))}else{this.graphic.setColor(this.getStyleProperty("color"))}},onDisable:function(){Ui.Combo.base.onDisable.call(this);this.graphic.setIsEnable(false)},onEnable:function(){Ui.Combo.base.onEnable.call(this);this.graphic.setIsEnable(true)}},{style:{color:new Ui.Color({r:0.31,g:0.66,b:1}),focusColor:"#f6caa2",radius:4,spacing:3}});Ui.Popup.extend("Ui.ComboDialog",{scroll:undefined,list:undefined,constructor:function(a){this.addEvents("item");this.setExpandable(true);this.setAutoHide(true);this.scroll=new Ui.ScrollingArea({margin:0,scrollHorizontal:true});this.list=new Ui.VBox();this.scroll.setContent(this.list);this.setContent(this.scroll)},appendItem:function(b){var a=new Ui.ComboItem();a.setContent(b);this.connect(a,"press",this.onItemPress);this.list.append(a);return a},onItemPress:function(c){var d=c.getContent();var a=-1;for(var b=0;b<this.list.getChildren().length;b++){if(this.list.getChildren()[b]==c){a=b;break}}this.fireEvent("item",this,d,a);this.hide()}});Ui.MouseOverable.extend("Ui.ComboItem",{background:undefined,pressable:undefined,constructor:function(){this.addEvents("press");this.background=new Ui.Rectangle({fill:"#1c8ef2",opacity:0,radius:4});this.append(this.background);this.pressable=new Ui.Pressable({padding:5,paddingLeft:10,paddingRight:10});this.append(this.pressable);this.connect(this.pressable,"press",function(){this.fireEvent("press",this)});this.connect(this,"enter",this.onEnter);this.connect(this,"leave",this.onLeave);this.connect(this.pressable,"down",this.onDown);this.connect(this.pressable,"up",this.onUp)},getContent:function(){return this.pressable.getChildren()[0]},onEnter:function(){this.background.setOpacity(0.6)},onLeave:function(){this.background.setOpacity(0)},onDown:function(){this.background.setOpacity(1)},onUp:function(){this.background.setOpacity(0)}},{setContent:function(a){this.pressable.setContent(Ui.Element.create(a))}});Ui.Togglable.extend("Ui.ToggleButton",{graphic:undefined,constructor:function(a){this.graphic=new Ui.ButtonGraphic();this.append(this.graphic);this.connect(this,"down",function(){this.graphic.setIsDown(true)});this.connect(this,"up",function(){this.graphic.setIsDown(this.getIsDown()||this.getIsToggled())});this.connect(this,"toggle",function(){this.graphic.setIsDown(true)});this.connect(this,"untoggle",function(){this.graphic.setIsDown(this.getIsDown()||this.getIsToggled())});this.connect(this,"focus",function(){this.graphic.setColor(this.getStyleProperty("focusColor"))});this.connect(this,"blur",function(){this.graphic.setColor(this.getStyleProperty("color"))})},getText:function(){return this.graphic.getText()},setText:function(a){this.graphic.setText(a)},getIcon:function(){return this.graphic.getIcon()},setIcon:function(a){this.graphic.setIcon(a)},getOrientation:function(){return this.graphic.getOrientation()},setOrientation:function(a){this.graphic.setOrientation(a)}},{onStyleChange:function(){this.graphic.setRadius(this.getStyleProperty("radius"));this.graphic.setSpacing(this.getStyleProperty("spacing"));if(this.getHasFocus()){this.graphic.setColor(this.getStyleProperty("focusColor"))}else{this.graphic.setColor(this.getStyleProperty("color"))}},onDisable:function(){Ui.Button.base.onDisable.call(this);this.graphic.setIsEnable(false)},onEnable:function(){Ui.Button.base.onEnable.call(this);this.graphic.setIsEnable(true)}},{style:{color:new Ui.Color({r:0.31,g:0.66,b:1}),focusColor:"#f6caa2",radius:4,spacing:3}});Ui.Uploadable.extend("Ui.UploadButton",{graphic:undefined,constructor:function(a){this.graphic=new Ui.ButtonGraphic();this.append(this.graphic);this.connect(this,"down",function(){this.graphic.setIsDown(true)});this.connect(this,"up",function(){this.graphic.setIsDown(false)});this.connect(this,"focus",function(){this.graphic.setColor(this.getStyleProperty("focusColor"))});this.connect(this,"blur",function(){this.graphic.setColor(this.getStyleProperty("color"))})},getText:function(){return this.graphic.getText()},setText:function(a){this.graphic.setText(a)},getIcon:function(){return this.graphic.getIcon()},setIcon:function(a){this.graphic.setIcon(a)},getOrientation:function(){return this.graphic.getOrientation()},setOrientation:function(a){this.graphic.setOrientation(a)}},{setContent:function(a){this.graphic.setContent(a)},onStyleChange:function(){this.graphic.setRadius(this.getStyleProperty("radius"));this.graphic.setSpacing(this.getStyleProperty("spacing"));if(this.getHasFocus()){this.graphic.setColor(this.getStyleProperty("focusColor"))}else{this.graphic.setColor(this.getStyleProperty("color"))}},onDisable:function(){Ui.Button.base.onDisable.call(this);this.graphic.setIsEnable(false)},onEnable:function(){Ui.Button.base.onEnable.call(this);this.graphic.setIsEnable(true)}},{style:{color:"#4fa8ff",focusColor:"#f6caa2",radius:4,spacing:3}});Ui.Linkable.extend("Ui.LinkButton",{graphic:undefined,constructor:function(a){this.graphic=new Ui.ButtonGraphic();this.setContent(this.graphic);this.connect(this,"down",function(){this.graphic.setIsDown(true)});this.connect(this,"up",function(){this.graphic.setIsDown(false)});this.connect(this,"focus",function(){this.graphic.setColor(this.getStyleProperty("focusColor"))});this.connect(this,"blur",function(){this.graphic.setColor(this.getStyleProperty("color"))})},getText:function(){return this.graphic.getText()},setText:function(a){this.graphic.setText(a)},getIcon:function(){return this.graphic.getIcon()},setIcon:function(a){this.graphic.setIcon(a)},getOrientation:function(){return this.graphic.getOrientation()},setOrientation:function(a){this.graphic.setOrientation(a)}},{onStyleChange:function(){this.graphic.setRadius(this.getStyleProperty("radius"));this.graphic.setSpacing(this.getStyleProperty("spacing"));if(this.getHasFocus()){this.graphic.setColor(this.getStyleProperty("focusColor"))}else{this.graphic.setColor(this.getStyleProperty("color"))}},onDisable:function(){Ui.Button.base.onDisable.call(this);this.graphic.setIsEnable(false)},onEnable:function(){Ui.Button.base.onEnable.call(this);this.graphic.setIsEnable(true)}},{style:{color:"#4fa8ff",focusColor:"#f6caa2",radius:4,spacing:3}});Ui.LinkButton.extend("Ui.DownloadButton",{constructor:function(a){this.addEvents("download");this.connect(this,"link",function(){this.fireEvent("download",this)})}});Ui.Togglable.extend("Ui.CheckBox",{check:undefined,checkBox:undefined,contentBox:undefined,hbox:undefined,lightShadow:undefined,darkShadow:undefined,lightBorder:undefined,background:undefined,content:undefined,text:undefined,constructor:function(a){this.addEvents("change");this.setPadding(3);this.hbox=new Ui.HBox();this.append(this.hbox);this.checkBox=new Ui.LBox();this.hbox.append(this.checkBox);this.lightShadow=new Ui.Rectangle({fill:new Ui.Color({r:1,g:1,b:1,a:0.25}),radius:4,margin:10,marginTop:11});this.checkBox.append(this.lightShadow);this.darkShadow=new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.4}),radius:4,margin:10,marginBottom:11});this.checkBox.append(this.darkShadow);this.lightBorder=new Ui.Rectangle({fill:"lightgray",radius:4,marginTop:11,marginBottom:12,marginLeft:11,marginRight:11});this.checkBox.append(this.lightBorder);this.background=new Ui.Rectangle({fill:"darkgray",radius:3,marginTop:12,marginBottom:12,marginLeft:11,marginRight:11});this.checkBox.append(this.background);this.check=new Ui.Icon({icon:"check",width:24,height:24,fill:"green"});this.check.setMargin(12);this.check.hide();this.checkBox.append(this.check);this.connect(this,"down",this.onCheckBoxDown);this.connect(this,"up",this.onCheckBoxUp);this.connect(this,"toggle",this.onCheckBoxToggle);this.connect(this,"untoggle",this.onCheckBoxUntoggle)},getValue:function(){return this.getIsToggled()},setValue:function(a){if(a){this.toggle()}else{this.untoggle()}},setText:function(a){if(a===undefined){if(this.contentBox!=undefined){this.hbox.remove(this.contentBox);this.contentBox=undefined}this.text=undefined;this.content=undefined}else{if(this.text!=undefined){this.text=a;this.contentBox.setText(this.text)}else{if(this.content!=undefined){this.hbox.remove(this.contentBox);this.content=undefined}this.text=a;this.contentBox=new Ui.Label({margin:8,text:this.text});this.hbox.append(this.contentBox)}}},getText:function(){return this.text},onCheckBoxDown:function(){this.background.setFill(this.getGradientDown());this.lightBorder.setFill(this.getLightBorderColorDown())},onCheckBoxUp:function(){this.background.setFill(this.getGradient());this.lightBorder.setFill(this.getLightBorderColor())},onCheckBoxToggle:function(){this.check.show()},onCheckBoxUntoggle:function(){this.check.hide()},getGradient:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:0.05,color:new Ui.Color({y:a.y,u:a.u,v:a.v})},{offset:0.9,color:new Ui.Color({y:a.y,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]})},getGradientDown:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1-0.2,u:a.u,v:a.v})},{offset:0.1,color:new Ui.Color({y:a.y-0.2,u:a.u,v:a.v})},{offset:0.9,color:new Ui.Color({y:a.y-0.2,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1-0.2,u:a.u,v:a.v})}]})},getLightBorderColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y+0.2,u:a.u,v:a.v})},getLightBorderColorDown:function(){var a=this.getStyleProperty("color").getYuv();if(a.y<0.4){return new Ui.Color({y:a.y,u:a.u,v:a.v})}else{return new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}}},{onStyleChange:function(){this.check.setFill(this.getStyleProperty("checkColor"));if(this.getIsDown()){this.background.setFill(this.getGradientDown());this.lightBorder.setFill(this.getLightBorderColorDown())}else{this.background.setFill(this.getGradient());this.lightBorder.setFill(this.getLightBorderColor())}var a=this.getStyleProperty("radius");this.lightShadow.setRadius(a);this.darkShadow.setRadius(a);this.lightBorder.setRadius(a);this.background.setRadius(a)},onDisable:function(){Ui.CheckBox.base.onDisable.call(this);this.check.setOpacity(0.4)},onEnable:function(){Ui.CheckBox.base.onEnable.call(this);this.check.setOpacity(1)},onToggle:function(){Ui.CheckBox.base.onToggle.call(this);this.fireEvent("change",this,true)},onUntoggle:function(){Ui.CheckBox.base.onUntoggle.call(this);this.fireEvent("change",this,false)},setContent:function(a){a=Ui.Element.create(a);if(a===undefined){if(this.contentBox!=undefined){this.hbox.remove(this.contentBox);this.contentBox=undefined}this.text=undefined;this.content=undefined}else{if(this.text!=undefined){this.hbox.remove(this.contentBox);this.text=undefined}if(this.content!=undefined){this.contentBox.remove(this.content)}else{this.contentBox=new Ui.LBox({padding:8});this.hbox.append(this.contentBox)}this.content=a;this.contentBox.append(this.content)}}},{style:{color:new Ui.Color({r:0.89,g:0.89,b:0.89}),checkColor:new Ui.Color({r:0,g:0.6,b:0}),radius:4}});Ui.LBox.extend("Ui.ToolBar",{hbox:undefined,scroll:undefined,background:undefined,constructor:function(a){this.topShadow=new Ui.Rectangle({height:1,verticalAlign:"top"});Ui.ToolBar.base.append.call(this,this.topShadow);this.bottomShadow=new Ui.Rectangle({height:1,verticalAlign:"bottom"});Ui.ToolBar.base.append.call(this,this.bottomShadow);var b=new Ui.LBox({marginTop:1,marginBottom:1});Ui.ToolBar.base.append.call(this,b);this.background=new Ui.Rectangle({});b.append(this.background);this.scroll=new Ui.ScrollingArea({scrollVertical:false,verticalAlign:"center"});b.append(this.scroll);this.hbox=new Ui.HBox();this.scroll.setContent(this.hbox)},getGradient:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]})},getLightColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y+0.3,u:a.u,v:a.v})},getDarkColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y-0.3,u:a.u,v:a.v})}},{append:function(b,a){this.hbox.append(b,a)},remove:function(a){this.hbox.remove(a)},setContent:function(a){this.hbox.setContent(a)},onStyleChange:function(){var d;var b;var a;var c=this.getStyleProperty("color").getYuv();d=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:c.y+0.1,u:c.u,v:c.v})},{offset:1,color:new Ui.Color({y:c.y-0.1,u:c.u,v:c.v})}]});b=new Ui.Color({y:c.y+0.3,u:c.u,v:c.v});a=new Ui.Color({y:c.y-0.3,u:c.u,v:c.v});this.background.setFill(d);this.topShadow.setFill(b);this.bottomShadow.setFill(a);var f=this.getStyleProperty("spacing");this.hbox.setMargin(f);this.hbox.setSpacing(f)}},{style:{color:new Ui.Color({r:0.11,g:0.56,b:1}),spacing:3}});Ui.Scrollable.extend("Ui.ScrollingArea",{horizontalScrollbar:undefined,verticalScrollbar:undefined,topShadow:undefined,bottomShadow:undefined,leftShadow:undefined,rightShadow:undefined,constructor:function(a){this.horizontalScrollbar=new Ui.Rectangle({radius:4,width:8,height:8,margin:10});this.setScrollbarHorizontal(this.horizontalScrollbar);this.verticalScrollbar=new Ui.Rectangle({radius:4,width:8,height:8,margin:10});this.setScrollbarVertical(this.verticalScrollbar);this.topShadow=new Ui.Rectangle({height:5});this.setTopShadow(this.topShadow);this.bottomShadow=new Ui.Rectangle({height:5});this.setBottomShadow(this.bottomShadow);this.leftShadow=new Ui.Rectangle({width:5});this.setLeftShadow(this.leftShadow);this.rightShadow=new Ui.Rectangle({width:5});this.setRightShadow(this.rightShadow)}},{setShowScrollbar:function(a){Ui.ScrollingArea.base.setShowScrollbar.call(this,a);if(a){this.horizontalScrollbar.setOpacity(1);this.horizontalScrollbar.setMargin(10);this.horizontalScrollbar.setWidth(8);this.horizontalScrollbar.setHeight(8);this.horizontalScrollbar.setRadius(4);this.verticalScrollbar.setOpacity(1);this.verticalScrollbar.setMargin(10);this.verticalScrollbar.setWidth(8);this.verticalScrollbar.setHeight(8);this.verticalScrollbar.setRadius(4)}else{this.horizontalScrollbar.setOpacity(0.6);this.horizontalScrollbar.setMargin(2);this.horizontalScrollbar.setWidth(4);this.horizontalScrollbar.setHeight(4);this.horizontalScrollbar.setRadius(2);this.verticalScrollbar.setOpacity(0.6);this.verticalScrollbar.setMargin(2);this.verticalScrollbar.setWidth(4);this.verticalScrollbar.setHeight(4);this.verticalScrollbar.setRadius(2)}},onStyleChange:function(){var b=this.getStyleProperty("color");this.horizontalScrollbar.setFill(b);this.verticalScrollbar.setFill(b);var g=this.getStyleProperty("shadowColor").getRgb();var f=new Ui.Color({r:g.r,g:g.g,b:g.b,a:0});var a=new Ui.Color({r:g.r,g:g.g,b:g.b,a:0.3});var d=new Ui.LinearGradient({orientation:"vertical",stops:[{offset:0,color:a},{offset:1,color:f}]});this.topShadow.setFill(d);d=new Ui.LinearGradient({orientation:"vertical",stops:[{offset:0,color:f},{offset:1,color:a}]});this.bottomShadow.setFill(d);var d=new Ui.LinearGradient({orientation:"horizontal",stops:[{offset:0,color:a},{offset:1,color:f}]});this.leftShadow.setFill(d);var d=new Ui.LinearGradient({orientation:"horizontal",stops:[{offset:0,color:f},{offset:1,color:a}]});this.rightShadow.setFill(d)}},{style:{color:new Ui.Color({r:0,g:0.62,b:0.88}),shadowColor:new Ui.Color({r:0,g:0,b:0})}});Ui.Scrollable2.extend("Ui.ScrollingArea2",{horizontalScrollbar:undefined,verticalScrollbar:undefined,constructor:function(a){this.horizontalScrollbar=new Ui.Rectangle({fill:new Ui.Color({r:0.2,g:0.2,b:0.2,a:0.7}),radius:2,width:4,height:4,margin:2});this.setScrollbarHorizontal(this.horizontalScrollbar);this.verticalScrollbar=new Ui.Rectangle({fill:new Ui.Color({r:0.2,g:0.2,b:0.2,a:0.7}),radius:2,width:4,height:4,margin:2});this.setScrollbarVertical(this.verticalScrollbar)}},{onStyleChange:function(){var a=this.getStyleProperty("color");this.horizontalScrollbar.setFill(a);this.verticalScrollbar.setFill(a)}},{style:{color:new Ui.Color({r:0.2,g:0.2,b:0.2,a:0.7})}});Ui.Container.extend("Ui.Slider",{value:0,background:undefined,button:undefined,constructor:function(a){this.addEvents("change");this.lightShadow=new Ui.Rectangle({fill:new Ui.Color({r:1,g:1,b:1,a:0.25}),radius:4});this.appendChild(this.lightShadow);this.darkShadow=new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.4}),radius:4});this.appendChild(this.darkShadow);this.background=new Ui.Rectangle({fill:new Ui.Color({r:0.85,g:0.85,b:0.85}),radius:4});this.appendChild(this.background);this.backgroundShadow=new Ui.Shadow({shadowWidth:2,inner:true,radius:4,opacity:0.2});this.appendChild(this.backgroundShadow);this.barBox=new Ui.LBox();this.appendChild(this.barBox);this.barBackground=new Ui.Rectangle({radius:3});this.barBox.append(this.barBackground);this.bar=new Ui.Rectangle({margin:1,radius:3});this.barBox.append(this.bar);this.button=new Ui.Movable({moveVertical:false});this.appendChild(this.button);this.connect(this.button,"move",this.onButtonMove);this.connect(this.button,"focus",this.updateColors);this.connect(this.button,"blur",this.updateColors);this.connect(this.button,"down",this.updateColors);this.connect(this.button,"up",this.updateColors);this.buttonContent=new Ui.SliderContentDrawing({marginTop:5,marginLeft:10,marginRight:10});this.button.setContent(this.buttonContent)},getValue:function(){return this.value},setValue:function(a){if(this.value!=a){this.value=a;this.updateValue();this.fireEvent("change",this)}},onButtonMove:function(b){var f=this.button.getPositionX();var c=this.getLayoutWidth();var d=c-44;if(f<0){f=0}else{if(f>d){f=d}}var a=this.value;this.value=f/d;this.disconnect(this.button,"move",this.onButtonMove);this.updateValue();this.connect(this.button,"move",this.onButtonMove);if(a!=this.value){this.fireEvent("change",this)}},updateValue:function(){var b=this.getLayoutWidth();var a=this.getLayoutHeight();var c=b-44;this.button.setPosition(c*this.value,undefined);var d=(a-44)/2;this.barBox.arrange(18,d+18,(b-36)*this.value,9)},getGradient:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]})},getBarBorderColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y-0.2,u:a.u,v:a.v})},getContentBorderColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y-0.4,u:a.u,v:a.v})},getButtonColor:function(){var b=this.getStyleProperty("color").getYuv();var a=0;if(this.button.getIsDown()){a=-0.3}else{if(this.button.getHasFocus()){a=0.1}}return new Ui.Color({y:b.y+a,u:b.u,v:b.v})},updateColors:function(){this.bar.setFill(this.getGradient());this.barBackground.setFill(this.getBarBorderColor());this.buttonContent.setFill(this.getButtonColor())}},{measureCore:function(b,a){this.lightShadow.measure(b-34,10);this.darkShadow.measure(b-34,10);this.background.measure(b-36,10);this.backgroundShadow.measure(b-36,10);this.barBox.measure(b-38,9);this.button.measure(40,40);return{width:88,height:44}},arrangeCore:function(b,a){var c=(a-44)/2;this.lightShadow.arrange(17,c+18,b-34,10);this.darkShadow.arrange(17,c+17,b-34,10);this.background.arrange(18,c+18,b-36,10);this.backgroundShadow.arrange(18,c+18,b-36,10);this.button.arrange(2,c+2,40,40);this.updateValue()},onStyleChange:function(){this.updateColors()},onDisable:function(){Ui.Slider.base.onDisable.call(this);this.button.setOpacity(0.2)},onEnable:function(){Ui.Slider.base.onEnable.call(this);this.button.setOpacity(1)}},{style:{color:new Ui.Color({r:0.31,g:0.66,b:1})}});Ui.LBox.extend("Ui.SliderContentDrawing",{contentDrawing:undefined,svgGradient:undefined,shadow:undefined,background:undefined,radius:8,fill:"black",constructor:function(a){this.shadow=new Ui.Shape();this.append(this.shadow);this.background=new Ui.Shape({margin:1});this.append(this.background)},setRadius:function(a){if(this.radius!=a){this.radius=a}},setFill:function(c){if(this.fill!=c){this.fill=Ui.Color.create(c);var a=this.fill.getYuv();var b=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.2,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]});this.background.setFill(b);this.shadow.setFill((new Ui.Color({y:a.y-0.9,u:a.u,v:a.v})).getCssHtml())}},genPath:function(c,b,a){return"M"+a+",0 L"+(c-a)+",0 Q"+c+",0 "+c+","+a+"  L"+c+","+(b*0.66)+" L"+(c/2)+","+b+" L0,"+(b*0.66)+" L0,"+a+" Q0,0 "+a+",0 z"}},{arrangeCore:function(b,a){Ui.SliderContentDrawing.base.arrangeCore.call(this,b,a);this.shadow.setPath(this.genPath(b,a,this.radius));this.background.setPath(this.genPath(b-2,a-2,this.radius-1.4))}});Ui.Container.extend("Ui.ProgressBar",{value:0,barBox:undefined,barBackground:undefined,bar:undefined,lightShadow:undefined,darkShadow:undefined,lightBorder:undefined,background:undefined,constructor:function(a){this.lightShadow=new Ui.Rectangle({fill:new Ui.Color({r:1,g:1,b:1,a:0.25}),radius:4,marginTop:1});this.appendChild(this.lightShadow);this.darkShadow=new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.4}),radius:4,marginBottom:1});this.appendChild(this.darkShadow);this.lightBorder=new Ui.Rectangle({fill:"lightgray",radius:4,marginTop:1,marginBottom:2,marginLeft:1,marginRight:1});this.appendChild(this.lightBorder);this.background=new Ui.Shadow({shadowWidth:2,inner:true,radius:3,opacity:0.2,margin:1,marginBottom:2});this.appendChild(this.background);this.barBox=new Ui.LBox();this.appendChild(this.barBox);this.barBackground=new Ui.Rectangle();this.barBox.append(this.barBackground);this.bar=new Ui.Rectangle({margin:1});this.barBox.append(this.bar)},setValue:function(b){if(b!=this.value){this.value=b;var a=(this.getLayoutWidth()-4)*this.value;if(a<2){this.barBox.hide()}else{this.barBox.show();this.barBox.arrange(2,2,a,this.getLayoutHeight()-5)}}},getValue:function(){return this.value},getGradient:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]})},getBarBorderColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y-0.2,u:a.u,v:a.v})},getLightBorderColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y+0.3,u:a.u,v:a.v})}},{measureCore:function(d,a){var f=0;var c=0;var b;b=this.lightShadow.measure(d,a);f=Math.max(b.height,f);c=Math.max(b.width,c);b=this.darkShadow.measure(d,a);f=Math.max(b.height,f);c=Math.max(b.width,c);b=this.lightBorder.measure(d,a);f=Math.max(b.height,f);c=Math.max(b.width,c);b=this.background.measure(d,a);f=Math.max(b.height,f);c=Math.max(b.width,c);this.barBox.measure(d,a);return{width:Math.max(c,12),height:Math.max(f,12)}},arrangeCore:function(c,a){this.lightShadow.arrange(0,0,c,a);this.darkShadow.arrange(0,0,c,a);this.lightBorder.arrange(0,0,c,a);this.background.arrange(0,0,c,a);var b=(c-4)*this.value;if(b<2){this.barBox.hide()}else{this.barBox.show();this.barBox.arrange(2,2,b,this.getLayoutHeight()-5)}},onStyleChange:function(){var a=this.getStyleProperty("radius");this.bar.setRadius(a);this.bar.setFill(this.getGradient());this.barBackground.setRadius(a);this.barBackground.setFill(this.getBarBorderColor())}},{style:{color:new Ui.Color({r:0.39,g:0.92,b:0.39}),radius:4}});Ui.LBox.extend("Ui.Loading",{icon:undefined,clock:undefined,constructor:function(a){this.icon=new Ui.Icon({icon:"loading"});this.icon.setTransformOrigin(0.5,0.5);this.append(this.icon);this.clock=new Anim.Clock({repeat:"forever",duration:2,onTimeupdate:this.onTick,scope:this})},onTick:function(b,a){this.icon.setTransform(Ui.Matrix.createRotate(a*360))}},{onLoad:function(){Ui.Loading.base.onLoad.call(this);this.clock.begin()},onUnload:function(){Ui.Loading.base.onUnload.call(this);this.clock.stop()},onStyleChange:function(){this.icon.setFill(this.getStyleProperty("color"))}},{style:{color:new Ui.Color({r:0.39,g:0.39,b:0.39})}});Ui.ScrollingArea.extend("Ui.IconList",{flow:undefined,constructor:function(a){this.flow=new Ui.Flow({uniform:true});this.setContent(this.flow)},append:function(a){this.flow.append(a)},remove:function(a){this.flow.remove(a)}},{clear:function(){while(this.flow.getChildren().length>0){this.flow.remove(this.flow.getChildren()[0])}}});Ui.Selectable.extend("Ui.IconListItem",{constructor:function(a){this.setPadding(10);this.setVerticalAlign("top");this.setHorizontalAlign("center")}});Ui.Container.extend("Ui.Locator",{path:undefined,foregrounds:undefined,backgrounds:undefined,spacing:2,border:undefined,constructor:function(a){this.addEvents("change")},setPath:function(l){this.path=l;while(this.getChildren().length>0){this.removeChild(this.getChildren()[0])}this.border=new Ui.Frame({frameWidth:1,fill:"#888888",radius:8});this.appendChild(this.border);this.backgrounds=[];this.foregrounds=[];var f;var h=this.getGradient();if(l=="/"){var d=new Ui.Pressable();d.locatorPath="/";d.locatorPos=0;this.connect(d,"press",this.onPathPress);this.connect(d,"down",this.onPathDown);this.connect(d,"up",this.onPathUp);d.appendChild(new Ui.Rectangle({fill:h,radius:7}));this.backgrounds.push(d);this.appendChild(d);var a=new Ui.Pressable();a.locatorPath="/";a.locatorPos=0;this.connect(a,"press",this.onPathPress);this.connect(a,"down",this.onPathDown);this.connect(a,"up",this.onPathUp);var g=new Ui.Icon({icon:"home",width:25,height:25});g.setVerticalAlign("center");g.setHorizontalAlign("center");g.setMargin(5);a.appendChild(g);this.foregrounds.push(a);this.appendChild(a)}else{var k=l.split("/");var b=[];for(var c=0;c<k.length;c++){if(k[c]!=""){b.push(k[c])}}k=b;var j="/";var d=new Ui.Pressable();d.locatorPath=j;d.locatorPos=0;this.connect(d,"press",this.onPathPress);this.connect(d,"down",this.onPathDown);this.connect(d,"up",this.onPathUp);d.appendChild(new Ui.LocatorRightArrow({fill:h,radius:7}));this.backgrounds.push(d);this.appendChild(d);var a=new Ui.Pressable();a.locatorPath=j;a.locatorPos=0;this.connect(a,"press",this.onPathPress);this.connect(a,"down",this.onPathDown);this.connect(a,"up",this.onPathUp);var g=new Ui.Icon({icon:"home",width:25,height:25});g.setVerticalAlign("center");g.setHorizontalAlign("center");g.setMargin(5);a.appendChild(g);this.foregrounds.push(a);this.appendChild(a);for(var c=0;c<k.length;c++){j+=k[c];var d=new Ui.Pressable();d.locatorPath=j;d.locatorPos=c+1;this.connect(d,"press",this.onPathPress);this.connect(d,"down",this.onPathDown);this.connect(d,"up",this.onPathUp);if(c==k.length-1){d.appendChild(new Ui.LocatorLeftArrow({fill:h,radius:7}))}else{d.appendChild(new Ui.LocatorLeftRightArrow({fill:h,radius:7}))}this.backgrounds.push(d);this.appendChild(d);var a=new Ui.Pressable();a.locatorPos=c+1;this.connect(a,"press",this.onPathPress);this.connect(a,"down",this.onPathDown);this.connect(a,"up",this.onPathUp);a.locatorPath=j;a.appendChild(new Ui.Label({text:k[c],margin:7}));this.foregrounds.push(a);this.appendChild(a);j+="/"}}},getPath:function(){return this.path},getGradient:function(){return new Ui.LinearGradient({stops:[{offset:0,color:"#fbfbfb"},{offset:1,color:"#c8c8c8"}]})},getDownGradient:function(){return new Ui.LinearGradient({stops:[{offset:0,color:"#bbbbbb"},{offset:1,color:"#989898"}]})},onPathPress:function(a){this.fireEvent("change",this,a.locatorPath)},onPathDown:function(a){this.backgrounds[a.locatorPos].getChildren()[0].setFill(this.getDownGradient())},onPathUp:function(a){this.backgrounds[a.locatorPos].getChildren()[0].setFill(this.getGradient())}},{measureCore:function(d,a){if(this.foregrounds.length==0){return{width:0,height:0}}for(var b=0;b<this.foregrounds.length;b++){this.foregrounds[b].measure(0,0)}for(var b=0;b<this.backgrounds.length;b++){this.backgrounds[b].measure(0,0)}this.border.measure(0,0);if(this.foregrounds.length==1){return{width:this.foregrounds[0].getMeasureWidth()+2,height:this.foregrounds[0].getMeasureHeight()+2}}else{var c=0;var f=0;for(var b=0;b<this.foregrounds.length;b++){var g=this.foregrounds[b];if(g.getMeasureHeight()>f){f=g.getMeasureHeight()}c+=g.getMeasureWidth()}c+=(this.foregrounds.length-1)*(f/2+this.spacing);return{width:c+2,height:f+2}}},arrangeCore:function(g,b){if(this.foregrounds.length==1){this.foregrounds[0].arrange(1,1,g-2,b-2);this.backgrounds[0].arrange(1,1,g-2,b-2);this.border.arrange(0,0,g,b);return}x=0;for(var f=0;f<this.foregrounds.length;f++){var d=this.backgrounds[f];var c=this.foregrounds[f];var a=c.getMeasureWidth();c.arrange(x+1,0+1,a,b-2);if(f==0){d.arrange(x+1,0+1,a+(b-2)/2,b-2)}else{if(f==this.foregrounds.length-1){d.arrange(x-b/2+1,0+1,a+(b-2)/2,b-2)}else{d.arrange(x-b/2+1,0+1,a+(b-2),b-2)}}x+=a+(b-2)/2+this.spacing}this.border.arrange(0,0,g,b)}});Ui.Shape.extend("Ui.LocatorRightArrow",{radius:8,constructor:function(a){},setRadius:function(a){this.radius=a}},{arrangeCore:function(b,a){Ui.LocatorRightArrow.base.arrangeCore.call(this,b,a);var f=b-a/2;var d=a/2;var c=a-this.radius;this.setPath("M"+this.radius+",0 L"+f+",0 L"+b+","+d+" L"+f+","+a+" L"+this.radius+","+a+" Q0,"+a+" 0,"+c+" L0,"+this.radius+" Q0,0 "+this.radius+",0 z")}});Ui.Shape.extend("Ui.LocatorLeftArrow",{radius:8,constructor:function(a){},setRadius:function(a){this.radius=a}},{arrangeCore:function(b,a){Ui.LocatorLeftArrow.base.arrangeCore.call(this,b,a);var f=b-this.radius;var d=a-this.radius;var c=a/2;this.setPath("M0,0 L"+f+",0 Q"+b+",0 "+b+","+this.radius+" L"+b+","+d+" Q"+b+","+a+" "+f+","+a+" L0,"+a+" L"+c+","+c+" z")}});Ui.Shape.extend("Ui.LocatorLeftRightArrow",{constructor:function(a){},setRadius:function(a){}},{arrangeCore:function(b,a){Ui.LocatorLeftRightArrow.base.arrangeCore.call(this,b,a);var d=b-a/2;var c=a/2;this.setPath("M0,0 L"+d+",0 L"+b+","+c+" L"+d+","+a+" L0,"+a+" L"+c+","+c+" z")}});Ui.LBox.extend("Ui.TextField",{entry:undefined,constructor:function(a){this.setPadding(3);this.append(new Ui.Rectangle({fill:new Ui.Color({r:1,g:1,b:1,a:0.25}),radius:4,marginTop:1}));this.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.4}),radius:4,marginBottom:1}));this.append(new Ui.Rectangle({fill:new Ui.Color({r:0.98,g:0.98,b:0.98}),radius:4,margin:1,marginBottom:2}));this.append(new Ui.Shadow({shadowWidth:2,inner:true,radius:4,opacity:0.2,margin:1,marginBottom:2}));this.entry=new Ui.Entry({margin:4,fontSize:16});this.append(this.entry);this.connect(this.entry,"change",this.onEntryChange);this.connect(this.entry,"validate",this.onEntryValidate);this.addEvents("change","validate")},setPasswordMode:function(a){this.entry.setPasswordMode(a)},getValue:function(){return this.entry.getValue()},setValue:function(a){this.entry.setValue(a)},onEntryChange:function(a,b){this.fireEvent("change",this,b)},onEntryValidate:function(a){this.fireEvent("validate",this)}},{onStyleChange:function(){},onDisable:function(){Ui.TextField.base.onDisable.call(this);this.entry.setOpacity(0.2)},onEnable:function(){Ui.TextField.base.onEnable.call(this);this.entry.setOpacity(1)}});Ui.LBox.extend("Ui.TextButtonField",{entry:undefined,button:undefined,buttonIcon:undefined,buttonText:undefined,constructor:function(c){this.addEvents("change","validate","buttonpress");this.setPadding(3);this.lightShadow=new Ui.Rectangle({fill:new Ui.Color({r:1,g:1,b:1,a:0.25}),radius:4,marginTop:1});this.append(this.lightShadow);this.darkShadow=new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.4}),radius:4,marginBottom:1});this.append(this.darkShadow);var b=new Ui.HBox({margin:1});this.append(b);var a=new Ui.LBox({marginBottom:1});b.append(a,true);a.append(new Ui.Rectangle({fill:new Ui.Color({r:0.98,g:0.98,b:0.98}),radiusTopLeft:4,radiusBottomLeft:4}));a.append(new Ui.Shadow({radiusTopLeft:4,radiusBottomLeft:4,opacity:0.2,shadowWidth:2,inner:true}));this.entry=new Ui.Entry({margin:4,fontSize:16});a.append(this.entry);this.connect(this.entry,"change",this.onEntryChange);this.connect(this.entry,"validate",this.onEntryValidate);this.button=new Ui.Pressable();b.append(this.button);this.connect(this.button,"press",this.onButtonPress);this.connect(this.button,"down",this.onButtonDown);this.connect(this.button,"up",this.onButtonUp);this.rect2=new Ui.Rectangle({radiusTopRight:4,radiusBottomRight:4,marginBottom:1});this.button.append(this.rect2);this.rect1=new Ui.Rectangle({radiusTopRight:3,radiusBottomRight:3,marginLeft:1,marginTop:1,marginBottom:1});this.button.append(this.rect1);this.buttonContentBox=new Ui.HBox({verticalAlign:"center",horizontalAlign:"center"});this.button.append(this.buttonContentBox);this.iconBox=new Ui.LBox({verticalAlign:"center",horizontalAlign:"center"});this.buttonContentBox.append(this.iconBox)},setWidthText:function(a){this.entry.setWidth(a*16*2/3)},getButtonIcon:function(){return this.buttonIcon},setButtonIcon:function(a){if(a===undefined){if(this.buttonIcon!=undefined){this.iconBox.remove(this.icon1);this.iconBox.remove(this.icon2);this.icon1=undefined;this.icon2=undefined;this.buttonIcon=undefined}if(this.buttonContent!=undefined){this.iconBox.remove(this.buttonContent);this.buttonContent=undefined}}else{if(typeof(a)=="string"){if(this.buttonContent!=undefined){this.iconBox.remove(this.buttonContent);this.buttonContent=undefined}if(this.buttonIcon!=a){this.buttonIcon=a;if(this.icon1!=undefined){this.iconBox.remove(this.icon1)}if(this.icon2!=undefined){this.iconBox.remove(this.icon2)}this.icon1=new Ui.Icon({icon:a,width:24,height:24,fill:"white"});this.icon2=new Ui.Icon({icon:a,width:24,height:24});this.iconBox.append(this.icon1);this.iconBox.append(this.icon2)}}else{if(this.icon1!=undefined){this.iconBox.remove(this.icon1)}if(this.icon2!=undefined){this.iconBox.remove(this.icon2)}this.icon1=undefined;this.icon2=undefined;this.buttonIcon=undefined;if(this.buttonContent!=a){if(this.buttonContent!=undefined){this.iconBox.remove(this.buttonContent)}this.buttonContent=a;this.iconBox.append(this.buttonContent)}}}this.updateSizes()},setButtonText:function(a){if(this.buttonText!=a){this.buttonText=a;if(this.buttonText===undefined){if(this.textBox!=undefined){this.buttonContentBox.remove(this.textBox);this.textBox=undefined;this.text1=undefined;this.text2=undefined}}else{if(this.textBox===undefined){this.textBox=new Ui.LBox({verticalAlign:"center",horizontalAlign:"center"});this.buttonContentBox.append(this.textBox);this.text1=new Ui.Label({text:this.buttonText,color:new Ui.Color({r:0.96,g:0.96,b:0.96})});this.text2=new Ui.Label({text:this.buttonText,color:new Ui.Color({r:0.38,g:0.38,b:0.38})});this.textBox.append(this.text1);this.textBox.append(this.text2)}else{this.text1.setText(this.buttonText);this.text2.setText(this.buttonText)}}this.updateSizes()}},getValue:function(){return this.entry.getValue()},setValue:function(a){this.entry.setValue(a)},updateSizes:function(){if(!this.getIsLoaded()){return}var a=this.getStyleProperty("spacing");if(this.buttonText!=undefined){if(this.buttonIcon!=undefined){this.textBox.setMarginLeft(a+2);this.textBox.setMarginRight(a+2);this.textBox.setMarginTop(a+1);this.textBox.setMarginBottom(a+1);this.text1.setMargin(0);this.text1.setMarginTop(2);this.text2.setMargin(1);this.text1.setFontWeight("bold");this.text2.setFontWeight("bold");this.iconBox.setMarginLeft(a+2);this.iconBox.setMarginRight(0);this.iconBox.setMarginTop(a+1);this.iconBox.setMarginBottom(a+1);this.icon1.setMarginTop(2);this.icon1.setMarginBottom(0);this.icon2.setMarginTop(1);this.icon2.setMarginBottom(1)}else{if(this.content!=undefined){this.textBox.setMarginLeft(a+2);this.textBox.setMarginRight(a+2);this.textBox.setMarginTop(a+1);this.textBox.setMarginBottom(a+1);this.text1.setMargin(0);this.text1.setMarginTop(2);this.text2.setMargin(1);this.text1.setFontWeight("bold");this.text2.setFontWeight("bold");this.iconBox.setMarginLeft(a+2);this.iconBox.setMarginRight(0);this.iconBox.setMarginTop(a+2);this.iconBox.setMarginBottom(0)}else{this.textBox.setMarginLeft(a+4);this.textBox.setMarginRight(a+4);this.textBox.setMarginTop(a+1);this.textBox.setMarginBottom(a+1);this.text1.setMargin(0);this.text1.setMarginTop(2);this.text2.setMargin(1);this.text1.setFontWeight("bold");this.text2.setFontWeight("bold");this.iconBox.setMargin(0)}}}else{if(this.buttonIcon!=undefined){this.iconBox.setMarginLeft(a+2);this.iconBox.setMarginRight(a+2);this.iconBox.setMarginTop(a+1);this.iconBox.setMarginBottom(a+1);this.icon1.setMarginTop(2);this.icon1.setMarginBottom(0);this.icon2.setMarginTop(1);this.icon2.setMarginBottom(1)}else{if(this.content!=undefined){this.iconBox.setMargin(a+2)}}}},getGradient:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]})},getGradientDown:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1-0.2,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1-0.2,u:a.u,v:a.v})}]})},getContentColor:function(){var a=this.getStyleProperty("color").getYuv();if(a.y<0.4){return new Ui.Color({y:a.y+0.6,u:a.u,v:a.v})}else{return new Ui.Color({y:a.y-0.6,u:a.u,v:a.v})}},getContentLightColor:function(){var a=this.getStyleProperty("color");var b=this.getStyleProperty("color").getYuv();if(b.y<0.4){return new Ui.Color({y:b.y-0.2,u:b.u,v:b.v})}else{return new Ui.Color({y:b.y+0.1,u:b.u,v:b.v})}},getContentLightColorDown:function(){var a=this.getStyleProperty("color").getYuv();if(a.y<0.4){return new Ui.Color({y:a.y-0.2,u:a.u,v:a.v})}else{return new Ui.Color({y:a.y+0.1-0.2,u:a.u,v:a.v})}},getLightColor:function(){var a=this.getStyleProperty("color").getYuv();if(a.y<0.4){return new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})}else{return new Ui.Color({y:a.y+0.3,u:a.u,v:a.v})}},getLightColorDown:function(){var a=this.getStyleProperty("color").getYuv();if(a.y<0.4){return new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})}else{return new Ui.Color({y:a.y,u:a.u,v:a.v})}},onButtonPress:function(){this.fireEvent("buttonpress",this);this.fireEvent("validate",this)},onButtonDown:function(){this.rect1.setFill(this.getGradientDown());if(this.icon1!=undefined){this.icon1.setFill(this.getContentLightColorDown())}if(this.text1!=undefined){this.text1.setColor(this.getContentLightColorDown())}this.rect2.setFill(this.getLightColorDown())},onButtonUp:function(){this.rect1.setFill(this.getGradient());if(this.icon1!=undefined){this.icon1.setFill(this.getContentLightColor())}if(this.text1!=undefined){this.text1.setColor(this.getContentLightColor())}this.rect2.setFill(this.getLightColor())},onEntryChange:function(a,b){this.fireEvent("change",this,b)},onEntryValidate:function(a){this.fireEvent("validate",this)}},{onStyleChange:function(){var g;var h;var b;var f;var a;var d;var c=Ui.Color.create(this.getStyleProperty("color")).getYuv();g=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:c.y+0.1,u:c.u,v:c.v})},{offset:1,color:new Ui.Color({y:c.y-0.1,u:c.u,v:c.v})}]});d=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:c.y+0.1-0.2,u:c.u,v:c.v})},{offset:1,color:new Ui.Color({y:c.y-0.1-0.2,u:c.u,v:c.v})}]});if(c.y<0.4){h=new Ui.Color({y:c.y+0.6,u:c.u,v:c.v});b=new Ui.Color({y:c.y-0.2,u:c.u,v:c.v});f=new Ui.Color({y:c.y-0.2,u:c.u,v:c.v});a=new Ui.Color({y:c.y+0.3,u:c.u,v:c.v});lightColorDown=new Ui.Color({y:c.y+0.1,u:c.u,v:c.v})}else{h=new Ui.Color({y:c.y-0.6,u:c.u,v:c.v});b=new Ui.Color({y:c.y+0.1,u:c.u,v:c.v});f=new Ui.Color({y:c.y+0.1-0.2,u:c.u,v:c.v});a=new Ui.Color({y:c.y+0.3,u:c.u,v:c.v});lightColorDown=new Ui.Color({y:c.y,u:c.u,v:c.v})}this.rect1.setFill(g);if(this.button.getIsDown()){if(this.icon1!=undefined){this.icon1.setFill(f)}if(this.text1!=undefined){this.text1.setColor(f)}this.rect2.setFill(lightColorDown)}else{if(this.icon1!=undefined){this.icon1.setFill(b)}if(this.text1!=undefined){this.text1.setColor(b)}this.rect2.setFill(a)}if(this.icon2!=undefined){this.icon2.setFill(h)}if(this.text2!=undefined){this.text2.setColor(h)}this.updateSizes()},onDisable:function(){Ui.TextButtonField.base.onDisable.call(this);this.entry.setOpacity(0.2)},onEnable:function(){Ui.TextButtonField.base.onEnable.call(this);this.entry.setOpacity(1)}},{style:{color:new Ui.Color({r:0.31,g:0.66,b:1}),radius:4,spacing:3}});Ui.LBox.extend("Ui.TextAreaField",{textarea:undefined,scroll:undefined,constructor:function(a){this.setPadding(3);this.append(new Ui.Rectangle({fill:new Ui.Color({r:1,g:1,b:1,a:0.25}),radius:4,marginTop:1}));this.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.4}),radius:4,marginBottom:1}));this.append(new Ui.Rectangle({fill:new Ui.Color({r:0.96,g:0.96,b:0.96}),radius:4,marginTop:1,marginBottom:1}));this.append(new Ui.Shadow({inner:true,radius:4,marginTop:1,marginBottom:1,opacity:0.2}));this.scroll=new Ui.ScrollingArea();this.append(this.scroll);this.textarea=new Ui.TextArea({margin:4,fontSize:16});this.scroll.setScrollingContent(this.textarea)},getValue:function(){return this.textarea.getValue()},setValue:function(a){this.textarea.setValue(a)}},{onStyleChange:function(){},onDisable:function(){Ui.TextAreaField.base.onDisable.call(this)},onEnable:function(){Ui.TextAreaField.base.onEnable.call(this)}});Ui.Container.extend("Ui.ListView",{data:undefined,headers:undefined,cols:undefined,rowsHeight:0,headersHeight:0,selectedRow:undefined,headersVisible:true,mode:"manual",constructor:function(b){this.addEvents("select","unselect","activate","header");this.rowContainer=new Ui.Container();this.appendChild(this.rowContainer);if(b.headers!=undefined){this.headers=b.headers;delete (b.headers)}else{this.headers=[{width:100,type:"string",title:"Title",key:"default"}]}this.data=[];this.cols=[];for(var c=0;c<this.headers.length;c++){var d=this.headers[c];d.ui=new Ui.ListViewHeader({title:d.title,width:d.width});this.connect(d.ui,"up",this.onHeaderUp);d.rows=[];d.colWidth=d.width;this.appendChild(d.ui)}for(var c=0;c<this.headers.length;c++){var a=new Ui.ListViewColBar({header:this.headers[c].ui});this.cols.push(a);this.appendChild(a)}},setMode:function(b){if(this.mode!==b){this.mode=b;for(var a=0;a<this.cols.length;a++){if(this.mode==="manual"){this.cols[a].enable()}else{this.cols[a].disable()}}this.invalidateMeasure()}},showHeaders:function(){if(!this.headersVisible){this.headersVisible=true;for(var a=0;a<this.headers.length;a++){var b=this.headers[a];b.ui.show()}this.invalidateMeasure()}},hideHeaders:function(){if(this.headersVisible){this.headersVisible=false;for(var a=0;a<this.headers.length;a++){var b=this.headers[a];b.ui.hide()}this.invalidateMeasure()}},getSelectedRow:function(){return this.selectedRow},appendData:function(c){this.data.push(c);for(var b=0;b<this.headers.length;b++){var a=new Ui.ListViewCellString({key:this.headers[b].key});this.connect(a,"down",this.onCellDown);this.connect(a,"up",this.onCellUp);this.connect(a,"select",this.onCellSelect);this.connect(a,"activate",this.onCellActivate);a.setString(c[this.headers[b].key]);this.headers[b].rows.push(a);this.rowContainer.appendChild(a)}this.invalidateMeasure()},updateData:function(b){var c=this.findDataRow(b);if(c!=-1){for(var a=0;a<this.headers.length;a++){this.headers[a].rows[c].setString(b[this.headers[a].key])}}},removeData:function(a){var b=this.findDataRow(a);if(b!=-1){this.removeDataAt(b)}},removeDataAt:function(b){if(b<this.data.length){if(this.selectedRow==b){this.fireEvent("unselect",this,this.selectedRow)}this.data.splice(b,1);for(var c=0;c<this.headers.length;c++){var a=this.headers[c].rows[b];if(this.selectedRow==b){a.unselect()}this.disconnect(a,"down",this.onCellDown);this.disconnect(a,"up",this.onCellUp);this.disconnect(a,"select",this.onCellSelect);this.disconnect(a,"activate",this.onCellActivate);this.rowContainer.removeChild(a);this.headers[c].rows.splice(b,1)}if(this.selectedRow!=undefined){if(this.selectedRow==b){this.selectedRow=undefined}else{if(b<this.selectedRow){this.selectedRow--}}}this.invalidateMeasure()}},clearData:function(){while(this.data.length>0){this.removeDataAt(0)}},getData:function(){return this.data},setData:function(b){this.clearData();if(b!=undefined){for(var a=0;a<b.length;a++){this.appendData(b[a])}}},selectRow:function(b){if((b>=0)&&(b<this.data.length)){if(this.selectedRow!=undefined){if(this.selectedRow==b){return}for(var a=0;a<this.headers.length;a++){this.headers[a].rows[this.selectedRow].unselect()}this.fireEvent("unselect",this,this.selectedRow)}this.selectedRow=b;for(var a=0;a<this.headers.length;a++){var c=this.headers[a].rows[b];this.disconnect(c,"select",this.onCellSelect);c.select();this.connect(c,"select",this.onCellSelect)}this.fireEvent("select",this,this.selectedRow)}},findDataRow:function(a){for(var b=0;b<this.data.length;b++){if(a==this.data[b]){return b}}return -1},findCellRow:function(a){var c=a.getKey();var g=undefined;for(var b=0;b<this.headers.length;b++){if(this.headers[b].key==c){g=this.headers[b];break}}if(g===undefined){return -1}var f=undefined;for(var d=0;d<g.rows.length;d++){if(a==g.rows[d]){f=d;break}}if(f===undefined){return -1}return f},onCellDown:function(a){var c=this.findCellRow(a);if(c!=-1){for(var b=0;b<this.headers.length;b++){this.headers[b].rows[c].down()}}},onCellUp:function(a){var c=this.findCellRow(a);if(c!=-1){for(var b=0;b<this.headers.length;b++){this.headers[b].rows[c].up()}}},onCellSelect:function(a){var b=this.findCellRow(a);if(b!=-1){this.selectRow(b)}},onCellActivate:function(a){var b=this.findCellRow(a);if(b!=-1){this.fireEvent("activate",this,b,a.getKey())}},onHeaderUp:function(d){var b;for(var a=0;a<this.headers.length;a++){var c=this.headers[a];if(c.ui===d){b=c.key}}if(b!=null){this.fireEvent("header",this,b)}}},{measureCoreAuto:function(c,n){for(var d=0;d<this.headers.length;d++){this.headers[d].minWidth=0}var a;do{a=true;this.rowsHeight=0;this.headersHeight=0;var o;do{o=true;var l=0;var m=c;for(var d=0;d<this.headers.length;d++){var h=this.headers[d];var g=h.minWidth;if(d==this.headers.length-1){g=Math.max(m,g)}var p;if(this.headersVisible){p=h.ui.measure(g,this.headersHeight)}else{p={width:0,height:0}}if(p.height>l){l=p.height}if(p.width>h.minWidth){h.minWidth=p.width;a=false}m-=h.minWidth}if(l>this.headersHeight){this.headersHeight=l;o=false}}while(!o);for(var j=0;j<this.data.length;j++){var f=this.data[j];f.rowHeight=0;var o;do{o=true;var l=0;var m=c;for(var d=0;d<this.headers.length;d++){var h=this.headers[d];var k=this.headers[d].rows[j];var g=h.minWidth;if(d==this.headers.length-1){g=Math.max(m,g)}var p=k.measure(g,f.rowHeight);if(p.height>l){l=p.height}if(p.width>h.minWidth){h.minWidth=p.width;a=false}m-=h.minWidth}if(l!=f.rowHeight){o=false;f.rowHeight=l}}while(!o);this.rowsHeight+=f.rowHeight}}while(!a);var b=0;for(var d=0;d<this.headers.length;d++){b+=this.headers[d].minWidth}return{width:b,height:this.headersHeight+this.rowsHeight}},measureCoreManual:function(b,m){this.rowsHeight=0;this.headersHeight=0;var l=0;for(var c=0;c<this.headers.length;c++){var h=this.headers[c];var n=h.ui.measure(0,0);if(n.height>l){l=n.height}}if(this.headersVisible){this.headersHeight=l}for(var j=0;j<this.data.length;j++){var g=this.data[j];var l=0;for(var c=0;c<this.headers.length;c++){var h=this.headers[c];var k=this.headers[c].rows[j];var f=h.ui.getMeasureWidth();var n=k.measure(f,0);if(n.height>l){l=n.height}}g.rowHeight=l;this.rowsHeight+=g.rowHeight}var a=0;for(var c=0;c<this.headers.length;c++){a+=this.headers[c].ui.getMeasureWidth()}for(var d=0;d<this.cols.length;d++){var c=this.cols[d];c.measure(0,this.headersHeight+this.rowsHeight)}return{width:a,height:this.headersHeight+this.rowsHeight}},arrangeCoreAuto:function(a,m){var j=0;var l=a;for(var c=0;c<this.headers.length;c++){var g=this.headers[c];var b=this.cols[c];var f=g.minWidth;if(c==this.headers.length-1){f=Math.max(f,l)}g.ui.arrange(j,0,f,this.headersHeight);b.setHeaderHeight(this.headersHeight);b.arrange(j+f-b.getMeasureWidth(),0,b.getMeasureWidth(),this.headersHeight+this.rowsHeight);j+=f;l-=f}if(this.data.length==0){return}var h=0;for(var n=0;n<this.data.length;n++){var d=this.data[n];var j=0;var l=a;for(var c=0;c<this.headers.length;c++){var g=this.headers[c];var f=g.minWidth;if(c==this.headers.length-1){f=Math.max(f,l)}var k=g.rows[n];k.arrange(j,h,f,d.rowHeight);j+=f;l-=f}h+=d.rowHeight}this.rowContainer.arrange(0,this.headersHeight,a,m-this.headersHeight)},arrangeCoreManual:function(a,m){var j=0;var l=a;for(var c=0;c<this.headers.length;c++){var g=this.headers[c];var b=this.cols[c];var f=g.ui.getMeasureWidth();if(c==this.headers.length-1){f=Math.max(f,l)}g.ui.arrange(j,0,f,this.headersHeight);b.setHeaderHeight(this.headersHeight);b.arrange(j+f-b.getMeasureWidth(),0,b.getMeasureWidth(),this.headersHeight+this.rowsHeight);j+=f;l-=f}if(this.data.length==0){return}var h=0;for(var n=0;n<this.data.length;n++){var d=this.data[n];var j=0;var l=a;for(var c=0;c<this.headers.length;c++){var g=this.headers[c];var f=g.ui.getMeasureWidth();if(c==this.headers.length-1){f=Math.max(f,l)}var k=g.rows[n];k.arrange(j,h,f,d.rowHeight);j+=f;l-=f}h+=d.rowHeight}this.rowContainer.arrange(0,this.headersHeight,a,m-this.headersHeight)},measureCore:function(b,a){if(this.mode==="auto"){return this.measureCoreAuto(b,a)}else{return this.measureCoreManual(b,a)}},arrangeCore:function(b,a){if(this.mode==="auto"){this.arrangeCoreAuto(b,a)}else{this.arrangeCoreManual(b,a)}}});Ui.Pressable.extend("Ui.ListViewHeader",{title:undefined,uiTitle:undefined,background:undefined,border:undefined,constructor:function(a){this.border=new Ui.Rectangle();this.append(this.border);this.background=new Ui.Rectangle({marginTop:1,marginBottom:1,marginRight:1});this.append(this.background);this.uiTitle=new Ui.Label({margin:8});this.append(this.uiTitle);this.connect(this,"down",this.onListViewHeaderDown);this.connect(this,"up",this.onListViewHeaderUp)},getTitle:function(){return this.title},setTitle:function(a){if(this.title!=a){this.title=a;this.uiTitle.setText(a)}},getGradient:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]})},getGradientDown:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1-0.2,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1-0.2,u:a.u,v:a.v})}]})},getDarkColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y-0.3,u:a.u,v:a.v})},onListViewHeaderDown:function(){this.background.setFill(this.getGradientDown())},onListViewHeaderUp:function(){this.background.setFill(this.getGradient())}},{onStyleChange:function(){var c;var a;var b=this.getStyleProperty("color").getYuv();c=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:b.y+0.1,u:b.u,v:b.v})},{offset:1,color:new Ui.Color({y:b.y-0.1,u:b.u,v:b.v})}]});a=new Ui.Color({y:b.y-0.3,u:b.u,v:b.v});this.background.setFill(c);this.border.setFill(a);var d=this.getStyleProperty("spacing");this.uiTitle.setMargin(d+2)}},{style:{color:new Ui.Color({r:0.96,g:0.96,b:0.96}),spacing:5}});Ui.Selectable.extend("Ui.ListViewCellString",{string:"",ui:undefined,background:undefined,border:undefined,cellDown:false,cellSelected:false,key:undefined,constructor:function(a){this.setClipToBounds(true);this.border=new Ui.Rectangle({height:1,verticalAlign:"bottom"});this.append(this.border);this.background=new Ui.Rectangle({fill:"white",marginBottom:1,marginRight:1});this.append(this.background);this.ui=new Ui.Label({margin:8,horizontalAlign:"left"});this.append(this.ui);this.connect(this,"select",this.onCellSelect);this.connect(this,"unselect",this.onCellUnselect)},getKey:function(){return this.key},setKey:function(a){this.key=a},getString:function(){return this.string},setString:function(a){if(this.string!=a){this.string=a;this.ui.setText(a)}},down:function(){this.cellDown=true;if(!this.getIsSelected()){this.background.setFill(this.getBackgroundDownColor())}},up:function(){this.cellDown=false;if(!this.getIsSelected()){this.background.setFill(this.getBackgroundColor())}},getDarkColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y-0.3,u:a.u,v:a.v})},getBackgroundSelectGradient:function(){var a=this.getStyleProperty("selectColor").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]})},getBackgroundColor:function(){return this.getStyleProperty("color")},getBackgroundDownColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})},onCellSelect:function(){this.background.setFill(this.getBackgroundSelectGradient())},onCellUnselect:function(){this.background.setFill(this.getBackgroundColor())}},{onStyleChange:function(){var b=this.getStyleProperty("color");var c=b.getYuv();var a=new Ui.Color({y:c.y-0.3,u:c.u,v:c.v});this.background.setFill(b);this.border.setFill(a);var d=this.getStyleProperty("spacing");this.ui.setMargin(d+2)}},{style:{color:new Ui.Color({r:0.99,g:0.99,b:0.99,a:0.1}),selectColor:new Ui.Color({r:0.31,g:0.66,b:1}),spacing:5}});Ui.Container.extend("Ui.ListViewColBar",{headerHeight:0,header:undefined,grip:undefined,separator:undefined,constructor:function(b){this.grip=new Ui.Movable({moveVertical:false});this.appendChild(this.grip);this.connect(this.grip,"move",this.onMove);this.connect(this.grip,"up",this.onUp);var a=new Ui.LBox();this.grip.setContent(a);a.append(new Ui.Rectangle({width:1,opacity:0.2,fill:"white",marginLeft:3,marginRight:9+2,marginTop:6,marginBottom:6}));a.append(new Ui.Rectangle({width:1,opacity:0.2,fill:"black",marginLeft:4,marginRight:8+2,marginTop:6,marginBottom:6}));a.append(new Ui.Rectangle({width:1,opacity:0.2,fill:"white",marginLeft:8,marginRight:4+2,marginTop:6,marginBottom:6}));a.append(new Ui.Rectangle({width:1,opacity:0.2,fill:"black",marginLeft:9,marginRight:3+2,marginTop:6,marginBottom:6}));this.separator=new Ui.Rectangle({width:1,fill:"black",opacity:0.3});this.appendChild(this.separator)},setHeader:function(a){this.header=a},setHeaderHeight:function(a){this.headerHeight=a},onMove:function(){this.separator.setTransform(Ui.Matrix.createTranslate(this.grip.getPositionX(),0))},onUp:function(){var a=this.grip.getPositionX();this.header.setWidth(Math.max(this.getMeasureWidth(),this.header.getMeasureWidth()+a));this.invalidateArrange()}},{measureCore:function(c,a){var b=this.grip.measure(c,a);this.separator.measure(c,a);return{width:b.width,height:0}},arrangeCore:function(b,a){this.grip.setPosition(0,0);this.separator.setTransform(Ui.Matrix.createTranslate(0,0));this.grip.arrange(0,0,b,this.headerHeight);this.separator.arrange(b-1,0,1,a)},onDisable:function(){Ui.ListViewColBar.base.onDisable.call(this);this.grip.hide()},onEnable:function(){Ui.ListViewColBar.base.onEnable.call(this);this.grip.show()}});Ui.IFrame.extend("Ui.Program",{arguments:undefined,constructor:function(b){this.connect(window,"message",this.onMessage,false);if(!("location" in b)){throw ("location config parameter is NEEDED")}var a=b.location;delete (b.location);if("arguments" in b){a+="?base64="+encodeURIComponent(JSON.stringify(b.arguments).toBase64());delete (b.arguments)}this.setSrc(a);this.addEvents("message")},sendMessage:function(a){this.getIFrame().contentWindow.postMessage(a.serialize(),"*")},onMessage:function(a){if(this.getIFrame().contentWindow===a.source){a.preventDefault();a.stopPropagation();var b=JSON.parse(a.data);this.fireEvent("message",this,b)}}});Core.Object.extend("Ui.Transition",{constructor:function(a){},run:function(c,b,a){throw ("transition classes MUST override run method")}},{},{transitions:{},register:function(a,b){this.transitions[a]=b},parse:function(a){return new this.transitions[a]()}});Ui.Transition.extend("Ui.Fade",{},{run:function(c,b,a){if(c!=undefined){if(a==1){c.setOpacity(1);c.hide()}else{c.setOpacity(1-a)}}if(b!=undefined){b.setOpacity(a)}}},{constructor:function(){Ui.Transition.register("fade",this)}});Ui.Transition.extend("Ui.Flip",{orientation:"horizontal",constructor:function(a){},setOrientation:function(a){this.orientation=a}},{run:function(c,b,a){if(a<0.5){if(c!=undefined){c.setTransformOrigin(0.5,0.5);if(this.orientation=="horizontal"){c.setTransform(Ui.Matrix.createScale((1-a*2),1))}else{c.setTransform(Ui.Matrix.createScale(1,(1-a*2)))}}if(b!=undefined){b.hide()}}else{if(c!=undefined){c.hide();c.setTransformOrigin(0,0);c.setTransform(undefined)}if(b!=undefined){if(a==1){b.show();b.setTransformOrigin(0,0);b.setTransform(undefined)}else{b.show();b.setTransformOrigin(0.5,0.5);if(this.orientation=="horizontal"){b.setTransform(Ui.Matrix.createScale((a-0.5)*2,1))}else{b.setTransform(Ui.Matrix.createScale(1,(a-0.5)*2))}}}}}},{constructor:function(){Ui.Transition.register("flip",this)}});Ui.Transition.extend("Ui.Slide",{direction:"right",constructor:function(a){},setDirection:function(a){this.direction=a}},{run:function(c,b,a){if(c!=undefined){if(a==1){c.hide();c.setTransformOrigin(0,0);c.setTransform(undefined)}else{c.setTransformOrigin(0,0);if(this.direction=="right"){c.setTransform(Ui.Matrix.createTranslate(-c.getLayoutWidth()*a,0))}else{if(this.direction=="left"){c.setTransform(Ui.Matrix.createTranslate(c.getLayoutWidth()*a,0))}else{if(this.direction=="top"){c.setTransform(Ui.Matrix.createTranslate(0,c.getLayoutHeight()*a))}else{c.setTransform(Ui.Matrix.createTranslate(0,-c.getLayoutHeight()*a))}}}}}if(b!=undefined){if(a==1){b.setTransformOrigin(0,0);b.setTransform(undefined)}else{b.setTransformOrigin(0,0);if(this.direction=="right"){b.setTransform(Ui.Matrix.createTranslate(b.getLayoutWidth()*(1-a),0))}else{if(this.direction=="left"){b.setTransform(Ui.Matrix.createTranslate(-b.getLayoutWidth()*(1-a),0))}else{if(this.direction=="top"){b.setTransform(Ui.Matrix.createTranslate(0,-b.getLayoutHeight()*(1-a)))}else{b.setTransform(Ui.Matrix.createTranslate(0,b.getLayoutHeight()*(1-a)))}}}}}}},{constructor:function(){Ui.Transition.register("slide",this)}});Ui.LBox.extend("Ui.TransitionBox",{transition:undefined,duration:0.5,ease:undefined,position:-1,transitionClock:undefined,current:undefined,next:undefined,replaceMode:false,constructor:function(a){this.addEvents("change");this.connect(this,"load",this.onTransitionBoxLoad);this.connect(this,"unload",this.onTransitionBoxUnload);this.setClipToBounds(true);this.setTransition("fade")},getPosition:function(){return this.position},setDuration:function(a){this.duration=a},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},setTransition:function(a){this.transition=Ui.Transition.create(a)},setCurrent:function(b){var a=this.getChildPosition(b);if(a!=-1){this.setCurrentAt(a)}},setCurrentAt:function(a){if(this.position!=a){if(this.next!=undefined){if(this.current!=undefined){this.current.hide();this.current=this.next;this.current.show();this.next=undefined}}if(this.transitionClock!=undefined){this.disconnect(this.transitionClock,"complete",this.onTransitionComplete);this.transitionClock.stop()}if(this.position!=-1){this.current=this.getChildren()[this.position]}else{this.current=undefined}this.next=this.getChildren()[a];this.next.show();this.transition.run(this.current,this.next,0);this.transitionClock=new Anim.Clock({duration:this.duration,scope:this,onTimeupdate:this.onTransitionTick,ease:this.ease});this.connect(this.transitionClock,"complete",this.onTransitionComplete);this.transitionClock.begin();this.position=a}},getCurrent:function(){if(this.position==-1){return undefined}else{return this.getChildren()[this.position].getChildren()[0]}},replaceContent:function(a){this.replaceMode=true;this.append(a);this.setCurrent(a)},onTransitionBoxLoad:function(){},onTransitionBoxUnload:function(){if(this.transitionClock!=undefined){this.transitionClock.stop();this.transitionClock=undefined}},onTransitionTick:function(b,a){this.progress=a;this.transition.run(this.current,this.next,a)},onTransitionComplete:function(b){this.transitionClock=undefined;var d=this.next;if(this.current!=undefined){this.current.hide()}this.next=undefined;if(this.replaceMode){this.replaceMode=false;var f=[];for(var a=0;a<this.getChildren();a++){var c=this.getChildren()[a];if(c!==d){f.push(c.getFirstChild())}}for(var a=0;a<f.length;a++){this.remove(f[a])}}this.fireEvent("change",this,this.position)}},{arrangeCore:function(b,a){Ui.TransitionBox.base.arrangeCore.call(this,b,a);if(this.transitionClock!=undefined){this.transition.run(this.current,this.next,this.transitionClock.getProgress())}},append:function(b){b=Ui.Element.create(b);var a=new Ui.TransitionBoxContent();a.append(b);a.hide();Ui.TransitionBox.base.append.call(this,a)},prepend:function(b){b=Ui.Element.create(b);if(this.position!=-1){this.position++}var a=new Ui.TransitionBoxContent();a.append(b);a.hide();Ui.TransitionBox.base.prepend.call(this,this.position)},remove:function(b){for(var a=0;a<this.getChildren().length;a++){if(this.getChildren()[a].getChildren()[0]==b){if(a<this.position){this.position--}if(a==this.position){this.position=-1}this.getChildren()[a].remove(b);Ui.TransitionBox.base.remove.call(this,this.getChildren()[a]);break}}},getChildPosition:function(b){for(var a=0;a<this.getChildren().length;a++){if(this.getChildren()[a].getChildren()[0]==b){return a}}return -1}});Ui.LBox.extend("Ui.TransitionBoxContent",{});Ui.Accordeonable.extend("Ui.Accordeon",{});Ui.MouseOverable.extend("Ui.Carousel",{carouselable:undefined,buttonNext:undefined,buttonNextIcon:undefined,buttonPrevious:undefined,buttonPreviousIcon:undefined,showClock:undefined,hideTimeout:undefined,showNext:false,showPrevious:false,constructor:function(a){this.addEvents("change");this.connect(this,"enter",this.onMouseEnter);this.connect(this,"leave",this.onMouseLeave);this.connect(this,"move",this.onMouseOverMove);this.carouselable=new Ui.Carouselable();Ui.Carousel.base.append.call(this,this.carouselable);this.connect(this.carouselable,"focus",this.onCarouselableFocus);this.connect(this.carouselable,"blur",this.onCarouselableBlur);this.connect(this.carouselable,"change",this.onCarouselableChange);this.buttonPrevious=new Ui.Pressable({horizontalAlign:"left",verticalAlign:"center",opacity:0});this.buttonPrevious.setFocusable(false);this.buttonPreviousIcon=new Ui.Icon({icon:"arrowleft",width:48,height:48});this.buttonPrevious.append(this.buttonPreviousIcon);Ui.Carousel.base.append.call(this,this.buttonPrevious);this.connect(this.buttonPrevious,"press",this.onPreviousPress);this.buttonNext=new Ui.Pressable({horizontalAlign:"right",verticalAlign:"center",opacity:0});this.buttonNext.setFocusable(false);this.buttonNextIcon=new Ui.Icon({icon:"arrowright",width:48,height:48});this.buttonNext.append(this.buttonNextIcon);Ui.Carousel.base.append.call(this,this.buttonNext);this.connect(this.buttonNext,"press",this.onNextPress)},setAutoPlay:function(a){this.carouselable.setAutoPlay(a)},next:function(){this.carouselable.next()},previous:function(){this.carouselable.previous()},getLogicalChildren:function(){return this.carouselable.getChildren()},onCarouselableChange:function(b,a){this.showArrows()},onCarouselableFocus:function(){this.showArrows()},onCarouselableBlur:function(){this.hideArrows()},onPreviousPress:function(){this.carouselable.focus();this.previous()},onNextPress:function(){this.carouselable.focus();this.next()},onMouseEnter:function(){this.showArrows()},onMouseOverMove:function(){this.showArrows()},onMouseLeave:function(){this.hideArrows()},showArrows:function(){if(this.hideTimeout!=undefined){this.hideTimeout.abort();this.hideTimeout=new Core.DelayedTask({delay:2,scope:this,callback:this.hideArrows})}else{this.hideTimeout=new Core.DelayedTask({delay:2,scope:this,callback:this.hideArrows})}var b=this.carouselable.getCurrentPosition();var a=this.carouselable.getLogicalChildren();if(a.length>0){this.showPrevious=(b>0);this.showNext=(b<a.length-1)}else{this.showPrevious=false;this.showNext=false}if(this.showClock===undefined){this.showClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:this.onShowTick});this.showClock.begin()}},hideArrows:function(){if(this.hideTimeout!=undefined){this.hideTimeout.abort();this.hideTimeout=undefined}this.showPrevious=false;this.showNext=false;if(this.showClock===undefined){this.showClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:this.onShowTick});this.showClock.begin()}},onShowTick:function(c,b,g){if(g==0){return}var f=false;if(this.showPrevious){var a=this.buttonPrevious.getOpacity();a=Math.min(a+g,1);this.buttonPrevious.setOpacity(a);if(a==1){f=true}}else{var a=this.buttonPrevious.getOpacity();a=Math.max(a-(g*2),0);this.buttonPrevious.setOpacity(a);if(a==0){f=true}}var d=false;if(this.showNext){var a=this.buttonNext.getOpacity();a=Math.min(a+g,1);this.buttonNext.setOpacity(a);if(a==1){d=true}}else{var a=this.buttonNext.getOpacity();a=Math.max(a-(g*2),0);this.buttonNext.setOpacity(a);if(a==0){d=true}}if(f&&d){this.showClock.stop();this.showClock=undefined}}},{append:function(a){this.carouselable.append(a)},remove:function(a){this.carouselable.remove(a)},onStyleChange:function(){var a=this.getStyleProperty("focusColor");this.buttonPreviousIcon.setFill(a);this.buttonNextIcon.setFill(a)}},{style:{focusColor:"#5d3109"}});Ui.LBox.extend("Ui.Switch",{value:false,background:undefined,pos:1,movable:undefined,switchbox:undefined,fixed:undefined,alignClock:undefined,speed:0,animNext:0,animStart:0,ease:undefined,constructor:function(a){this.setFocusable(true);this.connect(this,"focus",this.updateColors);this.connect(this,"blur",this.updateColors);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.append(new Ui.Frame({fill:new Ui.Color({r:1,g:1,b:1,a:0.25}),frameWidth:1,radius:4,marginTop:1}));this.fixed=new Ui.Fixed();this.append(this.fixed);this.bg1=new Ui.Rectangle({fill:new Ui.Color({r:0.2,g:0.9,b:0.6}),radius:4,margin:1,marginBottom:2});this.fixed.append(this.bg1);this.bg2=new Ui.Rectangle({fill:new Ui.Color({r:0.9,g:0.2,b:0.2}),radius:4,margin:1,marginBottom:2});this.fixed.append(this.bg2);this.append(new Ui.Shadow({radius:4,inner:true,margin:1,marginBottom:2,shadowWidth:2,opacity:0.5}));this.append(new Ui.Frame({fill:new Ui.Color({r:0,g:0,b:0,a:0.2}),frameWidth:1,radius:5,marginBottom:1}));this.setClipToBounds(true);this.movable=new Ui.Movable({moveVertical:false,margin:1,marginBottom:2,directionRelease:true});this.movable.setFocusable(false);this.append(this.movable);this.switchbox=new Ui.SwitchBox();this.movable.setContent(this.switchbox);this.connect(this.movable,"move",this.onMove);this.connect(this.movable,"down",this.onDown);this.connect(this.movable,"up",this.onUp);this.addEvents("change");if("trueContent" in a){this.setTrueContent(a.trueContent)}else{this.setTrueContent(new Ui.Label({text:"ON",marginLeft:5,marginRight:5}))}if("falseContent" in a){this.setFalseContent(a.falseContent)}else{this.setFalseContent(new Ui.Label({text:"OFF",marginLeft:5,marginRight:5}))}if("ease" in a){this.setEase(a.ease)}else{this.ease=Anim.EasingFunction.create({type:Anim.PowerEase,mode:"out"})}if("value" in a){this.value=a.value;if(this.value){this.pos=0}else{this.pos=1}}},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},setTrueContent:function(a){this.switchbox.setContent1(a)},setFalseContent:function(a){this.switchbox.setContent2(a)},getValue:function(){return this.value},setValue:function(a){if(this.value!=a){this.value=a;if(this.value){this.startAnimation(2)}else{this.startAnimation(-2)}}},onKeyDown:function(b){if(this.getIsDisabled()){return}var a=b.which;if((a==32)||(a==13)||(a==37)||(a==39)){b.stopPropagation();b.preventDefault()}if((a==32)||(a==13)){this.setValue(!this.value)}else{if(a==37){this.setValue(false)}else{if(a==39){this.setValue(true)}}}},onMove:function(b){var c=this.movable.getPositionX();var a=this.switchbox.getContentWidth();c=Math.min(0,Math.max(c,-a));this.pos=-c/a;this.updatePos()},onDown:function(a){this.focus();this.stopAnimation()},onUp:function(g,f,d,b,a,c,h){if(!h&&(c<10)){this.setValue(!this.value)}else{if(Math.abs(f)<100){if(this.pos>0.5){f=-1}else{f=1}}else{f/=this.switchbox.getContentWidth()}if(f!=0){this.startAnimation(f)}}},updatePos:function(){var a=this.switchbox.getContentWidth();var c=-this.pos*a;this.movable.setPosition(c,undefined);var b=this.getLayoutWidth()-a;this.bg1.setHeight(this.getLayoutHeight()-3);this.bg1.setWidth(a+c+b/2);this.bg2.setHeight(this.getLayoutHeight()-3);this.bg2.setWidth(-c+b/2-2);this.fixed.setPosition(this.bg2,this.getLayoutWidth()+c-b/2,0)},startAnimation:function(a){this.stopAnimation();this.speed=a;this.animStart=this.pos;if(this.speed<0){this.animNext=1}else{this.animNext=0}if(this.animStart!=this.animNext){this.alignClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:this.onAlignTick});this.alignClock.begin()}else{if(this.value!=(this.animNext==0)){this.value=(this.animNext==0);this.fireEvent("change",this,this.value)}}},stopAnimation:function(){if(this.alignClock!=undefined){this.alignClock.stop();this.alignClock=undefined}},onAlignTick:function(b,a,d){if(d==0){return}var c=-(b.getTime()*this.speed)/(this.animNext-this.animStart);if(c>=1){this.alignClock.stop();this.alignClock=undefined;c=1;this.value=(this.animNext==0);this.fireEvent("change",this,this.value)}c=this.ease.ease(c);this.pos=(this.animStart+c*(this.animNext-this.animStart));this.updatePos()},getGradient:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]})},updateColors:function(){var a=this.getStyleProperty("color");if(this.getHasFocus()){a=this.getStyleProperty("focusColor")}this.switchbox.getSwitchButton().setFill(a);this.bg1.setFill(this.getStyleProperty("trueColor"));this.bg2.setFill(this.getStyleProperty("falseColor"))}},{arrangeCore:function(b,a){Ui.Switch.base.arrangeCore.call(this,b,a);this.updatePos()},onStyleChange:function(){this.updateColors()},onDisable:function(){Ui.Switch.base.onDisable.call(this);this.switchbox.getContent1Box().setOpacity(0.2);this.switchbox.getContent2Box().setOpacity(0.2)},onEnable:function(){Ui.Switch.base.onEnable.call(this);this.switchbox.getContent1Box().setOpacity(1);this.switchbox.getContent2Box().setOpacity(1)}},{style:{color:new Ui.Color({r:0.96,g:0.96,b:0.96}),focusColor:"#f6caa2",trueColor:"#91f5c5",falseColor:"#ff9797"}});Ui.LBox.extend("Ui.SwitchButton",{shadow:undefined,background:undefined,radius:8,fill:undefined,constructor:function(a){this.shadow=new Ui.Rectangle({radius:4});this.append(this.shadow);this.background=new Ui.Rectangle({radius:3,margin:1});this.append(this.background);if("radius" in a){this.setRadius(a.radius)}if("fill" in a){this.setFill(a.fill)}else{this.setFill(new Ui.Color({r:0.96,g:0.96,b:0.96}))}},setRadius:function(a){if(this.radius!=a){this.radius=a}},setFill:function(c){if(this.fill!=c){this.fill=Ui.Color.create(c);var a=this.fill.getYuv();var b=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.2,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]});this.background.setFill(b);this.shadow.setFill((new Ui.Color({y:a.y-0.6,u:a.u,v:a.v})).getCssHtml())}}});Ui.Container.extend("Ui.SwitchBox",{content1Box:undefined,content2Box:undefined,button:undefined,constructor:function(){this.content1Box=new Ui.LBox({margin:5});this.appendChild(this.content1Box);this.button=new Ui.SwitchButton({width:28,height:28});this.appendChild(this.button);this.content2Box=new Ui.LBox({margin:5});this.appendChild(this.content2Box)},getSwitchButton:function(){return this.button},getContent1Box:function(){return this.content1Box},getContent2Box:function(){return this.content2Box},setContent1:function(a){if(this.content1!=a){if(this.content1!=undefined){this.content1Box.remove(this.content1)}this.content1=a;if(this.content1!=undefined){this.content1Box.append(this.content1)}}},setContent2:function(a){if(this.content2!=a){if(this.content2!=undefined){this.content2Box.remove(this.content2)}this.content2=a;if(this.content2!=undefined){this.content2Box.append(this.content2)}}},getContentWidth:function(){return this.getLayoutWidth()-this.button.getLayoutWidth()}},{measureCore:function(c,a){var b=this.content1Box.measure(0,0);var f=this.content2Box.measure(0,0);var d=this.button.measure(0,0);return{width:Math.max(b.width,f.width)+d.width,height:Math.max(b.height,Math.max(f.height,d.height))}},arrangeCore:function(c,a){var b=(c-this.button.getMeasureWidth());this.content1Box.arrange(0,0,b,a);this.content2Box.arrange(b+this.button.getMeasureWidth(),0,b,a);this.button.arrange(b,0,this.button.getMeasureWidth(),a)}});Ui.LBox.extend("Ui.App",{defs:undefined,styles:undefined,updateTask:undefined,loaded:false,focusElement:undefined,arguments:undefined,autoscale:false,ready:false,orientation:0,layoutList:undefined,windowWidth:0,windowHeight:0,windowScale:1,contentBox:undefined,content:undefined,dialogs:undefined,virtualkeyboard:undefined,constructor:function(f){this.addEvents("resize","ready","parentmessage","orientationchange");Ui.App.current=this;this.getDrawing().style.cursor="default";this.contentBox=new Ui.VBox();this.append(this.contentBox);if(f.autoscale!=undefined){this.setAutoScale(f.autoscale)}this.setTransformOrigin(0,0);this.connect(window,"load",this.onWindowLoad);this.connect(window,"resize",this.onWindowResize);this.connect(window,"selectstart",this.onWindowSelectStart);if(("onselectstart" in document)&&("attachEvent" in document)){document.attachEvent("onselectstart",this.onWindowSelectStart)}if("style" in f){this.setStyle(f.style)}else{this.setStyle(Ui.Styles["default"])}this.connect(window,"focus",function(l){if(l.target==undefined){return}this.focusElement=l.target;if((this.focusElement.tagName==="INPUT")||(this.focusElement.tagName==="TEXTAREA")){if(this.virtualkeyboard!==undefined){this.virtualkeyboard.open()}}else{if(this.virtualkeyboard!==undefined){this.virtualkeyboard.close()}}},true);this.connect(window,"blur",function(l){this.focusElement=undefined},true);this.connect(window,"dragstart",function(l){l.preventDefault()});this.connect(window,"dragenter",function(l){l.preventDefault();return false});this.connect(window,"dragover",function(l){l.dataTransfer.dropEffect="none";l.preventDefault();return false});this.connect(window,"drop",function(l){l.preventDefault();return false});this.connect(window,"contextmenu",function(l){l.preventDefault()});if(("oncontextmenu" in document)&&("attachEvent" in document)){document.attachEvent("oncontextmenu",function(l){return false})}if("onorientationchange" in window){this.connect(window,"orientationchange",this.onOrientationChange)}this.connect(window,"message",this.onMessage);if((window.location.search!=undefined)&&(window.location.search!="")){var j=undefined;var b={};var d=window.location.search.substring(1).split("&");for(var g=0;g<d.length;g++){var h=d[g].split("=");if(h.length==2){var k=decodeURIComponent(h[0]);var c=decodeURIComponent(h[1]);if(k=="base64"){j=JSON.parse(c.fromBase64())}else{b[k]=c}}}if(j!=undefined){this.arguments=j;for(var a in b){this.arguments[a]=b[a]}}else{this.arguments=b}}else{this.arguments={}}},setVirtualKeyboard:function(a){if(a){if(this.virtualkeyboard===undefined){this.virtualkeyboard=new Ui.VirtualKeyboard();this.contentBox.append(this.virtualkeyboard)}}else{if(this.virtualkeyboard!==undefined){this.contentBox.remove(this.virtualkeyboard);this.virtualkeyboard=undefined}}},openVirtualKeyboard:function(){if(this.virtualkeyboard!==undefined){this.virtualkeyboard.open()}},closeVirtualKeyboard:function(){if(this.virtualkeyboard!==undefined){this.virtualkeyboard.close()}},getOrientation:function(){return this.orientation},onWindowSelectStart:function(b){var c;if("target" in b){c=b.target}else{c=b.srcElement}var a=false;while((c!=undefined)&&(c!=window)){if("selectable" in c){a=c.selectable;break}c=c.parentNode}if(!a){if("preventDefault" in b){b.preventDefault()}return false}return true},onWindowLoad:function(){if(navigator.iPad||navigator.iPhone||navigator.Android){var a=document.createElement("meta");a.name="apple-mobile-web-app-capable";a.content="yes";document.getElementsByTagName("head")[0].appendChild(a);a=document.createElement("meta");a.name="apple-mobile-web-app-status-bar-style";a.content="black";document.getElementsByTagName("head")[0].appendChild(a);a=document.createElement("meta");a.name="viewport";a.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";document.getElementsByTagName("head")[0].appendChild(a)}this.loaded=true;this.onReady()},onWindowResize:function(){this.fireEvent("resize",this);this.invalidateMeasure()},onOrientationChange:function(a){this.orientation=window.orientation;this.fireEvent("orientationchange",this.orientation);this.fireEvent("resize",this);this.invalidateMeasure()},update:function(){this.updateTask=undefined;var a=document.body.clientWidth;var f=document.body.clientHeight;if(window.parent!=window){try{var g=window.parent.document.getElementsByTagName("IFRAME");for(var c=0;c<g.length;c++){if(g[c].contentWindow===window){a=new Number(g[c].style.width.replace(/px$/,""));f=new Number(g[c].style.height.replace(/px$/,""));break}}}catch(d){}}var b;if(this.autoscale){if((this.windowWidth!=a)||(this.windowHeight!=f)){var b=this.measure(a,f);if(b.width<a){b.width=a}if(b.height<f){b.height=f}this.windowScale=1;if((b.width>a)||(b.height>f)){this.windowScale=Math.max(b.width/a,b.height/f)}b=this.measure(a*this.windowScale,f*this.windowScale);this.setTransform(Ui.Matrix.createScale(1/this.windowScale))}else{b=this.measure(a*this.windowScale,f*this.windowScale);if((b.width>a*this.windowScale)||(b.height>f*this.windowScale)){if(b.width<a){b.width=a}if(b.height<f){b.height=f}this.windowScale=1;if((b.width>a)||(b.height>f)){this.windowScale=Math.max(b.width/a,b.height/f)}b=this.measure(a*this.windowScale,f*this.windowScale);this.setTransform(Ui.Matrix.createScale(1/scale))}}}else{this.windowScale=1;b=this.measure(a,f)}this.windowWidth=a;this.windowHeight=f;this.arrange(0,0,Math.max(this.windowWidth*this.windowScale,b.width),Math.max(this.windowHeight*this.windowScale,b.height))},getContent:function(){return this.content},getFocusElement:function(){return this.focusElement},appendDialog:function(c){if(this.dialogs===undefined){this.focusStack=[];this.dialogs=new Ui.LBox();this.append(this.dialogs)}this.focusStack.push(this.focusElement);this.dialogs.append(c);this.contentBox.disable();for(var b=0;b<this.dialogs.getChildren().length-1;b++){this.dialogs.getChildren()[b].disable()}var a=this.findFocusableDiv(c.getDrawing());if(a!=undefined){a.focus()}},removeDialog:function(b){if(this.dialogs!=undefined){this.dialogs.remove(b);if(this.dialogs.getChildren().length==0){this.remove(this.dialogs);this.dialogs=undefined;this.contentBox.enable()}else{this.dialogs.getLastChild().enable()}var a=this.focusStack.pop();if(a!=undefined){try{a.focus()}catch(c){}}}},getArguments:function(){return this.arguments},getAutoScale:function(){return this.autoscale},setAutoScale:function(a){if(this.autoscale!=a){this.autoscale=a;if(!this.autoscale){this.setTransform(undefined)}this.invalidateMeasure()}},getIsReady:function(){return this.ready},onReady:function(){if(this.loaded){this.ready=true;if(document.body===undefined){this.htmlRoot=document.createElement("body");document.body=this.htmlRoot}document.documentElement.style.padding="0px";document.documentElement.style.margin="0px";document.documentElement.style.border="0px solid black";document.documentElement.style.overflow="hidden";document.documentElement.style.width="100%";document.documentElement.style.height="100%";document.body.style.padding="0px";document.body.style.margin="0px";document.body.style.border="0px solid black";document.body.style.overflow="hidden";document.body.style.width="100%";document.body.style.height="100%";document.body.appendChild(this.getDrawing());this.update();this.setIsLoaded(true);this.setParentVisible(true);this.fireEvent("ready")}},onMessage:function(a){if(parent===a.source){a.preventDefault();a.stopPropagation();var b=JSON.parse(a.data);this.fireEvent("parentmessage",b)}},sendMessageToParent:function(a){parent.postMessage(a.serialize(),"*")},findFocusableDiv:function(c){if(("tabIndex" in c)&&(c.tabIndex>=0)){return c}if("childNodes" in c){for(var b=0;b<c.childNodes.length;b++){var a=this.findFocusableDiv(c.childNodes[b]);if(a!=undefined){return a}}}return undefined}},{invalidateMeasure:function(){this.invalidateArrange();this.measureValid=false;if((this.updateTask===undefined)&&this.ready){this.updateTask=new Core.DelayedTask({delay:0,scope:this,callback:this.update})}},invalidateArrange:function(){this.arrangeValid=false;if((this.updateTask===undefined)&&this.ready){this.updateTask=new Core.DelayedTask({delay:0,scope:this,callback:this.update})}},setContent:function(a){a=Ui.Element.create(a);if(this.content!=a){if(this.content!=undefined){this.contentBox.remove(this.content)}if(a!=undefined){this.contentBox.prepend(a,true)}this.content=a}}},{current:undefined,getWindowIFrame:function(c){if(c===undefined){c=window}var b=undefined;if(c.parent!=c){try{var f=c.parent.document.getElementsByTagName("IFRAME");for(var a=0;a<f.length;a++){if(f[a].contentWindow===c){b=f[a];break}}}catch(d){}}return b},getRootWindow:function(){var a=window;while(a.parent!=a){a=a.parent}return a}});Ui.LBox.extend("Ui.Embed",{content:undefined,div:undefined,divId:undefined,updateTask:undefined,constructor:function(a){if(Ui.App.current===undefined){new Ui.App()}this.getDrawing().style.cursor="default";this.setIsLoaded(true);this.connect(Ui.App.current,"ready",this.onReady)},getDiv:function(){return this.div},setDiv:function(a){if(this.div!=undefined){this.div.removeChild(this.getDrawing())}this.div=a;if(this.div!=undefined){this.div.style.position="relative";this.div.style.left="0px";this.div.style.top="0px";this.div.style.width=this.getWidth()+"px";this.div.style.height=this.getHeight()+"px";this.div.appendChild(this.getDrawing());this.update()}},setDivId:function(a){this.divId=a},getContent:function(){return this.content},update:function(){var b=(this.getWidth()!=undefined)?this.getWidth():0;var c=(this.getHeight()!=undefined)?this.getHeight():0;var a=this.measure(b,c);b=Math.max(b,a.width);c=Math.max(c,a.height);this.arrange(0,0,b,c);this.updateTask=undefined;if(this.div!==undefined){this.div.style.width=Math.round(b)+"px";this.div.style.height=Math.round(c)+"px"}},onReady:function(){console.log(this+".onReady");if((this.div===undefined)&&(this.divId!==undefined)){this.setDiv(document.getElementById(this.divId))}}},{invalidateMeasure:function(){this.invalidateArrange();this.measureValid=false;if(this.updateTask===undefined){this.updateTask=new Core.DelayedTask({delay:0,scope:this,callback:this.update})}},invalidateArrange:function(){this.arrangeValid=false;if(this.updateTask===undefined){this.updateTask=new Core.DelayedTask({delay:0,scope:this,callback:this.update})}},setContent:function(a){a=Ui.Element.create(a);if(this.content!=a){if(this.content!=undefined){this.remove(this.content)}if(a!=undefined){this.append(a)}this.content=a}}});Ui.VBox.extend("Ui.MonthCalendar",{selectedDate:undefined,date:undefined,title:undefined,leftarrow:undefined,rightarrow:undefined,grid:undefined,dayFilter:undefined,dateFilter:undefined,constructor:function(b){this.addEvents("dayselect");if("date" in b){this.date=new Date(b.date.getTime());delete (b.date)}else{this.date=new Date()}if("selectedDate" in b){this.selectedDate=b.selectedDate;delete (b.selectedDate)}var a=new Ui.HBox();this.append(a);var c=new Ui.Pressable({verticalAlign:"center"});this.leftarrow=new Ui.Icon({icon:"arrowleft",width:24,height:24});c.append(this.leftarrow);a.append(c);this.connect(c,"press",this.onLeftButtonPress);this.title=new Ui.Label({fontWeight:"bold",fontSize:18,margin:5});a.append(this.title,true);c=new Ui.Pressable({verticalAlign:"center"});this.rightarrow=new Ui.Icon({icon:"arrowright",width:24,height:24});c.append(this.rightarrow);a.append(c);this.connect(c,"press",this.onRightButtonPress);this.grid=new Ui.Grid({cols:"auto,auto,auto,auto,auto,auto,auto",rows:"auto,auto,auto,auto,auto,auto,auto",horizontalAlign:"center"});this.append(this.grid);this.updateDate()},setDayFilter:function(a){this.dayFilter=a;this.updateDate()},setDateFilter:function(a){this.dateFilter=a;this.updateDate()},onLeftButtonPress:function(){this.date.setMonth(this.date.getMonth()-1);this.updateDate()},onRightButtonPress:function(){this.date.setMonth(this.date.getMonth()+1);this.updateDate()},onDaySelect:function(a){this.fireEvent("dayselect",this,a.monthCalendarDate)},updateDate:function(){var c=[6,0,1,2,3,4,5];var b=["Lu","Ma","Me","Je","Ve","Sa","Di"];var j=["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"];this.title.setText(j[this.date.getMonth()]+" "+this.date.getFullYear());while(this.grid.getFirstChild()!=undefined){this.grid.detach(this.grid.getFirstChild())}for(var h=0;h<7;h++){this.grid.attach(new Ui.Label({text:b[h],fontWeight:"bold",margin:5}),h,0)}var l=this.date.getMonth();var m=new Date(this.date.getTime());m.setDate(1);var p=1;var a=new Date();do{var n=new Ui.Pressable();n.monthCalendarDate=m;this.connect(n,"press",this.onDaySelect);var g;if((m.getFullYear()==a.getFullYear())&&(m.getMonth()==a.getMonth())&&(m.getDate()==a.getDate())){n.monthCalendarCurrent=true;g=new Ui.Rectangle({radius:2,fill:new Ui.Color({r:0.2,g:0.4,b:1,a:0.4}),margin:1});n.append(g)}else{g=new Ui.Rectangle({radius:2,fill:new Ui.Color({r:0.8,g:0.8,b:0.8,a:0.4}),margin:1});n.append(g)}if((this.selectedDate!=undefined)&&(m.getFullYear()==this.selectedDate.getFullYear())&&(m.getMonth()==this.selectedDate.getMonth())&&(m.getDate()==this.selectedDate.getDate())){n.append(new Ui.Frame({frameWidth:3,fill:"red",radius:2}))}var f=false;if(this.dayFilter!=undefined){var k=m.getDay();for(var h=0;(h<this.dayFilter.length)&&!f;h++){if(k==this.dayFilter[h]){f=true}}}if(this.dateFilter!=undefined){var d=m.getFullYear()+"/";if(m.getMonth()+1<10){d+="0"}d+=(m.getMonth()+1)+"/";if(m.getDate()<10){d+="0"}d+=m.getDate();for(var h=0;(h<this.dateFilter.length)&&!f;h++){var o=new RegExp(this.dateFilter[h]);if(o.test(d)){f=true}}}if(f){n.disable();n.setOpacity(0.2)}n.append(new Ui.Label({text:m.getDate(),margin:5}));this.grid.attach(n,c[m.getDay()],p);m=new Date(m.getTime()+1000*60*60*24);if(c[m.getDay()]==0){p++}}while(l==m.getMonth());this.onStyleChange()}},{onStyleChange:function(){var b=this.getStyleProperty("color");var d=this.getStyleProperty("dayColor");var a=this.getStyleProperty("currentDayColor");this.title.setColor(b);this.leftarrow.setFill(b);this.rightarrow.setFill(b);for(var c=0;c<this.grid.getChildren().length;c++){var h=this.grid.getChildren()[c];if(Ui.Label.hasInstance(h)){h.setColor(b)}else{if(Ui.Pressable.hasInstance(h)){for(var f=0;f<h.getChildren().length;f++){var g=h.getChildren()[f];if(Ui.Label.hasInstance(g)){g.setColor(b)}else{if(Ui.Rectangle.hasInstance(g)){if(h.monthCalendarCurrent){g.setFill(a)}else{g.setFill(d)}}}}}}}}},{style:{color:"black",dayColor:new Ui.Color({r:0.81,g:0.81,b:0.81,a:0.5}),currentDayColor:new Ui.Color({r:1,g:0.31,b:0.66,a:0.5})}});Ui.TextButtonField.extend("Ui.DatePicker",{popup:undefined,calendar:undefined,selectedDate:undefined,lastValid:"",isValid:false,dayFilter:undefined,dateFilter:undefined,constructor:function(a){this.setButtonIcon("calendar");this.setWidthText(9);this.connect(this,"buttonpress",this.onDatePickerButtonPress);this.connect(this,"change",this.onDatePickerChange)},setDayFilter:function(a){this.dayFilter=a},setDateFilter:function(a){this.dateFilter=a},getIsValid:function(){return this.isValid},getSelectedDate:function(){return this.selectedDate},setSelectedDate:function(a){this.lastValid=((a.getDate()<10)?"0":"")+a.getDate()+"/"+((a.getMonth()<9)?"0":"")+(a.getMonth()+1)+"/"+a.getFullYear();this.selectedDate=a;this.setValue(this.lastValid);this.isValid=true;this.fireEvent("change",this,this.getValue())},onDatePickerButtonPress:function(){var a=this.getValue().match(/^(\d{1,2})\/(\d{1,2})\/(\d{1,4})$/);if(a!=null){this.selectedDate=new Date();this.selectedDate.setFullYear(new Number(a[3]),new Number(a[2])-1,new Number(a[1]))}this.popup=new Ui.Popup();if(this.selectedDate!=undefined){this.calendar=new Ui.MonthCalendar({selectedDate:this.selectedDate,date:this.selectedDate})}else{this.calendar=new Ui.MonthCalendar()}if(this.dayFilter!=undefined){this.calendar.setDayFilter(this.dayFilter)}if(this.dateFilter!=undefined){this.calendar.setDateFilter(this.dateFilter)}this.popup.setContent(this.calendar);this.connect(this.calendar,"dayselect",this.onDaySelect);this.popup.show(this)},onDatePickerChange:function(){this.isValid=false;this.selectedDate=undefined;var a=this.getValue();if(a.match(/^(\d{1,2})\/(\d{1,2})\/(\d{1,4})$/)){var d=this.getValue().match(/^(\d{1,2})\/(\d{1,2})\/(\d{1,4})$/);var c=new Date();c.setFullYear(new Number(d[3]),new Number(d[2])-1,new Number(d[1]));var b=((c.getDate()<10)?"0":"")+c.getDate()+"/"+((c.getMonth()<9)?"0":"")+(c.getMonth()+1)+"/"+c.getFullYear();if((new Number(d[3])!=c.getFullYear())||(new Number(d[2])-1!=c.getMonth())||(new Number(d[1])!=c.getDate())){this.lastValid=b;this.setValue(this.lastValid)}this.selectedDate=c;this.isValid=true}else{if(a.match(/^(\d{1,2})\/(\d{1,2})\/(\d{0,4})$/)){this.lastValid=a}else{if(a.match(/^(\d{1,2})\/(\d{0,2})$/)){this.lastValid=a}else{if(a.match(/^(\d{0,2})$/)){this.lastValid=a}else{this.setValue(this.lastValid)}}}}},onDaySelect:function(b,a){this.setSelectedDate(a);this.popup.hide();this.popup=undefined}});Ui.Container.extend("Ui.Notebook",{current:-1,currentPage:undefined,pages:undefined,headerHeight:0,hiddenColor:undefined,currentColor:undefined,constructor:function(a){this.addEvents("change");this.setFocusable(true);this.connect(this,"focus",this.updateColors);this.connect(this,"blur",this.updateColors);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.pages=[]},setContent:function(b){while(this.getPages().length>0){this.removePage(this.getPages()[0])}if((b!=undefined)&&(typeof(b)=="object")){if(b.constructor==Array){for(var a=0;a<b.length;a++){this.appendPage(b[a])}}else{this.appendPage(b)}}},setCurrentPage:function(b){for(var a=0;a<this.pages.length;a++){if(this.pages[a]==b){this.setCurrentPosition(a);return}}},getCurrentPosition:function(){return this.current},setCurrentPosition:function(b){if(this.pages.length==0){if(this.currentPage!=undefined){this.currentPage.unselect()}this.currentPage=undefined;this.current=-1}else{this.current=b;var a=this.pages[this.current];if(a!=this.currentPage){if(this.currentPage!=undefined){this.currentPage.unselect()}this.currentPage=a;this.fireEvent("change",this,this.currentPage,this.current);this.disconnect(this.currentPage,"select",this.onPageSelect);this.currentPage.select();this.connect(this.currentPage,"select",this.onPageSelect)}}this.invalidateArrange()},appendPage:function(a){a=Ui.NotebookPage.create(a);this.pages.push(a);this.prependChild(a.getBackground());this.appendChild(a.getHeaderBox());this.appendChild(a.getContentBox());this.connect(a,"select",this.onPageSelect);this.connect(a,"close",this.onPageClose);if(this.pages.length==1){a.select()}},removePage:function(b){var a=0;while((a<this.pages.length)&&(this.pages[a]!=b)){a++}if(a<this.pages.length){this.pages.splice(a,1);this.removeChild(b.getBackground());this.removeChild(b.getHeaderBox());this.removeChild(b.getContentBox());this.disconnect(b,"select",this.onPageSelect);this.disconnect(b,"close",this.onPageClose);if((this.current==a)&&(this.current==0)){this.setCurrentPosition(0)}else{if(this.current>=a){this.setCurrentPosition(this.current-1)}else{this.setCurrentPosition(this.current)}}}},getPages:function(){return this.pages},getCurrentPage:function(){return this.currentPage},next:function(){if((this.current>=0)&&(this.current+1<this.pages.length)){this.setCurrentPosition(this.current+1)}},previous:function(){if(this.current>=1){this.setCurrentPosition(this.current-1)}},onKeyDown:function(b){if(this.getIsDisabled()){return}var a=b.which;if((a==37)||(a==39)){b.stopPropagation();b.preventDefault()}if(a==37){this.previous()}else{if(a==39){this.next()}}},onPageSelect:function(a){this.setCurrentPage(a);this.focus()},onPageClose:function(a){this.removePage(a)},getCurrentColor:function(){var a=this.getStyleProperty("color");if(this.getHasFocus()){a=this.getStyleProperty("focusColor")}return a},updateColors:function(){if(this.currentPage!=undefined){this.currentPage.getBackground().setFill(this.getCurrentColor())}}},{measureCore:function(c,m){var j=10;var k=0;var f=0;for(var d=0;d<this.pages.length;d++){var g=this.pages[d];g.getBackground().measure(c,m);var n=g.getHeaderBox().measure(0,0);k+=n.width+j*2;if(n.height>f){f=n.height}}f+=j*2;var h=Math.max(k,c-(j*2));var a=Math.max(m-(f+(j*2)),0);var b=0;var l=0;for(var d=0;d<this.pages.length;d++){var g=this.pages[d];var n=g.getContentBox().measure(h,a);if(n.width>b){b=n.width}if(n.height>l){l=n.height}}b+=j*2;l+=j*2;this.headerHeight=f;return{width:Math.max(b,k),height:l+f}},arrangeCore:function(f,b){var h=10;var a=0;for(var d=0;d<this.pages.length;d++){var g=this.pages[d];var c=g.getHeaderBox().getMeasureWidth();g.getHeaderBox().arrange(a+h,h,c,this.headerHeight-(h*2));if(this.current==d){g.getContentBox().show();g.getContentBox().arrange(h,this.headerHeight+h,f-(h*2),b-(this.headerHeight+h*2));if(this.currentColor!=undefined){g.getBackground().setFill(this.getCurrentColor())}g.getBackground().setTab(a,c+h*2,this.headerHeight);g.getBackground().arrange(0,0,f,b)}else{this.moveChildAt(g.getBackground(),0);g.getContentBox().hide();if(this.hiddenColor!=undefined){g.getBackground().setFill(this.hiddenColor)}g.getBackground().setTab(a,c+h*2,this.headerHeight);g.getBackground().arrange(0,0,f,b)}a+=c+(h*2)}},onStyleChange:function(){this.currentColor=Ui.Color.create(this.getStyleProperty("color"));var b=this.currentColor.getYuva();this.hiddenColor=new Ui.Color({y:b.y-0.18,u:b.u,v:b.v});for(var a=0;a<this.pages.length;a++){if(a==this.current){this.pages[a].getBackground().setFill(this.currentColor)}else{this.pages[a].getBackground().setFill(this.hiddenColor)}}}},{style:{color:"white",focusColor:"#f6caa2"}});Core.Object.extend("Ui.NotebookPage",{headerBox:undefined,header:undefined,contentBox:undefined,content:undefined,background:undefined,isSelected:false,constructor:function(a){this.addEvents("select","unselect","close");this.headerBox=new Ui.Pressable();this.headerBox.setFocusable(false);this.connect(this.headerBox,"press",this.onHeaderPress);this.contentBox=new Ui.LBox();this.contentBox.hide();this.background=new Ui.NotebookBackground()},close:function(){this.fireEvent("close",this)},select:function(){if(!this.isSelected){this.isSelected=true;this.contentBox.show();this.fireEvent("select",this)}},getIsSelected:function(){return this.isSelected},getHeader:function(){return this.header},setHeader:function(a){if(a!=this.header){if(this.header!=undefined){this.headerBox.removeChild(this.header)}this.header=Ui.Element.create(a);if(this.header!=undefined){this.headerBox.appendChild(this.header)}}},getContent:function(){return this.content},setContent:function(a){if(a!=this.content){if(this.content!=undefined){this.contentBox.removeChild(this.content)}this.content=Ui.Element.create(a);if(this.content!=undefined){this.contentBox.appendChild(this.content)}}},unselect:function(){if(this.isSelected){this.isSelected=false;this.fireEvent("unselect",this);this.contentBox.hide()}},getHeaderBox:function(){return this.headerBox},getContentBox:function(){return this.contentBox},getBackground:function(){return this.background},onHeaderPress:function(){this.select()}});Ui.Fixed.extend("Ui.NotebookBackground",{darkShadow:undefined,lightShadow:undefined,background:undefined,radius:8,fill:"black",tabOffset:30,tabWidth:10,tabHeight:10,constructor:function(a){this.darkShadow=new Ui.Shape({fill:"#010002"});this.append(this.darkShadow);this.lightShadow=new Ui.Shape({fill:"#5f625b"});this.append(this.lightShadow);var b=(new Ui.Color({r:0.5,g:0.5,b:0.5})).getYuv();var c=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:0.25,u:b.u,v:b.v})},{offset:1,color:new Ui.Color({y:0.16,u:b.u,v:b.v})}]});this.background=new Ui.Shape({fill:c});this.append(this.background);this.connect(this,"resize",this.onResize)},setTab:function(c,b,a){this.tabOffset=c;this.tabWidth=b;this.tabHeight=a;this.invalidateArrange()},setRadius:function(a){if(this.radius!=a){this.radius=a;this.invalidateArrange()}},setFill:function(c){if(this.fill!=c){this.fill=Ui.Color.create(c);var a=this.fill.getYuva();var b=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]});this.background.setFill(b);this.darkShadow.setFill(new Ui.Color({y:a.y-0.4,u:a.u,v:a.v}));this.lightShadow.setFill(new Ui.Color({y:a.y+0.1,u:a.u,v:a.v}))}},genPath:function(g,b,a,d,c,f){var h="M"+d+","+f+" L"+d+","+a+" Q"+d+",0 "+(d+a)+",0 L"+(d+c-a)+",0 Q"+(d+c)+",0 "+(d+c)+","+a+" L"+(d+c)+","+f+" L"+(g-a)+","+f+" Q"+g+","+f+" "+g+","+(f+a)+" L"+g+","+(b-a)+" Q"+g+","+b+" "+(g-a)+","+b+" L"+a+","+b+" Q0,"+b+" 0,"+(b-a);if(d==0){h+=" z"}else{h+=" L0,"+(f+a)+" Q0,"+f+" "+a+","+f+" z"}return h},onResize:function(b,c,a){this.darkShadow.setWidth(c);this.darkShadow.setHeight(a);this.darkShadow.setPath(this.genPath(c,a,this.radius,this.tabOffset,this.tabWidth,this.tabHeight));this.lightShadow.setWidth(c-2);this.lightShadow.setHeight(a-2);this.setPosition(this.lightShadow,1,1);this.lightShadow.setPath(this.genPath(c-2,a-2,this.radius-1,this.tabOffset,this.tabWidth-2,this.tabHeight));this.background.setWidth(c-4);this.background.setHeight(a-4);this.setPosition(this.background,2,2);this.background.setPath(this.genPath(c-4,a-4,this.radius-1.4,this.tabOffset,this.tabWidth-4,this.tabHeight))}});Ui.ToolBar.extend("Ui.MenuBar",{});Ui.Pressable.extend("Ui.Menu",{headerLabel:undefined,header:undefined,dialog:undefined,scope:undefined,constructor:function(a){this.addEvents("item");this.headerLabel=new Ui.Label({margin:5,horizontalAlign:"left"});this.append(this.headerLabel);this.dialog=new Ui.MenuDialog({element:this.headerLabel});this.connect(this.dialog,"item",function(b,c){this.fireEvent("item",this,c)});this.connect(this,"press",this.onTitlePress)},setHeader:function(a){if(this.header!=a){this.header=a;this.headerLabel.setText(a);this.dialog.setHeader(a)}},appendItem:function(b,f,a){if(typeof(b)=="string"){b=new Ui.Label({horizontalAlign:"left",text:b})}var d=this;var c=this.dialog.appendItem(b);if(f!=undefined){if(a===undefined){if(this.scope===undefined){a=this}else{a=this.scope}}a.connect(c,"press",function(g){f.call(this,d,g.getChildren()[0])})}},setScope:function(a){this.scope=a},setItems:function(a){this.dialog.clearItems();for(var b=0;b<a.length;b++){this.appendItem(a[b].item,a[b].callback,a[b].scope)}},appendSeparator:function(){this.dialog.appendSeparator()},getIsOpen:function(){return this.dialog.getIsVisible()},open:function(){this.dialog.show()},close:function(){this.dialog.hide()},onTitlePress:function(){this.open()}});Ui.Container.extend("Ui.MenuDialog",{element:undefined,background:undefined,header:undefined,scroll:undefined,content:undefined,shadow:undefined,constructor:function(a){this.addEvents("item");if("element" in a){this.element=a.element;delete (a.element)}else{throw ("element property is NEEDED for Ui.MenuDialog")}this.shadow=new Ui.Rectangle({opacity:0,fill:new Ui.Color({a:0})});this.appendChild(this.shadow);this.background=new Ui.MenuBackground({fill:new Ui.Color({r:0.96,g:0.96,b:0.96}),radius:4});this.appendChild(this.background);this.header=new Ui.Label({margin:5,horizontalAlign:"left"});this.appendChild(this.header);this.scroll=new Ui.ScrollingArea({margin:5,scrollHorizontal:true});this.content=new Ui.VBox();this.scroll.setContent(this.content);this.appendChild(this.scroll);this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.scroll.getDrawing(),"mousedown",function(b){b.stopPropagation()});this.connect(this.getDrawing(),"fingerdown",this.onFingerDown);this.connect(this.scroll.getDrawing(),"fingerdown",function(b){b.stopPropagation()});this.connect(this.getDrawing(),"keydown",this.onKeyDown)},setHeader:function(a){this.header.setText(a)},clearItems:function(){while(this.content.getFirstChild()!=undefined){this.content.remove(this.content.getFirstChild())}},appendItem:function(b){var a=new Ui.MenuItem();a.setContent(b);this.connect(a,"press",this.onItemPress);this.content.append(a);return a},appendSeparator:function(){this.content.append(new Ui.Separator())},onItemPress:function(b){var a=b.getContent();this.fireEvent("item",this,a);this.hide()},onMouseDown:function(a){this.hide();a.preventDefault();a.stopPropagation()},onFingerDown:function(a){this.hide();a.preventDefault();a.stopPropagation()},onKeyDown:function(d){var b=d.which;if(b==27){d.preventDefault();d.stopPropagation();this.hide()}else{if(b==40){for(var a=0;a<this.content.getChildren().length;a++){if(!Ui.MenuItem.hasInstance(this.content.getChildren()[a])){continue}if(this.content.getChildren()[a].getIsCurrent()){for(a=a+1;a<this.content.getChildren().length;a++){if(Ui.MenuItem.hasInstance(this.content.getChildren()[a])){d.preventDefault();d.stopPropagation();this.content.getChildren()[a].setCurrent();break}}}}}else{if(b==38){var c=undefined;for(var a=0;a<this.content.getChildren().length;a++){if(!Ui.MenuItem.hasInstance(this.content.getChildren()[a])){continue}if(this.content.getChildren()[a].getIsCurrent()){if(c!=undefined){d.preventDefault();d.stopPropagation();c.setCurrent()}break}c=this.content.getChildren()[a]}}}}}},{visible:false,show:function(){var a=this.getIsVisible();Ui.MenuDialog.base.show.call(this);if(!a){this.header.setFontWeight(this.element.getFontWeight());this.header.setFontSize(this.element.getFontSize());Ui.App.current.appendDialog(this)}},onHidden:function(){Ui.App.current.removeDialog(this)},measureCore:function(g,b){this.shadow.measure(g,b);var f=this.element.pointToWindow({x:0,y:0});var c=this.element.pointToWindow({x:this.element.getLayoutWidth(),y:this.element.getLayoutHeight()});var a=this.header.measure(c.x,c.y);var d=this.scroll.measure(g,b-c.y);return{width:Math.max(a.width,d.width),height:(a.height+d.height)}},arrangeCore:function(d,a){this.shadow.arrange(0,0,d,a);var c=this.element.pointToWindow({x:0,y:0});var b=this.element.pointToWindow({x:this.element.getLayoutWidth(),y:this.element.getLayoutHeight()});this.header.arrange(c.x-5,c.y-5,this.header.getMeasureWidth(),this.header.getMeasureHeight());var f=0;if(this.scroll.getMeasureWidth()>d-c.x-5){f=c.x-(d-this.scroll.getMeasureWidth())-5}this.scroll.arrange(c.x-f-5,b.y,Math.max(this.header.getMeasureWidth(),this.scroll.getMeasureWidth()),this.scroll.getMeasureHeight());this.background.setTab(f,this.header.getMeasureWidth(),this.header.getMeasureHeight()-5);this.background.arrange(c.x-f-5,c.y-5,Math.max(this.header.getMeasureWidth(),this.scroll.getMeasureWidth()),this.header.getMeasureHeight()+this.scroll.getMeasureHeight()-5)}});Ui.Container.extend("Ui.MenuBackground",{darkShadow:undefined,lightShadow:undefined,background:undefined,radius:8,fill:"black",tabOffset:30,tabWidth:10,tabHeight:10,constructor:function(a){this.darkShadow=new Ui.Shape({fill:"#010002"});this.appendChild(this.darkShadow);this.lightShadow=new Ui.Shape({fill:"#5f625b"});this.appendChild(this.lightShadow);var b=(new Ui.Color({r:0.5,g:0.5,b:0.5})).getYuv();var c=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:0.25,u:b.u,v:b.v})},{offset:1,color:new Ui.Color({y:0.16,u:b.u,v:b.v})}]});this.background=new Ui.Shape({fill:c});this.appendChild(this.background)},setTab:function(c,b,a){this.tabOffset=c;this.tabWidth=b;this.tabHeight=a;this.invalidateArrange()},setRadius:function(a){if(this.radius!=a){this.radius=a;this.invalidateArrange()}},setFill:function(c){if(this.fill!=c){this.fill=Ui.Color.create(c);var a=this.fill.getYuva();if(this.getLayoutHeight()>0){var b=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})},{offset:this.tabHeight/(this.getLayoutHeight()*2),color:new Ui.Color({y:a.y,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y,u:a.u,v:a.v})}]});this.background.setFill(b)}this.darkShadow.setFill(new Ui.Color({y:a.y-0.4,u:a.u,v:a.v}));this.lightShadow.setFill(new Ui.Color({y:a.y+0.1,u:a.u,v:a.v}))}},genPath:function(g,b,a,d,c,f){if(c==g){return"M"+a+",0 L"+(g-a)+",0 Q"+g+",0 "+g+","+a+" L"+g+","+(b-a)+" Q"+g+","+b+" "+(g-a)+","+b+" L"+a+","+b+" Q"+0+","+b+" 0,"+(b-a)+" L0,"+a+" Q0,0 "+a+",0 z"}var h="M"+d+","+f+" L"+d+","+a+" Q"+d+",0 "+(d+a)+",0 L"+(d+c-a)+",0 Q"+(d+c)+",0 "+(d+c)+","+a+" L"+(d+c)+","+f+" L"+(g-a)+","+f+" Q"+g+","+f+" "+g+","+(f+a)+" L"+g+","+(b-a)+" Q"+g+","+b+" "+(g-a)+","+b+" L"+a+","+b+" Q0,"+b+" 0,"+(b-a);if(d==0){h+=" z"}else{h+=" L0,"+(f+a)+" Q0,"+f+" "+a+","+f+" z"}return h}},{arrangeCore:function(c,a){this.darkShadow.setPath(this.genPath(c,a,this.radius,this.tabOffset,this.tabWidth,this.tabHeight));this.darkShadow.arrange(0,0,c,a);this.lightShadow.setPath(this.genPath(c-2,a-2,this.radius-1,this.tabOffset,this.tabWidth-2,this.tabHeight));this.lightShadow.arrange(1,1,c-2,a-2);this.background.setPath(this.genPath(c-4,a-4,this.radius-1.4,this.tabOffset,this.tabWidth-4,this.tabHeight));this.background.arrange(2,2,c-4,a-4);var b=this.fill.getYuva();var d=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:b.y-0.1,u:b.u,v:b.v})},{offset:this.tabHeight/(a*2),color:new Ui.Color({y:b.y,u:b.u,v:b.v})},{offset:1,color:new Ui.Color({y:b.y,u:b.u,v:b.v})}]});this.background.setFill(d)}});Ui.MouseOverable.extend("Ui.MenuItem",{background:undefined,pressable:undefined,constructor:function(){this.addEvents("press");this.background=new Ui.Rectangle({fill:"#1c8ef2",opacity:0,radius:4});this.append(this.background);this.pressable=new Ui.Pressable({padding:5,paddingLeft:10,paddingRight:10});this.append(this.pressable);this.connect(this.pressable,"press",function(){this.fireEvent("press",this)});this.connect(this,"enter",this.onEnter);this.connect(this,"leave",this.onLeave);this.connect(this.pressable,"down",this.onDown);this.connect(this.pressable,"up",this.onUp);this.connect(this.pressable,"focus",this.onItemFocus);this.connect(this.pressable,"blur",this.onItemBlur)},getIsCurrent:function(){return this.pressable.getHasFocus()},setCurrent:function(){this.pressable.focus()},getContent:function(){return this.pressable.getChildren()[0]},onEnter:function(){this.pressable.focus()},onLeave:function(){},onDown:function(){this.background.setOpacity(1)},onUp:function(){this.background.setOpacity(0)},onItemFocus:function(){this.background.setOpacity(0.6)},onItemBlur:function(){this.background.setOpacity(0)}},{setContent:function(a){this.pressable.append(Ui.Element.create(a))}});Ui.LBox.extend("Ui.SegmentBar",{border:undefined,hbox:undefined,current:undefined,field:"text",data:undefined,constructor:function(a){this.setFocusable(true);this.addEvents("change");this.border=new Ui.Frame({frameWidth:1,fill:"#888888",radius:8});this.append(this.border);this.hbox=new Ui.HBox({uniform:true,margin:1});this.append(this.hbox);this.connect(this,"focus",this.updateColors);this.connect(this,"blur",this.updateColors);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},setField:function(a){this.field=a},setData:function(c){while(this.hbox.getFirstChild()!=undefined){this.disconnect(this.hbox.getFirstChild(),"select",this.onSegmentSelect);this.hbox.remove(this.hbox.getFirstChild())}this.data=c;for(var a=0;a<c.length;a++){var b=new Ui.SegmentButton({data:c[a],text:c[a][this.field],mode:(a==0)?"left":(a==c.length-1)?"right":"middle"});this.hbox.append(b,true);this.connect(b,"select",this.onSegmentSelect)}},setCurrentPosition:function(a){if((a>=0)&&(a<this.hbox.getChildren().length)){this.hbox.getChildren()[a].select()}},getCurrentPosition:function(){for(var a=0;a<this.hbox.getChildren().length;a++){if(this.hbox.getChildren()[a].getIsSelected()){return a}}},next:function(){for(var a=0;a<this.hbox.getChildren().length;a++){if(this.hbox.getChildren()[a]==this.current){this.setCurrentPosition(a+1);break}}},previous:function(){for(var a=0;a<this.hbox.getChildren().length;a++){if(this.hbox.getChildren()[a]==this.current){this.setCurrentPosition(a-1);break}}},onSegmentSelect:function(a){this.focus();if(this.current!=undefined){this.current.unselect()}this.current=a;this.fireEvent("change",this,a.getData())},onKeyDown:function(b){if(this.getIsDisabled()){return}var a=b.which;if((a==37)||(a==39)){b.stopPropagation();b.preventDefault()}if(a==37){this.previous()}else{if(a==39){this.next()}}},getCurrentColor:function(){var a=this.getStyleProperty("color");if(this.getHasFocus()){a=this.getStyleProperty("focusColor")}return a},updateColors:function(){var a=this.getCurrentColor();for(var b=0;b<this.hbox.getChildren().length;b++){this.hbox.getChildren()[b].setFill(a)}}},{onStyleChange:function(){this.updateColors()}},{style:{color:"#548be3",focusColor:"#ba8f68"}});Ui.Selectable.extend("Ui.SegmentButton",{label:undefined,bg:undefined,shadow:undefined,mode:undefined,sep1:undefined,sep2:undefined,data:undefined,fill:undefined,downGradient:undefined,constructor:function(a){this.setFocusable(false);var b=new Ui.LinearGradient({stops:[{offset:0,color:"#fbfbfb"},{offset:1,color:"#c8c8c8"}]});this.bg=new Ui.Rectangle({fill:b,radiusTopLeft:7,radiusBottomLeft:7});this.append(this.bg);this.labelShadow=new Ui.Label({fontWeight:"bold",marginTop:6,marginBottom:4,marginLeft:11,marginRight:9,color:"#ffffff"});this.append(this.labelShadow);this.label=new Ui.Label({fontWeight:"bold",margin:5,marginLeft:10,marginRight:10,color:"#656565"});this.append(this.label);this.sep1=new Ui.Rectangle({width:1,fill:"#ebebeb",horizontalAlign:"left"});this.append(this.sep1);this.sep2=new Ui.Rectangle({width:1,fill:"#aaaaaa",horizontalAlign:"right"});this.append(this.sep2);this.shadow=new Ui.Shadow({shadowWidth:3,inner:true,opacity:0,color:"#041a3d"});this.append(this.shadow);this.connect(this,"select",this.onButtonSelect);this.connect(this,"unselect",this.onButtonUnselect)},getData:function(){return this.data},setData:function(a){this.data=a},setText:function(a){this.label.setText(a);this.labelShadow.setText(a)},setMode:function(a){this.mode=a;if(a=="left"){this.shadow.setRadiusTopLeft(6);this.shadow.setRadiusBottomLeft(6);this.shadow.setRadiusTopRight(0);this.shadow.setRadiusBottomRight(0);this.bg.setRadiusTopLeft(6);this.bg.setRadiusBottomLeft(6);this.bg.setRadiusTopRight(0);this.bg.setRadiusBottomRight(0);this.sep1.hide();this.sep2.show()}else{if(a=="right"){this.shadow.setRadiusTopLeft(0);this.shadow.setRadiusBottomLeft(0);this.shadow.setRadiusTopRight(6);this.shadow.setRadiusBottomRight(6);this.bg.setRadiusTopLeft(0);this.bg.setRadiusBottomLeft(0);this.bg.setRadiusTopRight(6);this.bg.setRadiusBottomRight(6);this.sep1.show();this.sep2.hide()}else{this.shadow.setRadiusTopLeft(0);this.shadow.setRadiusBottomLeft(0);this.shadow.setRadiusTopRight(0);this.shadow.setRadiusBottomRight(0);this.bg.setRadiusTopLeft(0);this.bg.setRadiusBottomLeft(0);this.bg.setRadiusTopRight(0);this.bg.setRadiusBottomRight(0);this.sep1.show();this.sep2.show()}}},setFill:function(b){if(this.fill!=b){this.fill=Ui.Color.create(b);var a=this.fill.getYuva();this.downGradient=new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})}]});if(this.getIsSelected()){this.bg.setFill(this.downGradient)}this.shadow.setColor(new Ui.Color({y:a.y-0.4,u:a.u,v:a.v}))}},onButtonSelect:function(){this.bg.setFill(this.downGradient);this.shadow.setOpacity(0.5);this.sep1.hide();this.sep2.hide();this.label.hide()},onButtonUnselect:function(){var a=new Ui.LinearGradient({stops:[{offset:0,color:"#fbfbfb"},{offset:1,color:"#c8c8c8"}]});this.bg.setFill(a);this.shadow.setOpacity(0);if(this.mode=="left"){this.sep2.show()}else{if(this.mode=="right"){this.sep1.show()}else{this.sep1.show();this.sep2.show()}}this.label.show()}},{onDisable:function(){Ui.Selectable.base.onDisable.call(this);this.bg.setOpacity(0.2)},onEnable:function(){Ui.Selectable.base.onEnable.call(this);this.bg.setOpacity(1)}});Ui.Container.extend("Ui.Paned",{vertical:true,cursor:undefined,content1Box:undefined,content1:undefined,minContent1Size:0,content2Box:undefined,content2:undefined,minContent2Size:0,pos:0.5,constructor:function(a){this.content1Box=new Ui.LBox();this.appendChild(this.content1Box);this.content2Box=new Ui.LBox();this.appendChild(this.content2Box);this.cursor=new Ui.Movable();this.appendChild(this.cursor);this.cursor.setContent(new Ui.VPanedCursor());this.connect(this.cursor,"move",this.onCursorMove);if(a.orientation!=undefined){this.setOrientation(a.orientation)}},getOrientation:function(){if(this.vertical){return"vertical"}else{return"horizontal"}},setOrientation:function(b){var a=true;if(b!="vertical"){a=false}if(this.vertical!=a){this.vertical=a;if(this.vertical){this.cursor.setContent(new Ui.VPanedCursor())}else{this.cursor.setContent(new Ui.HPanedCursor())}this.invalidateMeasure()}},getContent1:function(){return this.content1},setContent1:function(a){if(this.content1!=a){if(this.content1!=undefined){this.content1Box.remove(this.content1)}this.content1=a;if(this.content1!=undefined){this.content1Box.append(this.content1)}}},getContent2:function(){return this.content2},setContent2:function(a){if(this.content2!=a){if(this.content2!=undefined){this.content2Box.remove(this.content2)}this.content2=a;if(this.content2!=undefined){this.content2Box.append(this.content2)}}},onCursorMove:function(){this.disconnect(this.cursor,"move",this.onCursorMove);var b;var a;if(this.vertical){b=this.cursor.getPositionY();a=this.getLayoutHeight()-this.cursor.getLayoutHeight()}else{b=this.cursor.getPositionX();a=this.getLayoutWidth()-this.cursor.getLayoutWidth()}this.pos=b/a;if(a*this.pos<this.minContent1Size){this.pos=this.minContent1Size/a}if(a*(1-this.pos)<this.minContent2Size){this.pos=1-(this.minContent2Size/a)}b=this.pos*a;if(b<0){b=0}if(b>a){b=a}if(this.vertical){this.cursor.setPosition(0,b)}else{this.cursor.setPosition(b,0)}this.invalidateMeasure();this.connect(this.cursor,"move",this.onCursorMove)}},{measureCore:function(d,a){if(this.vertical){var b=this.cursor.measure(d,0);this.minContent1Size=this.content1Box.measure(d,0).height;this.minContent2Size=this.content2Box.measure(d,0).height;var f=this.content1Box.measure(d,(a-b.height)*this.pos);var c=this.content2Box.measure(d,(a-b.height)*(1-this.pos));return{width:Math.max(b.width,Math.max(f.width,c.width)),height:f.height+b.height+c.height}}else{var b=this.cursor.measure(0,a);this.minContent1Size=this.content1Box.measure(0,0).width;this.minContent2Size=this.content2Box.measure(0,0).width;var f=this.content1Box.measure((d-b.width)*this.pos,a);var c=this.content2Box.measure((d-b.width)*(1-this.pos),a);return{width:f.width+b.width+c.width,height:Math.max(b.height,Math.max(f.height,c.height))}}},arrangeCore:function(f,a){if(this.vertical){var c=this.cursor.getMeasureHeight();var g=a-c;this.cursor.arrange(0,0,f,c);this.cursor.setPosition(0,g*this.pos);this.content1Box.arrange(0,0,f,g*this.pos);this.content2Box.arrange(0,(g*this.pos)+c,f,g*(1-this.pos))}else{var b=this.cursor.getMeasureWidth();var d=f-b;this.content1Box.arrange(0,0,d*this.pos,a);this.cursor.arrange(0,0,b,a);this.cursor.setPosition(d*this.pos,0);this.content2Box.arrange((d*this.pos)+b,0,d*(1-this.pos),a)}}});Ui.Paned.extend("Ui.VPaned",{constructor:function(a){this.setOrientation("vertical")}});Ui.Paned.extend("Ui.HPaned",{constructor:function(a){this.setOrientation("horizontal")}});Ui.LBox.extend("Ui.HPanedCursor",{constructor:function(b){var a=new Ui.HBox({verticalAlign:"center",height:30});this.append(a);a.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.6}),width:1,marginLeft:10}));a.append(new Ui.Rectangle({fill:new Ui.Color({r:0.31,g:0.66,b:1,a:0.6}),width:1}));a.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.6}),width:1,marginLeft:5}));a.append(new Ui.Rectangle({fill:new Ui.Color({r:0.31,g:0.66,b:1,a:0.6}),width:1,marginRight:10}))}});Ui.LBox.extend("Ui.VPanedCursor",{constructor:function(a){var b=new Ui.VBox({horizontalAlign:"center",width:30});this.append(b);b.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.6}),height:1,marginTop:10}));b.append(new Ui.Rectangle({fill:new Ui.Color({r:0.31,g:0.66,b:1,a:0.6}),height:1}));b.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.6}),height:1,marginTop:5}));b.append(new Ui.Rectangle({fill:new Ui.Color({r:0.31,g:0.66,b:1,a:0.6}),height:1,marginBottom:10}))}});Ui.LBox.extend("Ui.VirtualKeyboard",{bg:undefined,fold:undefined,constructor:function(a){this.addEvents("open","close");this.fold=new Ui.Fold({mode:"extend",over:false,orientation:"vertical"});this.setContent(this.fold);var j=new Ui.LinearGradient({orientation:"vertical",stops:[{offset:0,color:new Ui.Color({r:0.8,g:0.8,b:0.8})},{offset:0.01,color:new Ui.Color({r:0.5,g:0.5,b:0.5})},{offset:0.2,color:new Ui.Color({r:0.4,g:0.4,b:0.4})},{offset:1,color:new Ui.Color({r:0.2,g:0.2,b:0.2})}]});var b=new Ui.LBox();this.fold.setContent(b);this.bg=new Ui.Rectangle({fill:j});b.append(this.bg);var h=new Ui.VBox({margin:10,spacing:5,horizontalAlign:"center",uniform:true,height:200});b.append(h);var c=new Ui.HBox();h.append(c,true);var k="AZERTYUIOP";for(var d=0;d<k.length;d++){var g=k.charAt(d);var f=new Ui.VirtualKeyboardKey({text:g,key:g,focusable:false,width:60});this.connect(f,"press",this.onKeyPress);c.append(f)}var f=new Ui.VirtualKeyboardKey({text:"backspace",key:"\b",focusable:false,width:100});c.append(f,true);c=new Ui.HBox({marginLeft:20});h.append(c,true);k="QSDFGHJKLM";for(var d=0;d<k.length;d++){var g=k.charAt(d);var f=new Ui.VirtualKeyboardKey({text:g,key:g,focusable:false,width:60});this.connect(f,"press",this.onKeyPress);c.append(f)}var f=new Ui.VirtualKeyboardKey({text:"retour",key:"\n",focusable:false,width:100});c.append(f,true);c=new Ui.HBox();h.append(c,true);var f=new Ui.VirtualKeyboardKey({text:"shift",focusable:false,width:60});c.append(f,true);k="WXCVBN?!'";for(var d=0;d<k.length;d++){var g=k.charAt(d);var f=new Ui.VirtualKeyboardKey({text:g,key:g,focusable:false,width:60});this.connect(f,"press",this.onKeyPress);c.append(f)}var f=new Ui.VirtualKeyboardKey({text:"shift",focusable:false,width:60});c.append(f,true);c=new Ui.HBox();h.append(c,true);var f=new Ui.VirtualKeyboardKey({text:".?123",focusable:false,width:100});c.append(f,false);var f=new Ui.VirtualKeyboardKey({text:"",focusable:false});c.append(f,true);var f=new Ui.VirtualKeyboardKey({text:".?123",focusable:false,width:100});c.append(f,false);var f=new Ui.VirtualKeyboardKey({icon:"arrowbottom",width:60});c.append(f,false);this.connect(f,"press",this.close)},open:function(){this.fold.unfold();this.fireEvent("open",this)},close:function(){this.fold.fold();this.fireEvent("close",this)},onKeyPress:function(c){console.log("onKeyPress "+c.getKey()+", focus: "+Ui.App.current.getFocusElement()+", code: "+c.getKey().charCodeAt(0));var b=Ui.App.current.getFocusElement();if(b!=undefined){var a=c.getKey().charCodeAt(0);var d;if("TextEvent" in window){d=document.createEvent("TextEvent");d.initTextEvent("textInput",true,true,window,c.getKey(),TextEvent.DOM_INPUT_METHOD_KEYBOARD,"")}else{d=document.createEvent("KeyboardEvent");if("initKeyboardEvent" in d){d.initKeyboardEvent("keypress",true,true,window,"U+0041",KeyboardEvent.DOM_KEY_LOCATION_STANDARD,"")}else{d.initKeyEvent("keypress",true,true,window,false,false,false,false,a,a)}}b.dispatchEvent(d)}}});Ui.Button.extend("Ui.VirtualKeyboardKey",{key:undefined,constructor:function(a){},setKey:function(a){this.key=a},getKey:function(){return this.key}});Core.Object.extend("Ui.Styles",{},{},{"default":{"Ui.Label":{fontSize:16,color:"#000000"},"Ui.Button":{color:"#4fa8ff",focusColor:"#f6caa2"},"Ui.DownloadButton":{color:new Ui.Color({r:0.21,g:0.9,b:0.56}),focusColor:"#f6caa2"},"Ui.Separator":{color:"#000000"},"Ui.ToolBar":{"Ui.Label":{fontSize:16,color:"#ffffff"},"Ui.Button":{color:"#f4f4f4"},"Ui.UploadButton":{color:"#f4f4f4"},"Ui.ToggleButton":{color:"#f4f4f4"},"Ui.TextButtonField":{color:"#f4f4f4"},"Ui.ScrollingArea":{color:"#f4f4f4"}},"Ui.Popup":{color:new Ui.Color({r:0.1,g:0.15,b:0.2}),shadowColor:new Ui.Color({r:0,g:0,b:0,a:0.5}),"Ui.Label":{color:"#ffffff"},"Ui.Text":{color:"#ffffff"},"Ui.Separator":{color:"#ffffff"},"Ui.MonthCalendar":{color:"#ffffff",dayColor:new Ui.Color({r:0.31,g:0.66,b:1,a:0.3}),currentDayColor:new Ui.Color({r:1,g:0.31,b:0.66,a:0.5})}},"Ui.MenuDialog":{"Ui.Separator":{color:"#666666"}},"Ui.VirtualKeyboardKey":{radius:8,color:new Ui.Color({r:0.9,g:0.9,b:0.9}),focusColor:new Ui.Color({r:0.9,g:0.9,b:0.9})}}});Ui.LBox.extend("Form.Field",{label:undefined,labelBox:undefined,requireStar:undefined,require:false,description:undefined,validation:undefined,defaultValue:undefined,fieldBox:undefined,contentBox:undefined,labelAlign:undefined,error:undefined,background:undefined,uiElt:undefined,uiEltType:Ui.Element,constructor:function(c){this.addEvents("change");this.setWidth(200);this.labelAlign=this.getStyleProperty("labelAlign");var a=this.labelAlign==="top"?Ui.VBox:Ui.HBox;var b=this.labelAlign==="right"?"right":"left";this.setMargin(2);this.setContent([{type:Ui.Rectangle,name:"background",opacity:0,fill:"pink",radius:8},{type:a,margin:5,name:"contentBox",content:[{type:Ui.HBox,name:"labelBox",spacing:2,horizontalAlign:b,verticalAlign:"top",content:[{type:Ui.Label,name:"label"}]},{type:Ui.VBox,name:"fieldBox",content:[{type:Ui.Text,name:"description",textAlign:"left",color:"#444444"},{type:Ui.Text,name:"error",color:"red",textAlign:"left",fontWeight:"bold"}]}]}])},setLabelAlign:function(c){if(this.labelAlign!==c){this.labelAlign=c;this.contentBox.clear();this.remove(this.contentBox);var a=this.labelAlign==="top"?Ui.VBox:Ui.HBox;var b=this.labelAlign==="right"?"right":"left";this.contentBox=new a({content:[this.labelBox,this.fieldBox]});this.labelBox.setHorizontalAlign(b);this.append(this.contentBox)}},setUiElementType:function(a){this.uiEltType=a;this.setUiElement({})},setLabel:function(a){this.label.setText(a)},setRequire:function(a){this.require=a;if(this.require){this.requireStar=new Ui.Label({text:"*",color:"red",fontWeight:"bold"});this.labelBox.append(this.requireStar)}else{if(this.requireStar!=null&&this.labelBox.hasChild(this.requireStar)){this.labelBox.remove(this.requireStar)}}},isRequire:function(){return this.require},setDescription:function(a){this.description.setText(a)},setValidation:function(a){this.validation=a},getValidation:function(){return this.validation},setDefaultValue:function(a){this.defaultValue=a;this.setValue(this.defaultValue)},getError:function(){return this.error.getText()},setError:function(a){if(a!==""){this.background.setOpacity(1)}else{this.background.setOpacity(0)}this.error.setText(a)},validate:function(){this.setError("")},setRequireError:function(){this.setError("Champs obligatoire")},getValue:function(){return this.uiElt!==undefined?this.uiElt.getValue():undefined},setValue:function(a){if(this.uiElt!==undefined){this.uiElt.setValue(a)}},setUiElement:function(a){if(this.uiElt!==undefined){this.fieldBox.remove(this.uiElt)}this.uiElt=this.uiEltType.create(a);this.fieldBox.prepend(this.uiElt)},reset:function(){if(this.defaultValue!==undefined){this.setValue(this.defaultValue)}},isValid:function(){return true},onChange:function(){this.fireEvent("change",this)}},{},{style:{labelAlign:"top"}});Form.Field.extend("Form.ComboField",{constructor:function(a){this.setUiElementType(Ui.Combo);if(!("uiElement" in a)){this.setUiElement({horizontalAlign:"left"})}this.connect(this.uiElt,"change",this.onChange)}},{getValue:function(){return this.uiElt.getCurrent()},setValue:function(a){this.uiElt.setData(a)},setUiElement:function(a){a=Ui.Combo.create(a);a.setHorizontalAlign("left");Form.ComboField.base.setUiElement.call(this,a)},isValid:function(){if(this.isRequire()&&this.getValue()===undefined){this.setRequireError();return false}else{this.validate();return true}}});Form.Field.extend("Form.TextField",{constructor:function(a){this.setUiElementType(Ui.TextField)}},{setUiElement:function(a){Form.TextField.base.setUiElement.call(this,a);if(this.uiElt.entry!=null){this.uiElt.entry.setFontSize(this.getStyleProperty("fontSize"));this.connect(this.uiElt,"change",this.onChange)}},isValid:function(){var b=true;var d=this.getValue()!=null?this.getValue().trim():"";var a=this.getValidation();var c=d.length===0?true:false;if(this.isRequire()&&c){b=false;this.setRequireError()}else{if(!c&&a!==undefined){if(a instanceof RegExp){b=a.test(d)}else{if(typeof a==="function"){b=a(d)}}if(!b){this.setError("Non valide")}}}if(b){this.validate()}return b},onChange:function(){Form.TextField.base.onChange.call(this);this.isValid()}},{style:{fontSize:14}});Form.TextField.extend("Form.TextAreaField",{constructor:function(a){this.setUiElementType(Ui.TextAreaField)}},{setUiElement:function(a){Form.TextAreaField.base.setUiElement.call(this,a);if(this.uiElt.textarea!=null){this.uiElt.textarea.setFontSize(this.getStyleProperty("fontSize"));this.connect(this.uiElt.textarea,"change",this.onChange)}}});Form.TextField.extend("Form.PasswordField",{},{setUiElement:function(a){Form.PasswordField.base.setUiElement.call(this,a);this.uiElt.setPasswordMode(true)}});Form.Field.extend("Form.DateField",{constructor:function(a){this.setUiElementType(Ui.DatePicker);if(!("uiElement" in a)){this.setUiElement({horizontalAlign:"left"})}}},{getValue:function(){return this.uiElt.getSelectedDate()},setValue:function(a){this.uiElt.setSelectedDate(a)},setUiElement:function(a){Form.DateField.base.setUiElement.call(this,a);this.connect(this.uiElt,"change",this.onChange)},isValid:function(){if((this.isRequire()&&!this.uiElt.getIsValid())){this.setRequireError();return false}else{this.validate();return true}}});Form.Field.extend("Form.CheckBoxField",{constructor:function(){this.setUiElementType(Ui.CheckBox)}},{isValid:function(){if((this.isRequire()&&!this.getValue())){this.setRequireError();return false}else{this.validate();return true}}});Form.Field.extend("Form.LabelField",{constructor:function(){this.setUiElementType(Ui.Label)}},{setUiElement:function(a){Form.LabelField.base.setUiElement.call(this,a);this.uiElt.setHorizontalAlign("left")},setValue:function(a){this.uiElt.setText(a)},getValue:function(){this.uiElt.getText()}});Form.Field.extend("Form.FieldContainer",{fields:undefined,constructor:function(a){this.setUiElementType(Ui.HBox)},setFields:function(a){this.fields={};for(var b in a){var c=this.fields[b]=Form.Field.create(a[b]);this.uiElt.append(c)}}},{setUiElement:function(a){Form.FieldContainer.base.setUiElement.call(this,a);this.fieldBox.moveChildAt(this.description,0);if(this.fields!=null){this.setFields(this.fields)}if(this.require){this.setRequire(this.require)}},setValue:function(c){if(typeof c==="object"&&this.uiElt!=null){for(var a in c){var b=this.fields[a];if(b!=null){b.setValue(c[a])}}}},getValue:function(){var c={};for(var a in this.fields){var b=this.fields[a];if(b!=null){c[a]=b.getValue()}}return c},isValid:function(){var a=this.uiElt.getChildren();for(var b=0;b<a.length;b++){if(!a[b].isValid()){return false}}return true},setRequire:function(b){this.require=b;if(b){var a=this.uiElt.getChildren();for(var c=0;c<a.length;c++){a[c].setRequire(b)}}}});Ui.LBox.extend("Form.Panel",{title:undefined,description:undefined,requireFieldMsg:undefined,fields:undefined,layout:undefined,defaultLayout:true,value:undefined,submitUrl:undefined,submitHandler:undefined,submitType:"ajax",constructor:function(a){this.addEvents("change","submit");this.setPadding(10);this.title=new Ui.Label({fontSize:18,horizontalAlign:"left"});this.description=new Ui.Text({textAlign:"left",marginBottom:10});this.requireFieldMsg=new Ui.HBox({spacing:2,marginBottom:5,content:[{type:Ui.Label,text:"*",color:"red",fontWeight:"bold"},{type:Ui.Label,text:"Champs indispensables"}]});if("layout" in a){this.defaultLayout=false}},reset:function(){for(var a in this.fields){this.fields[a].reset()}},isValid:function(){var a=true;for(var b in this.fields){if(!this.fields[b].isValid()){a=false}}return a},getValue:function(){var b={};for(var c in this.fields){b[c]=this.fields[c].getValue()}for(var a in this.value){b[a]=this.value[a]}return b},setValue:function(a){this.value=a;this.updateValue()},updateValue:function(){var b={};if(this.value!==undefined){if(this.fields!==undefined){for(var a in this.value){if(a in this.fields){var c="set"+a.charAt(0).toUpperCase()+a.substr(1);if((c in this)&&(typeof(this[c])==="function")){this[c].call(this,this.value[a])}else{this.fields[a].setValue(this.value[a])}}else{b[a]=this.value[a]}}this.value=b}}},submit:function(){var d=this.isValid();if(this.submitUrl!==undefined&&d){var a=this.getValue();if(this.submitHandler!==undefined){a=this.submitHandler(a)}if(this.submitType==="ajax"){req=new Core.HttpRequest({url:this.submitUrl,method:"POST",arguments:a});this.connect(req,"done",this.onSubmitDone);req.send()}else{if(this.submitType==="link"){var c=Core.Util.encodeURIQuery(a);var b=this.submitUrl;var f=b.indexOf("?")===-1?"?":"&";b+=f+c;window.open(b)}}}return d},onSubmitDone:function(a){this.fireEvent("submit",a)},_buildDefaultLayout:function(c){var a=new Ui.VBox({content:[this.title,this.description]});if(c){a.prepend(this.requireFieldMsg)}for(var b in this.fields){a.append(this.fields[b])}return a},setTitle:function(a){this.title.setText(a)},setDescription:function(a){this.description.setText(a)},setFields:function(a){var g=false;this.fields={};for(var b in a){var d=this.fields[b]=Form.Field.create(a[b]);this.connect(d,"change",this.onChange);if(d.isRequire()){g=true}}if(this.defaultLayout){var c=this._buildDefaultLayout(g);this.setLayout(c)}else{if(this.layout!==undefined&&this.content===undefined){this.setLayout(this.layout)}}this.updateValue()},appendField:function(a,d){if(this.fields==null){this.fields={};if(this.defaultLayout){var b=this._buildDefaultLayout(false);this.setLayout(b)}}var c=this.fields[a]=Form.Field.create(d);this.connect(c,"change",this.onChange);this.layout.append(c)},removeField:function(a){if(this.fields!=null){var b=this.fields[a];if(b!=null){this.layout.remove(b)}}},getField:function(a){return this.fields!=null?this.fields[a]:undefined},setLayout:function(a){this.layout=a;if(this.fields===undefined){return}else{this.setContent(a)}},setSubmitUrl:function(a){if(typeof a==="string"){this.submitUrl=a}},getSubmitUrl:function(){return this.submitUrl},setSubmitType:function(a){this.submitType=a},getSubmitType:function(){return this.submitType},setSubmitHandler:function(a){if(typeof a==="function"){this.submitHandler=a}},onChange:function(a){this.fireEvent("change",a)}});Ui.LBox.extend("Form.PanelContainer",{layout:undefined,layoutType:Ui.VBox,panels:undefined,constructor:function(a){},setLayoutType:function(a){this.layoutType=a;this._rebuildLayout()},setPanels:function(b){this.panels={};for(var a in b){this.panels[a]=Form.Panel.create(b[a])}this._rebuildLayout()},appendPanel:function(b,a){if(this.panels==null){this.panels={}}var c=this.panels[b]=Form.Panel.create(a);this.layout.append(c)},removePanel:function(a){if(this.panels!=null){var b=this.panels[a];if(b!=null){this.layout.remove(b)}}},getPanel:function(a){return this.panels!=null?this.panels[a]:undefined},setValue:function(b){if(this.panels!=null){for(var a in b){var c=this.panels[a];if(c!=null){c.setValue(b[a])}}}},getValue:function(){var b={};if(this.panels!=null){for(var a in this.panels){b[a]=this.panels[a].getValue()}}return b},_rebuildLayout:function(){if(this.layout!=null){this.layout.clear()}if(this.panels!=null){this.layout=new this.layoutType();for(var a in this.panels){this.layout.append(this.panels[a])}this.append(this.layout)}}});Ui.Popup.extend("Form.Popup",{panel:undefined,vbox:undefined,buttonBox:undefined,undoBtn:undefined,submitBtn:undefined,constructor:function(a){this.setContent({type:Ui.VBox,name:"vbox",width:600,content:[{type:Ui.HBox,uniform:true,name:"buttonBox",horizontalAlign:"right",content:[{type:Ui.Button,name:"undoBtn",text:"Annuler",onPress:function(){this.hide()}},{type:Ui.Button,name:"submitBtn",text:"Valider",onPress:this.onSubmit}]}]})},setPanel:function(a){this.panel=Form.Panel.create(a);this.vbox.prepend(this.panel,true)},setUndoText:function(a){this.undoBtn.setText(a)},setSubmitText:function(a){this.submitBtn.setText(a)},onSubmit:function(){this.panel.submit();this.hide()}});