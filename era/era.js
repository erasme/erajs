document.createElement("canvas").getContext||function(){function a(){return this.context_||(this.context_=new n(this))}function b(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function c(a){a.namespaces.g_vml_||a.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML");a.namespaces.g_o_||a.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML");a.styleSheets.ex_canvas_||(a=a.createStyleSheet(),a.owningElement.id="ex_canvas_",a.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}")}
function d(a){a=a.srcElement;a.firstChild&&(a.firstChild.style.width=a.clientWidth+"px",a.firstChild.style.height=a.clientHeight+"px")}function e(){return[[1,0,0],[0,1,0],[0,0,1]]}function g(a,b){for(var c=e(),d=0;3>d;d++)for(var f=0;3>f;f++){for(var g=0,h=0;3>h;h++)g+=a[d][h]*b[h][f];c[d][f]=g}return c}function f(a,b){b.fillStyle=a.fillStyle;b.lineCap=a.lineCap;b.lineJoin=a.lineJoin;b.lineWidth=a.lineWidth;b.miterLimit=a.miterLimit;b.shadowBlur=a.shadowBlur;b.shadowColor=a.shadowColor;b.shadowOffsetX=
a.shadowOffsetX;b.shadowOffsetY=a.shadowOffsetY;b.strokeStyle=a.strokeStyle;b.globalAlpha=a.globalAlpha;b.font=a.font;b.textAlign=a.textAlign;b.textBaseline=a.textBaseline;b.arcScaleX_=a.arcScaleX_;b.arcScaleY_=a.arcScaleY_;b.lineScale_=a.lineScale_}function h(a){var b=a.indexOf("(",3),c=a.indexOf(")",b+1),b=a.substring(b+1,c).split(",");if(4!=b.length||"a"!=a.charAt(3))b[3]=1;return b}function k(a,b,c){return Math.min(c,Math.max(b,a))}function m(a,b,c){0>c&&c++;1<c&&c--;return 1>6*c?a+6*(b-a)*c:
1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}function l(a){if(a in F)return F[a];var b,c=1;a=String(a);if("#"==a.charAt(0))b=a;else if(/^rgb/.test(a)){c=h(a);b="#";for(var d,e=0;3>e;e++)d=-1!=c[e].indexOf("%")?Math.floor(255*(parseFloat(c[e])/100)):+c[e],b+=B[k(d,0,255)];c=+c[3]}else if(/^hsl/.test(a)){e=c=h(a);b=parseFloat(e[0])/360%360;0>b&&b++;d=k(parseFloat(e[1])/100,0,1);e=k(parseFloat(e[2])/100,0,1);if(0==d)d=e=b=e;else{var f=0.5>e?e*(1+d):e+d-e*d,g=2*e-f;d=m(g,f,b+1/3);e=m(g,f,b);b=m(g,f,b-1/3)}b="#"+
B[Math.floor(255*d)]+B[Math.floor(255*e)]+B[Math.floor(255*b)];c=c[3]}else b=L[a]||a;return F[a]={color:b,alpha:c}}function n(a){this.m_=e();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.fillStyle=this.strokeStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=1*w;this.globalAlpha=1;this.font="10px sans-serif";this.textAlign="left";this.textBaseline="alphabetic";this.canvas=a;var b="width:"+a.clientWidth+"px;height:"+a.clientHeight+"px;overflow:hidden;position:absolute",
c=a.ownerDocument.createElement("div");c.style.cssText=b;a.appendChild(c);b=c.cloneNode(!1);b.style.backgroundColor="red";b.style.filter="alpha(opacity=0)";a.appendChild(b);this.element_=c;this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function p(a,b,c,d){a.currentPath_.push({type:"bezierCurveTo",cp1x:b.x,cp1y:b.y,cp2x:c.x,cp2y:c.y,x:d.x,y:d.y});a.currentX_=d.x;a.currentY_=d.y}function r(a,b){var c=l(a.strokeStyle),d=c.color,c=c.alpha*a.globalAlpha,e=a.lineScale_*a.lineWidth;1>e&&(c*=e);b.push("<g_vml_:stroke",
' opacity="',c,'"',' joinstyle="',a.lineJoin,'"',' miterlimit="',a.miterLimit,'"',' endcap="',M[a.lineCap]||"square",'"',' weight="',e,'px"',' color="',d,'" />')}function v(a,b,c,d){var e=a.fillStyle,f=a.arcScaleX_,g=a.arcScaleY_,h=d.x-c.x,k=d.y-c.y;if(e instanceof C){var m=0,n=d=0,p=0,q=1;if("gradient"==e.type_){m=e.x1_/f;c=e.y1_/g;var r=u(a,e.x0_/f,e.y0_/g),m=u(a,m,c),m=180*Math.atan2(m.x-r.x,m.y-r.y)/Math.PI;0>m&&(m+=360);1E-6>m&&(m=0)}else r=u(a,e.x0_,e.y0_),d=(r.x-c.x)/h,n=(r.y-c.y)/k,h/=f*w,
k/=g*w,q=z.max(h,k),p=2*e.r0_/q,q=2*e.r1_/q-p;f=e.colors_;f.sort(function(a,b){return a.offset-b.offset});g=f.length;r=f[0].color;c=f[g-1].color;h=f[0].alpha*a.globalAlpha;a=f[g-1].alpha*a.globalAlpha;for(var k=[],t=0;t<g;t++){var v=f[t];k.push(v.offset*q+p+" "+v.color)}b.push('<g_vml_:fill type="',e.type_,'"',' method="none" focus="100%"',' color="',r,'"',' color2="',c,'"',' colors="',k.join(","),'"',' opacity="',a,'"',' g_o_:opacity2="',h,'"',' angle="',m,'"',' focusposition="',d,",",n,'" />')}else e instanceof
G?h&&k&&b.push("<g_vml_:fill",' position="',-c.x/h*f*f,",",-c.y/k*g*g,'"',' type="tile"',' src="',e.src_,'" />'):(e=l(a.fillStyle),b.push('<g_vml_:fill color="',e.color,'" opacity="',e.alpha*a.globalAlpha,'" />'))}function u(a,b,c){a=a.m_;return{x:w*(b*a[0][0]+c*a[1][0]+a[2][0])-A,y:w*(b*a[0][1]+c*a[1][1]+a[2][1])-A}}function s(a,b,c){isFinite(b[0][0])&&isFinite(b[0][1])&&isFinite(b[1][0])&&isFinite(b[1][1])&&isFinite(b[2][0])&&isFinite(b[2][1])&&(a.m_=b,c&&(a.lineScale_=N(O(b[0][0]*b[1][1]-b[0][1]*
b[1][0]))))}function C(a){this.type_=a;this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0;this.colors_=[]}function G(a,b){if(!a||1!=a.nodeType||"IMG"!=a.tagName)throw new D("TYPE_MISMATCH_ERR");if("complete"!=a.readyState)throw new D("INVALID_STATE_ERR");switch(b){case "repeat":case null:case "":this.repetition_="repeat";break;case "repeat-x":case "repeat-y":case "no-repeat":this.repetition_=b;break;default:throw new D("SYNTAX_ERR");}this.src_=a.src;this.width_=a.width;this.height_=a.height}
function D(a){this.code=this[a];this.message=a+": DOM Exception "+this.code}var z=Math,t=z.round,H=z.sin,I=z.cos,O=z.abs,N=z.sqrt,w=10,A=w/2;navigator.userAgent.match(/MSIE ([\d.]+)?/);c(document);var K={init:function(a){(a||document).createElement("canvas")},init_:function(a){},initElement:function(b){if(!b.getContext){b.getContext=a;c(b.ownerDocument);b.innerHTML="";b.attachEvent("onresize",d);var e=b.attributes;e.width&&e.width.specified?b.style.width=e.width.nodeValue+"px":b.width=b.clientWidth;
e.height&&e.height.specified?b.style.height=e.height.nodeValue+"px":b.height=b.clientHeight}return b}};K.init();for(var B=[],q=0;16>q;q++)for(var E=0;16>E;E++)B[16*q+E]=q.toString(16)+E.toString(16);var L={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",
cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",
dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",
lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",
midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",
seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"},F={},J={},M={butt:"flat",round:"round"},q=n.prototype;q.clearRect=function(){this.textMeasureEl_&&(this.textMeasureEl_.removeNode(!0),this.textMeasureEl_=null);this.element_.innerHTML=
""};q.beginPath=function(){this.currentPath_=[]};q.moveTo=function(a,b){var c=u(this,a,b);this.currentPath_.push({type:"moveTo",x:c.x,y:c.y});this.currentX_=c.x;this.currentY_=c.y};q.lineTo=function(a,b){var c=u(this,a,b);this.currentPath_.push({type:"lineTo",x:c.x,y:c.y});this.currentX_=c.x;this.currentY_=c.y};q.bezierCurveTo=function(a,b,c,d,e,f){e=u(this,e,f);a=u(this,a,b);c=u(this,c,d);p(this,a,c,e)};q.quadraticCurveTo=function(a,b,c,d){a=u(this,a,b);c=u(this,c,d);d={x:this.currentX_+2/3*(a.x-
this.currentX_),y:this.currentY_+2/3*(a.y-this.currentY_)};p(this,d,{x:d.x+(c.x-this.currentX_)/3,y:d.y+(c.y-this.currentY_)/3},c)};q.arc=function(a,b,c,d,e,f){c*=w;var g=f?"at":"wa",h=a+I(d)*c-A,k=b+H(d)*c-A;d=a+I(e)*c-A;e=b+H(e)*c-A;h!=d||f||(h+=0.125);a=u(this,a,b);h=u(this,h,k);d=u(this,d,e);this.currentPath_.push({type:g,x:a.x,y:a.y,radius:c,xStart:h.x,yStart:h.y,xEnd:d.x,yEnd:d.y})};q.rect=function(a,b,c,d){this.moveTo(a,b);this.lineTo(a+c,b);this.lineTo(a+c,b+d);this.lineTo(a,b+d);this.closePath()};
q.strokeRect=function(a,b,c,d){var e=this.currentPath_;this.beginPath();this.moveTo(a,b);this.lineTo(a+c,b);this.lineTo(a+c,b+d);this.lineTo(a,b+d);this.closePath();this.stroke();this.currentPath_=e};q.fillRect=function(a,b,c,d){var e=this.currentPath_;this.beginPath();this.moveTo(a,b);this.lineTo(a+c,b);this.lineTo(a+c,b+d);this.lineTo(a,b+d);this.closePath();this.fill();this.currentPath_=e};q.createLinearGradient=function(a,b,c,d){var e=new C("gradient");e.x0_=a;e.y0_=b;e.x1_=c;e.y1_=d;return e};
q.createRadialGradient=function(a,b,c,d,e,f){var g=new C("gradientradial");g.x0_=a;g.y0_=b;g.r0_=c;g.x1_=d;g.y1_=e;g.r1_=f;return g};q.drawImage=function(a,b){var c,d,e,f,g,h,k,l;e=a.runtimeStyle.width;f=a.runtimeStyle.height;a.runtimeStyle.width="auto";a.runtimeStyle.height="auto";var m=a.width,n=a.height;a.runtimeStyle.width=e;a.runtimeStyle.height=f;if(3==arguments.length)c=arguments[1],d=arguments[2],g=h=0,k=e=m,l=f=n;else if(5==arguments.length)c=arguments[1],d=arguments[2],e=arguments[3],f=
arguments[4],g=h=0,k=m,l=n;else if(9==arguments.length)g=arguments[1],h=arguments[2],k=arguments[3],l=arguments[4],c=arguments[5],d=arguments[6],e=arguments[7],f=arguments[8];else throw Error("Invalid number of arguments");var p=u(this,c,d),q=[];q.push(" <g_vml_:group",' coordsize="',10*w,",",10*w,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;");if(1!=this.m_[0][0]||this.m_[0][1]||1!=this.m_[1][1]||this.m_[1][0]){var r=[];r.push("M11=",this.m_[0][0],",","M12=",
this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",t(p.x/w),",","Dy=",t(p.y/w),"");var v=u(this,c+e,d),s=u(this,c,d+f);c=u(this,c+e,d+f);p.x=z.max(p.x,v.x,s.x,c.x);p.y=z.max(p.y,v.y,s.y,c.y);q.push("padding:0 ",t(p.x/w),"px ",t(p.y/w),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",r.join(""),", sizingmethod='clip');")}else q.push("top:",t(p.y/w),"px;left:",t(p.x/w),"px;");q.push(' ">','<g_vml_:image src="',a.src,'"',' style="width:',w*e,"px;"," height:",w*f,'px"',' cropleft="',
g/m,'"',' croptop="',h/n,'"',' cropright="',(m-g-k)/m,'"',' cropbottom="',(n-h-l)/n,'"'," />","</g_vml_:group>");this.element_.insertAdjacentHTML("BeforeEnd",q.join(""))};q.stroke=function(a){var b=[];b.push("<g_vml_:shape",' filled="',!!a,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0,0"',' coordsize="',10*w,",",10*w,'"',' stroked="',!a,'"',' path="');for(var c={x:null,y:null},d={x:null,y:null},e=0;e<this.currentPath_.length;e++){var f=this.currentPath_[e];switch(f.type){case "moveTo":b.push(" m ",
t(f.x),",",t(f.y));break;case "lineTo":b.push(" l ",t(f.x),",",t(f.y));break;case "close":b.push(" x ");f=null;break;case "bezierCurveTo":b.push(" c ",t(f.cp1x),",",t(f.cp1y),",",t(f.cp2x),",",t(f.cp2y),",",t(f.x),",",t(f.y));break;case "at":case "wa":b.push(" ",f.type," ",t(f.x-this.arcScaleX_*f.radius),",",t(f.y-this.arcScaleY_*f.radius)," ",t(f.x+this.arcScaleX_*f.radius),",",t(f.y+this.arcScaleY_*f.radius)," ",t(f.xStart),",",t(f.yStart)," ",t(f.xEnd),",",t(f.yEnd))}if(f){if(null==c.x||f.x<c.x)c.x=
f.x;if(null==d.x||f.x>d.x)d.x=f.x;if(null==c.y||f.y<c.y)c.y=f.y;if(null==d.y||f.y>d.y)d.y=f.y}}b.push(' ">');a?v(this,b,c,d):r(this,b);b.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",b.join(""))};q.fill=function(){this.stroke(!0)};q.closePath=function(){this.currentPath_.push({type:"close"})};q.save=function(){var a={};f(this,a);this.aStack_.push(a);this.mStack_.push(this.m_);this.m_=g(e(),this.m_)};q.restore=function(){this.aStack_.length&&(f(this.aStack_.pop(),this),this.m_=
this.mStack_.pop())};q.translate=function(a,b){s(this,g([[1,0,0],[0,1,0],[a,b,1]],this.m_),!1)};q.rotate=function(a){var b=I(a);a=H(a);s(this,g([[b,a,0],[-a,b,0],[0,0,1]],this.m_),!1)};q.scale=function(a,b){this.arcScaleX_*=a;this.arcScaleY_*=b;s(this,g([[a,0,0],[0,b,0],[0,0,1]],this.m_),!0)};q.transform=function(a,b,c,d,e,f){s(this,g([[a,b,0],[c,d,0],[e,f,1]],this.m_),!0)};q.setTransform=function(a,b,c,d,e,f){s(this,[[a,b,0],[c,d,0],[e,f,1]],!0)};q.drawText_=function(a,c,d,e,f){var g=this.m_;e=0;
var h=1E3,k=0,l=[],m;m=this.font;if(J[m])m=J[m];else{var n=document.createElement("div").style;try{n.font=m}catch(p){}m=J[m]={style:n.fontStyle||"normal",variant:n.fontVariant||"normal",weight:n.fontWeight||"normal",size:n.fontSize||10,family:n.fontFamily||"sans-serif"}}var n=m,q=this.element_;m={};for(var s in n)m[s]=n[s];s=parseFloat(q.currentStyle.fontSize);q=parseFloat(n.size);"number"==typeof n.size?m.size=n.size:-1!=n.size.indexOf("px")?m.size=q:-1!=n.size.indexOf("em")?m.size=s*q:-1!=n.size.indexOf("%")?
m.size=s/100*q:-1!=n.size.indexOf("pt")?m.size=q/0.75:m.size=s;m.size*=0.981;s=m.style+" "+m.variant+" "+m.weight+" "+m.size+"px "+m.family;q=this.element_.currentStyle;n=this.textAlign.toLowerCase();switch(n){case "left":case "center":case "right":break;case "end":n="ltr"==q.direction?"right":"left";break;case "start":n="rtl"==q.direction?"right":"left";break;default:n="left"}switch(this.textBaseline){case "hanging":case "top":k=m.size/1.75;break;case "middle":break;default:case null:case "alphabetic":case "ideographic":case "bottom":k=
-m.size/2.25}switch(n){case "right":e=1E3;h=0.05;break;case "center":e=h=500}c=u(this,c+0,d+k);l.push('<g_vml_:line from="',-e,' 0" to="',h,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!f,'" stroked="',!!f,'" style="position:absolute;width:1px;height:1px;">');f?r(this,l):v(this,l,{x:-e,y:0},{x:h,y:m.size});f=g[0][0].toFixed(3)+","+g[1][0].toFixed(3)+","+g[0][1].toFixed(3)+","+g[1][1].toFixed(3)+",0,0";c=t(c.x/w)+","+t(c.y/w);l.push('<g_vml_:skew on="t" matrix="',f,'" ',' offset="',
c,'" origin="',e,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',b(a),'" style="v-text-align:',n,";font:",b(s),'" /></g_vml_:line>');this.element_.insertAdjacentHTML("beforeEnd",l.join(""))};q.fillText=function(a,b,c,d){this.drawText_(a,b,c,d,!1)};q.strokeText=function(a,b,c,d){this.drawText_(a,b,c,d,!0)};q.measureText=function(a){this.textMeasureEl_||(this.element_.insertAdjacentHTML("beforeEnd",'<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>'),
this.textMeasureEl_=this.element_.lastChild);var b=this.element_.ownerDocument;this.textMeasureEl_.innerHTML="";this.textMeasureEl_.style.font=this.font;this.textMeasureEl_.appendChild(b.createTextNode(a));return{width:this.textMeasureEl_.offsetWidth}};q.clip=function(){};q.arcTo=function(a,b,c,d,e,f,g){this.quadraticCurveTo(a,b,c,d)};q.createPattern=function(a,b){return new G(a,b)};C.prototype.addColorStop=function(a,b){b=l(b);this.colors_.push({offset:a,color:b.color,alpha:b.alpha})};q=D.prototype=
Error();q.INDEX_SIZE_ERR=1;q.DOMSTRING_SIZE_ERR=2;q.HIERARCHY_REQUEST_ERR=3;q.WRONG_DOCUMENT_ERR=4;q.INVALID_CHARACTER_ERR=5;q.NO_DATA_ALLOWED_ERR=6;q.NO_MODIFICATION_ALLOWED_ERR=7;q.NOT_FOUND_ERR=8;q.NOT_SUPPORTED_ERR=9;q.INUSE_ATTRIBUTE_ERR=10;q.INVALID_STATE_ERR=11;q.SYNTAX_ERR=12;q.INVALID_MODIFICATION_ERR=13;q.NAMESPACE_ERR=14;q.INVALID_ACCESS_ERR=15;q.VALIDATION_ERR=16;q.TYPE_MISMATCH_ERR=17;G_vmlCanvasManager=K;CanvasRenderingContext2D=n;CanvasGradient=C;CanvasPattern=G;DOMException=D}();var DEBUG=!1;navigator.isGecko=null!=navigator.userAgent.match(/Gecko\//i);navigator.isWebkit=null!=navigator.userAgent.match(/WebKit\//i);navigator.isIE=null!=navigator.userAgent.match(/MSIE/i)||null!=navigator.userAgent.match(/Trident/i);navigator.isIE7=null!=navigator.userAgent.match(/MSIE 7\./i);navigator.isIE8=null!=navigator.userAgent.match(/MSIE 8\./i);navigator.isIE11=navigator.isIE&&null!=navigator.userAgent.match(/rv:11\./i);navigator.isOpera=void 0==navigator.userAgent||null!=navigator.userAgent.match(/Opera\//i);
navigator.isChrome=null!=navigator.userAgent.match(/ Chrome\//);navigator.isSafari=null!=navigator.userAgent.match(/ Safari\//);navigator.isFirefox=null!=navigator.userAgent.match(/ Firefox\//);navigator.isFirefox3=null!=navigator.userAgent.match(/ Firefox\/3\./);navigator.isFirefox3_5=null!=navigator.userAgent.match(/ Firefox\/3\.5\./);navigator.isFirefox3_6=null!=navigator.userAgent.match(/ Firefox\/3\.6\./);navigator.iPad=null!=navigator.userAgent.match(/iPad/i);navigator.iPhone=null!=navigator.userAgent.match(/iPhone/i);
navigator.iOs=navigator.iPad||navigator.iPhone;navigator.Android=null!=navigator.userAgent.match(/Android/i);var svgNS="http://www.w3.org/2000/svg",htmlNS="http://www.w3.org/1999/xhtml";
(function(){navigator.supportSVG=!1;try{var a=document.createElementNS(svgNS,"g");"ownerSVGElement"in a&&(navigator.supportSVG=!0)}catch(b){}a=document.createElement("canvas");navigator.supportCanvas="getContext"in a;navigator.supportRgba=!0;navigator.supportRgb=!0;a=document.createElement("div");try{a.style.background="rgba(0, 0, 0, 0.5)"}catch(c){navigator.supportRgba=!1}try{a.style.background="rgb(0, 0, 0)"}catch(d){navigator.supportRgb=!1}})();Core={Util:{}};Core.Util.idGenerator=0;
Core.Util.generateId=function(){return++Core.Util.idGenerator};Core.Util.baseDirectory=function(a){var b;b=void 0!=document.scripts?document.scripts:document.getElementsByTagName("script");for(var c=0;c<b.length;c++){var d=b[c].src.search(a);if(-1!=d)return b[c].src.substring(0,d)}};Core.Util.include=function(a){document.write("<script type='text/javascript' src='"+a+"'>\x3c/script>")};Core.Util.clone=function(a){if(null===a||"object"!==typeof a)return null;var b={},c;for(c in a)b[c]=a[c];return b};
Core.Util.encodeURIQuery=function(a){var b="";if(void 0!=a)for(var c in a){var d=a[c];if("number"==typeof d||"string"==typeof d||"boolean"==typeof d||"object"==typeof d)""!=b&&(b+="&"),b+=encodeURIComponent(c)+"=",b="object"==typeof d?b+encodeURIComponent(JSON.stringify(d)):b+encodeURIComponent(d)}return b};
String.prototype.utf8Encode=function(){for(var a="",b=0;b<this.length;b++){var c=this.charCodeAt(b);128>c?a+=String.fromCharCode(c):(128<=c&&2048>c?a+=String.fromCharCode(c>>6|192):(a+=String.fromCharCode(c>>12|224),a+=String.fromCharCode(c>>6&63|128)),a+=String.fromCharCode(c&63|128))}return a};
String.prototype.utf8Decode=function(){for(var a="",b=0,c;b<this.length;)c=this.charCodeAt(b++),a=128>c?a+String.fromCharCode(c):192<=c&&224>c?a+String.fromCharCode((c&31)<<6|this.charCodeAt(b++)&63):a+String.fromCharCode((c&15)<<12|(this.charCodeAt(b++)&63)<<6|this.charCodeAt(b++)&63);return a};
String.prototype.toBase64=function(){for(var a=this.utf8Encode(),b="",c=0;c+2<a.length;)var d=a.charCodeAt(c++)&255,e=a.charCodeAt(c++)&255,g=a.charCodeAt(c++)&255,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>2),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((d&3)<<4|e>>4),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&15)<<2|g>>6),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g&
63),b=b+(f+d+e+g);c+1<a.length?(d=a.charCodeAt(c++)&255,e=a.charCodeAt(c++)&255,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>2),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((d&3)<<4|e>>4),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&15)<<2),b+=f+d+e+"="):c<a.length&&(d=a.charCodeAt(c++)&255,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>2),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((d&
3)<<4),b+=f+d+"==");return b};
String.prototype.fromBase64=function(){for(var a="",b=0;b<this.length;)enc1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(this.charAt(b++)),enc2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(this.charAt(b++)),enc3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(this.charAt(b++)),enc4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(this.charAt(b++)),char1=enc1<<2|enc2>>4,char2=(enc2&
15)<<4|enc3>>2,char3=(enc3&3)<<6|enc4,a+=String.fromCharCode(char1),64!=enc3&&(a+=String.fromCharCode(char2),64!=enc4&&(a+=String.fromCharCode(char3)));return a.utf8Decode()};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});Function.prototype.bind||(Function.prototype.bind=function(a){var b=this,c;c=1<arguments.length?arguments.slice(1,arguments.length-1):[];return function(){return b.apply(a,c.concat(arguments))}});navigator.supportVML=!1;
if(navigator.isIE){if(navigator.supportSVG)SVGTextContentElement.prototype.__getStartPositionOfChar=SVGTextContentElement.prototype.getStartPositionOfChar,SVGTextContentElement.prototype.getStartPositionOfChar=function(a){return this.__getStartPositionOfChar(a).matrixTransform(this.getScreenCTM().inverse())},SVGTextContentElement.prototype.__getEndPositionOfChar=SVGTextContentElement.prototype.getEndPositionOfChar,SVGTextContentElement.prototype.getEndPositionOfChar=function(a){return this.__getEndPositionOfChar(a).matrixTransform(this.getScreenCTM().inverse())},
SVGTextContentElement.prototype.__getCharNumAtPosition=SVGTextContentElement.prototype.getCharNumAtPosition,SVGTextContentElement.prototype.getCharNumAtPosition=function(a){return this.getCharNumAtPositionHelper(a.x,0,this.getNumberOfChars()-1)},SVGTextContentElement.prototype.getCharNumAtPositionHelper=function(a,b,c){startX=this.getStartPositionOfChar(b).x;endX=this.getEndPositionOfChar(c).x;if(a<startX||a>endX)return-1;if(b==c)return b;var d=Math.floor((b+c)/2);b=this.getCharNumAtPositionHelper(a,
b,d);return-1!=b?b:this.getCharNumAtPositionHelper(a,d+1,c)};else{document.namespaces.vml||(null!=navigator.userAgent.match(/MSIE 8/i)?document.namespaces.add("vml","urn:schemas-microsoft-com:vml","#default#VML"):document.namespaces.add("vml","urn:schemas-microsoft-com:vml"));var styleSheet=0<document.styleSheets.length?document.styleSheets[0]:document.createStyleSheet();styleSheet.addRule("vml\\:shape","behavior:url(#default#VML)");styleSheet.addRule("vml\\:fill","behavior:url(#default#VML)");styleSheet.addRule("vml\\:rect",
"behavior:url(#default#VML)");styleSheet.addRule("vml\\:roundrect","behavior:url(#default#VML)");navigator.supportVML=!0}(navigator.isIE7||navigator.isIE8)&&window.parent!=window&&(document.elementFromPoint=function(a,b,c){void 0==c&&(c=document.body);if("childNodes"in c&&"offsetLeft"in c&&"offsetTop"in c){for(var d=0;d<c.childNodes.length;d++){var e=document.elementFromPoint(a-c.offsetLeft,b-c.offsetTop,c.childNodes[d]);if(void 0!=e)return e}if(a>=c.offsetLeft&&b>=c.offsetTop&&a-c.offsetLeft<=c.clientWidth&&
b-c.offsetTop<=c.clientHeight)return c}});!navigator.isIE7&&!navigator.isIE8||"DOMParser"in window||(window.DOMParser=function(){this.parseFromString=function(a){var b=new ActiveXObject("Microsoft.XMLDOM");b.async=!1;b.loadXML(a);return b}})}
if(void 0==window.JSON){var json={parse:function(a){return eval("("+a+")")},stringify:function(a){var b="",c=!0,d=-1!=a.constructor.toString().indexOf("function Array()"),e;for(e in a)try{var g=a[e];if("number"==typeof g||"string"==typeof g||"object"==typeof g||"boolean"==typeof g)c?c=!1:b+=", ",d||(b+='"'+e+'": '),null===g?b+="null":"object"==typeof g?b+=JSON.stringify(g):"number"==typeof g?b+=g:"string"==typeof g?b+='"'+g.replace('"','\\"')+'"':"boolean"==typeof g&&(b+=g?"true":"false")}catch(f){}return d?
"[ "+b+" ]":"{ "+b+" }"}};window.JSON=json}void 0==window.console&&(window.console={log:function(){},error:function(){},warn:function(){}});Core.Object=function(){};Core.Object.prototype.classType="Core.Object";Core.Object.prototype.toString=function(){return"[object "+this.classType+"]"};Core.Object.prototype.dump=function(a){void 0!=a&&(a=RegExp(a,"i"));console.log(this+":");for(var b in this)try{var c=!0;void 0!=a&&(c=a.test(b));c&&console.log(b+" => "+this[b])}catch(d){}};Core.Object.dump=function(a,b){void 0!=b&&(b=RegExp(b,"i"));console.log(a+":");for(var c in a)try{var d=!0;void 0!=b&&(d=b.test(c));d&&console.log(c+" => "+a[c])}catch(e){}};
Core.Object.diff=function(a,b){var c={},d=!0,e;for(e in b)e in a&&b[e]!==a[e]&&(c[e]=b[e],d=!1);return d?void 0:c};Core.Object.prototype.serialize=function(){return JSON.stringify(this)};Core.Object.prototype.constructorHelper=function(a,b){void 0==b&&(b=this.__proto__);void 0!=b&&(void 0==a&&(a={}),void 0!=b.__baseclass__?this.constructorHelper.call(this,a,b.__baseclass__):void 0!=b.__proto__&&this.constructorHelper.call(this,a,b.__proto__),void 0!=b.__constructor&&b.__constructor.call(this,a))};
Function.prototype.extend=function(a,b,c,d){for(var e=a.split("."),g="",f=window,h=0;h<e.length-1;h++)""!=g&&(g+="."),g+=e[h],void 0==f[e[h]]&&(f[e[h]]={}),f=f[e[h]];e=eval("( "+a+" = function(config) { Core.Object.currentScopes.push(this); var nconfig = Core.Util.clone(config); this.constructorHelper.call(this, nconfig); Core.Object.currentScopes.pop(); this.autoConfig(nconfig); } )");if(void 0==e.prototype.__proto__){for(var k in this.prototype)e.prototype[k]=this.prototype[k];e.prototype.__proto__=
e.prototype}else e.prototype.__proto__=this.prototype;e.prototype.__baseclass__=this.prototype;e.base=this.prototype;for(k in e.base.constructor)"function"==typeof e.base.constructor[k]&&(e[k]=e.base.constructor[k]);if(void 0!==d)for(k in d)e[k]=d[k];if(void 0!==b){for(k in b)if("constructor"===k)e.prototype.__constructor=b[k];else{if("object"===typeof b[k]&&null!==b[k])throw"object are not allowed in classDefine ("+k+"). Create object in the constructor";if(k in e.prototype)throw"Try to override "+
k+" on class "+a+". Use classOverride you want to do it";e.prototype[k]=b[k]}b.constructor===Object.prototype.constructor&&(e.prototype.__constructor=void 0);navigator.isIE&&b.constructor!==Object.prototype.constructor&&(e.prototype.__constructor=b.constructor)}if(void 0!==c)for(k in c){if("object"==typeof c[k]&&null!=c[k])throw"object are not allowed in classOverride ("+k+"). Create object in the constructor";e.prototype[k]=c[k]}e.prototype.classType=a;void 0!==d&&"constructor"in d&&d.constructor.call(e);
return e};Function.prototype.hasInstance=function(a){if("object"!=typeof a||null==a||a.constructorHelper!=Core.Object.prototype.constructorHelper)return!1;for(;void 0!=a;){if(a.classType==this.prototype.classType)return!0;a=a.__baseclass__}return!1};Core.Object.prototype.isSubclassOf=function(a){for(var b=this;void 0!=b;){if(b.classType==a)return!0;b=b.__baseclass__}return!1};
Core.Object.prototype.addEvents=function(){void 0==this.events&&(this.events=[]);for(var a=0;a<arguments.length;a++)this.events[arguments[a]]=[]};Core.Object.prototype.hasEvent=function(a){return void 0!=this.events&&a in this.events};
Core.Object.prototype.fireEvent=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=!1,e=this.events[a];if(null!=e)for(c=0;c<e.length&&!d;c++)d=this.events[a][c].method.apply(this.events[a][c].scope,b),void 0==d&&(d=!1);else if(DEBUG)throw"Event '"+a+"' not found on "+this;return d};
Core.Object.prototype.connect=function(a,b,c,d){void 0==d&&(d=!1);if(DEBUG&&"function"!==typeof c)throw"Invalid method to connect on event '"+b+"'";if("addEventListener"in a){var e=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};e.scope=this;e.callback=c;e.eventName=b;e.capture=d;a.addEventListener(b,e,d);void 0===a.events&&(a.events=[]);a.events.push(e)}else if("attachEvent"in a)e=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)},
e.scope=this,e.callback=c,e.eventName=b,e.capture=d,a.attachEvent(b,e),void 0===a.events&&(a.events=[]),a.events.push(e);else if(c={scope:this,method:c,capture:d},e=a.events[b],void 0!==e)if(!0===d){for(a=0;a<e.length&&!0===e[a].capture;a++);e.splice(0===a?0:a-1,0,c)}else e.push(c);else if(DEBUG)throw"Event '"+b+"' not found on "+a;};
Core.Object.prototype.disconnect=function(a,b,c){if("removeEventListener"in a)for(var d=0;void 0!==a.events&&d<a.events.length;d++){var e=a.events[d];e.scope!=this||e.eventName!=b||void 0!=c&&e.callback!=c||(a.removeEventListener(e.eventName,e,e.capture),a.events.splice(d,1),d--)}else if("detachEvent"in a)for(d=0;void 0!=a.events&&d<a.events.length;d++)e=a.events[d],e.scope!=this||e.eventName!=b||void 0!=c&&e.callback!=c||(a.detachEvent(e.eventName,e),a.events.splice(d,1),d--);else for(d=0;void 0!==
a.events&&d<a.events[b].length;d++)e=a.events[b][d],e.scope!=this||void 0!=c&&e.method!=c||(a.events[b].splice(d,1),d--)};Core.Object.currentScopes=[];
Core.Object.prototype.autoConfig=function(a){if(void 0!=a){var b,c=!1;"scope"in a?(b=a.scope,Core.Object.currentScopes.push(b),c=!0):0<Core.Object.currentScopes.length?b=Core.Object.currentScopes[Core.Object.currentScopes.length-1]:(b=this,Core.Object.currentScopes.push(b),c=!0);for(var d in a)if("name"===d)b[a.name]=this,delete a.name;else{var e="set"+d.charAt(0).toUpperCase()+d.substr(1);if(e in this&&"function"==typeof this[e])this[e].call(this,a[d]),delete a[d];else if(-1!=d.indexOf(".")){for(var e=
d.split("."),g=window,f=0;f<e.length-1;f++)g=g[e[f]];e=e[e.length-1];e="set"+e.charAt(0).toUpperCase()+e.substr(1);if(e in g&&typeof("function"==g[e]))g[e].call(g,this,a[d]),delete a[d];else if(DEBUG)throw"Attached property '"+d+"' not found";}else if(0==d.indexOf("on"))if(g=d.charAt(2).toLowerCase()+d.substr(3),void 0!=this.events&&g in this.events){if(DEBUG&&"function"!=typeof a[d])throw"function is need to connect to the '"+g+"' on "+this.classType;b.connect(this,g,a[d]);delete a[d]}else{if(DEBUG)throw"event '"+
g+"' not found on "+this.classType;}else if(DEBUG&&"scope"!==d&&"type"!==d)throw"Property '"+d+"' not found on "+this.classType;}c&&Core.Object.currentScopes.pop()}};
Core.Object.create=function(a,b){if(void 0!==a){if("string"==typeof a){if("parse"in this)return this.parse(a);throw"static parse need to be defined in class "+this.prototype.classType+" to create from a string";}if(Core.Object.hasInstance(a))return a;void 0!==b&&Core.Object.currentScopes.push(b);var c=a.type;if(DEBUG&&"type"in a&&void 0===c)throw"Cannot create object of type undefined";if(void 0===c)c=this;else if(DEBUG)for(var d=c;void 0!==d&&d!==this;){if(void 0==d.base)throw"Expecting class "+
this.prototype.classType+" got "+c.prototype.classType;d=d.base.constructor}c=new c(a);void 0!==b&&Core.Object.currentScopes.pop();return c}};Core.Object.extend("Core.Uri",{scheme:void 0,user:void 0,password:void 0,host:void 0,port:void 0,path:void 0,query:void 0,fragment:void 0,constructor:function(a){var b=!0,c;c="baseURI"in document?document.baseURI:document.location.href;var d;"uri"in a?(d=a.uri,delete a.uri):d=c;a=d.match(/^([^:\/]+):\/\/([^\/]+)(\/.*)$/);null===a&&(b=!1,a=c.match(/^([^:\/]+):\/\/([^\/]+)(\/.*)$/));this.scheme=a[1];c=a[2];var e=a[3];a=c.match(/^(.+):(.+)@(.*)$/);null!==a&&(this.user=a[1],this.password=a[2],c=a[3]);
a=c.match(/^(.+):(.+)$/);null!==a?(c=a[1],this.port=a[2]):this.port="https"==this.scheme?443:80;this.host=c;b?this.path=e:0==d.indexOf("/")?this.path=Core.Uri.cleanPath(d):this.path=Core.Uri.mergePath(e,d)},getScheme:function(){return this.scheme},getUser:function(){return this.user},getPassword:function(){return this.password},getHost:function(){return this.host},getPort:function(){return this.port},getPath:function(){return this.path},getQuery:function(){return this.query},getFragment:function(){return this.fragment}},
{toString:function(){var a=this.scheme+"://";void 0!=this.user&&void 0!=this.password&&(a+=this.user+":"+this.password+"@");a+=this.host;void 0!=this.port&&(a+=":"+this.port);return a+=this.path}},{cleanPath:function(a){for(;a.match(/\/([^\/]*)\/\.\.\//);)a=a.replace(/\/([^\/]*)\/\.\.\//,"/");for(;a.match(/\/\//,"/");)a=a.replace(/\/\//,"/");for(;a.match(/\/\.\//);)a=a.replace(/\/\.\//,"/");return a},mergePath:function(a,b){var c=a.match(/^(.*)\//)[0];return Core.Uri.cleanPath(c+b)}});Core.Object.extend("Core.Event",{defaultPrevented:!1,type:void 0,bubbles:!0,cancelable:!0,view:void 0,target:void 0,cancelBubble:!1,constructor:function(a){void 0!=a.type&&(this.type=a.type)},preventDefault:function(){this.defaultPrevented=!0},stopPropagation:function(){this.cancelBubble=!0},stopImmediatePropagation:function(){},dispatchEvent:function(a){this.target=a;if(this.bubbles){a=[];for(var b=this.target;void 0!=b;)"dispatchEvent"in b&&a.push(b),b=b.parentNode;a.push(window);for(var c=a.length-
1;0<=c&&!this.cancelBubble;c--)if(b=a[c],void 0!=b.__extendCaptureEvents&&void 0!=b.__extendCaptureEvents[this.type]){for(var d=[],e=0;e<b.__extendCaptureEvents[this.type].length;e++)d.push(b.__extendCaptureEvents[this.type][e]);for(e=0;e<d.length;e++)d[e].call(b,this)}for(c=0;c<a.length&&!this.cancelBubble;c++)if(b=a[c],void 0!=b.__extendEvents&&void 0!=b.__extendEvents[this.type]){d=[];for(e=0;e<b.__extendEvents[this.type].length;e++)d.push(b.__extendEvents[this.type][e]);for(e=0;e<d.length;e++)d[e].call(b,
this)}}else{if(void 0!=a.__extendCaptureEvents&&void 0!=a.__extendCaptureEvents[this.type]){d=[];for(e=0;e<a.__extendCaptureEvents[this.type].length;e++)d.push(a.__extendCaptureEvents[this.type][e]);for(c=0;c<d.length;c++)d[c].call(a,this)}if(void 0!=a.__extendEvents&&void 0!=a.__extendEvents[this.type]){d=[];for(e=0;e<a.__extendEvents[this.type].length;e++)d.push(a.__extendEvents[this.type][e]);for(c=0;c<d.length;c++)d[c].call(a,this)}}return this.defaultPrevented}},{},{events:{},types:{},registerEvent:function(a,
b){Core.Event.events[a]=b},getEvent:function(a){return Core.Event.events[a]},register:function(a,b){Core.Event.types[a]=b},getType:function(a){return Core.Event.types[a]},dispatchEvent:function(a){if(Core.Event.hasInstance(a))return a.dispatchEvent(this);if(void 0!=this.__dispatchEvent)return this.__dispatchEvent(a)},addEventListener:function(a,b,c){if(void 0!=Core.Event.getType(a))c?(void 0==this.__extendCaptureEvents&&(this.__extendCaptureEvents={}),void 0==this.__extendCaptureEvents[a]&&(this.__extendCaptureEvents[a]=
[]),this.__extendCaptureEvents[a].push(b)):(void 0==this.__extendEvents&&(this.__extendEvents={}),void 0==this.__extendEvents[a]&&(this.__extendEvents[a]=[]),this.__extendEvents[a].push(b));else{if(void 0!=this.__addEventListener)return this.__addEventListener(a,b,c);if(void 0!=this.attachEvent){var d=function(){if(1==arguments.length){var a={},b;for(b in arguments[0])a[b]=arguments[0][b];"keyCode"in arguments[0]&&!("which"in arguments[0])&&(a.which=arguments[0].keyCode);a.preventDefault=function(){this.defaultPrevented=
!0;this.returnValue=!1};a.stopPropagation=function(){this.cancelBubble=!0};a.target=a.srcElement;b=arguments.callee.callback.call(arguments.callee.scope,a);arguments[0].returnValue=a.returnValue;arguments[0].cancelBubble=a.cancelBubble;return b}return arguments.callee.callback.apply(arguments.callee.scope,arguments)};d.scope=this;d.callback=b;d.eventName=a;d.capture=c;this.attachEvent("on"+a,d);void 0==this.__ieevents&&(this.__ieevents=[]);this.__ieevents.push(d)}}},removeEventListener:function(a,
b,c){if(void 0!=Core.Event.getType(a))if(c){if(void 0!=this.__extendCaptureEvents)for(c=0;c<this.__extendCaptureEvents[a].length;c++)if(this.__extendCaptureEvents[a][c]==b){this.__extendCaptureEvents[a].splice(c,1);break}}else{if(void 0!=this.__extendEvents)for(c=0;c<this.__extendEvents[a].length;c++)if(this.__extendEvents[a][c]==b){this.__extendEvents[a].splice(c,1);break}}else{if(void 0!=this.__removeEventListener)return this.__removeEventListener(a,b,c);if(void 0!=this.detachEvent)for(c=0;c<this.__ieevents.length;c++){var d=
this.__ieevents[c];d.scope!=this||d.eventName!=a||void 0!=b&&d.callback!=b||(this.detachEvent(d.eventName,d),this.__ieevents.splice(c,1),c--)}}},createEvent:function(a){var b=Core.Event.getEvent(a);if(void 0!=b)return new b;if(void 0!=document.__createEvent)return document.__createEvent.call(document,a)},createElement:function(a){a=document.__createElement.call(document,a);a.dispatchEvent!=Core.Event.dispatchEvent&&(a.__dispatchEvent=a.dispatchEvent,a.dispatchEvent=Core.Event.dispatchEvent);a.addEventListener!=
Core.Event.addEventListener&&(a.__addEventListener=a.addEventListener,a.addEventListener=Core.Event.addEventListener);a.removeEventListener!=Core.Event.removeEventListener&&(a.__removeEventListener=a.removeEventListener,a.removeEventListener=Core.Event.removeEventListener);return a},cleanTarget:function(a){for(;null!==a&&void 0!==a;){if("dispatchEvent"in a&&"innerHTML"in a&&a.dispatchEvent===Core.Event.dispatchEvent)return a;a="offsetParent"in a?a.offsetParent:"parentNode"in a?a.parentNode:void 0}return window}});
"HTMLElement"in window&&(HTMLElement.prototype.__dispatchEvent=HTMLElement.prototype.dispatchEvent,HTMLElement.prototype.dispatchEvent=Core.Event.dispatchEvent,HTMLElement.prototype.__addEventListener=HTMLElement.prototype.addEventListener,HTMLElement.prototype.addEventListener=Core.Event.addEventListener,HTMLElement.prototype.__removeEventListener=HTMLElement.prototype.removeEventListener,HTMLElement.prototype.removeEventListener=Core.Event.removeEventListener);
"SVGElement"in window&&(SVGElement.prototype.__dispatchEvent=SVGElement.prototype.dispatchEvent,SVGElement.prototype.dispatchEvent=Core.Event.dispatchEvent,SVGElement.prototype.__addEventListener=SVGElement.prototype.addEventListener,SVGElement.prototype.addEventListener=Core.Event.addEventListener,SVGElement.prototype.__removeEventListener=SVGElement.prototype.removeEventListener,SVGElement.prototype.removeEventListener=Core.Event.removeEventListener);window.__dispatchEvent=window.dispatchEvent;
window.dispatchEvent=Core.Event.dispatchEvent;window.__addEventListener=window.addEventListener;window.addEventListener=Core.Event.addEventListener;window.__removeEventListener=window.removeEventListener;window.removeEventListener=Core.Event.removeEventListener;
"HTMLDocument"in window?(HTMLDocument.prototype.__createEvent=HTMLDocument.prototype.createEvent,HTMLDocument.prototype.createEvent=Core.Event.createEvent,HTMLDocument.prototype.__createElement=HTMLDocument.prototype.createElement,HTMLDocument.prototype.createElement=Core.Event.createElement):(document.__createEvent=document.createEvent,document.createEvent=Core.Event.createEvent,document.__createElement=document.createElement,document.createElement=Core.Event.createElement);Core.Event.extend("Core.MouseEvents",{detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,constructor:function(a){},initMouseEvent:function(a,b,c,d,e,g,f,h,k,m,l,n,p,r,v){this.type=a;this.bubbles=b;this.cancelable=c;this.view=d;this.detail=e;this.screenX=g;this.screenY=f;this.clientX=h;this.clientY=k;this.ctrlKey=m;this.altKey=l;this.shiftKey=n;this.metaKey=p;this.button=r}});
Core.Object.extend("Core.MouseManager",{captureElement:void 0,constructor:function(a){Core.Event.registerEvent("MouseEvents",Core.MouseEvents);Core.Event.register("mousedown",Core.MouseEvents);Core.Event.register("mousemove",Core.MouseEvents);Core.Event.register("mouseup",Core.MouseEvents);Core.Event.register("click",Core.MouseEvents);a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onMouseDown;document.attachEvent("onmousedown",a);
a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onMouseMove;document.attachEvent("onmousemove",a);a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onMouseUp;document.attachEvent("onmouseup",a);a=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};a.scope=this;a.callback=this.onMouseDblClick;document.attachEvent("ondblclick",a);a=function(){return arguments.callee.callback.apply(arguments.callee.scope,
arguments)};a.scope=this;a.callback=this.onMouseClick;document.attachEvent("onclick",a)},onMouseDblClick:function(a){this.onMouseDown(a);this.onMouseUp(a);return this.onMouseClick(a)},onMouseClick:function(a){var b=Core.Event.cleanTarget(a.srcElement),c=document.createEvent("MouseEvents"),d=a.button;1==d?d=0:4==d&&(d=1);c.initMouseEvent("click",!0,!0,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,d,b);b.dispatchEvent(c);a.returnValue=!c.defaultPrevented;
return a.returnValue},onMouseDown:function(a){var b=Core.Event.cleanTarget(a.srcElement);"tagName"in b&&"INPUT"!==b.tagName.toUpperCase()&&"TEXTAREA"!==b.tagName.toUpperCase()&&(this.captureElement=b,this.captureElement.setCapture());var c=document.createEvent("MouseEvents"),d=a.button;1==d?d=0:4==d&&(d=1);c.initMouseEvent("mousedown",!0,!0,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,d,b);b.dispatchEvent(c);a.returnValue=!c.defaultPrevented;return a.returnValue},
onMouseMove:function(a){var b=document.createEvent("MouseEvents"),c=Core.Event.cleanTarget(a.srcElement),d=a.button;1==d?d=0:4==d&&(d=1);b.initMouseEvent("mousemove",!0,!0,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,d,c);c.dispatchEvent(b);a.returnValue=!b.defaultPrevented;return a.returnValue},onMouseUp:function(a){void 0!=this.captureElement&&this.captureElement.releaseCapture();var b=Core.Event.cleanTarget(a.srcElement),c=document.createEvent("MouseEvents"),
d=a.button;1==d?d=0:4==d&&(d=1);c.initMouseEvent("mouseup",!0,!0,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,d,b);b.dispatchEvent(c);a.returnValue=!c.defaultPrevented;return a.returnValue}});"attachEvent"in window&&(null!=navigator.userAgent.match(/MSIE 7.0/i)||navigator.userAgent.match(/MSIE 8.0/i))&&new Core.MouseManager;Core.Event.extend("Core.DragEvent",{dataTransfer:void 0,constructor:function(a){},initDragEvent:function(a,b,c,d,e,g,f,h,k,m,l,n,p){this.type=a;this.bubbles=b;this.cancelable=c;this.view=d;this.dataTransfer=e;this.screenX=g;this.screenY=f;this.clientX=h;this.clientY=k;this.ctrlKey=m;this.altKey=l;this.shiftKey=n;this.metaKey=p}});
Core.Object.extend("Core.DragDataTransfer",{draggable:void 0,image:void 0,startX:0,startY:0,startImagePoint:void 0,overElement:void 0,hasStarted:!1,types:void 0,pointerId:0,dropEffect:"none",data:void 0,type:void 0,timer:void 0,delayed:!1,constructor:function(a){this.draggable=a.draggable;delete a.draggable;this.startX=a.x;delete a.x;this.startY=a.y;delete a.y;this.type=a.type;delete a.type;this.delayed=a.delayed;delete a.delayed;"pointerId"in a&&(this.pointerId=a.pointerId,delete a.pointerId);"ondragstart"in
this.draggable&&(this.draggable.ondragstart=function(a){void 0!==a&&("preventDefault"in a&&a.preventDefault(),"stopImmediatePropagation"in a&&a.stopImmediatePropagation());return!1});this.data={};"mouse"===this.type?(this.connect(window,"mouseup",this.onMouseUp,!0),this.connect(window,"mousemove",this.onMouseMove,!0)):"touch"===this.type?(this.connect(this.draggable,"touchmove",this.onTouchMove),this.connect(this.draggable,"touchend",this.onTouchEnd),this.connect(this.draggable,"touchcancel",this.onTouchCancel)):
"pointer"===this.type&&(this.connect(window,"pointermove",this.onPointerMove),this.connect(window,"pointerup",this.onPointerUp),this.connect(window,"pointercancel",this.onPointerCancel));this.delayed&&(this.timer=new Core.DelayedTask({scope:this,delay:0.5,callback:this.onTimer}))},setData:function(a,b){this.data[a.toLowerCase()]=b;this.updateTypes()},getData:function(a){return this.data[a.toLowerCase()]},hasData:function(){var a=!1,b;for(b in this.data)a=!0;return a},generateImage:function(a){var b;
if(navigator.isIE7||navigator.isIE8)b=document.createElement("div"),b.style.position="absolute",b.style.left="-10000px",b.style.top="-10000px",b.style.outline="0px",b.innerHTML=a.outerHTML,b=b.childNodes[0];else{if("tagName"in a&&"IMG"==a.tagName.toUpperCase())b=a.cloneNode(!1),b.oncontextmenu=function(a){a.preventDefault()};else if("tagName"in a&&"CANVAS"==a.tagName.toUpperCase()){b=document.createElement("img");b.oncontextmenu=function(a){a.preventDefault()};for(var c in a.style)b.style[c]=a.style[c];
b.setAttribute("src",a.toDataURL("image/png"))}else if(navigator.isFirefox||void 0===a.toDataURL)for(b=a.cloneNode(!1),c=0;c<a.childNodes.length;c++)b.appendChild(this.generateImage(a.childNodes[c]));else{b=document.createElement("img");b.oncontextmenu=function(a){a.preventDefault()};for(c in a.style)b.style[c]=a.style[c];b.setAttribute("src",a.toDataURL("image/png"))}"setAttribute"in b&&b.setAttribute("draggable",!1)}return b},updateTypes:function(){this.types=[];for(var a in this.data)this.types.push(a)},
onTimer:function(){this.timer=void 0;var a=document.createEvent("DragEvent");a.initDragEvent("dragstart",!1,!0,window,this,this.startX,this.startY,this.startX,this.startY,!1,!1,!1,!1);this.draggable.dispatchEvent(a);if(this.hasData())this.hasStarted=!0,this.image=this.generateImage(this.draggable),this.image.style.touchAction="none",this.image.style.zIndex=1E5,this.image.style.position="absolute",navigator.supportOpacity&&(this.image.style.opacity=0.8),a=this.delayed?-10:0,this.startImagePoint=Ui.Element.pointToWindow(this.draggable,
{x:0,y:0}),this.image.style.left=this.startImagePoint.x+a+"px",this.image.style.top=this.startImagePoint.y+a+"px",document.body.appendChild(this.image);else if("touch"===this.type)this.onTouchCancel();else if("pointer"===this.type)this.onPointerCancel();else if("mouse"===this.type)this.onMouseCancel()},onMove:function(a,b){if(void 0!==this.timer){var c=a-this.startX,d=b-this.startY,e=Math.sqrt(c*c+d*d);if(20<e)return!1}else if(this.hasStarted){document.body.removeChild(this.image);e=document.elementFromPoint(a,
b);e=Core.Event.cleanTarget(e);document.body.appendChild(this.image);var c=a-this.startX,d=b-this.startY,g=this.delayed?-10:0;this.image.style.left=this.startImagePoint.x+c+g+"px";this.image.style.top=this.startImagePoint.y+d+g+"px";void 0!==e&&null!==e&&e!==document.documentElement&&(c=document.createEvent("DragEvent"),this.overElement!=e?c.initDragEvent("dragenter",!0,!0,window,this,a,b,a,b,!1,!1,!1,!1):c.initDragEvent("dragover",!0,!0,window,this,a,b,a,b,!1,!1,!1,!1),e.dispatchEvent(c));this.overElement=
e}else if(c=a-this.startX,d=b-this.startY,e=Math.sqrt(c*c+d*d),5<e)return this.onTimer(),this.hasStarted;return!0},onUp:function(a,b){if(this.hasStarted){document.body.removeChild(this.image);if(void 0!=this.overElement){var c=document.createEvent("DragEvent");c.initDragEvent("drop",!0,!0,window,this,a,b,a,b,!1,!1,!1,!1);this.overElement.dispatchEvent(c)}c=document.createEvent("DragEvent");c.initDragEvent("dragend",!1,!0,window,this,a,b,a,b,!1,!1,!1,!1);this.draggable.dispatchEvent(c);return!0}return!1},
onMouseMove:function(a){if(!0===this.onMove(a.clientX,a.clientY))a.preventDefault(),a.stopPropagation();else this.onMouseCancel(a)},onMouseUp:function(a){if(0==a.button)if(this.onUp(a.clientX,a.clientY))a.preventDefault(),a.stopPropagation(),this.disconnect(window,"mouseup",this.onMouseUp,!0),this.disconnect(window,"mousemove",this.onMouseMove,!0);else this.onMouseCancel(a)},onMouseCancel:function(){console.log("dragevent onMouseCancel");this.disconnect(window,"mouseup",this.onMouseUp,!0);this.disconnect(window,
"mousemove",this.onMouseMove,!0)},onTouchMove:function(a){console.log(this+".onTouchMove");if(!0===this.onMove(a.changedTouches[0].clientX,a.changedTouches[0].clientY))void 0===this.timer&&(a.preventDefault(),a.stopPropagation());else this.onTouchCancel(a)},onTouchEnd:function(a){if(!0===this.onUp(a.changedTouches[0].clientX,a.changedTouches[0].clientY))a.preventDefault(),a.stopPropagation(),this.disconnect(this.draggable,"touchmove",this.onTouchMove),this.disconnect(this.draggable,"touchend",this.onTouchEnd),
this.disconnect(this.draggable,"touchcancel",this.onTouchCancel);else this.onTouchCancel(a)},onTouchCancel:function(){this.disconnect(this.draggable,"touchmove",this.onTouchMove);this.disconnect(this.draggable,"touchend",this.onTouchEnd);this.disconnect(this.draggable,"touchcancel",this.onTouchCancel);void 0!==this.timer&&(this.timer.abort(),this.timer=void 0)},onPointerMove:function(a){if(a.pointerId===this.pointerId)if(!0===this.onMove(a.clientX,a.clientY))a.preventDefault(),a.stopPropagation();
else this.onPointerCancel(a)},onPointerUp:function(a){if(a.pointerId===this.pointerId)if(!0===this.onUp(a.clientX,a.clientY))a.preventDefault(),a.stopPropagation(),this.disconnect(window,"pointermove",this.onPointerMove),this.disconnect(window,"pointerup",this.onPointerUp),this.disconnect(window,"pointercancel",this.onPointerCancel);else this.onPointerCancel(a)},onPointerCancel:function(a){if(void 0===a||a.pointerId===this.pointerId)this.disconnect(window,"pointermove",this.onPointerMove),this.disconnect(window,
"pointerup",this.onPointerUp),this.disconnect(window,"pointercancel",this.onPointerCancel),void 0!==this.timer&&(this.timer.abort(),this.timer=void 0)}});
Core.Object.extend("Core.DragManager",{constructor:function(a){Core.Event.registerEvent("DragEvent",Core.DragEvent);Core.Event.register("dragstart",Core.DragEvent);Core.Event.register("dragend",Core.DragEvent);Core.Event.register("dragenter",Core.DragEvent);Core.Event.register("dragover",Core.DragEvent);Core.Event.register("drop",Core.DragEvent);this.connect(window,"load",function(){if(void 0===document.body||null===document.body){var a=document.createElement("body");document.body=a}window.PointerEvent?
this.connect(window,"pointerdown",this.onPointerDown):"ontouchstart"in document.body?this.connect(document.body,"touchstart",this.onTouchStart):this.connect(window,"mousedown",this.onMouseDown,!0)})},findDraggable:function(a){for(var b=void 0;void 0===b&&void 0!==a&&a!==window&&null!==a;){var c=a.getAttribute("draggable");if("true"===c||!0===c)b=a;a=a.offsetParent}return b},onPointerDown:function(a){var b="touch"===a.pointerType,c=this.findDraggable(a.target);void 0!==c&&(a.stopPropagation(),new Core.DragDataTransfer({type:"pointer",
draggable:c,x:a.clientX,y:a.clientY,delayed:b,pointerId:a.pointerId}))},onTouchStart:function(a){if(1===a.changedTouches.length){var b=this.findDraggable(a.target);void 0!==b&&(a.stopPropagation(),new Core.DragDataTransfer({type:"touch",draggable:b,x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY,delayed:!0}))}},onMouseDown:function(a){if(0===a.button){var b=this.findDraggable(a.target);void 0!==b&&new Core.DragDataTransfer({type:"mouse",draggable:b,x:a.clientX,y:a.clientY,delayed:!1})}}});
navigator.supportDrag=("ondragstart"in window||navigator.isGecko)&&!navigator.isIE7&&!navigator.isIE8&&!navigator.iPad&&!navigator.iPhone&&!navigator.Android;navigator.supportMimetypeDrag=navigator.supportDrag&&!navigator.isIE;navigator.supportDrag||(Core.DragManager.current=new Core.DragManager);Core.Object.extend("Core.DelayedTask",{delay:1,scope:void 0,callback:void 0,arguments:void 0,isDone:!1,constructor:function(a){"delay"in a&&(this.delay=a.delay,delete a.delay);"scope"in a&&(this.scope=a.scope,delete a.scope);"arguments"in a?(this.arguments=a.arguments,delete a.arguments):this.arguments=[];if("callback"in a)this.callback=a.callback,delete a.callback;else throw"callback MUST be given for a DelayedTask";a=function(){arguments.callee.delayedtask.handle=void 0;arguments.callee.delayedtask.callback.apply(arguments.callee.delayedtask.scope,
arguments.callee.delayedtask.arguments);arguments.callee.delayedtask.isDone=!0};a.delayedtask=this;this.handle=setTimeout(a,1E3*this.delay)},abort:function(){void 0!=this.handle&&(clearTimeout(this.handle),this.handle=void 0)}});Core.Object.extend("Core.Timer",{interval:1,arguments:void 0,constructor:function(a){this.addEvents("timeupdate");"interval"in a&&(this.interval=a.interval,delete a.interval);"arguments"in a?(this.arguments=a.arguments,delete a.arguments):this.arguments=[];this.wrapper=function(){var a=(new Date).getTime()/1E3,c=arguments.callee.timer;c.fireEvent("timeupdate",c,c.arguments);a=(new Date).getTime()/1E3-a;0>a&&(a=0);a=1E3*c.interval-a;0>a&&(a=0);void 0!=c.handle&&(c.handle=setTimeout(c.wrapper,a))};
this.wrapper.timer=this;this.handle=setTimeout(this.wrapper,0)},abort:function(){void 0!=this.handle&&(clearTimeout(this.handle),this.handle=void 0)}});Core.Object.extend("Core.HttpRequest",{url:void 0,method:"GET",binary:!1,request:void 0,arguments:void 0,content:void 0,headers:void 0,constructor:function(a){this.addEvents("error","done");this.request=new XMLHttpRequest;a=function(){var a=arguments.callee.httprequest;4==a.request.readyState&&(200<=a.request.status&&300>a.request.status?a.fireEvent("done",a):a.fireEvent("error",a,a.request.status),a.request.onreadystatechange=null,a.request=void 0)};a.httprequest=this;this.request.onreadystatechange=
a},setUrl:function(a){this.url=a},setBinary:function(a){this.binary=a},setMethod:function(a){this.method=a},setRequestHeader:function(a,b){void 0==this.headers&&(this.headers={});this.headers[a]=b},setArguments:function(a){this.arguments=a},addArgument:function(a,b){void 0==this.arguments&&(this.arguments={});this.arguments[a]=b},setContent:function(a){this.content=a},abort:function(){this.request.abort()},send:function(){if(void 0==this.url)throw"url MUST be given for an HttpRequest";var a="";void 0!=
this.arguments&&(a=Core.Util.encodeURIQuery(this.arguments));var b=this.url;"GET"!=this.method&&"DELETE"!=this.method&&void 0==this.content||""==a||(b=-1==this.url.indexOf("?")?b+("?"+a):b+("&"+a));this.request.open(this.method,b,!0);this.binary&&this.request.overrideMimeType("text/plain; charset=x-user-defined");this.request.setRequestHeader("X-Requested-With","XMLHttpRequest");if(void 0!=Core.HttpRequest.requestHeaders)for(var c in Core.HttpRequest.requestHeaders)this.request.setRequestHeader(c,
Core.HttpRequest.requestHeaders[c]);if(void 0!=this.headers)for(c in this.headers)this.request.setRequestHeader(c,this.headers[c]);void 0!==this.content?(void 0!=this.headers&&void 0!=this.headers["Content-Type"]||this.request.setRequestHeader("Content-Type","text/plain; charset=utf-8"),this.request.send(this.content)):""===a||"POST"!=this.method&&"PUT"!=this.method?this.request.send():(void 0!=this.headers&&void 0!=this.headers["Content-Type"]||this.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),
this.request.send(a))},getResponseHeader:function(a){return this.request.getResponseHeader(a)},getResponseText:function(){return this.request.responseText},getResponseBase64:function(){for(var a=this.request.responseText,b="",c=0;c+2<a.length;)var d=a.charCodeAt(c++)&255,e=a.charCodeAt(c++)&255,g=a.charCodeAt(c++)&255,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>2],d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(d&3)<<4|e>>4],e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(e&
15)<<2|g>>6],b=b+(f+d+e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g&63]);c+1<a.length?(d=a.charCodeAt(c++)&255,e=a.charCodeAt(c++)&255,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>2],d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(d&3)<<4|e>>4],e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(e&15)<<2],b+=f+d+e+"="):c<a.length&&(d=a.charCodeAt(c++)&255,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>
2],d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(d&3)<<4],b+=f+d+"==");return b},getResponseJSON:function(){var a;try{a=JSON.parse(this.getResponseText())}catch(b){a=void 0}return a},getResponseXML:function(){var a=new DOMParser;try{return a.parseFromString(this.getResponseText(),"text/xml")}catch(b){}},getStatus:function(){return this.request.status}},{},{requestHeaders:void 0,setRequestHeader:function(a,b){void 0==Core.HttpRequest.requestHeaders&&(Core.HttpRequest.requestHeaders=
{});Core.HttpRequest.requestHeaders[a]=b}});Core.Object.extend("Core.Socket",{host:void 0,service:"/",port:80,mode:void 0,secure:!1,websocket:void 0,websocketdelay:void 0,emuopenrequest:void 0,emupollrequest:void 0,emusendrequest:void 0,emuid:void 0,emumessages:void 0,lastPosition:0,readSize:!0,size:0,data:"",isClosed:!1,closeSent:!1,sep:"?",lastPoll:void 0,delayPollTask:void 0,pollInterval:2.5,constructor:function(a){this.addEvents("error","message","close","open");"host"in a?(this.host=a.host,delete a.host):this.host=document.location.hostname;
"secure"in a&&(this.secure=a.secure,delete a.secure);"port"in a?(this.port=a.port,delete a.port):this.port=void 0!=document.location.port&&""!=document.location.port?document.location.port:this.secure?443:80;"service"in a&&(this.service=a.service,delete a.service,-1==this.service.indexOf("?")?this.sep="?":this.sep="&");"mode"in a?(this.mode=a.mode,delete a.mode):this.mode=Core.Socket.supportWebSocket?"websocket":"poll";"websocket"==this.mode?(this.websocket=new WebSocket((this.secure?"wss":"ws")+
"://"+this.host+":"+this.port+this.service),this.websocketdelay=new Core.DelayedTask({scope:this,callback:this.onWebSocketOpenTimeout,delay:30}),this.connect(this.websocket,"open",this.onWebSocketOpen),this.connect(this.websocket,"error",this.onWebSocketError),this.connect(this.websocket,"message",this.onWebSocketMessage),this.connect(this.websocket,"close",this.onWebSocketClose)):(this.emumessages=[],this.emuopenrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+
this.service+this.sep+"socket=poll&command=open"}),this.connect(this.emuopenrequest,"done",this.onEmuSocketOpenDone),this.connect(this.emuopenrequest,"error",this.onEmuSocketOpenError),this.emuopenrequest.send())},send:function(a){void 0!=this.websocket?this.websocket.send(a):void 0===this.emusendrequest?(a=(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket="+this.mode+"&command=send&id="+this.emuid+"&messages="+encodeURIComponent(a.toBase64()),this.emusendrequest=
new Core.HttpRequest({url:a}),this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone),this.connect(this.emusendrequest,"error",this.onEmuSocketSendError),this.emusendrequest.send(),void 0!==this.delayPollTask&&(this.delayPollTask.abort(),this.delayPollTask=new Core.DelayedTask({delay:0.1,scope:this,callback:this.delayPollDone}))):this.emumessages.push(a.toBase64())},close:function(){void 0!=this.delayPollTask&&(this.delayPollTask.abort(),this.delayPollTask=void 0);void 0!=this.websocket?
(this.isClosed=!0,this.websocket.close()):this.isClosed||(this.isClosed=!0,void 0!=this.emuopenrequest?(this.emuopenrequest.abort(),this.emuopenrequest=void 0):void 0!=this.emuid&&void 0==this.emusendrequest&&(this.closeSent=!0,this.emusendrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket="+this.mode+"&command=close&id="+this.emuid}),this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone),this.connect(this.emusendrequest,
"error",this.onEmuSocketSendError),this.emusendrequest.send()))},onWebSocketOpenTimeout:function(){this.websocketdelay=void 0;this.disconnect(this.websocket,"open",this.onWebSocketOpen);this.disconnect(this.websocket,"error",this.onWebSocketError);this.disconnect(this.websocket,"message",this.onWebSocketMessage);this.disconnect(this.websocket,"close",this.onWebSocketClose);this.websocket.close();this.websocket=void 0;this.mode="poll";this.emumessages=[];this.emuopenrequest=new Core.HttpRequest({url:(this.secure?
"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket=poll&command=open"});this.connect(this.emuopenrequest,"done",this.onEmuSocketOpenDone);this.connect(this.emuopenrequest,"error",this.onEmuSocketOpenError);this.emuopenrequest.send()},onWebSocketOpen:function(){void 0!=this.websocketdelay&&(this.websocketdelay.abort(),this.websocketdelay=void 0);this.fireEvent("open",this)},onWebSocketError:function(){void 0!=this.websocketdelay&&(this.websocketdelay.abort(),this.websocketdelay=
void 0);this.fireEvent("error",this)},onWebSocketMessage:function(a){"PING"==a.data?this.websocket.send("PONG"):this.fireEvent("message",this,a.data)},onWebSocketClose:function(a){void 0!=this.websocketdelay&&(this.websocketdelay.abort(),this.websocketdelay=void 0);this.fireEvent("close",this)},emuSocketDataAvailable:function(a){void 0==this.emuid?(this.emuid=a,this.fireEvent("open",this)):"keepalive"!=a&&this.fireEvent("message",this,a.fromBase64())},emuSocketUpdate:function(a){for(var b=0;b<a.length;b++){var c=
a[b];this.readSize?":"==c?(this.readSize=!1,this.size=parseInt("0x"+this.data),this.data=""):this.data+=c:(this.data+=c,this.data.length>=this.size+2&&(this.emuSocketDataAvailable(this.data.substring(0,this.data.length-2)),this.readSize=!0,this.data=""))}},onEmuSocketSendDone:function(){this.emusendrequest.getResponseJSON();if(0<this.emumessages.length){for(var a="",b=0;b<this.emumessages.length;b++)""!=a&&(a+=";"),a+=this.emumessages[b];this.emusendrequest=new Core.HttpRequest({url:(this.secure?
"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket="+this.mode+"&command=send&id="+this.emuid+"&messages="+encodeURIComponent(a)});this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone);this.connect(this.emusendrequest,"error",this.onEmuSocketSendError);this.emusendrequest.send();this.emumessages=[]}else this.isClosed&&!this.closeSent?(this.emusendrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+
"socket="+this.mode+"&command=close&id="+this.emuid}),this.connect(this.emusendrequest,"done",this.onEmuSocketSendDone),this.connect(this.emusendrequest,"error",this.onEmuSocketSendError),this.emusendrequest.send()):this.emusendrequest=void 0},onEmuSocketSendError:function(){this.emusendrequest=void 0},onEmuSocketOpenDone:function(){this.lastPoll=new Date;var a=this.emuopenrequest.getResponseJSON();this.emuopenrequest=void 0;void 0==a?(this.fireEvent("error",this),this.fireEvent("close",this)):(this.emuid=
a.id,"keepAliveInterval"in a&&(this.pollInterval=Math.min(a.keepAliveInterval,2.5)),"open"!=a.status?(this.fireEvent("error",this),this.fireEvent("close",this)):(this.fireEvent("open",this),this.emupollrequest=new Core.HttpRequest({url:(this.secure?"https":"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket=poll&command=poll&id="+this.emuid}),this.connect(this.emupollrequest,"done",this.onEmuSocketPollDone),this.connect(this.emupollrequest,"error",this.onEmuSocketPollError),this.emupollrequest.send()))},
onEmuSocketOpenError:function(a,b){this.emuopenrequest=void 0;this.fireEvent("error",this);this.fireEvent("close",this)},onEmuSocketPollDone:function(){var a=this.emupollrequest.getResponseJSON();this.emupollrequest=void 0;if(void 0==a)this.close(),this.fireEvent("close",this);else{if(void 0!=a.messages)for(var b=0;b<a.messages.length;b++){var c=a.messages[b].fromBase64();this.fireEvent("message",this,c)}"open"!=a.status?(this.close(),this.fireEvent("close",this)):(a=new Date,b=Math.max(0,a.getTime()-
this.lastPoll.getTime()),this.lastPoll=a,b>=1E3*this.pollInterval?this.sendPoll():this.delayPollTask=new Core.DelayedTask({delay:this.pollInterval,scope:this,callback:this.delayPollDone}))}},onEmuSocketPollError:function(){this.emupollrequest=void 0;this.fireEvent("error",this);this.close()},delayPollDone:function(){this.delayPollTask=void 0;void 0===this.emupollrequest&&this.sendPoll()},sendPoll:function(){this.lastPoll=new Date;this.emupollrequest=new Core.HttpRequest({url:(this.secure?"https":
"http")+"://"+this.host+":"+this.port+this.service+this.sep+"socket=poll&command=poll&id="+this.emuid});this.connect(this.emupollrequest,"done",this.onEmuSocketPollDone);this.connect(this.emupollrequest,"error",this.onEmuSocketPollError);this.emupollrequest.send()}});"MozWebSocket"in window&&!("WebSocket"in window)&&(window.WebSocket=window.MozWebSocket);Core.Socket.supportWebSocket="WebSocket"in window;Core.Object.extend("Core.File",{iframe:void 0,form:void 0,fileInput:void 0,fileApi:void 0,constructor:function(a){void 0!=a.form&&(this.form=a.form,delete a.form);void 0!=a.iframe&&(this.iframe=a.iframe,delete a.iframe);void 0!=a.fileInput&&(this.fileInput=a.fileInput,delete a.fileInput);void 0!=a.fileApi&&(this.fileApi=a.fileApi,delete a.fileApi)},getFileName:function(){return void 0!=this.fileApi?void 0!=this.fileApi.fileName?this.fileApi.fileName:this.fileApi.name:void 0!=this.fileInput.fileName?
this.fileInput.fileName:this.fileInput.name},getRelativePath:function(){var a=void 0;void 0!=this.fileApi&&("relativePath"in this.fileApi?a=this.fileApi.relativePath:"webkitRelativePath"in this.fileApi?a=this.fileApi.webkitRelativePath:"mozRelativePath"in this.fileApi&&(a=this.fileApi.mozRelativePath));""===a&&(a=void 0);return a},getMimetype:function(){return void 0!=this.fileApi&&"type"in this.fileApi?this.fileApi.type:"application/octet-stream"}});Core.Object.extend("Core.FilePostUploader",{file:void 0,service:void 0,reader:void 0,request:void 0,binaryString:!1,responseText:void 0,fileReader:void 0,boundary:void 0,method:"POST",fields:void 0,loadedOctets:void 0,totalOctets:void 0,constructor:function(a){this.addEvents("progress","complete","error");this.fields={}},setMethod:function(a){this.method=a},getFile:function(){return this.file},setFile:function(a){this.file=a},setService:function(a){this.service=a},setField:function(a,b){this.fields[a]=
b},setDestination:function(a){this.setField("destination",a)},send:function(){if(void 0!=this.file.fileApi)if(navigator.supportFormData){var a=new FormData;void 0==this.destination&&(this.destination=this.file.getFileName());for(var b in this.fields)a.append(b,this.fields[b]);a.append("file",this.file.fileApi);this.request=new XMLHttpRequest;"upload"in this.request&&this.connect(this.request.upload,"progress",this.onUpdateProgress);this.request.open(this.method,this.service);this.request.send(a);
b=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};b.scope=this;b.callback=this.onStateChange;this.request.onreadystatechange=b}else{this.fileReader=new FileReader;this.request=new XMLHttpRequest;"upload"in this.request&&this.connect(this.request.upload,"progress",this.onUpdateProgress);this.request.open(this.method,this.service);this.boundary="----";for(b=0;16>b;b++)this.boundary+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"[Math.floor(62*Math.random())];
this.boundary+="----";this.request.setRequestHeader("Content-Type","multipart/form-data, boundary="+this.boundary);this.request.setRequestHeader("Content-Length",this.file.fileApi.size);b=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};b.scope=this;b.callback=this.onStateChange;this.request.onreadystatechange=b;b=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};b.scope=this;b.callback=this.onFileReaderLoad;this.fileReader.onload=
b;b=function(){return arguments.callee.callback.apply(arguments.callee.scope,arguments)};b.scope=this;b.callback=this.onFileReaderError;this.fileReader.onerror=b;this.fileReader.readAsBinaryString(this.file.fileApi)}else{this.file.form.action=this.service;for(b in this.fields)a=document.createElement("input"),a.type="hidden",a.setAttribute("name",b),destDrawing.setAttribute("value",this.fields[b]),this.file.form.insertBefore(a,this.file.form.firstChild);this.connect(this.file.iframe,"load",this.onIFrameLoad);
b=0;for(a=!1;!a&&5>b;)try{this.file.form.submit(),a=!0}catch(c){b++}}},abort:function(){void 0!=this.request&&this.request.abort()},getResponseText:function(){return this.responseText},getResponseJSON:function(){var a;try{a=JSON.parse(this.getResponseText())}catch(b){a=void 0}return a},onStateChange:function(a){4==this.request.readyState&&(200==this.request.status?(this.responseText=this.request.responseText,this.fireEvent("complete",this)):(this.responseText=this.request.responseText,this.fireEvent("error",
this,this.request.status)),this.request=void 0)},getTotal:function(){return this.totalOctets},getLoaded:function(){return this.loadedOctets},onUpdateProgress:function(a){this.loadedOctets=a.loaded;this.totalOctets=a.total;this.fireEvent("progress",this,a.loaded,a.total)},onFileReaderError:function(a){this.request.abort();this.request=void 0;this.fireEvent("error",this);this.fileReader=void 0},onFileReaderLoad:function(a){var b="--"+this.boundary+"\r\n",b=b+("Content-Disposition: form-data; name='file'; filename='"+
this.file.fileApi.name+"'\r\n"),b=b+("Content-Type: "+this.file.fileApi.type+"\r\n\r\n"),b=b+(a.target.result+"\r\n"),b=b+("--"+this.boundary+"--");this.request.sendAsBinary(b);this.fileReader=void 0},onIFrameLoad:function(a){this.responseText=a.target.contentWindow.document.body.innerText;document.body.removeChild(this.file.iframe);this.fireEvent("complete",this)}});"getUserMedia"in navigator||(navigator.getUserMedia="webkitGetUserMedia"in navigator?navigator.webkitGetUserMedia.bind(navigator):"mozGetUserMedia"in navigator?navigator.mozGetUserMedia.bind(navigator):void 0);navigator.supportUserMedia=void 0!==navigator.getUserMedia;"mozRTCPeerConnection"in window?RTCPeerConnection=mozRTCPeerConnection:"webkitRTCPeerConnection"in window&&(RTCPeerConnection=webkitRTCPeerConnection);"mozRTCSessionDescription"in window?RTCSessionDescription=mozRTCSessionDescription:"webkitRTCSessionDescription"in window&&(RTCSessionDescription=webkitRTCSessionDescription);"mozRTCIceCandidate"in window?RTCIceCandidate=mozRTCIceCandidate:"webkitRTCIceCandidate"in window&&(RTCIceCandidate=webkitRTCIceCandidate);
navigator.supportWebRTC="RTCPeerConnection"in window&&void 0!==RTCPeerConnection;Core.Object.extend("Core.RemoteDebug",{host:void 0,port:void 0,socket:void 0,socketAlive:!1,retryTask:void 0,nativeConsole:void 0,buffer:void 0,constructor:function(a){Core.RemoteDebug.current=this;this.host=a.host;delete a.host;this.port=a.port;delete a.port;this.buffer=[];this.nativeConsole=window.console;window.console={log:Core.RemoteDebug.onConsoleLog,error:Core.RemoteDebug.onConsoleError,warn:Core.RemoteDebug.onConsoleWarn};window.onerror=Core.RemoteDebug.onError;this.startSocket()},startSocket:function(){this.socket=
new Core.Socket({service:"/",host:this.host,port:this.port});this.connect(this.socket,"open",this.onSocketOpen);this.connect(this.socket,"error",this.onSocketError);this.connect(this.socket,"close",this.onSocketClose)},onSocketOpen:function(){for(this.socketAlive=!0;0<this.buffer.length;)this.socket.send(this.buffer.shift())},onSocketError:function(){this.socketAlive=!1;this.socket.close()},onSocketClose:function(){this.socketAlive=!1;this.disconnect(this.socket,"error",this.oSocketError);this.disconnect(this.socket,
"close",this.onSocketClose);this.socket=void 0;this.retryTask=new Core.DelayedTask({delay:5,scope:this,callback:this.startSocket})},onConsoleLog:function(a){this.socketAlive?this.socket.send({type:"log",message:a}):this.buffer.push({type:"log",message:a})},onConsoleError:function(a){this.socketAlive?this.socket.send({type:"error",message:a}):this.buffer.push({type:"error",message:a})},onConsoleWarn:function(a){this.socketAlive?this.socket.send({type:"warn",message:a}):this.buffer.push({type:"warn",
message:a})},onError:function(a,b,c){this.socketAlive?this.socket.send({type:"warn",message:a,url:b,line:c}):this.buffer.push({type:"warn",message:a,url:b,line:c})}},{},{current:void 0,onConsoleLog:function(a){Core.RemoteDebug.current.onConsoleLog.call(Core.RemoteDebug.current,a)},onConsoleError:function(a){Core.RemoteDebug.current.onConsoleError.call(Core.RemoteDebug.current,a)},onConsoleWarn:function(a){Core.RemoteDebug.current.onConsoleWarn.call(Core.RemoteDebug.current,a)},onError:function(a,
b,c){Core.RemoteDebug.current.onError.call(Core.RemoteDebug.current,a,b,c)}});Core.Object.extend("Anim.TimeManager",{clocks:void 0,timer:void 0,start:0,constructor:function(a){this.clocks=[];this.start=(new Date).getTime();this.addEvents("tick")},add:function(a){this.clocks.push(a);1==this.clocks.length&&(this.timer=new Core.Timer({onTimeupdate:this.onTick,scope:this,interval:1/60}))},remove:function(a){for(var b=0;b<this.clocks.length&&this.clocks[b]!=a;)b++;b<this.clocks.length&&this.clocks.splice(b,1);0==this.clocks.length&&(this.timer.abort(),this.timer=void 0)},onTick:function(){for(var a=
(new Date).getTime()-this.start,a=a/1E3,b=0;b<this.clocks.length;b++)this.clocks[b].update(a);this.fireEvent("tick")}});Anim.TimeManager.current=new Anim.TimeManager;Core.Object.extend("Anim.AnimationManager",{clocks:void 0,start:0,onTickBind:void 0,constructor:function(a){this.addEvents("tick");this.clocks=[];this.start=(new Date).getTime();this.onTickBind=this.onTick.bind(this)},add:function(a){this.clocks.push(a);1==this.clocks.length&&requestAnimationFrame(this.onTickBind)},remove:function(a){for(var b=0;b<this.clocks.length&&this.clocks[b]!=a;)b++;b<this.clocks.length&&this.clocks.splice(b,1)},forceTick:function(){if(0<this.clocks.length)this.onTickBind()},
onTick:function(){(new Date).getTime();for(var a=(new Date).getTime()-this.start,a=a/1E3,b=0;b<this.clocks.length;b++)this.clocks[b].update(a);this.fireEvent("tick");0<this.clocks.length&&requestAnimationFrame(this.onTickBind)}});
"requestAnimationFrame"in window||(window.requestAnimationFrame="webkitRequestAnimationFrame"in window?window.webkitRequestAnimationFrame:"mozRequestAnimationFrame"in window?window.mozRequestAnimationFrame:"msRequestAnimationFrame"in window?window.msRequestAnimationFrame:function(a){setTimeout(a,1/60)});Anim.AnimationManager.current=new Anim.AnimationManager;Core.Object.extend("Anim.EasingFunction",{mode:"in",constructor:function(a){},setMode:function(a){this.mode=a},getMode:function(){return this.mode},ease:function(a){return"in"==this.mode?this.easeInCore(a):"out"==this.mode?1-this.easeInCore(1-a):0.5>=a?this.easeInCore(2*a)/2:0.5+(1-this.easeInCore(2-2*a))/2},easeInCore:function(a){return a}},{},{eases:{},register:function(a,b){this.eases[a]=b},parse:function(a){return new this.eases[a]}});Anim.EasingFunction.extend("Anim.LinearEase",{constructor:function(a){}},{easeInCore:function(a){return a}},{constructor:function(){Anim.EasingFunction.register("linear",this)}});Anim.EasingFunction.extend("Anim.PowerEase",{power:2,constructor:function(a){this.autoConfig(a,"power")},setPower:function(a){this.power=a},getPower:function(){return this.power}},{easeInCore:function(a){return Math.pow(a,this.power)}},{constructor:function(){Anim.EasingFunction.register("power",this)}});Anim.EasingFunction.extend("Anim.ElasticEase",{oscillations:3,springiness:3,constructor:function(a){this.autoConfig(a,"oscillations","springiness")},setOscillations:function(a){this.oscillations=a},getOscillations:function(){return this.oscillations},setSpringiness:function(a){this.springiness=a},getSpringiness:function(){return this.springiness}},{easeInCore:function(a){return Math.sin(a*(2*this.oscillations+0.5)*Math.PI)*Math.pow(a,this.springiness)}},{constructor:function(){Anim.EasingFunction.register("elastic",
this)}});Anim.EasingFunction.extend("Anim.BounceEase",{bounces:3,bounciness:2,constructor:function(a){this.autoConfig(a,"oscillations")},setBounces:function(a){this.bounces=a},getBounces:function(){return this.Bounces},setBounciness:function(a){this.bounciness=a},getBounciness:function(){return this.bounciness}},{easeInCore:function(a){a=Math.exp(1/this.bounciness*Math.log(a));var b=Math.floor(a*(this.bounces+0.5));return Math.sin((a*(this.bounces+0.5)-b)*Math.PI)/Math.exp(this.bounces-b)}},{constructor:function(){Anim.EasingFunction.register("bounce",
this)}});Core.Object.extend("Anim.Clock",{animation:!0,parent:void 0,time:void 0,iteration:void 0,progress:void 0,isActive:!1,globalTime:0,startTime:0,lastTick:0,beginTime:0,isPaused:!1,speed:1,duration:"forever",pendingState:"none",autoReverse:!1,repeat:1,target:void 0,ease:void 0,constructor:function(a){this.addEvents("complete","timeupdate")},setAnimation:function(a){this.animation=a},setRepeat:function(a){this.repeat=a},setSpeed:function(a){this.speed=a},setAutoReverse:function(a){this.autoReverse=a},
setBeginTime:function(a){this.beginTime=a},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},setTarget:function(a){this.target=a},setDuration:function(a){this.duration="automatic"==a?"forever":a},setParent:function(a){this.parent=a},getParent:function(){return this.parent},getGlobalTime:function(){return this.globalTime+(this.lastTick-this.startTime)*this.speed},getIsActive:function(){return this.isActive},getTime:function(){return this.time},getIteration:function(){return this.iteration},
getProgress:function(){return this.progress},begin:function(){void 0==this.parent?this.animation?Anim.AnimationManager.current.add(this):Anim.TimeManager.current.add(this):void 0==this.scope&&(this.scope=this.parent.scope);this.pendingState="active";void 0!=this.target&&void 0!=this.target.setAnimClock&&this.target.setAnimClock(this)},pause:function(){this.pendingState="paused"},resume:function(){this.pendingState="resumed"},stop:function(){this.pendingState="stopped"},onComplete:function(){void 0==
this.parent&&(this.animation?Anim.AnimationManager.current.remove(this):Anim.TimeManager.current.remove(this));this.fireEvent("complete")},onTimeUpdate:function(a){var b=this.getProgress();void 0!=this.ease&&(b=this.ease.ease(b));this.fireEvent("timeupdate",this,b,a)},update:function(a){var b;do if(b=this.pendingState,this.pendingState="none","none"==b){if(this.isActive&&!this.isPaused){b=a-this.lastTick;this.lastTick=a;var c=this.getGlobalTime(),c=c-this.beginTime;if(0<=c)if("forever"!=this.duration&&
"automatic"!=this.duration){var d=c/this.duration,e=Math.floor(d+1),c=c%this.duration;this.autoReverse&&(0==(e&1)&&(c=this.duration-c),d/=2,e=Math.floor(d+1));"forever"==this.repeat?(this.iteration=e,this.time=c,this.progress=c/this.duration,this.onTimeUpdate(b)):d>=this.repeat?(this.pendingState="stopped",this.iteration=this.repeat,this.time=this.duration,this.progress=this.autoReverse?0:1,this.onTimeUpdate(0)):(this.iteration=e,this.time=c,this.progress=c/this.duration,this.onTimeUpdate(b))}else this.time=
c,this.progress=0,this.iteration=void 0,this.onTimeUpdate(b)}}else"active"==b?this.isActive||(this.isActive=!0,this.globalTime=0,this.lastTick=this.startTime=a,0<this.beginTime?this.iteration=this.progress=this.time=void 0:(this.progress=this.time=0,this.iteration=1,this.onTimeUpdate(0))):"paused"==b?!this.isPaused&&this.isActive&&(this.isPaused=!0,this.globalTime=this.getGlobalTime(),this.lastTick=this.startTime=0):"resumed"==b?this.isPaused&&this.isActive&&(this.isPaused=!1,this.lastTick=this.startTime=
a):"stopped"==b&&this.isActive&&(this.iteration=this.time=this.progress=void 0,this.isActive=!1);while("none"!=this.pendingState);if(void 0==this.parent&&!this.isActive)this.onComplete()}});Anim.Clock.extend("Anim.ClockGroup",{children:void 0,constructor:function(a){this.children=[]},appendChild:function(a){a.setParent(this);this.children.push(a)},setContent:function(a){this.children=[];if(void 0!=a&&"object"==typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.appendChild(Anim.Clock.create(a[b]));else this.appendChild(Anim.Clock.create(a))}},{begin:function(){Anim.ClockGroup.base.begin.call(this);for(var a=0;a<this.children.length;a++)this.children[a].begin()},pause:function(){Anim.ClockGroup.base.pause.call(this);
for(var a=0;a<this.children.length;a++)this.children[a].pause()},resume:function(){Anim.ClockGroup.base.resume.call(this);for(var a=0;a<this.children.length;a++)this.children[a].resume()},stop:function(){Anim.ClockGroup.base.stop.call(this);for(var a=0;a<this.children.length;a++)this.children[a].stop()},onCompleted:function(){Anim.ClockGroup.base.onCompleted.call(this);for(var a=0;a<this.children.length;a++)this.children[a].onCompleted()},update:function(a){do{Anim.ClockGroup.base.update.call(this,
a);for(var b=!0,c=0;c<this.children.length;c++){var d=this.children[c];d.update(this.getGlobalTime());d.getIsActive()&&(b=!1)}this.getIsActive()&&b&&(this.pendingState="stopped")}while("none"!=this.pendingState)}});Core.Object.extend("Ui.Matrix",{a:1,b:0,c:0,d:1,e:0,f:0,constructor:function(a){},isTranslateOnly:function(){return 1==this.a&&0==this.b&&0==this.c&&1==this.d},isIdentity:function(){return 1==this.a&&0==this.b&&0==this.c&&1==this.d&&0==this.e&&0==this.f},translate:function(a,b){this.multiply(Ui.Matrix.createTranslate(a,b))},rotate:function(a){this.multiply(Ui.Matrix.createRotate(a))},scale:function(a,b){void 0===b&&(b=a);this.multiply(Ui.Matrix.createScale(a,b))},multiply:function(a){var b=a.c*this.a+
a.d*this.c,c=a.e*this.a+a.f*this.c+this.e,d=a.a*this.b+a.b*this.d,e=a.c*this.b+a.d*this.d,g=a.e*this.b+a.f*this.d+this.f;this.a=a.a*this.a+a.b*this.c;this.b=d;this.c=b;this.d=e;this.e=c;this.f=g},getDeterminant:function(){return this.a*this.d-this.b*this.c},inverse:function(){var a=this.getDeterminant();if(0==a)throw"Matrix not invertible";var a=1/a,b=-this.b*a,c=-this.c*a,d=this.a*a,e=(this.c*this.f-this.e*this.d)*a,g=(this.e*this.b-this.a*this.f)*a;this.a=this.d*a;this.b=b;this.c=c;this.d=d;this.e=
e;this.f=g},setMatrix:function(a,b,c,d,e,g){this.a=a;this.b=b;this.c=c;this.d=d;this.e=e;this.f=g},getA:function(){return this.a},getB:function(){return this.b},getC:function(){return this.c},getD:function(){return this.d},getE:function(){return this.e},getF:function(){return this.f},clone:function(){return Ui.Matrix.createMatrix(this.a,this.b,this.c,this.d,this.e,this.f)}},{toString:function(){return"matrix("+this.a.toFixed(4)+","+this.b.toFixed(4)+","+this.c.toFixed(4)+","+this.d.toFixed(4)+","+
this.e.toFixed(4)+","+this.f.toFixed(4)+")"}},{createMatrix:function(a,b,c,d,e,g){var f=new Ui.Matrix;f.setMatrix(a,b,c,d,e,g);return f},createTranslate:function(a,b){return Ui.Matrix.createMatrix(1,0,0,1,a,b)},createScaleAt:function(a,b,c,d){return Ui.Matrix.createMatrix(a,0,0,b,c-a*c,d-b*d)},createScale:function(a,b){void 0===b&&(b=a);return Ui.Matrix.createScaleAt(a,b,0,0)},createRotateAt:function(a,b,c){a=a%360*Math.PI/180;var d=Math.sin(a);a=Math.cos(a);return Ui.Matrix.createMatrix(a,d,-d,a,
b*(1-a)+c*d,c*(1-a)-b*d)},createRotate:function(a){return Ui.Matrix.createRotateAt(a,0,0)},parse:function(a){var b;if("string"===typeof a){var c;if(null!=(c=a.match(/^matrix\((-?\d+\.?\d*),(-?\d+\.?\d*),(-?\d+\.?\d*),(-?\d+\.?\d*),(-?\d+\.?\d*),(-?\d+\.?\d*)\)$/))){var d=parseFloat(c[1]),e=parseFloat(c[2]),g=parseFloat(c[3]),f=parseFloat(c[4]),h=parseFloat(c[5]);c=parseFloat(c[6]);b=new Ui.Matrix;b.setMatrix(d,e,g,f,h,c)}}if(void 0===b)throw"Unknown matrix format ("+a+")";return b}});Core.Object.extend("Ui.Point",{x:0,y:0,constructor:function(a){},matrixTransform:function(a){var b=this.x*a.b+this.y*a.d+a.f;this.x=this.x*a.a+this.y*a.c+a.e;this.y=b;return this},setPoint:function(a){this.x=a.x;this.y=a.y},getX:function(){return this.x},setX:function(a){this.x=a},getY:function(){return this.y},setY:function(a){this.y=a},clone:function(){return new Ui.Point({x:this.x,y:this.y})}},{toString:function(){return"point("+this.x.toFixed(4)+", "+this.y.toFixed(4)+")"}});Core.Object.extend("Ui.Color",{r:0,g:0,b:0,a:1,constructor:function(a){if(void 0!=a.r&&void 0!=a.g&&void 0!=a.b)this.r=Math.min(Math.max(a.r,0),1),this.g=Math.min(Math.max(a.g,0),1),this.b=Math.min(Math.max(a.b,0),1),delete a.r,delete a.g,delete a.b;else if(void 0!=a.h&&void 0!=a.s&&void 0!=a.l)this.initFromHsl(void 0!=a.h?a.h:0,void 0!=a.s?a.s:0,void 0!=a.l?a.l:0),delete a.h,delete a.s,delete a.l;else if(void 0!=a.y&&void 0!=a.u&&void 0!=a.v){var b=Math.max(void 0!=a.y?a.y:0,0);this.initFromYuv(b,
void 0!=a.u?a.u:0,void 0!=a.v?a.v:0);delete a.y;delete a.u;delete a.v}void 0!=a.a&&(this.a=Math.min(Math.max(a.a,0),1),delete a.a)},getCssRgba:function(){return"rgba("+Math.round(255*this.r)+","+Math.round(255*this.g)+","+Math.round(255*this.b)+","+this.a+")"},getCssRgb:function(){return"rgb("+Math.round(255*this.r)+","+Math.round(255*this.g)+","+Math.round(255*this.b)+")"},getCssHtml:function(){var a="#",b=Math.round(255*this.r).toString(16);1==b.length&&(b="0"+b);a+=b;b=Math.round(255*this.g).toString(16);
1==b.length&&(b="0"+b);a+=b;b=Math.round(255*this.b).toString(16);1==b.length&&(b="0"+b);return a+b},getRgba:function(){return{r:this.r,g:this.g,b:this.b,a:this.a}},getRgb:function(){return this.getRgba()},getHsla:function(){var a=this.r,b=this.g,c=this.b,d=Math.min(a,Math.min(b,c)),e=Math.max(a,Math.max(b,c)),d=e-d;if(0==e)return{h:0,s:0,l:e,a:this.a};a=60*(a==e?(b-c)/d:b==e?2+(c-a)/d:4+(a-b)/d);0>a&&(a+=360);return{h:a,s:d/e,l:e,a:this.a}},getHsl:function(){return this.getHsla()},getYuva:function(){var a=
0.299*this.r+0.587*this.g+0.114*this.b;return{y:a,u:0.492*(this.b-a),v:0.877*(this.r-a),a:this.a}},getYuv:function(){return this.getYuva()},initFromHsl:function(a,b,c){if(0>=b)this.b=this.g=this.r=c;else{a/=60;var d=Math.floor(a),e=a-d;a=c*(1-b);var g=c*(1-b*e);b=c*(1-b*(1-e));0==d?(this.r=c,this.g=b,this.b=a):1==d?(this.r=g,this.g=c,this.b=a):2==d?(this.r=a,this.g=c,this.b=b):3==d?(this.r=a,this.g=g,this.b=c):4==d?(this.r=b,this.g=a,this.b=c):(this.r=c,this.g=a,this.b=g)}},initFromYuv:function(a,
b,c){this.r=Math.max(0,Math.min(a+1.13983*c,1));this.g=Math.max(0,Math.min(a-0.39465*b-0.5806*c,1));this.b=Math.max(0,Math.min(a+2.03211*b,1))}},{toString:function(){return"color("+this.r.toFixed(4)+", "+this.g.toFixed(4)+", "+this.b.toFixed(4)+", "+this.a.toFixed(4)+")"}},{knownColor:{white:"#ffffff",black:"#000000",red:"#ff0000",green:"#008000",blue:"#0000ff",lightblue:"#add8e6",lightgreen:"#90ee90",orange:"#ffa500",purple:"#800080",lightgray:"#d3d3d3",darkgray:"#a9a9a9",pink:"#ffc0cb",brown:"#a52a2a"},
parse:function(a){if("string"==typeof a){a in Ui.Color.knownColor&&(a=Ui.Color.knownColor[a]);var b;if(null!=(b=a.match(/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+\.?\d*)\s*\)\s*$/))){var c=parseInt(b[1])/255,d=parseInt(b[2])/255;a=parseInt(b[3])/255;b=parseFloat(b[4]);return new Ui.Color({r:c,g:d,b:a,a:b})}if(null!=(b=a.match(/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/)))return c=parseInt(b[1])/255,d=parseInt(b[2])/255,a=parseInt(b[3])/255,new Ui.Color({r:c,g:d,b:a});if(0==
a.indexOf("#")){if(7==a.length)return c=parseInt(a.substr(1,2),16)/255,d=parseInt(a.substr(3,2),16)/255,a=parseInt(a.substr(5,2),16)/255,new Ui.Color({r:c,g:d,b:a});if(4==a.length)return c=parseInt(a.substr(1,1),16)/15,d=parseInt(a.substr(2,1),16)/15,a=parseInt(a.substr(3,1),16)/15,new Ui.Color({r:c,g:d,b:a})}}throw"Unknown color format ("+a+")";}});Core.Object.extend("Ui.LinearGradient",{orientation:"vertical",stops:void 0,image:void 0,constructor:function(a){"stops"in a?(this.stops=a.stops,delete a.stops):this.stops=[{offset:0,color:new Ui.Color({r:1,g:1,b:1,a:1})},{offset:1,color:new Ui.Color({r:0,g:0,b:0,a:1})}];void 0!=a.orientation&&(this.orientation=a.orientation,delete a.orientation);for(a=0;a<this.stops.length;a++)this.stops[a].color=Ui.Color.create(this.stops[a].color)},getBackgroundImage:function(){if(void 0!=this.image)return this.image;
if(navigator.isWebkit){this.image="-webkit-gradient(linear, 0% 0%, ";this.image="vertical"==this.orientation?this.image+"0% 100%":this.image+"100% 0%";for(var a=0;a<this.stops.length;a++){var b=this.stops[a];this.image+=", color-stop("+b.offset+", "+b.color.getCssRgba()+")"}this.image+=")"}else if(navigator.isGecko){this.image="-moz-linear-gradient(";this.image="vertical"==this.orientation?this.image+"-90deg":this.image+"0deg";for(a=0;a<this.stops.length;a++)b=this.stops[a],this.image+=", "+b.color.getCssRgba()+
" "+Math.round(100*b.offset)+"%";this.image+=")"}else if(navigator.supportCanvas){var c=document.createElement("canvas"),d=c.getContext("2d");if("vertical"==this.orientation){c.setAttribute("width",1,null);c.setAttribute("height",100,null);for(var e=d.createLinearGradient(0,0,0,100),a=0;a<this.stops.length;a++)b=this.stops[a],e.addColorStop(b.offset,b.color.getCssRgba());d.fillStyle=e;d.fillRect(0,0,1,100)}else{c.setAttribute("width",100,null);c.setAttribute("height",1,null);e=d.createLinearGradient(0,
0,100,0);for(a=0;a<this.stops.length;a++)b=this.stops[a],e.addColorStop(b.offset,b.color.getCssRgba());d.fillStyle=e;d.fillRect(0,0,100,1)}this.image="url("+c.toDataURL()+")"}else this.image="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAACCAYAAACddGYaAAAAAXNSR0IArs4c6QAAAAZiS0dEAO8AUQBRItXOlAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9gJDxcIBl8Z3A0AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAC0lEQVQI12NgwAUAABoAASRETuUAAAAASUVORK5CYII%3D)";return this.image},getSVGGradient:function(){var a=
document.createElementNS(svgNS,"linearGradient");a.setAttributeNS(null,"gradientUnits","objectBoundingBox");a.setAttributeNS(null,"x1",0);a.setAttributeNS(null,"y1",0);"vertical"==this.orientation?(a.setAttributeNS(null,"x2",0),a.setAttributeNS(null,"y2",1)):(a.setAttributeNS(null,"x2",1),a.setAttributeNS(null,"y2",0));for(var b=0;b<this.stops.length;b++){var c=this.stops[b],d=document.createElementNS(svgNS,"stop");d.setAttributeNS(null,"offset",c.offset);d.style.stopColor=c.color.getCssHtml();d.style.stopOpacity=
c.color.getRgba().a;a.appendChild(d)}return a},getCanvasGradient:function(a,b,c){a="vertical"==this.orientation?a.createLinearGradient(0,0,0,c):a.createLinearGradient(0,0,b,0);for(b=0;b<this.stops.length;b++)c=this.stops[b],a.addColorStop(c.offset,c.color.getCssRgba());return a},getVMLFill:function(){var a=document.createElement("vml:fill");a.type="gradient";a.angle="vertical"==this.orientation?180:270;a.color=this.stops[0].color.getCssHtml();a.opacity=this.stops[0].color.getRgba().a;a.color2=this.stops[this.stops.length-
1].color.getCssHtml();a.opacity2=this.stops[this.stops.length-1].color.getRgba().a;a.method="None";if(2<this.stops.length){for(var b="",c=1;c<this.stops.length-1;c++)""!=b&&(b+=","),b+=Math.round(100*this.stops[c].offset)+"% "+this.stops[c].color.getCssHtml();a.colors=b}return a}});Core.Object.extend("Ui.Keyboard",{shiftKey:!1,altKey:!1,ctrlKey:!1,altGraphKey:!1,metaKey:!1,elementCapture:void 0,constructor:function(a){},capture:function(a){if(void 0!=this.elementCapture)throw"keyboard capture already done on element (type: "+this.elementCapture.type+", id: "+this.elementCapture.id+", newid: "+a.id+")";this.elementCapture=a},release:function(){if(void 0!=this.elementCapture)this.elementCapture=void 0;else throw"keyboard capture release but no element capture the keyboard";},
getShiftKey:function(){return this.shiftKey},getAltKey:function(){return this.altKey},getCtrlKey:function(){return this.ctrlKey},getAltGraphKey:function(){return this.altGraphKey},getMetaKey:function(){return this.metaKey}});Ui.Keyboard.current=new Ui.Keyboard;Core.Object.extend("Ui.Element",{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0,parent:void 0,width:void 0,height:void 0,drawing:void 0,collapse:!1,measureValid:!1,measureConstraintPixelRatio:1,measureConstraintWidth:0,measureConstraintHeight:0,measureWidth:0,measureHeight:0,arrangeValid:!1,arrangeX:0,arrangeY:0,arrangeWidth:0,arrangeHeight:0,arrangePixelRatio:1,drawValid:!0,drawNext:void 0,layoutValid:!0,layoutNext:void 0,layoutX:0,layoutY:0,layoutWidth:0,layoutHeight:0,isLoaded:!1,verticalAlign:"stretch",
horizontalAlign:"stretch",clipToBounds:!1,clipX:void 0,clipY:void 0,clipWidth:void 0,clipHeight:void 0,visible:void 0,parentVisible:void 0,focusable:!1,hasFocus:!1,keyboardRequired:!1,selectable:!1,transform:void 0,transformOriginX:0.5,transformOriginY:0.5,transformOriginAbsolute:!1,animClock:void 0,opacity:1,parentOpacity:1,disabled:void 0,parentDisabled:void 0,style:void 0,parentStyle:void 0,mergeStyle:void 0,constructor:function(a){this.drawing=this.renderDrawing(a);DEBUG&&this.drawing.setAttribute("class",
this.classType);this.drawing.style.position="absolute";this.drawing.style.left="-10000px";this.drawing.style.top="-10000px";this.drawing.style.outline="none";this.connect(this.drawing,"focus",this.onFocus);this.connect(this.drawing,"blur",this.onBlur);this.addEvents("keypress","keydown","keyup","focus","blur","load","unload","enable","disable","visible","hidden")},getDrawing:function(){return this.drawing},getSelectable:function(){return this.selectable},setSelectable:function(a){this.selectable=
a;(this.getDrawing().selectable=a)?(this.getDrawing().style.cursor="text",navigator.isWebkit?this.getDrawing().style.removeProperty("-webkit-user-select"):navigator.isGecko?this.getDrawing().style.removeProperty("-moz-user-select"):navigator.isIE?navigator.isIE7||navigator.isIE8?this.disconnect(this.getDrawing(),"selectstart",this.onIESelectStart):this.getDrawing().style.removeProperty("-ms-user-select"):navigator.isOpera&&(this.getDrawing().onmousedown=void 0)):(this.getDrawing().style.cursor="inherit",
navigator.isWebkit?this.getDrawing().style.webkitUserSelect="none":navigator.isGecko?this.getDrawing().style.MozUserSelect="none":navigator.isIE?navigator.isIE7||navigator.isIE8?this.connect(this.getDrawing(),"selectstart",this.onIESelectStart):this.getDrawing().style.msUserSelect="none":navigator.isOpera&&(this.getDrawing().onmousedown=function(a){a.preventDefault()}))},getLayoutX:function(){return this.layoutX},getLayoutY:function(){return this.layoutY},getLayoutWidth:function(){return this.layoutWidth},
getLayoutHeight:function(){return this.layoutHeight},setId:function(a){this.drawing.setAttribute("id",a)},getId:function(){return this.drawing.getAttribute("id")},setFocusable:function(a){(this.focusable=a)&&!this.getIsDisabled()?this.drawing.tabIndex=0:this.drawing.tabIndex=-1},getFocusable:function(){return this.focusable},setKeyboardRequired:function(a){this.keyboardRequired=a},getKeyboardRequired:function(){return this.keyboardRequired},setRole:function(a){"setAttributeNS"in this.drawing&&(void 0===
a?this.drawing.hasAttributeNS("http://www.w3.org/2005/07/aaa","role")&&this.drawing.removeAttributeNS("http://www.w3.org/2005/07/aaa","role"):this.drawing.setAttributeNS("http://www.w3.org/2005/07/aaa","role",a))},measure:function(a,b){if(this.isLoaded){if(this.collapse)return this.measureValid=!0,{width:0,height:0};if(this.measureValid&&this.measureConstraintWidth==a&&this.measureConstraintHeight==b&&this.measureConstraintPixelRatio==(window.devicePixelRatio||1))return{width:this.measureWidth,height:this.measureHeight};
this.measureConstraintPixelRatio=window.devicePixelRatio||1;this.measureConstraintWidth=a;this.measureConstraintHeight=b;var c=this.getMarginLeft(),d=this.getMarginRight(),e=this.getMarginTop(),g=this.getMarginBottom(),f=Math.max(a-(c+d),0),h=Math.max(b-(e+g),0);"stretch"!=this.horizontalAlign&&(f=0);"stretch"!=this.verticalAlign&&(h=0);void 0!==this.width&&(f=Math.max(this.width,f));void 0!==this.height&&(h=Math.max(this.height,h));f=this.measureCore(f,h);this.measureWidth=void 0!==this.width&&f.width<
this.width?this.width+c+d:f.width+c+d;this.measureHeight=void 0!=this.height&&f.height<this.height?this.height+e+g:f.height+e+g;this.measureValid=!0;return{width:this.measureWidth,height:this.measureHeight}}},measureCore:function(a,b){return{width:0,height:0}},invalidateMeasure:function(){if(this.measureValid&&(this.measureValid=!1,void 0!==this.parent&&this.parent.measureValid))this.parent.onChildInvalidateMeasure(this,"change");this.invalidateArrange()},onChildInvalidateMeasure:function(a,b){this.invalidateMeasure()},
arrange:function(a,b,c,d){if(this.isLoaded&&!this.collapse){isNaN(a)&&(a=0);isNaN(b)&&(b=0);isNaN(c)&&(c=0);isNaN(d)&&(d=0);if(!this.arrangeValid||this.arrangeX!=a||this.arrangeY!=b||this.arrangeWidth!=c||this.arrangeHeight!=d||this.arrangePixelRatio!=(window.devicePixelRatio||1)){this.arrangeX=a;this.arrangeY=b;this.arrangeWidth=c;this.arrangeHeight=d;this.arrangePixelRatio=window.devicePixelRatio||1;"top"==this.verticalAlign?d=this.measureHeight:"bottom"==this.verticalAlign?(b+=d-this.measureHeight,
d=this.measureHeight):"center"==this.verticalAlign&&(b+=(d-this.measureHeight)/2,d=this.measureHeight);"left"==this.horizontalAlign?c=this.measureWidth:"right"==this.horizontalAlign?(a+=c-this.measureWidth,c=this.measureWidth):"center"==this.horizontalAlign&&(a+=(c-this.measureWidth)/2,c=this.measureWidth);var e=this.getMarginLeft(),g=this.getMarginRight(),f=this.getMarginTop(),h=this.getMarginBottom();d-=f+h;this.layoutX=a+e;this.layoutY=b+f;this.layoutWidth=Math.max(c-(e+g),0);this.layoutHeight=
Math.max(d,0);this.drawing.style.left=Math.round(this.layoutX)+"px";this.drawing.style.top=Math.round(this.layoutY)+"px";void 0!==this.transform&&this.updateTransform();this.drawing.style.width=Math.round(this.layoutWidth)+"px";this.drawing.style.height=Math.round(this.layoutHeight)+"px";this.clipToBounds&&(this.clipY=this.clipX=0,this.clipWidth=this.layoutWidth,this.clipHeight=this.layoutHeight,this.updateClipRectangle());this.arrangeCore(this.layoutWidth,this.layoutHeight)}this.arrangeValid=!0}},
arrangeCore:function(a,b){},invalidateArrange:function(){if(this.arrangeValid&&(this.arrangeValid=!1,void 0!=this.parent))this.parent.onChildInvalidateArrange(this)},onChildInvalidateArrange:function(a){this.invalidateArrange()},draw:function(){this.drawCore();this.drawValid=!0},drawCore:function(){},invalidateDraw:function(){void 0!==Ui.App.current&&this.drawValid&&(this.drawValid=!1,Ui.App.current.enqueueDraw(this))},renderDrawing:function(){return document.createElement("div")},getWidth:function(){return this.width},
setWidth:function(a){this.width!=a&&(this.width=a,this.invalidateMeasure())},getHeight:function(){return this.height},setHeight:function(a){this.height!=a&&(this.height=a,this.invalidateMeasure())},getVerticalAlign:function(){return this.verticalAlign},setVerticalAlign:function(a){this.verticalAlign=a;this.invalidateArrange()},getHorizontalAlign:function(){return this.horizontalAlign},setHorizontalAlign:function(a){this.horizontalAlign=a;this.invalidateArrange()},getClipToBounds:function(){return this.clipToBounds},
setClipToBounds:function(a){this.clipToBounds!=a&&((this.clipToBounds=a)?(this.clipY=this.clipX=0,this.clipWidth=this.layoutWidth,this.clipHeight=this.layoutHeight):this.clipHeight=this.clipWidth=this.clipY=this.clipX=void 0,this.updateClipRectangle())},setClipRectangle:function(a,b,c,d){this.clipX=a;this.clipY=b;this.clipWidth=c;this.clipHeight=d;this.updateClipRectangle()},updateClipRectangle:function(){if(void 0!=this.clipX){var a=Math.round(this.clipX),b=Math.round(this.clipY),c=Math.round(this.clipWidth),
d=Math.round(this.clipHeight);this.drawing.style.clip="rect("+b+"px "+(a+c)+"px "+(b+d)+"px "+a+"px)"}else"removeProperty"in this.drawing.style?this.drawing.style.removeProperty("clip"):"removeAttribute"in this.drawing.style&&this.drawing.style.removeAttribute("clip")},setMargin:function(a){this.setMarginTop(a);this.setMarginBottom(a);this.setMarginLeft(a);this.setMarginRight(a)},getMarginTop:function(){return this.marginTop},setMarginTop:function(a){a!=this.marginTop&&(this.marginTop=a,this.invalidateMeasure())},
getMarginBottom:function(){return this.marginBottom},setMarginBottom:function(a){a!=this.marginBottom&&(this.marginBottom=a,this.invalidateMeasure())},getMarginLeft:function(){return this.marginLeft},setMarginLeft:function(a){a!=this.marginLeft&&(this.marginLeft=a,this.invalidateMeasure())},getMarginRight:function(){return this.marginRight},setMarginRight:function(a){a!=this.marginRight&&(this.marginRight=a,this.invalidateMeasure())},getOpacity:function(){return this.opacity},setOpacity:function(a){this.opacity!=
a&&(this.opacity=a,navigator.supportOpacity&&(this.drawing.style.opacity=this.opacity))},focus:function(){if(this.focusable)try{this.drawing.focus()}catch(a){}},blur:function(){try{this.drawing.blur()}catch(a){}},setTransform:function(a){this.transform!=a&&(this.transform=a,this.updateTransform())},setTransformOrigin:function(a,b,c){if(this.transformOriginX!=a||this.transformOriginY!=b||this.transformOriginAbsolute!=c)this.transformOriginX=a,this.transformOriginY=b,this.transformOriginAbsolute=void 0===
c?!1:c,this.updateTransform()},transformToWindow:function(){return Ui.Element.transformToWindow(this.drawing)},transformFromWindow:function(){return Ui.Element.transformFromWindow(this.drawing)},transformToElement:function(a){var b=this.transformToWindow();b.multiply(a.transformFromWindow());return b},pointToWindow:function(a){return Ui.Element.pointToWindow(this.drawing,a)},pointFromWindow:function(a){return Ui.Element.pointFromWindow(this.drawing,a)},pointFromElement:function(a,b){return this.pointFromWindow(a.pointToWindow(b))},
getIsLoaded:function(){return this.isLoaded},getMeasureWidth:function(){return this.measureWidth},getMeasureHeight:function(){return this.measureHeight},hide:function(a){if(void 0===this.visible||this.visible){var b=this.getIsVisible();this.visible=!1;this.drawing.style.display="none";this.collapse=!0===a;if(b)this.onInternalHidden();this.collapse&&this.invalidateMeasure()}},show:function(){if(void 0===this.visible||!this.visible){var a=this.getIsVisible();this.visible=!0;this.drawing.style.display=
"block";if(this.getIsVisible()&&!a)this.onInternalVisible();this.collapse&&(this.collapse=!1,this.invalidateMeasure())}},getIsVisible:function(){return!0===this.parentVisible&&!1!==this.visible},setParentVisible:function(a){var b=this.getIsVisible();this.parentVisible=a;if(b!=this.getIsVisible())if(this.getIsVisible())this.onInternalVisible();else this.onInternalHidden()},onInternalHidden:function(){this.onHidden();this.fireEvent("hidden",this)},onHidden:function(){},onInternalVisible:function(){this.onVisible();
this.fireEvent("visible",this)},checkVisible:function(){if(void 0!==this.getDrawing()){for(var a=!1,b=this.getDrawing();void 0!=b;){if("none"==b.style.display){a=!1;break}if(b==document.body){a=!0;break}b=b.parentNode}this.getIsVisible()!==a&&console.log("checkVisible expect: "+this.getIsVisible()+", got: "+a+" (on "+this+")")}},onVisible:function(){},disable:function(){if(void 0===this.disabled||!this.disabled){var a=this.getIsDisabled();this.disabled=!0;if(!a)this.onInternalDisable()}},enable:function(){if(void 0===
this.disabled||this.disabled){var a=this.getIsDisabled();this.disabled=!1;if(a&&!this.getIsDisabled())this.onInternalEnable()}},setEnable:function(a){a?this.enable():this.disable()},getIsDisabled:function(){return void 0!==this.disabled&&!0===this.disabled||void 0!==this.parentDisabled&&!0===this.parentDisabled?!0:!1},setParentDisabled:function(a){var b=this.getIsDisabled();this.parentDisabled=a;if(b!==this.getIsDisabled())if(this.getIsDisabled())this.onInternalDisable();else this.onInternalEnable()},
onInternalDisable:function(){this.focusable&&(this.drawing.tabIndex=-1,this.hasFocus&&this.blur());this.onDisable();this.fireEvent("disable",this)},onDisable:function(){},onInternalEnable:function(){this.focusable&&(this.drawing.tabIndex=0);this.onEnable();this.fireEvent("enable",this)},onEnable:function(){},containSubStyle:function(a){for(var b in a)if(-1!==b.indexOf(".")&&"object"===typeof a[b])return!0;return!1},fusionStyle:function(a,b){for(var c in b)if(-1!==c.indexOf(".")&&"object"===typeof b[c])if(void 0!==
a[c]){var d=a[c];a[c]={};for(var e in d)a[c][e]=d[e];for(e in b[c])a[c][e]=b[c][e]}else a[c]=b[c]},mergeStyles:function(){this.mergeStyle=void 0;if(void 0!==this.parentStyle){for(var a=this,b=!1;void 0!==a;){if(void 0!==this.parentStyle[a.classType]&&this.containSubStyle(this.parentStyle[a.classType])){void 0===this.mergeStyle&&(this.mergeStyle=Core.Util.clone(this.parentStyle));this.fusionStyle(this.mergeStyle,this.parentStyle[a.classType]);b=!0;break}a=a.__baseclass__}b||(this.mergeStyle=this.parentStyle)}if(void 0!==
this.style)if(void 0!==this.mergeStyle)for(this.mergeStyle=Core.Util.clone(this.mergeStyle),this.fusionStyle(this.mergeStyle,this.style),a=this;void 0!==a;){if(void 0!==this.style[a.classType]&&this.containSubStyle(this.style[a.classType])){this.fusionStyle(this.mergeStyle,this.style[a.classType]);break}a=a.__baseclass__}else{a=this;for(b=!1;void 0!==a;){if(void 0!==this.style[a.classType]&&this.containSubStyle(this.style[a.classType])){void 0===this.mergeStyle&&(this.mergeStyle=Core.Util.clone(this.style));
this.fusionStyle(this.mergeStyle,this.style[a.classType]);b=!0;break}a=a.__baseclass__}b||(this.mergeStyle=this.style)}},getParent:function(){return this.parent},setParentStyle:function(a){this.parentStyle!==a&&(this.parentStyle=a);this.mergeStyles();this.onInternalStyleChange()},setStyle:function(a){this.style=a;this.mergeStyles();this.onInternalStyleChange()},setStyleProperty:function(a,b){void 0===this.style&&(this.style={});void 0===this.style[this.classType]&&(this.style[this.classType]={});
this.style[this.classType][a]=b},getStyleProperty:function(a){if(void 0!==this.mergeStyle)for(var b=this;void 0!=b;){if(void 0!==this.mergeStyle[b.classType]&&void 0!==this.mergeStyle[b.classType][a])return this.mergeStyle[b.classType][a];b=b.__baseclass__}for(b=this;void 0!=b;){if(void 0!=b.constructor.style&&a in b.constructor.style)return b.constructor.style[a];b=b.__baseclass__}},onInternalStyleChange:function(){if(this.isLoaded)this.onStyleChange()},onStyleChange:function(){},getHasFocus:function(){return this.hasFocus},
onIESelectStart:function(a){a.preventDefault()},onFocus:function(a){this.focusable&&!this.getIsDisabled()&&(a.preventDefault(),a.stopPropagation(),this.hasFocus=!0,this.fireEvent("focus",this))},onBlur:function(a){this.focusable&&(a.preventDefault(),a.stopPropagation(),this.hasFocus=!1,this.fireEvent("blur",this))},setIsLoaded:function(a){if(this.isLoaded!=a)if(this.isLoaded=a)this.onLoad();else this.onUnload()},updateTransform:function(){if(void 0!==this.transform){var a=new Ui.Matrix,b=this.transformOriginX,
c=this.transformOriginY;this.transformOriginAbsolute||(b*=this.layoutWidth,c*=this.layoutHeight);a.translate(b,c);a.multiply(this.transform);a.translate(-b,-c);navigator.isIE7||navigator.isIE8?(this.drawing.style.left=Math.round(this.layoutX+(isNaN(a.getE())?0:a.getE()))+"px",this.drawing.style.top=Math.round(this.layoutY+(isNaN(a.getF())?0:a.getF()))+"px"):(this.drawing.style.transform=a.toString(),this.drawing.style.transformOrigin="0% 0%",navigator.isIE?(this.drawing.style.msTransform=a.toString(),
this.drawing.style.msTransformOrigin="0% 0%"):navigator.isGecko?(this.drawing.style.MozTransform="matrix("+a.getA().toFixed(4)+", "+a.getB().toFixed(4)+", "+a.getC().toFixed(4)+", "+a.getD().toFixed(4)+", "+a.getE().toFixed(0)+"px, "+a.getF().toFixed(0)+"px)",this.drawing.style.MozTransformOrigin="0% 0%"):navigator.isWebkit?(this.drawing.style.webkitTransform=a.toString(),this.drawing.style.webkitTransformOrigin="0% 0%"):navigator.isOpera&&(this.drawing.style.OTransform=a.toString(),this.drawing.style.OTransformOrigin=
"0% 0%"))}else navigator.isIE7||navigator.isIE8?(this.drawing.style.left=Math.round(this.layoutX)+"px",this.drawing.style.top=Math.round(this.layoutY)+"px"):("removeProperty"in this.drawing.style&&(this.drawing.style.removeProperty("transform"),this.drawing.style.removeProperty("transform-origin")),navigator.isIE&&"removeProperty"in this.drawing.style?(this.drawing.style.removeProperty("-ms-transform"),this.drawing.style.removeProperty("-ms-transform-origin")):navigator.isGecko?(this.drawing.style.removeProperty("-moz-transform"),
this.drawing.style.removeProperty("-moz-transform-origin")):navigator.isWebkit?(this.drawing.style.removeProperty("-webkit-transform"),this.drawing.style.removeProperty("-webkit-transform-origin")):navigator.isOpera&&(this.drawing.style.removeProperty("-o-transform"),this.drawing.style.removeProperty("-o-transform-origin")))},setAnimClock:function(a){void 0!=this.animClock&&this.animClock.stop();this.animClock=a;void 0!==a&&this.connect(a,"complete",this.onAnimClockComplete)},onAnimClockComplete:function(){this.animClock=
void 0},onLoad:function(){void 0!==this.parent&&(this.setParentStyle(this.parent.mergeStyle),this.setParentDisabled(this.parent.getIsDisabled()),this.setParentVisible(this.parent.getIsVisible()));this.fireEvent("load",this)},onUnload:function(){void 0!=this.animClock&&(this.animClock.stop(),this.animClock=void 0);this.fireEvent("unload",this)}},{},{transformToWindow:function(a,b){void 0===b&&(b=window);if(navigator.isWebkit){for(var c=new Ui.Matrix,d=a;void 0!=d;){var e=b.getComputedStyle(d,null).getPropertyValue("-webkit-transform");
if("none"!=e){var g=b.getComputedStyle(d,null).getPropertyValue("-webkit-transform-origin"),f=0,h=0;"0px 0px"!=g&&(h=g.split(" "),f=new Number(h[0].replace(/px$/,"")),h=new Number(h[1].replace(/px$/,"")));var e=new WebKitCSSMatrix(e),k=Ui.Matrix.createMatrix(e.a,e.b,e.c,e.d,e.e,e.f);c.translate(-f,-h);c.multiply(k);c.translate(f,h)}c.translate(d.offsetLeft,d.offsetTop);c.translate(-d.scrollLeft,-d.scrollTop);d=d.offsetParent}return c}if(navigator.isGecko){c=new Ui.Matrix;for(d=a;void 0!=d;){e=b.getComputedStyle(d,
null).getPropertyValue("-moz-transform");if("none"!=e){var f=e.split(" "),k=new Number(f[0].slice(7,f[0].length-1)),m=new Number(f[1].slice(0,f[1].length-1)),l=new Number(f[2].slice(0,f[2].length-1)),n=new Number(f[3].slice(0,f[3].length-1)),p=new Number(f[4].slice(0,f[4].length-3)),r=new Number(f[5].slice(0,f[5].length-3)),g=b.getComputedStyle(d,null).getPropertyValue("-moz-transform-origin"),h=f=0;"0px 0px"!=g&&(h=g.split(" "),f=new Number(h[0].replace(/px$/,"")),h=new Number(h[1].replace(/px$/,
"")));k=Ui.Matrix.createMatrix(k,m,l,n,p,r);c.translate(-f,-h);c.multiply(k);c.translate(f,h)}c.translate(d.offsetLeft,d.offsetTop);c.translate(-d.scrollLeft,-d.scrollTop);d=d.offsetParent}return c}if(navigator.isOpera){c=new Ui.Matrix;for(d=a;void 0!=d;)e=b.getComputedStyle(d,null).getPropertyValue("-o-transform"),"none"!=e&&"matrix(1, 0, 0, 1, 0, 0)"!=e&&(f=e.split(" "),k=new Number(f[0].slice(7,f[0].length-1)),m=new Number(f[1].slice(0,f[1].length-1)),l=new Number(f[2].slice(0,f[2].length-1)),
n=new Number(f[3].slice(0,f[3].length-1)),p=new Number(f[4].slice(0,f[4].length-1)),r=new Number(f[5].slice(0,f[5].length-1)),g=b.getComputedStyle(d,null).getPropertyValue("-o-transform-origin"),h=f=0,"0px 0px"!=g&&(h=g.split(" "),f=new Number(h[0].replace(/px$/,"")),h=new Number(h[1].replace(/px$/,""))),k=Ui.Matrix.createMatrix(k,m,l,n,p,r),c.translate(-f,-h),c.multiply(k),c.translate(f,h)),c.translate(d.offsetLeft,d.offsetTop),c.translate(-d.scrollLeft,-d.scrollTop),d=d.offsetParent;return c}if(navigator.isIE){c=
new Ui.Matrix;for(d=a;void 0!==d&&null!==d&&d!==window;){try{e=b.getComputedStyle(d,null).getPropertyValue("-ms-transform")}catch(v){e="none"}"none"!=e&&"matrix(1, 0, 0, 1, 0, 0)"!=e&&(f=e.split(" "),k=new Number(f[0].slice(7,f[0].length-1)),m=new Number(f[1].slice(0,f[1].length-1)),l=new Number(f[2].slice(0,f[2].length-1)),n=new Number(f[3].slice(0,f[3].length-1)),p=new Number(f[4].slice(0,f[4].length-1)),r=new Number(f[5].slice(0,f[5].length-1)),g=b.getComputedStyle(d,null).getPropertyValue("-ms-transform-origin"),
h=f=0,"0px 0px"!=g&&(h=g.split(" "),f=new Number(h[0].replace(/px$/,"")),h=new Number(h[1].replace(/px$/,""))),k=Ui.Matrix.createMatrix(k,m,l,n,p,r),c.translate(-f,-h),c.multiply(k),c.translate(f,h));c.translate(d.offsetLeft,d.offsetTop);c.translate(-d.scrollLeft,-d.scrollTop);d=d.offsetParent}return c}if(navigator.supportSVG)return c=document.createElementNS(svgNS,"svg"),void 0===a.firstChild?a.appendChild(c):a.insertBefore(c,a.firstChild),d=c.getScreenCTM(),a.removeChild(c),Ui.Matrix.createMatrix(d.a,
d.b,d.c,d.d,d.e,d.f);c=new Ui.Matrix;for(d=a;void 0!==d&&null!==d&&d!==window;)c.translate(d.offsetLeft,d.offsetTop),c.translate(-d.scrollLeft,-d.scrollTop),d=d.offsetParent;return c},transformFromWindow:function(a,b){var c=Ui.Element.transformToWindow(a,b);c.inverse();return c},pointToWindow:function(a,b,c){b=new Ui.Point({point:b});b.matrixTransform(Ui.Element.transformToWindow(a,c));return b},pointFromWindow:function(a,b,c){b=new Ui.Point({point:b});b.matrixTransform(Ui.Element.transformFromWindow(a,
c));return b}});navigator.supportOpacity=!(null!=navigator.userAgent.match(/MSIE 7/i)||null!=navigator.userAgent.match(/MSIE 8/i));Ui.Element.extend("Ui.Container",{children:void 0,containerDrawing:void 0,constructor:function(a){this.children=[];void 0===this.containerDrawing&&(this.containerDrawing=this.getDrawing())},setContainerDrawing:function(a){this.containerDrawing=a},appendChild:function(a){a.parent=this;this.children.push(a);this.containerDrawing.appendChild(a.getDrawing());a.getDrawing().style.zIndex=this.children.length;a.setIsLoaded(this.isLoaded);a.setParentVisible(this.getIsVisible());a.setParentDisabled(this.getIsDisabled());
this.onChildInvalidateMeasure(a,"add")},prependChild:function(a){a.parent=this;this.children.unshift(a);void 0!=this.containerDrawing.firstChild?this.containerDrawing.insertBefore(a.getDrawing(),this.containerDrawing.firstChild):this.containerDrawing.appendChild(a.getDrawing());for(var b=0;b<this.children.length;b++)this.children[b].getDrawing().style.zIndex=b+1;a.setIsLoaded(this.isLoaded);a.setParentVisible(this.getIsVisible());a.setParentDisabled(this.getIsDisabled());this.onChildInvalidateMeasure(a,
"add")},removeChild:function(a){a.parent=void 0;this.containerDrawing.removeChild(a.getDrawing());for(var b=0;b<this.children.length&&this.children[b]!=a;)b++;b<this.children.length&&this.children.splice(b,1);for(b=0;b<this.children.length;b++)this.children[b].getDrawing().style.zIndex=b+1;a.setIsLoaded(!1);a.setParentVisible(!1);this.onChildInvalidateMeasure(a,"remove")},insertChildAt:function(a,b){this.appendChild(a);this.moveChildAt(a,b)},moveChildAt:function(a,b){0>b&&(b=this.children.length+
b);0>b&&(b=0);b>=this.children.length&&(b=this.children.length);for(var c=0;c<this.children.length&&this.children[c]!=a;)c++;if(c<this.children.length)for(this.children.splice(c,1),this.children.splice(b,0,a),c=0;c<this.children.length;c++)this.children[c].getDrawing().style.zIndex=c+1;this.onChildInvalidateMeasure(a,"move")},getChildren:function(){return this.children},getFirstChild:function(){if(0<this.children.length)return this.children[0]},getLastChild:function(){if(0<this.children.length)return this.children[this.children.length-
1]},getChildPosition:function(a){for(var b=0;b<this.children.length;b++)if(this.children[b]===a)return b;return-1},hasChild:function(a){return-1!==this.getChildPosition(a)},clear:function(){for(;null!=this.getFirstChild();)this.removeChild(this.getFirstChild())}},{get:function(a){if(this.name==a)return this;for(var b=0;b<this.children.length;b++){var c=this.children[b].get(a);if(void 0!==c)return c}},setIsLoaded:function(a){if(this.isLoaded!=a){if(this.isLoaded=a)this.onLoad();else this.onUnload();
for(var b=0;b<this.children.length;b++)this.children[b].setIsLoaded(a)}},onInternalStyleChange:function(){if(this.isLoaded&&(this.onStyleChange(),void 0!=this.children))for(var a=0;a<this.children.length;a++)this.children[a].setParentStyle(this.mergeStyle)},onInternalDisable:function(){Ui.Container.base.onInternalDisable.call(this);for(var a=0;a<this.children.length;a++)this.children[a].setParentDisabled(!0)},onInternalEnable:function(){Ui.Container.base.onInternalEnable.call(this);for(var a=0;a<
this.children.length;a++)this.children[a].setParentDisabled(!1)},onInternalVisible:function(){Ui.Container.base.onInternalVisible.call(this);for(var a=0;a<this.children.length;a++)this.children[a].setParentVisible(!0)},onInternalHidden:function(){Ui.Container.base.onInternalHidden.call(this);for(var a=0;a<this.children.length;a++)this.children[a].setParentVisible(!1)}});Core.Object.extend("Ui.SvgParser",{path:void 0,pos:0,cmd:void 0,current:void 0,value:!1,end:!1,constructor:function(a){this.path=navigator.isIE7||navigator.isIE8?a.path.split(""):a.path;delete a.path},isEnd:function(){return this.end},next:function(){this.end=this.pos>=this.path.length;if(!this.end){for(;this.pos<this.path.length&&(" "==this.path[this.pos]||","==this.path[this.pos]||";"==this.path[this.pos]);)this.pos++;this.current="";for(var a=void 0;this.pos<this.path.length&&" "!=this.path[this.pos]&&
","!=this.path[this.pos]&&";"!=this.path[this.pos];){var b=this.path[this.pos],c="e"!=b&&"a"<=b&&"z">=b||"A"<=b&&"Z">=b;if(void 0===a||a==c)a=c,this.current+=b,this.pos++;else break}a=new Number(this.current);(this.value=!isNaN(a))?this.current=a:this.cmd=this.current}},setCmd:function(a){this.cmd=a},getCmd:function(){return this.cmd},getCurrent:function(){return this.current},isCmd:function(){return!this.value},isValue:function(){return this.value}});Ui.Element.extend("Ui.SVGElement",{},{renderDrawing:function(){var a=document.createElementNS(svgNS,"svg");a.setAttribute("focusable",!1);return a}});Ui.Container.extend("Ui.CanvasElement",{canvasEngine:"svg",context:void 0,svgDrawing:void 0,vmlDrawing:void 0,eventCatcher:void 0,dpiRatio:1,constructor:function(a){this.setSelectable(!1)},update:function(){if("canvas"===this.canvasEngine||"vml"===this.canvasEngine)this.context.save(),this.context.clearRect(0,0,Math.ceil(this.getLayoutWidth()*this.dpiRatio),Math.ceil(this.getLayoutHeight()*this.dpiRatio)),1!==this.dpiRatio&&this.context.scale(this.dpiRatio,this.dpiRatio),this.updateCanvas(this.context),
this.context.restore();else{void 0!==this.svgDrawing&&this.getDrawing().removeChild(this.svgDrawing);var a=document.createElementNS(svgNS,"svg");a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.width=this.getLayoutWidth()+"px";a.style.height=this.getLayoutHeight()+"px";a.setAttribute("focusable",!1);a.setAttribute("draggable",!1);a.setAttribute("pointer-events","none");var b=new Core.SVG2DContext({document:a});this.updateCanvas(b);this.svgDrawing=a;this.svgDrawing.appendChild(b.getSVG());
this.getDrawing().appendChild(this.svgDrawing)}},getContext:function(){return this.context},updateCanvas:function(a){}},{renderDrawing:function(a){"canvasEngine"in a&&(this.canvasEngine=a.canvasEngine,delete a.canvasEngine);"canvas"!==this.canvasEngine||navigator.supportCanvas||(this.canvasEngine=navigator.supportSVG?"svg":"vml");"svg"!==this.canvasEngine||navigator.supportSVG||(this.canvasEngine=navigator.supportCanvas?"canvas":"vml");"vml"!==this.canvasEngine||navigator.supportVML||(this.canvasEngine=
navigator.supportCanvas?"canvas":"svg");if("canvas"===this.canvasEngine)a=document.createElement("canvas"),this.context=a.getContext("2d");else if("vml"===this.canvasEngine){a=document.createElement("div");var b=document.createElement("div");b.style.width="0px";b.style.height="0px";b.style.visibility="hidden";a.appendChild(b);this.setContainerDrawing(b);this.vmlDrawing=document.createElement("canvas");this.vmlDrawing=G_vmlCanvasManager.initElement(this.vmlDrawing);this.vmlDrawing.style.position="absolute";
this.vmlDrawing.style.top="0px";this.vmlDrawing.style.left="0px";this.context=this.vmlDrawing.getContext("2d");this.context.roundRect=Core.SVG2DPath.prototype.roundRect;this.context.svgPath=Core.SVG2DContext.prototype.svgPath;this.context.roundRectFilledShadow=Core.SVG2DContext.prototype.roundRectFilledShadow;a.appendChild(this.vmlDrawing);this.eventCatcher=document.createElement("div");this.eventCatcher.style.position="absolute";this.eventCatcher.style.top="0px";this.eventCatcher.style.left="0px";
this.eventCatcher.style.background="red";this.eventCatcher.style.filter="alpha(opacity=0)";a.appendChild(this.eventCatcher)}else a=document.createElement("div"),b=document.createElement("div"),b.style.width="0px",b.style.height="0px",b.style.visibility="hidden",a.appendChild(b),this.setContainerDrawing(b),navigator.supportCanvas&&(a.toDataURL=this.svgToDataURL.bind(this));return a},svgToDataURL:function(){var a=document.createElement("canvas"),b=a.getContext("2d");a.setAttribute("width",Math.ceil(this.getLayoutWidth()),
null);a.setAttribute("height",Math.ceil(this.getLayoutHeight()),null);this.updateCanvas(b);return a.toDataURL.apply(a,arguments)},arrangeCore:function(a,b){var c=window.devicePixelRatio||1,d=1;void 0!==this.context&&(d=this.context.webkitBackingStorePixelRatio||this.context.mozBackingStorePixelRatio||this.context.msBackingStorePixelRatio||this.context.oBackingStorePixelRatio||this.context.backingStorePixelRatio||1);this.dpiRatio=c/d;this.getDrawing().setAttribute("width",Math.ceil(a*this.dpiRatio),
null);this.getDrawing().setAttribute("height",Math.ceil(b*this.dpiRatio),null);"vml"===this.canvasEngine&&(this.vmlDrawing.style.width=a+"px",this.vmlDrawing.style.height=b+"px",this.vmlDrawing.setAttribute("width",Math.ceil(a),null),this.vmlDrawing.setAttribute("height",Math.ceil(b),null),this.eventCatcher.style.width=a+"px",this.eventCatcher.style.height=b+"px");this.getIsVisible()&&this.getIsLoaded()&&this.update()},drawCore:function(){0!==this.getLayoutWidth()&&0!==this.getLayoutHeight()&&this.update()},
onInternalVisible:function(){Ui.CanvasElement.base.onInternalVisible.call(this);this.invalidateDraw()}});
Core.Object.extend("Core.SVG2DPath",{path:void 0,context:void 0,x:0,y:0,constructor:function(a){this.path=document.createElementNS(svgNS,"path");this.context=a.context;delete a.context},moveTo:function(a,b){this.path.pathSegList.appendItem(this.path.createSVGPathSegMovetoAbs(a,b));this.x=a;this.y=b},lineTo:function(a,b){this.path.pathSegList.appendItem(this.path.createSVGPathSegLinetoAbs(a,b));this.x=a;this.y=b},quadraticCurveTo:function(a,b,c,d){this.path.pathSegList.appendItem(this.path.createSVGPathSegCurvetoQuadraticAbs(c,
d,a,b));this.x=c;this.y=d},bezierCurveTo:function(a,b,c,d,e,g){this.path.pathSegList.appendItem(this.path.createSVGPathSegCurvetoCubicAbs(e,g,a,b,c,d));this.x=e;this.y=g},arcTo:function(a,b,c,d,e,g,f){a=(this.x-a)*(d-b)-(this.y-b)*(c-a);void 0===f&&(f=g,g=e);this.path.pathSegList.appendItem(this.path.createSVGPathSegArcAbs(c,d,e,g,f*Math.PI/180,0,0>a?1:0));this.x=c;this.y=d},closePath:function(){this.path.pathSegList.appendItem(this.path.createSVGPathSegClosePath())},rect:function(a,b,c,d){this.moveTo(a,
b);this.lineTo(a+c,b);this.lineTo(a+c,b+d);this.lineTo(a,b+d)},arc:function(a,b,c,d,e,g){this.ellipse(a,b,c,c,0,d,e,g)},ellipse:function(a,b,c,d,e,g,f,h){0===e&&0===g&&f===2*Math.PI?(this.moveTo(a,b+d),this.arcTo(a+c,b+d,a+c,b,c,d,Math.PI/2),this.arcTo(a+c,b-d,a,b-d,c,d,Math.PI/2),this.arcTo(a-c,b-d,a-c,b,c,d,Math.PI/2),this.arcTo(a-c,b+d,a,b+d,c,d,Math.PI/2)):(this.moveTo(a,b),this.lineTo(a,b+d))},roundRect:function(a,b,c,d,e,g,f,h,k){!0===k?(this.moveTo(a+e,b),0<e&&this.arcTo(a,b,a,b+e,e,e,Math.PI/
4),this.lineTo(a,b+d-h),0<h&&this.arcTo(a,b+d,a+h,b+d,h,h,Math.PI/4),this.lineTo(a+c-f,b+d),0<f&&this.arcTo(a+c,b+d,a+c,b+d-f,f,f,Math.PI/4),this.lineTo(a+c,b+g),0<g&&this.arcTo(a+c,b,a+c-g,b,g,g,Math.PI/4)):(this.moveTo(a,b+e),0<e&&this.arcTo(a,b,a+e,b,e,e,Math.PI/4),this.lineTo(a+c-g,b),0<g&&this.arcTo(a+c,b,a+c,b+g,g,g,Math.PI/4),this.lineTo(a+c,b+d-f),0<f&&this.arcTo(a+c,b+d,a+c-f,b+d,f,f,Math.PI/4),this.lineTo(a+h,b+d),0<h&&this.arcTo(a,b+d,a,b+d-h,h,h,Math.PI/4))},getSVG:function(){return this.path.cloneNode()}});
Core.Object.extend("Core.SVGGradient",{gradient:void 0,id:void 0,constructor:function(a){this.gradient=document.createElementNS(svgNS,"linearGradient");this.gradient.setAttributeNS(null,"gradientUnits","userSpaceOnUse");this.gradient.setAttributeNS(null,"x1",a.x0);this.gradient.setAttributeNS(null,"y1",a.y0);this.gradient.setAttributeNS(null,"x2",a.x1);this.gradient.setAttributeNS(null,"y2",a.y1);delete a.x0;delete a.y0;delete a.x1;delete a.y1;this.id="_grad"+ ++Core.SVGGradient.counter;this.gradient.setAttributeNS(null,
"id",this.id)},getId:function(){return this.id},addColorStop:function(a,b){var c=document.createElementNS(svgNS,"stop");c.setAttributeNS(null,"offset",a);c.style.stopColor=b;b=Ui.Color.create(b);c.style.stopOpacity=b.getRgba().a;this.gradient.appendChild(c)},getSVG:function(){return this.gradient}},{},{counter:0});
Core.Object.extend("Core.SVG2DContext",{fillStyle:"black",strokeStyle:"black",lineWidth:1,globalAlpha:1,currentTransform:void 0,font:"default 10px sans-serif",textAlign:"start",textBaseLine:"alphabetic",direction:"inherit",clipId:void 0,document:void 0,currentPath:void 0,g:void 0,defs:void 0,states:void 0,constructor:function(a){this.document=a.document;delete a.document;this.g=document.createElementNS(svgNS,"g");this.currentTransform=this.document.createSVGMatrix();this.states=[];this.defs=document.createElementNS(svgNS,
"defs");this.g.appendChild(this.defs)},beginPath:function(){this.currentPath=new Core.SVG2DPath({context:this})},moveTo:function(a,b){this.currentPath.moveTo(a,b)},lineTo:function(a,b){this.currentPath.lineTo(a,b)},quadraticCurveTo:function(a,b,c,d){this.currentPath.quadraticCurveTo(a,b,c,d)},bezierCurveTo:function(a,b,c,d,e,g){this.currentPath.bezierCurveTo(a,b,c,d,e,g)},rect:function(a,b,c,d){this.currentPath.rect(a,b,c,d)},arc:function(a,b,c,d,e,g){this.currentPath.arc(a,b,c,d,e,g)},ellipse:function(a,
b,c,d,e,g,f,h){this.currentPath.ellipse(a,b,c,d,e,g,f,h)},roundRect:function(a,b,c,d,e,g,f,h,k){this.currentPath.roundRect(a,b,c,d,e,g,f,h,k)},closePath:function(){this.currentPath.closePath()},fill:function(){var a=this.currentPath.getSVG();if(Core.SVGGradient.hasInstance(this.fillStyle)){var b=this.fillStyle.getId();this.defs.appendChild(this.fillStyle.getSVG());a.style.fill="url(#"+b+")"}else a.style.fill=this.fillStyle;void 0!==this.clipId&&a.setAttributeNS(null,"clip-path","url(#"+this.clipId+
")");a.style.opacity=this.globalAlpha;a.transform.baseVal.initialize(this.document.createSVGTransformFromMatrix(this.currentTransform));this.g.appendChild(a)},stroke:function(){var a=this.currentPath.getSVG();a.style.stroke=this.strokeStyle;a.style.fill="none";a.style.opacity=this.globalAlpha;a.style.strokeWidth=this.lineWidth;void 0!==this.clipId&&a.setAttributeNS(null,"clip-path","url(#"+this.clipId+")");a.setAttributeNS(null,"pointer-events","none");a.transform.baseVal.initialize(this.document.createSVGTransformFromMatrix(this.currentTransform));
this.g.appendChild(a)},clip:function(){var a=document.createElementNS(svgNS,"clipPath");this.clipId="_clip"+ ++Core.SVG2DContext.counter;a.setAttributeNS(null,"id",this.clipId);a.appendChild(this.currentPath.getSVG());this.defs.appendChild(a)},resetClip:function(){this.clipId=void 0},drawImage:function(a,b,c,d,e,g,f,h,k){var m=a.naturalWidth,l=a.naturalHeight;void 0===d?(g=b,f=c,c=b=0,d=m,e=l,h=m,k=l):void 0===g&&(g=b,f=c,h=d,k=e,c=b=0,d=m,e=l);if(0===b&&0===c&&d===m&&e==l){var n=document.createElementNS(svgNS,
"image");void 0!==this.clipId&&n.setAttributeNS(null,"clip-path","url(#"+this.clipId+")");n.style.opacity=this.globalAlpha;n.setAttributeNS(null,"pointer-events","none");n.href.baseVal=a.src;n.setAttributeNS(null,"x",g);n.setAttributeNS(null,"y",f);n.setAttributeNS(null,"width",h);n.setAttributeNS(null,"height",k);n.transform.baseVal.initialize(this.document.createSVGTransformFromMatrix(this.currentTransform));this.g.appendChild(n)}else{var p=document.createElementNS(svgNS,"pattern"),r="_pat"+ ++Core.SVG2DContext.counter;
p.setAttributeNS(null,"id",r);p.setAttributeNS(null,"patternUnits","userSpaceOnUse");p.setAttributeNS(null,"x",g);p.setAttributeNS(null,"y",f);p.setAttributeNS(null,"width",h);p.setAttributeNS(null,"height",k);n=document.createElementNS(svgNS,"image");n.href.baseVal=a.src;n.setAttributeNS(null,"x",-b*h/d);n.setAttributeNS(null,"y",-c*k/e);n.setAttributeNS(null,"width",m*h/d);n.setAttributeNS(null,"height",l*k/e);p.appendChild(n);this.defs.appendChild(p);a=document.createElementNS(svgNS,"path");a.setAttributeNS(null,
"pointer-events","none");a.pathSegList.appendItem(a.createSVGPathSegMovetoAbs(g,f));a.pathSegList.appendItem(a.createSVGPathSegLinetoAbs(g+h,f));a.pathSegList.appendItem(a.createSVGPathSegLinetoAbs(g+h,f+k));a.pathSegList.appendItem(a.createSVGPathSegLinetoAbs(g,f+k));a.pathSegList.appendItem(a.createSVGPathSegClosePath());a.style.fill="url(#"+r+")";void 0!==this.clipId&&a.setAttributeNS(null,"clip-path","url(#"+this.clipId+")");a.style.opacity=this.globalAlpha;a.transform.baseVal.initialize(this.document.createSVGTransformFromMatrix(this.currentTransform));
this.g.appendChild(a)}},fillText:function(a,b,c,d){d=document.createElementNS(svgNS,"text");a=document.createTextNode(a);d.appendChild(a);d.style.fill=this.fillStyle;d.style.opacity=this.globalAlpha;d.setAttributeNS(null,"pointer-events","none");d.transform.baseVal.initialize(this.document.createSVGTransformFromMatrix(this.currentTransform));"center"==this.textAlign?d.style.textAnchor="middle":"end"==this.textAlign?d.style.textAnchor="end":"right"==this.textAlign&&(d.style.textAnchor="end");a=this.parseFont(this.font);
d.style.fontFamily=a.family;d.style.fontSize=a.size;d.style.fontStyle=a.style;navigator.isWebkit?"top"===this.textBaseline?d.style.alignmentBaseline="text-before-edge":"hanging"===this.textBaseline?d.style.alignmentBaseline="text-before-edge":"middle"===this.textBaseline?d.style.alignmentBaseline="central":"alphabetic"===this.textBaseline?d.style.alignmentBaseline="alphabetic":"ideographic"===this.textBaseline?d.style.alignmentBaseline="ideographic":"bottom"===this.textBaseline&&(d.style.alignmentBaseline=
"text-after-edge"):(a=parseInt(a.size),"top"===this.textBaseline?c+=0.8*a:"hanging"===this.textBaseline?c+=0.8*a:"middle"===this.textBaseline?c+=0.8*a/2:"bottom"===this.textBaseline&&(c+=-0.2*a));d.setAttributeNS(null,"x",b);d.setAttributeNS(null,"y",c);this.g.appendChild(d)},strokeText:function(a,b,c,d){},save:function(){this.states.push({fillStyle:this.fillStyle,strokeStyle:this.strokeStyle,lineWidth:this.lineWidth,globalAlpha:this.globalAlpha,matrix:{a:this.currentTransform.a,b:this.currentTransform.b,
c:this.currentTransform.c,d:this.currentTransform.d,e:this.currentTransform.e,f:this.currentTransform.f},font:this.font,textAlign:this.textAlign,textBaseLine:this.textBaseLine,direction:this.direction,clipId:this.clipId})},restore:function(){if(0<this.states.length){var a=this.states.pop();this.fillStyle=a.fillStyle;this.strokeStyle=a.strokeStyle;this.lineWidth=a.lineWidth;this.globalAlpha=a.globalAlpha;this.currentTransform=this.document.createSVGMatrix();this.currentTransform.a=a.matrix.a;this.currentTransform.b=
a.matrix.b;this.currentTransform.c=a.matrix.c;this.currentTransform.d=a.matrix.d;this.currentTransform.e=a.matrix.e;this.currentTransform.f=a.matrix.f;this.font=a.font;this.textAlign=a.textAlign;this.textBaseLine=a.textBaseLine;this.direction=a.direction;this.clipId=a.clipId}},scale:function(a,b){this.currentTransform=this.currentTransform.scaleNonUniform(a,void 0===b?a:b)},rotate:function(a){this.currentTransform=this.currentTransform.rotate(180*a/Math.PI)},translate:function(a,b){this.currentTransform=
this.currentTransform.translate(a,b)},transform:function(a,b,c,d,e,g){var f=this.document.createSVGMatrix();f.a=a;f.b=b;f.c=c;f.d=d;f.e=e;f.f=g;this.currentTransform.multiply(f)},setTransform:function(a,b,c,d,e,g){this.currentTransform.a=a;this.currentTransform.b=b;this.currentTransform.c=c;this.currentTransform.d=d;this.currentTransform.e=e;this.currentTransform.f=g},resetTransform:function(){this.currentTransform=this.document.createSVGMatrix()},clearRect:function(a,b,c,d){},fillRect:function(a,
b,c,d){this.beginPath();this.currentPath.rect(a,b,c,d);this.closePath();this.fill()},strokeRect:function(a,b,c,d){this.beginPath();this.currentPath.rect(a,b,c,d);this.closePath();this.stroke()},createLinearGradient:function(a,b,c,d){return new Core.SVGGradient({x0:a,y0:b,x1:c,y1:d})},svgPath:function(a){var b=0,c=0,d=new Ui.SvgParser({path:a});d.next();for(this.beginPath();!d.isEnd();){var e=d.getCmd();d.isCmd()&&d.next();if("m"==e)d.setCmd("l"),b+=d.getCurrent(),d.next(),c+=d.getCurrent(),d.next(),
this.moveTo(b,c);else if("M"==e)d.setCmd("L"),b=d.getCurrent(),d.next(),c=d.getCurrent(),d.next(),this.moveTo(b,c);else if("l"==e)b+=d.getCurrent(),d.next(),c+=d.getCurrent(),d.next(),this.lineTo(b,c);else if("L"==e)b=d.getCurrent(),d.next(),c=d.getCurrent(),d.next(),this.lineTo(b,c);else if("v"==e)c+=d.getCurrent(),d.next(),this.lineTo(b,c);else if("V"==e)c=d.getCurrent(),d.next(),this.lineTo(b,c);else if("h"==e)b+=d.getCurrent(),d.next(),this.lineTo(b,c);else if("H"==e)b=d.getCurrent(),d.next(),
this.lineTo(b,c);else if("c"==e){e=b+d.getCurrent();d.next();var g=c+d.getCurrent();d.next();var f=b+d.getCurrent();d.next();var h=c+d.getCurrent();d.next();b+=d.getCurrent();d.next();c+=d.getCurrent();d.next();this.bezierCurveTo(e,g,f,h,b,c)}else if("C"==e)e=d.getCurrent(),d.next(),g=d.getCurrent(),d.next(),f=d.getCurrent(),d.next(),h=d.getCurrent(),d.next(),b=d.getCurrent(),d.next(),c=d.getCurrent(),d.next(),this.bezierCurveTo(e,g,f,h,b,c);else if("s"==e)e=b+d.getCurrent(),d.next(),g=c+d.getCurrent(),
d.next(),f=e,h=g,b+=d.getCurrent(),d.next(),c+=d.getCurrent(),d.next(),this.bezierCurveTo(e,g,f,h,b,c),this.lineTo(b,c);else if("S"==e)e=d.getCurrent(),d.next(),g=d.getCurrent(),d.next(),f=e,h=g,b=d.getCurrent(),d.next(),c=d.getCurrent(),d.next(),this.bezierCurveTo(e,g,f,h,b,c);else if("q"==e)e=b+d.getCurrent(),d.next(),g=c+d.getCurrent(),d.next(),f=b+d.getCurrent(),d.next(),h=c+d.getCurrent(),d.next(),this.quadraticCurveTo(e,g,f,h),b=f,c=h;else if("Q"==e)e=d.getCurrent(),d.next(),g=d.getCurrent(),
d.next(),f=d.getCurrent(),d.next(),h=d.getCurrent(),d.next(),this.quadraticCurveTo(e,g,f,h),b=f,c=h;else if("z"==e||"Z"==e)this.closePath();else throw"Invalid SVG path cmd: "+e+" ("+a+")";}},parseFont:function(a){a=a.split(" ");if(1===a.length)return{style:"default",weight:"normal",size:"16px",family:a[0]};if(2===a.length)return{style:"default",weight:"normal",size:a[0],family:a[1]};if(3===a.length)return{style:"default",weight:a[0],size:a[1],family:a[2]};if(4===a.length)return{style:a[0],weight:a[1],
size:a[2],family:a[3]}},roundRectFilledShadow:function(a,b,c,d,e,g,f,h,k,m,l){this.save();for(var n=l.getRgba(),p=0;p<m;p++)k?1==m?l=1:(l=(p+1)/m,l*=l):l=(p+1)/(m+1),l=new Ui.Color({r:n.r,g:n.g,b:n.b,a:n.a*l}),this.fillStyle=l.getCssRgba(),k?(this.beginPath(),this.roundRect(a,b,c,d,e,g,f,h),this.roundRect(a+m-p,b+m-p,c-2*(m-p),d-2*(m-p),e,g,f,h,!0)):(this.beginPath(),this.roundRect(a+p,b+p,c-2*p,d-2*p,e,g,f,h)),this.closePath(),this.fill();this.restore()},getSVG:function(){return this.g}},{},{counter:0});
navigator.supportCanvas&&(CanvasRenderingContext2D.prototype.roundRect=Core.SVG2DPath.prototype.roundRect,CanvasRenderingContext2D.prototype.svgPath=Core.SVG2DContext.prototype.svgPath,CanvasRenderingContext2D.prototype.roundRectFilledShadow=Core.SVG2DContext.prototype.roundRectFilledShadow);Ui.CanvasElement.extend("Ui.Shape",{fill:void 0,path:void 0,scale:1,constructor:function(a){},setScale:function(a){this.scale!=a&&(this.scale=a,this.invalidateDraw())},getFill:function(){return void 0===this.fill?Ui.Color.create(this.getStyleProperty("color")):this.fill},setFill:function(a){this.fill!==a&&("string"===typeof a?a=Ui.Color.create(a):void 0!==a&&(a=Ui.Element.create(a)),this.fill=a,this.invalidateDraw())},setPath:function(a){this.path!=a&&(this.path=a,this.invalidateDraw())}},{onStyleChange:function(){this.invalidateDraw()},
updateCanvas:function(a){if(void 0!==this.path){1!=this.scale&&a.scale(this.scale,this.scale);a.svgPath(this.path);var b=this.getFill();Ui.Color.hasInstance(b)?a.fillStyle=b.getCssRgba():Ui.LinearGradient.hasInstance(b)&&(a.fillStyle=b.getCanvasGradient(a,this.getLayoutWidth(),this.getLayoutHeight()));a.fill()}}},{style:{color:new Ui.Color({r:0,g:0,b:0})}});Ui.Container.extend("Ui.LBox",{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,constructor:function(a){},setContent:function(a){if(1!==this.getChildren().length||a!==this.getFirstChild()){for(;void 0!==this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!==a&&"object"===typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.append(a[b]);else this.append(a)}},setPadding:function(a){this.setPaddingTop(a);this.setPaddingBottom(a);this.setPaddingLeft(a);this.setPaddingRight(a)},
getPaddingTop:function(){return this.paddingTop},setPaddingTop:function(a){this.paddingTop!=a&&(this.paddingTop=a,this.invalidateMeasure())},getPaddingBottom:function(){return this.paddingBottom},setPaddingBottom:function(a){this.paddingBottom!=a&&(this.paddingBottom=a,this.invalidateMeasure())},getPaddingLeft:function(){return this.paddingLeft},setPaddingLeft:function(a){this.paddingLeft!=a&&(this.paddingLeft=a,this.invalidateMeasure())},getPaddingRight:function(){return this.paddingRight},setPaddingRight:function(a){this.paddingRight!=
a&&(this.paddingRight=a,this.invalidateMeasure())},append:function(a){this.appendChild(Ui.Element.create(a))},prepend:function(a){this.prependChild(Ui.Element.create(a))},remove:function(a){this.removeChild(a)}},{measureCore:function(a,b){for(var c=this.getPaddingLeft(),d=this.getPaddingRight(),e=this.getPaddingTop(),g=this.getPaddingBottom(),f=Math.max(a-(c+d),0),h=Math.max(b-(e+g),0),k=0,m=0,l=0;l<this.getChildren().length;l++){var n=this.getChildren()[l].measure(f,h);n.width>k&&(k=n.width);n.height>
m&&(m=n.height)}return{width:k+(c+d),height:m+(e+g)}},arrangeCore:function(a,b){var c=this.getPaddingLeft(),d=this.getPaddingRight(),e=this.getPaddingTop(),g=this.getPaddingBottom();a-=c+d;b-=e+g;for(d=0;d<this.getChildren().length;d++)this.getChildren()[d].arrange(c,e,a,b)}});Ui.Container.extend("Ui.Box",{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,uniform:!1,spacing:0,star:0,vertical:!0,constructor:function(a){},setContent:function(a){for(;void 0!=this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!=a&&"object"==typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.append(a[b]);else this.append(a)},getOrientation:function(){return this.vertical?"vertical":"horizontal"},setOrientation:function(a){var b=!0;"vertical"!=a&&(b=!1);
this.vertical!=b&&(this.vertical=b,this.invalidateMeasure())},setPadding:function(a){this.setPaddingTop(a);this.setPaddingBottom(a);this.setPaddingLeft(a);this.setPaddingRight(a)},getPaddingTop:function(){return this.paddingTop},setPaddingTop:function(a){this.paddingTop!=a&&(this.paddingTop=a,this.invalidateMeasure())},getPaddingBottom:function(){return this.paddingBottom},setPaddingBottom:function(a){this.paddingBottom!=a&&(this.paddingBottom=a,this.invalidateMeasure())},getPaddingLeft:function(){return this.paddingLeft},
setPaddingLeft:function(a){this.paddingLeft!=a&&(this.paddingLeft=a,this.invalidateMeasure())},getPaddingRight:function(){return this.paddingRight},setPaddingRight:function(a){this.paddingRight!=a&&(this.paddingRight=a,this.invalidateMeasure())},getUniform:function(){return this.uniform},setUniform:function(a){this.uniform!=a&&(this.uniform=a,this.invalidateMeasure())},getSpacing:function(){return this.spacing},setSpacing:function(a){this.spacing!=a&&(this.spacing=a,this.invalidateMeasure())},append:function(a,
b){a=Ui.Element.create(a);Ui.Box.setResizable(a,!0===b);this.appendChild(a)},prepend:function(a,b){a=Ui.Element.create(a);Ui.Box.setResizable(a,!0===b);this.prependChild(a)},insertAt:function(a,b,c){a=Ui.Element.create(a);Ui.Box.setResizable(a,!0===c);this.insertChildAt(a,b)},moveAt:function(a,b){this.moveChildAt(a,b)},remove:function(a){this.removeChild(a)},measureUniform:function(a,b){for(var c=this.vertical?b:a,d=this.vertical?a:b,c=c-this.spacing*(this.getChildren().length-1),e=c/this.getChildren().length,
g=0,f=0,h=0,k=!0;k;){for(var m=0;m<this.getChildren().length;m++){var l=this.getChildren()[m];Ui.Box.getResizable(l)&&g++;l=this.vertical?l.measure(d,e):l.measure(e,d);(this.vertical?l.width:l.height)>h&&(h=this.vertical?l.width:l.height);(this.vertical?l.height:l.width)>f&&(f=this.vertical?l.height:l.width)}h>d||f>e?(f>e&&(e=f),d=h,g=f=h=0):k=!1}0<g&&f*this.getChildren().length<c&&(f=c/this.getChildren().length);this.uniformSize=f;c=this.uniformSize*this.getChildren().length;c+=this.spacing*(this.getChildren().length-
1);return this.vertical?{width:h,height:c}:{width:c,height:h}},measureNonUniformVertical:function(a,b){var c=a,d;d=b-this.spacing*(this.getChildren().length-1);for(var e=0,g=0,f=0,h=!0,k=0;h;){for(var m=0;m<this.getChildren().length;m++){var l=this.getChildren()[m],n=l.measure(c,0);n.width>g&&(g=n.width);Ui.Box.getResizable(l)?(l.boxStarDone=!1,e++):f+=n.height}g>c?(c=g,e=f=g=0):h=!1}if(0<e){d-=f;h=!0;k=d/e;do for(h=!0,m=0;m<this.getChildren().length;m++)if(l=this.getChildren()[m],Ui.Box.getResizable(l)&&
!l.boxStarDone)if(l.getMeasureHeight()>k){l.boxStarDone=!0;h=!1;d-=l.getMeasureHeight();f+=l.getMeasureHeight();e--;k=d/e;break}else l.measure(c,k);while(!h)}f+=this.spacing*(this.getChildren().length-1);0<e?(f+=k*e,this.star=k):this.star=0;return{width:g,height:f}},measureNonUniformHorizontal:function(a,b){var c,d=b;c=a-this.spacing*(this.getChildren().length-1);for(var e,g,f,h=!0;h;){for(var k=f=g=e=0;k<this.getChildren().length;k++){var m=this.getChildren()[k];if(Ui.Box.getResizable(m))m.boxStarDone=
!1,e++;else{var l=m.measure(0,d);l.height>f&&(f=l.height);g+=l.width}}if(0<e){var n=c-g,p=!0,r=n/e;do for(p=!0,k=0;k<this.getChildren().length;k++)if(m=this.getChildren()[k],Ui.Box.getResizable(m)&&!m.boxStarDone&&(l=m.measure(r,d),l.height>f&&(f=l.height),l.width>r)){m.boxStarDone=!0;p=!1;n-=l.width;g+=l.width;e--;r=n/e;break}while(!p)}f>d?d=f:h=!1}g+=this.spacing*(this.getChildren().length-1);0<e?(g+=r*e,this.star=r):this.star=0;return{width:g,height:f}}},{measureCore:function(a,b){var c=this.getPaddingLeft(),
d=this.getPaddingRight(),e=this.getPaddingTop(),g=this.getPaddingBottom(),f=Math.max(0,a-(c+d)),h=Math.max(0,b-(e+g)),f=this.uniform?this.measureUniform(f,h):this.vertical?this.measureNonUniformVertical(f,h):this.measureNonUniformHorizontal(f,h);f.width+=c+d;f.height+=e+g;return f},arrangeCore:function(a,b){var c=this.paddingLeft,d=this.paddingTop,e=this.paddingBottom;a-=c+this.paddingRight;b-=d+e;for(var e=this.vertical?d:c,g=0;g<this.getChildren().length;g++){var f=this.getChildren()[g];0!=g&&(e+=
this.spacing);this.uniform?(this.vertical?f.arrange(c,e,a,this.uniformSize):f.arrange(e,d,this.uniformSize,b),e+=this.uniformSize):Ui.Box.getResizable(f)&&(this.vertical?f.getMeasureHeight():f.getMeasureWidth())<this.star?(this.vertical?f.arrange(c,e,a,this.star):f.arrange(e,d,this.star,b),e+=this.star):this.vertical?(f.arrange(c,e,a,f.getMeasureHeight()),e+=f.getMeasureHeight()):(f.arrange(e,d,f.getMeasureWidth(),b),e+=f.getMeasureWidth())}}},{getResizable:function(a){return a["Ui.Box.resizable"]?
!0:!1},setResizable:function(a,b){Ui.Box.getResizable(a)!=b&&(a["Ui.Box.resizable"]=b,a.invalidateMeasure())}});Ui.Box.extend("Ui.VBox",{constructor:function(a){this.setOrientation("vertical")}});Ui.Box.extend("Ui.HBox",{constructor:function(a){this.setOrientation("horizontal")}});Ui.Container.extend("Ui.Flow",{uniform:!1,uniformWidth:void 0,uniformHeight:void 0,itemAlign:"left",spacing:0,constructor:function(a){},setContent:function(a){for(;void 0!=this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!==a&&"object"==typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.appendChild(Ui.Element.create(a[b]));else this.appendChild(Ui.Element.create(a))},getSpacing:function(){return this.spacing},setSpacing:function(a){this.spacing!=a&&(this.spacing=
a,this.invalidateMeasure(),this.invalidateArrange())},getItemAlign:function(){return this.itemAlign},setItemAlign:function(a){a!=this.itemAlign&&(this.itemAlign=a,this.invalidateMeasure(),this.invalidateArrange())},getUniform:function(){return this.uniform},setUniform:function(a){this.uniform!=a&&(this.uniform=a,this.invalidateMeasure())},append:function(a){this.appendChild(a)},prepend:function(a){this.prependChild(a)},insertAt:function(a,b){this.insertChildAt(a,b)},moveAt:function(a,b){this.moveChildAt(a,
b)},remove:function(a){this.removeChild(a)},measureChildrenNonUniform:function(a,b){for(var c={pos:0,y:0,width:0,height:0},d=0,e=0,g=0,f=0,h=0,k=0;k<this.getChildren().length;k++){var m=this.getChildren()[k],l=m.measure(a,b);0!=d&&d+l.width>a&&(c.width=d-this.spacing,c.height=f,d=0,e+=f+this.spacing,f=0,g++,c={pos:g,y:e,width:0,height:0});m.flowLine=c;m.flowLineX=d;d+=l.width+this.spacing;l.height>f&&(f=l.height);d>h&&(h=d)}c.width=d;c.height=f;return{width:h,height:e+f}},measureChildrenUniform:function(a,
b){for(var c=0,d=0,e=0;e<this.getChildren().length;e++){var g=this.getChildren()[e].measure(a,b);g.width>c&&(c=g.width);g.height>d&&(d=g.height)}for(var g=Math.max(Math.floor((a+this.spacing)/(c+this.spacing)),1),f=Math.ceil(this.getChildren().length/g),e=0;e<this.getChildren().length;e++)this.getChildren()[e].measure(c,d);this.uniformWidth=c;this.uniformHeight=d;return{width:c*g+(g-1)*this.spacing,height:f*d+(f-1)*this.spacing}}},{measureCore:function(a,b){return 0==this.getChildren().length?{width:0,
height:0}:this.uniform?this.measureChildrenUniform(a,b):this.measureChildrenNonUniform(a,b)},arrangeCore:function(a,b){if(this.uniform)if("left"==this.itemAlign)for(var c=0,d=0,e=0;e<this.getChildren().length;e++){var g=this.getChildren()[e];c+this.uniformWidth>a&&(c=0,d+=this.uniformHeight+this.spacing);g.arrange(c,d,this.uniformWidth,this.uniformHeight);c+=this.uniformWidth+this.spacing}else{if("right"==this.itemAlign)for(var f=Math.max(Math.floor((a+this.spacing)/(this.uniformWidth+this.spacing)),
1),h=f*this.uniformWidth+(f-1)*this.spacing,c=this.getChildren().length<f?a-(this.getChildren().length*(this.uniformWidth+this.spacing)-this.spacing):a-h,e=d=0;e<this.getChildren().length;e++)g=this.getChildren()[e],c+this.uniformWidth>a&&(c=this.getChildren().length-e<f?a-((this.getChildren().length-e)*(this.uniformWidth+this.spacing)-this.spacing):a-h,d+=this.uniformHeight+this.spacing),g.arrange(c,d,this.uniformWidth,this.uniformHeight),c+=this.uniformWidth+this.spacing}else for(e=0;e<this.getChildren().length;e++)g=
this.getChildren()[e],"left"==this.itemAlign?g.arrange(g.flowLineX,g.flowLine.y,g.getMeasureWidth(),g.flowLine.height):g.arrange(g.flowLineX+(a-g.flowLine.width),g.flowLine.y,g.getMeasureWidth(),g.flowLine.height)}});Core.Object.extend("Ui.SFlowState",{x:0,y:0,width:0,height:0,xpos:0,ypos:0,zones:void 0,currentZone:void 0,boxes:void 0,lineHeight:0,drawCount:0,drawCmd:void 0,drawWidth:0,drawSpaceWidth:0,render:!1,centerstatus:!1,spacing:0,align:"left",constructor:function(a){this.width=a.width;delete a.width;this.render=a.render;delete a.render;"spacing"in a&&(this.spacing=a.spacing,delete a.spacing);"align"in a&&(this.align=a.align,delete a.align);this.zones=[{xstart:0,xend:this.width}];this.currentZone=0;this.boxes=
[];this.drawCmd=[]},getSize:function(){this.flush();return{width:this.width,height:this.ypos}},append:function(a){var b=Ui.SFlow.getFloat(a),c=a.measure(this.width,0);if("none"===b)for(;;){var b=this.zones[this.currentZone],d=!1;b.xstart===this.xpos&&(d=!0);if(this.xpos+c.width+(d?0:this.spacing)<=b.xend){this.pushDraw({width:c.width,height:c.height,spaceWidth:d?0:this.spacing,el:a});d||(this.xpos+=this.spacing);this.xpos+=c.width;c.height>this.lineHeight&&(this.lineHeight=c.height);break}else this.nextZone()}else if("left"===
b)for(;;)if(b=this.zones[this.currentZone],d=!1,0===this.xpos&&(d=!0),d&&c.width<=b.xend-this.xpos){this.render&&a.arrange(this.xpos,this.ypos,c.width,c.height);this.insertBox({x:this.xpos,y:this.ypos,width:c.width,height:c.height});break}else this.nextZone();else if("right"===b)for(;;)if(b=this.zones[this.currentZone],d=!1,this.width==b.xend&&(d=!0),d&&c.width<=b.xend-this.xpos){this.render&&a.arrange(b.xend-c.width,this.ypos,c.width,c.height);this.insertBox({x:b.xend-c.width,y:this.ypos,width:c.width,
height:c.height});break}else this.nextZone();else if(DEBUG)throw"Invalid Ui.SFlow float policy ("+b+")";},flushDraw:function(){if(this.render&&0<this.drawCmd.length){var a=this.zones[this.currentZone],b=a.xstart,c=0;"right"===this.align?b+=a.xend-a.xstart-(this.drawWidth+this.drawSpaceWidth):"center"===this.align?b+=(a.xend-a.xstart-(this.drawWidth+this.drawSpaceWidth))/2:"stretch"===this.align&&(c=(a.xend-a.xstart-(this.drawWidth+this.drawSpaceWidth))/this.drawCmd.length);for(a=0;a<this.drawCmd.length;a++){var d=
this.drawCmd[a];d.el.arrange(b+d.spaceWidth,this.ypos,d.width+c,this.lineHeight);b+=d.width+d.spaceWidth+c}}this.drawCmd=[];this.drawSpaceWidth=this.drawCount=this.drawWidth=0},pushDraw:function(a){this.drawCmd.push(a);this.drawCount++;this.drawWidth+=a.width;this.drawSpaceWidth+=a.spaceWidth},insertBox:function(a){this.boxes.push(a);this.calculZone()},calculZone:function(){this.zones=[{xstart:0,xend:this.width}];for(var a=0;a<this.boxes.length;a++){var b=this.boxes[a];if(!(this.ypos+this.lineHeight<
b.y||this.ypos>=b.y+b.height)){for(var c=[],d=0;d<this.zones.length;d++){var e=this.zones[d];b.x<=e.xstart&&b.x+b.width<e.xend?c.push({xstart:b.x+b.width,xend:e.xend}):b.x<e.xend&&b.x+b.width>=e.xend?c.push({xstart:e.xstart,xend:b.x}):b.x>e.xstart&&b.x+b.width<e.xend?(c.push({xstart:e.xstart,xend:b.x}),c.push({xstart:b.x+b.width,xend:e.xend})):b.x<=e.xstart&&b.x+b.width>=e.xend||c.push({xstart:e.xstart,xend:e.xend})}this.zones=c}}for(this.currentZone=0;this.currentZone<this.zones.length&&!(e=this.zones[this.currentZone],
this.xpos>=e.xstart&&this.xpos<=e.xend);this.currentZone++);if(this.currentZone>=this.zones.length){this.currentZone=-1;for(this.currentZone=0;this.currentZone<this.zones.length;this.currentZone++)if(e=this.zones[this.currentZone],e.xstart>=this.xpos){this.xpos=e.xstart;break}this.currentZone>=this.zones.length&&this.nextLine()}},flush:function(){for(0!=this.drawCount&&this.nextLine();;){var a=this.zones[this.currentZone];if(a.xstart==this.xpos&&a.xend==this.xpos+this.width)break;else this.nextZone()}},
nextLine:function(){this.flushDraw();do if(0<this.lineHeight)this.ypos+=this.lineHeight+this.spacing,this.lineHeight=0,this.calculZone();else if(0<this.boxes.length){for(var a=Number.MAX_VALUE,b=0;b<this.boxes.length;b++){var c=this.boxes[b];this.ypos<c.y+c.height&&a>c.y+c.height&&(a=c.y+c.height)}a!==Number.MAX_VALUE&&(this.ypos=a+this.spacing);this.calculZone()}while(0==this.zones.length);this.currentZone=0;this.xpos=this.zones[0].xstart},nextZone:function(){this.flushDraw();this.currentZone>=this.zones.length-
1?this.nextLine():(this.currentZone++,this.xpos=this.zones[this.currentZone].xstart)}});
Ui.Container.extend("Ui.SFlow",{uniform:!1,uniformWidth:void 0,uniformHeight:void 0,itemAlign:"left",spacing:0,constructor:function(a){},setContent:function(a){for(;void 0!=this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!==a&&"object"==typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.appendChild(Ui.Element.create(a[b]));else this.appendChild(Ui.Element.create(a))},getSpacing:function(){return this.spacing},setSpacing:function(a){this.spacing!=a&&(this.spacing=
a,this.invalidateMeasure(),this.invalidateArrange())},getItemAlign:function(){return this.itemAlign},setItemAlign:function(a){a!=this.itemAlign&&(this.itemAlign=a,this.invalidateMeasure(),this.invalidateArrange())},getUniform:function(){return this.uniform},setUniform:function(a){this.uniform!=a&&(this.uniform=a,this.invalidateMeasure())},append:function(a,b){this.appendChild(a);b&&Ui.SFlow.setFloat(a,b)},prepend:function(a,b){this.prependChild(a);b&&Ui.SFlow.setFloat(a,b)},insertAt:function(a,b,
c){this.insertChildAt(a,b);c&&Ui.SFlow.setFloat(a,c)},moveAt:function(a,b){this.moveChildAt(a,b)},remove:function(a){this.removeChild(a)},measureChildrenNonUniform:function(a,b){for(var c={pos:0,y:0,width:0,height:0},d=0,e=0,g=0,f=0,h=0,k=0;k<this.getChildren().length;k++){var m=this.getChildren()[k],l=m.measure(a,b);0!=d&&d+l.width>a&&(c.width=d-this.spacing,c.height=f,d=0,e+=f+this.spacing,f=0,g++,c={pos:g,y:e,width:0,height:0});m.flowLine=c;m.flowLineX=d;d+=l.width+this.spacing;l.height>f&&(f=
l.height);d>h&&(h=d)}c.width=d;c.height=f;return{width:h,height:e+f}},measureChildrenUniform:function(a,b){for(var c=0,d=0,e=0;e<this.getChildren().length;e++){var g=this.getChildren()[e].measure(a,b);g.width>c&&(c=g.width);g.height>d&&(d=g.height)}for(var g=Math.max(Math.floor((a+this.spacing)/(c+this.spacing)),1),f=Math.ceil(this.getChildren().length/g),e=0;e<this.getChildren().length;e++)this.getChildren()[e].measure(c,d);this.uniformWidth=c;this.uniformHeight=d;return{width:c*g+(g-1)*this.spacing,
height:f*d+(f-1)*this.spacing}}},{measureCore:function(a,b){if(0==this.getChildren().length)return{width:0,height:0};for(var c=new Ui.SFlowState({width:a,render:!1,spacing:this.spacing,align:this.itemAlign}),d=0;d<this.getChildren().length;d++){var e=this.getChildren()[d];c.append(e)}return c.getSize()},arrangeCore:function(a,b){for(var c=new Ui.SFlowState({width:a,render:!0,spacing:this.spacing,align:this.itemAlign}),d=0;d<this.getChildren().length;d++){var e=this.getChildren()[d];c.append(e)}c.getSize()}},
{getFloat:function(a){return a["Ui.SFlow.float"]?a["Ui.SFlow.float"]:"none"},setFloat:function(a,b){Ui.SFlow.getFloat(a)!=b&&(a["Ui.SFlow.float"]=b,a.invalidateMeasure())}});Ui.Container.extend("Ui.Grid",{cols:void 0,rows:void 0,constructor:function(a){this.cols=[{auto:!0,star:!1,absolute:!1,actualWidth:0,offset:0,width:0}];this.rows=[{auto:!0,star:!1,absolute:!1,actualHeight:0,offset:0,height:0}]},setCols:function(a){this.cols=[];a=a.split(",");for(var b=0;b<a.length;b++){var c=a[b];if("auto"==c)this.cols.push({auto:!0,star:!1,absolute:!1,actualWidth:0,offset:0,width:0});else if("*"==c)this.cols.push({auto:!1,star:!0,absolute:!1,actualWidth:0,offset:0,width:1});else if(c.match(/^[0-9]+\.?[0-9]*\*$/))this.cols.push({auto:!1,
star:!0,absolute:!1,actualWidth:0,offset:0,width:new Number(c.slice(0,c.length-1))});else if(c.match(/^[0-9]+$/))this.cols.push({auto:!1,star:!1,absolute:!0,actualWidth:0,offset:0,width:new Number(c)});else if(DEBUG)throw'Ui.Grid column definition "'+c+'" not supported';}this.invalidateMeasure()},setRows:function(a){this.rows=[];a=a.split(",");for(var b=0;b<a.length;b++){var c=a[b];if("auto"==c)this.rows.push({auto:!0,star:!1,absolute:!1,actualHeight:0,offset:0,height:0});else if("*"==c)this.rows.push({auto:!1,
star:!0,absolute:!1,actualHeight:0,offset:0,height:1});else if(c.match(/^[0-9]+\.?[0-9]*\*$/))this.rows.push({auto:!1,star:!0,absolute:!1,actualHeight:0,offset:0,height:new Number(c.slice(0,c.length-1))});else if(c.match(/^[0-9]+$/))this.rows.push({auto:!1,star:!1,absolute:!0,actualHeight:0,offset:0,height:new Number(c)});else if(DEBUG)throw'Ui.Grid row definition "'+c+'" not supported';}},setContent:function(a){for(;void 0!=this.getFirstChild();)this.removeChild(this.getFirstChild());if(void 0!=
a&&"object"==typeof a)if(a.constructor==Array)for(var b=0;b<a.length;b++)this.appendChild(Ui.Element.create(a[b]));else this.appendChild(Ui.Element.create(a))},attach:function(a,b,c,d,e){void 0===d&&(d=1);void 0===e&&(e=1);Ui.Grid.setCol(a,b);Ui.Grid.setRow(a,c);Ui.Grid.setColSpan(a,d);Ui.Grid.setRowSpan(a,e);this.appendChild(a)},detach:function(a){this.removeChild(a)},getColMin:function(a){for(var b=0,c=0;c<this.getChildren().length;c++){var d=this.getChildren()[c],e=Ui.Grid.getCol(d),g=Ui.Grid.getColSpan(d);
if(1==g&&e==a)d.getMeasureWidth()>b&&(b=d.getMeasureWidth());else if(e<=a&&e+g>a){for(var f=!0,h=!1,k=0,m=e;m<a;m++){var l=this.cols[m],k=k+l.actualWidth;if(l.star){h=!0;break}}if(!h)for(m=a+1;m<e+g;m++){l=this.cols[m];if(l.star){h=!0;break}if(l.auto){f=!1;break}}!h&&f&&d.getMeasureWidth()-k>b&&(b=d.getMeasureWidth()-k)}}return b},getRowMin:function(a){for(var b=0,c=0;c<this.getChildren().length;c++){var d=this.getChildren()[c],e=Ui.Grid.getRow(d),g=Ui.Grid.getRowSpan(d);if(1==g&&e==a)d.getMeasureHeight()>
b&&(b=d.getMeasureHeight());else if(e<=a&&e+g>a){for(var f=!0,h=!1,k=0,m=e;m<a;m++){var l=this.rows[m],k=k+l.actualHeight;if(l.star){h=!0;break}}if(!h)for(m=a+1;m<e+g;m++){l=this.rows[m];if(l.star){h=!0;break}if(l.auto){f=!1;break}}!h&&f&&d.getMeasureHeight()-k>b&&(b=d.getMeasureHeight()-k)}}return b}},{measureCore:function(a,b){for(var c=0;c<this.getChildren().length;c++){var d=this.getChildren()[c],e=a*Ui.Grid.getColSpan(d)/this.cols.length,g=b*Ui.Grid.getRowSpan(d)/this.rows.length;d.measure(e,
g)}for(var f=c=0,d=e=0;d<this.cols.length;d++){var h=this.cols[d];h.offset=e;h.absolute?h.actualWidth+=h.width:h.star?(h.actualWidth=0,c+=h.width):h.auto&&(h.actualWidth=this.getColMin(d));e+=h.actualWidth}g=0;0<c&&(g=(a-e)/c);for(c=e=0;c<this.cols.length;c++)h=this.cols[c],h.offset=e,h.star&&(h.actualWidth=g*h.width),e+=h.actualWidth;for(c=0;c<this.getChildren().length;c++){for(var d=this.getChildren()[c],h=Ui.Grid.getCol(d),k=Ui.Grid.getColSpan(d),m=0,l=h;l<h+k;l++)m+=this.cols[l].actualWidth;d.measure(m,
b)}for(d=e=0;d<this.cols.length;d++)h=this.cols[d],h.offset=e,h.absolute?h.actualWidth=h.width:h.star?h.actualWidth=Math.max(this.getColMin(d),g*h.width):h.auto&&(h.actualWidth=this.getColMin(d)),e+=h.actualWidth;for(c=0;c<this.getChildren().length;c++){d=this.getChildren()[c];h=Ui.Grid.getCol(d);k=Ui.Grid.getColSpan(d);m=0;for(l=h;l<h+k;l++)m+=this.cols[l].actualWidth;d.measure(m,b)}for(c=d=0;c<this.rows.length;c++)h=this.rows[c],h.offset=d,h.absolute?h.actualHeight=h.height:h.star?(h.actualHeight=
0,f+=h.height):h.auto&&(h.actualHeight=this.getRowMin(c)),d+=h.actualHeight;g=0;0<f&&(g=(b-d)/f);for(c=d=0;c<this.rows.length;c++)h=this.rows[c],h.offset=d,h.star&&(h.actualHeight=g*h.height),d+=h.actualHeight;for(c=0;c<this.getChildren().length;c++){d=this.getChildren()[c];h=Ui.Grid.getCol(d);k=Ui.Grid.getColSpan(d);m=0;for(l=h;l<h+k;l++)m+=this.cols[l].actualWidth;h=Ui.Grid.getRow(d);f=Ui.Grid.getRowSpan(d);k=0;for(l=h;l<h+f;l++)k+=this.rows[l].actualHeight;d.measure(m,k)}for(c=d=0;c<this.rows.length;c++)h=
this.rows[c],h.offset=d,h.absolute?h.actualHeight=h.height:h.star?(f=this.getRowMin(c),h.actualHeight=Math.max(f,g*h.height)):h.auto&&(h.actualHeight=this.getRowMin(c)),d+=h.actualHeight;return{width:e,height:d}},arrangeCore:function(a,b){for(var c=0;c<this.getChildren().length;c++){for(var d=this.getChildren()[c],e=Ui.Grid.getCol(d),g=Ui.Grid.getColSpan(d),f=Ui.Grid.getRow(d),h=Ui.Grid.getRowSpan(d),k=this.cols[e].offset,m=this.rows[f].offset,l=0,n=0,p=e;p<e+g;p++)l+=this.cols[p].actualWidth;for(e=
f;e<f+h;e++)n+=this.rows[e].actualHeight;d.arrange(k,m,l,n)}}},{getCol:function(a){return void 0!=a["Ui.Grid.col"]?a["Ui.Grid.col"]:0},setCol:function(a,b){Ui.Grid.getCol(a)!=b&&(a["Ui.Grid.col"]=b,a.invalidateMeasure())},getRow:function(a){return void 0!=a["Ui.Grid.row"]?a["Ui.Grid.row"]:0},setRow:function(a,b){Ui.Grid.getRow(a)!=b&&(a["Ui.Grid.row"]=b,a.invalidateMeasure())},getColSpan:function(a){return void 0!=a["Ui.Grid.colSpan"]?a["Ui.Grid.colSpan"]:1},setColSpan:function(a,b){Ui.Grid.getColSpan(a)!=
b&&(a["Ui.Grid.colSpan"]=b,a.invalidateMeasure())},getRowSpan:function(a){return void 0!=a["Ui.Grid.rowSpan"]?a["Ui.Grid.rowSpan"]:1},setRowSpan:function(a,b){Ui.Grid.getRowSpan(a)!=b&&(a["Ui.Grid.rowSpan"]=b,a.invalidateMeasure())}});Ui.Container.extend("Ui.Fixed",{constructor:function(a){this.addEvents("resize")},setPosition:function(a,b,c){void 0!==b&&(a["Ui.Fixed.x"]=b);void 0!==c&&(a["Ui.Fixed.y"]=c);this.updateItemTransform(a)},setRelativePosition:function(a,b,c,d){void 0!==b&&(a["Ui.Fixed.relativeX"]=b);void 0!==c&&(a["Ui.Fixed.relativeY"]=c);a["Ui.Fixed.relativeAbsolute"]=!0===d;this.updateItemTransform(a)},append:function(a,b,c){a["Ui.Fixed.x"]=b;a["Ui.Fixed.y"]=c;this.appendChild(a)},remove:function(a){delete a["Ui.Fixed.x"];
delete a["Ui.Fixed.y"];delete a["Ui.Fixed.relativeX"];delete a["Ui.Fixed.relativeY"];delete a["Ui.Fixed.relativeAbsolute"];this.removeChild(a)},updateItemTransform:function(a){var b=0;void 0!=a["Ui.Fixed.x"]&&(b=a["Ui.Fixed.x"]);void 0!=a["Ui.Fixed.relativeX"]&&(b-=a["Ui.Fixed.relativeX"]*(!0===a["Ui.Fixed.relativeAbsolute"]?1:a.getMeasureWidth()));var c=0;void 0!=a["Ui.Fixed.y"]&&(c=a["Ui.Fixed.y"]);void 0!=a["Ui.Fixed.relativeY"]&&(c-=a["Ui.Fixed.relativeY"]*(!0===a["Ui.Fixed.relativeAbsolute"]?
1:a.getMeasureHeight()));a.setTransform(Ui.Matrix.createTranslate(b,c))}},{measureCore:function(a,b){for(var c=0;c<this.getChildren().length;c++)this.getChildren()[c].measure(a,b);return{width:0,height:0}},arrangeCore:function(a,b){this.fireEvent("resize",this,a,b);for(var c=0;c<this.getChildren().length;c++){var d=this.getChildren()[c],e=0;void 0!=d["Ui.Fixed.x"]&&(e=d["Ui.Fixed.x"]);void 0!=d["Ui.Fixed.relativeX"]&&(e-=d["Ui.Fixed.relativeX"]*(!0===d["Ui.Fixed.relativeAbsolute"]?1:d.getMeasureWidth()));
var g=0;void 0!=d["Ui.Fixed.y"]&&(g=d["Ui.Fixed.y"]);void 0!=d["Ui.Fixed.relativeY"]&&(g-=d["Ui.Fixed.relativeY"]*(!0===d["Ui.Fixed.relativeAbsolute"]?1:d.getMeasureHeight()));d.arrange(e,g,d.getMeasureWidth(),d.getMeasureHeight())}},onChildInvalidateMeasure:function(a,b){"remove"!==b&&a.measure(this.getLayoutWidth(),this.getLayoutHeight())},onChildInvalidateArrange:function(a){a.arrange(0,0,a.getMeasureWidth(),a.getMeasureHeight());this.updateItemTransform(a)}});Ui.Container.extend("Ui.Fold",{headerBox:void 0,header:void 0,contentBox:void 0,content:void 0,background:void 0,offset:0,position:"bottom",isFolded:!0,over:!0,mode:"extend",clock:void 0,contentSize:0,animDuration:2,constructor:function(a){this.addEvents("fold","unfold","positionchange");this.headerBox=new Ui.Pressable;this.appendChild(this.headerBox);this.connect(this.headerBox,"press",this.onHeaderPress);this.contentBox=new Ui.LBox;this.appendChild(this.contentBox);this.contentBox.hide()},setHeaderActive:function(a){this.headerBox.setLock(!a)},
getIsFolded:function(){return this.isFolded},setIsFolded:function(a){this.isFolded!=a&&((this.isFolded=a)?(this.setOffset(0),this.contentBox.hide(),this.fireEvent("fold",this)):(this.setOffset(1),this.contentBox.show(),this.fireEvent("unfold",this)))},fold:function(){this.isFolded||(this.isFolded=!0,this.startAnimation(),this.fireEvent("fold",this))},unfold:function(){this.isFolded&&(this.isFolded=!1,this.startAnimation(),this.fireEvent("unfold",this))},getOver:function(){return this.over},setOver:function(a){this.over!=
a&&(this.over=a,this.stopAnimation(),this.setTransform(Ui.Matrix.createTranslate(0,0)),this.invalidateMeasure())},getMode:function(){return this.mode},setMode:function(a){this.mode!=a&&(this.mode=a,this.stopAnimation(),this.invalidateMeasure())},getHeader:function(){return this.header},setHeader:function(a){a!=this.header&&(void 0!=this.header&&this.headerBox.removeChild(this.header),this.header=a,void 0!=this.header&&this.headerBox.appendChild(this.header))},getContent:function(){return this.content},
setContent:function(a){this.content!=a&&(void 0!=this.content&&this.contentBox.removeChild(this.content),this.content=a,void 0!=this.content&&this.contentBox.appendChild(this.content))},getBackground:function(){return this.background},setBackground:function(a){this.background!==a&&(void 0!==this.background&&this.removeChild(this.background),this.background=a,void 0!==this.background&&this.prependChild(this.background))},getPosition:function(){return this.position},setPosition:function(a){this.position!=
a&&(this.position=a,this.fireEvent("positionchange",this,a),this.invalidateMeasure())},getOffset:function(){return this.offset},setOffset:function(a){this.offset=a;this.over?"right"===this.position?("slide"===this.mode?this.setTransform(Ui.Matrix.createTranslate(-this.offset*this.contentSize,0)):this.setTransform(Ui.Matrix.createTranslate(0,0)),this.contentBox.setClipRectangle(0,0,Math.round(this.contentSize*this.offset),this.getLayoutHeight()),void 0!==this.background&&this.background.arrange(0,
0,Math.round(this.headerBox.getMeasureWidth()+this.contentSize*this.offset),Math.round(this.getLayoutHeight()))):"left"===this.position?("slide"===this.mode?this.setTransform(Ui.Matrix.createTranslate(-this.contentSize+this.offset*this.contentSize,0)):this.setTransform(Ui.Matrix.createTranslate(-this.contentSize,0)),this.contentBox.setClipRectangle(Math.round(this.contentSize*(1-this.offset)),0,this.contentSize,this.getLayoutHeight()),void 0!==this.background&&this.background.arrange(Math.round(this.contentSize*
(1-this.offset)),0,Math.round(this.headerBox.getMeasureWidth()+this.contentSize*this.offset),Math.round(this.getLayoutHeight()))):"top"===this.position?("slide"===this.mode?this.setTransform(Ui.Matrix.createTranslate(0,-this.contentSize+this.offset*this.contentSize)):this.setTransform(Ui.Matrix.createTranslate(0,-this.contentSize)),this.contentBox.setClipRectangle(0,Math.round(this.contentSize*(1-this.offset)),this.getLayoutWidth(),Math.round(this.contentSize*this.offset)),void 0!==this.background&&
this.background.arrange(0,Math.round(this.contentSize*(1-this.offset)),this.getLayoutWidth(),Math.round(this.headerBox.getMeasureHeight()+this.contentSize*this.offset))):("slide"===this.mode?this.setTransform(Ui.Matrix.createTranslate(0,-this.offset*this.contentSize)):this.setTransform(Ui.Matrix.createTranslate(0,0)),this.contentBox.setClipRectangle(0,0,this.getLayoutWidth(),Math.round(this.contentSize*this.offset)),void 0!==this.background&&this.background.arrange(0,0,this.getLayoutWidth(),Math.round(this.headerBox.getMeasureHeight()+
this.contentSize*this.offset))):this.invalidateMeasure()},onHeaderPress:function(){this.isFolded?this.unfold():this.fold()},setAnimDuration:function(a){this.animDuration=a},startAnimation:function(){void 0!=this.clock&&this.clock.stop();this.isFolded||this.contentBox.show();this.clock=new Anim.Clock({duration:this.animDuration,scope:this,target:this,onTimeupdate:this.onClockTick});this.clock.begin()},stopAnimation:function(){void 0!=this.clock&&(this.clock.stop(),this.clock=void 0)},onClockTick:function(a,
b){if(void 0===this.content)void 0!=this.clock&&(this.clock.stop(),this.clock=void 0);else{var c=this.getOffset();if(1<c)this.setOffset(1);else{var d;d=this.isFolded?0:1;this.setOffset(d-(d-c)*(1-b))}1==b&&this.isFolded&&this.contentBox.hide()}}},{measureCore:function(a,b){void 0!==this.background&&this.background.measure(a,b);var c=this.headerBox.measure(a,b),d={width:0,height:0};"left"==this.position||"right"==this.position?(d=this.contentBox.measure(a-c.width,b),d.height>c.height&&(c.height=d.height),
this.over||(c.width+=d.width*this.offset),this.contentSize=d.width):(d=this.contentBox.measure(a,b-c.height),d.width>c.width&&(c.width=d.width),this.over||(c.height+=d.height*this.offset),this.contentSize=d.height);return c},arrangeCore:function(a,b){"left"==this.position?(this.over||this.setTransform(Ui.Matrix.createTranslate(-this.contentSize+this.offset*this.contentSize,0)),this.contentBox.arrange(0,0,this.contentBox.getMeasureWidth(),b),this.headerBox.arrange(this.contentBox.getMeasureWidth(),
0,this.headerBox.getMeasureWidth(),b),void 0!==this.background&&this.background.arrange(Math.round(this.contentSize*(1-this.offset)),0,Math.round(this.headerBox.getMeasureWidth()+this.contentSize*this.offset),Math.round(b)),this.contentBox.setClipRectangle(Math.round(this.contentSize*(1-this.offset)),0,Math.round(this.contentSize*this.offset),Math.round(b))):"right"==this.position?(this.headerBox.arrange(0,0,this.headerBox.getMeasureWidth(),b),this.contentBox.arrange(this.headerBox.getMeasureWidth(),
0,this.contentBox.getMeasureWidth(),b),void 0!==this.background&&this.background.arrange(0,0,Math.round(this.headerBox.getMeasureWidth()+this.contentSize*this.offset),Math.round(b)),this.contentBox.setClipRectangle(0,0,Math.round(this.contentSize*this.offset),Math.round(b))):"top"==this.position?(this.over||this.setTransform(Ui.Matrix.createTranslate(0,-this.contentSize+this.offset*this.contentSize)),this.contentBox.arrange(0,0,a,this.contentBox.getMeasureHeight()),this.headerBox.arrange(0,this.contentBox.getMeasureHeight(),
a,this.headerBox.getMeasureHeight()),void 0!==this.background&&this.background.arrange(0,Math.round(this.contentSize*(1-this.offset)),a,Math.round(this.headerBox.getMeasureHeight()+this.contentSize*this.offset)),this.contentBox.setClipRectangle(0,Math.round(this.contentSize*(1-this.offset)),Math.round(a),Math.round(this.contentSize*this.offset))):(this.headerBox.arrange(0,0,a,this.headerBox.getMeasureHeight()),this.contentBox.arrange(0,this.headerBox.getMeasureHeight(),a,this.contentBox.getMeasureHeight()),
void 0!==this.background&&this.background.arrange(0,0,a,Math.round(this.headerBox.getMeasureHeight()+this.contentSize*this.offset)),this.contentBox.setClipRectangle(0,0,Math.round(a),Math.round(this.contentSize*this.offset)));this.setOffset(this.offset)}});Ui.Container.extend("Ui.Accordeonable",{current:-1,currentPage:void 0,clock:void 0,headersSize:0,contentSize:0,orientation:"horizontal",constructor:function(a){this.addEvents("change");this.setClipToBounds(!0)},getOrientation:function(){return this.orientation},setOrientation:function(a){if(this.orientation!=a){this.orientation=a;for(var b=0;b<this.getChildren().length;b++)this.getChildren()[b].setOrientation(a);this.invalidateMeasure()}},getPages:function(){return this.getChildren()},getCurrentPage:function(){return this.currentPage},
setCurrentPage:function(a){for(var b=0;b<this.getChildren().length;b++)if(this.getChildren()[b]==a){this.setCurrentPosition(b);break}},getCurrentPosition:function(){return this.current},setCurrentPosition:function(a){0==this.getChildren().length?(void 0!=this.currentPage&&this.currentPage.unselect(),this.currentPage=void 0,this.current=-1):(this.current=a,a=this.getChildren()[this.current],a!=this.currentPage&&(void 0!=this.currentPage&&this.currentPage.unselect(),this.currentPage=a,this.fireEvent("change",
this,this.currentPage,this.current),this.disconnect(this.currentPage,"select",this.onPageSelect),this.currentPage.select(),this.connect(this.currentPage,"select",this.onPageSelect)),void 0!=this.clock&&this.clock.stop(),this.clock=new Anim.Clock({scope:this,duration:2,target:this,onTimeupdate:this.onClockTick}),this.clock.begin())},appendPage:function(a){a=Ui.AccordeonPage.create(a);this.appendChild(a);a.setOffset(1);a.setOrientation(this.orientation);this.connect(a,"select",this.onPageSelect);this.connect(a,
"close",this.onPageClose);a.select()},removePage:function(a){for(var b=-1,c=0;c<this.getChildren().length;c++)if(this.getChildren()[c]==a){b=c;break}-1!=b&&(this.disconnect(a,"select",this.onPageSelect),this.disconnect(a,"close",this.onPageClose),this.removeChild(a),this.current==b&&0==this.current?this.setCurrentPosition(0):this.current>=b?this.setCurrentPosition(this.current-1):this.setCurrentPosition(this.current))},onClockTick:function(a,b){for(var c=0;c<this.getChildren().length;c++){var d=this.getChildren()[c];
c==this.current&&d.showContent();var e=d.getOffset();if(1<e)d.setOffset(1);else{var g;g=c<=this.current?0:1;d.setOffset(g-(g-e)*(1-b))}1==b&&c!=this.current&&d.hideContent()}},onPageSelect:function(a){this.setCurrentPage(a)},onPageClose:function(a){this.removePage(a)},measureHorizontal:function(a,b){for(var c=0,d=0,e=0,g=0;g<this.getChildren().length;g++){var f=this.getChildren()[g];f.measure(a,b);c+=f.getHeader().getMeasureWidth();f.getHeader().getMeasureHeight()>e&&(e=f.getHeader().getMeasureHeight())}for(g=
0;g<this.getChildren().length;g++)f=this.getChildren()[g],f.measure(a-c+f.getHeader().getMeasureWidth(),b),f=f.getContent(),void 0!=f&&f.getMeasureWidth()>d&&(d=f.getMeasureWidth(),f.getMeasureHeight()>e&&(e=f.getMeasureHeight()));this.headersSize=c;return{width:c+d,height:e}},measureVertical:function(a,b){for(var c=0,d=0,e=0,g=0;g<this.getChildren().length;g++){var f=this.getChildren()[g];f.measure(a,b);c+=f.getHeader().getMeasureHeight();f.getHeader().getMeasureWidth()>e&&(e=f.getHeader().getMeasureWidth())}for(g=
0;g<this.getChildren().length;g++)f=this.getChildren()[g],f.measure(a,b-c+f.getHeader().getMeasureHeight()),f=f.getContent(),void 0!=f&&f.getMeasureHeight()>d&&(d=f.getMeasureHeight(),f.getMeasureWidth()>e&&(e=f.getMeasureWidth()));this.headersSize=c;return{width:e,height:c+d}}},{measureCore:function(a,b){return"horizontal"==this.orientation?this.measureHorizontal(a,b):this.measureVertical(a,b)},arrangeCore:function(a,b){if("horizontal"==this.orientation){var c=0;this.contentSize=a-this.headersSize;
for(var d=0;d<this.getChildren().length;d++){var e=this.getChildren()[d];e.arrange(c,0,this.contentSize+e.getHeader().getMeasureWidth(),b);c+=e.getHeader().getMeasureWidth()}}else for(c=0,this.contentSize=b-this.headersSize,d=0;d<this.getChildren().length;d++)e=this.getChildren()[d],e.arrange(0,c,a,this.contentSize+e.getHeader().getMeasureHeight()),c+=e.getHeader().getMeasureHeight()}});
Ui.Container.extend("Ui.AccordeonPage",{headerBox:void 0,header:void 0,content:void 0,offset:0,orientation:"horizontal",isSelected:!1,constructor:function(a){this.addEvents("select","unselect","close","orientationchange");this.headerBox=new Ui.Pressable;this.appendChild(this.headerBox);this.connect(this.headerBox,"press",this.onHeaderPress)},close:function(){this.fireEvent("close",this)},select:function(){this.isSelected||(this.isSelected=!0,this.fireEvent("select",this))},getIsSelected:function(){return this.isSelected},
getHeader:function(){return this.header},setHeader:function(a){a=Ui.Element.create(a);a!=this.header&&(void 0!=this.header&&this.headerBox.removeChild(this.header),this.header=a,void 0!=this.header&&this.headerBox.appendChild(this.header))},getContent:function(){return this.content},setContent:function(a){a=Ui.Element.create(a);this.content!=a&&(void 0!=this.content&&this.removeChild(this.content),this.content=a,void 0!=this.content&&this.appendChild(this.content,!0))},getOrientation:function(){return this.orientation},
setOrientation:function(a){this.orientation!=a&&(this.orientation=a,this.fireEvent("orientationchange",this,a),this.invalidateMeasure())},unselect:function(){this.isSelected&&(this.isSelected=!1,this.fireEvent("unselect",this))},showContent:function(){void 0!=this.content&&this.content.show()},hideContent:function(){void 0!=this.content&&this.content.hide()},getOffset:function(){return this.offset},setOffset:function(a){this.offset=a;"horizontal"==this.orientation?this.setTransform(Ui.Matrix.createTranslate(this.offset*
(this.getLayoutWidth()-this.headerBox.getMeasureWidth()),0)):this.setTransform(Ui.Matrix.createTranslate(0,this.offset*(this.getLayoutHeight()-this.headerBox.getMeasureHeight())))},onHeaderPress:function(){this.select()}},{measureCore:function(a,b){var c=this.headerBox.measure(a,b),d={width:0,height:0};void 0!=this.content&&("horizontal"==this.orientation?(d=this.content.measure(a-c.width,b),d.height>c.height&&(c.height=d.height),c.width+=d.width):(d=this.content.measure(a,b-c.height),d.width>c.width&&
(c.width=d.width),c.height+=d.height));return c},arrangeCore:function(a,b){"horizontal"==this.orientation?(this.headerBox.arrange(0,0,this.headerBox.getMeasureWidth(),b),void 0!=this.content&&this.content.arrange(this.headerBox.getMeasureWidth(),0,a-this.headerBox.getMeasureWidth(),b)):(this.headerBox.arrange(0,0,a,this.headerBox.getMeasureHeight()),void 0!=this.content&&this.content.arrange(0,this.headerBox.getMeasureHeight(),a,b-this.headerBox.getMeasureHeight()));this.setOffset(this.offset)}});Ui.Element.extend("Ui.Spacer",{constructor:function(a){}});Ui.CanvasElement.extend("Ui.Rectangle",{fill:void 0,radiusTopLeft:0,radiusTopRight:0,radiusBottomLeft:0,radiusBottomRight:0,constructor:function(a){this.fill=new Ui.Color({r:0,g:0,b:0})},getFill:function(){return this.fill},setFill:function(a){this.fill!=a&&(this.fill=a="string"===typeof a?Ui.Color.create(a):Ui.Element.create(a),this.invalidateDraw())},setRadius:function(a){this.setRadiusTopLeft(a);this.setRadiusTopRight(a);this.setRadiusBottomLeft(a);this.setRadiusBottomRight(a)},getRadiusTopLeft:function(){return this.radiusTopLeft},
setRadiusTopLeft:function(a){this.radiusTopLeft!=a&&(this.radiusTopLeft=a,this.invalidateDraw())},getRadiusTopRight:function(){return this.radiusTopRight},setRadiusTopRight:function(a){this.radiusTopRight!=a&&(this.radiusTopRight=a,this.invalidateDraw())},getRadiusBottomLeft:function(){return this.radiusBottomLeft},setRadiusBottomLeft:function(a){this.radiusBottomLeft!=a&&(this.radiusBottomLeft=a,this.invalidateDraw())},getRadiusBottomRight:function(){return this.radiusBottomRight},setRadiusBottomRight:function(a){this.radiusBottomRight!=
a&&(this.radiusBottomRight=a,this.invalidateDraw())}},{updateCanvas:function(a){a.beginPath();a.roundRect(0,0,this.getLayoutWidth(),this.getLayoutHeight(),this.radiusTopLeft,this.radiusTopRight,this.radiusBottomRight,this.radiusBottomLeft);a.closePath();Ui.Color.hasInstance(this.fill)?a.fillStyle=this.fill.getCssRgba():Ui.LinearGradient.hasInstance(this.fill)&&(a.fillStyle=this.fill.getCanvasGradient(a,this.getLayoutWidth(),this.getLayoutHeight()));a.fill()}});Ui.Shape.extend("Ui.Frame",{radiusTopLeft:0,radiusTopRight:0,radiusBottomLeft:0,radiusBottomRight:0,frameWidth:10,constructor:function(a){},getFrameWidth:function(){return this.frameWidth},setFrameWidth:function(a){a!=this.frameWidth&&(this.frameWidth=a,this.invalidateArrange())},setRadius:function(a){this.setRadiusTopLeft(a);this.setRadiusTopRight(a);this.setRadiusBottomLeft(a);this.setRadiusBottomRight(a)},getRadiusTopLeft:function(){return this.radiusTopLeft},setRadiusTopLeft:function(a){this.radiusTopLeft!=
a&&(this.radiusTopLeft=a,this.invalidateArrange())},getRadiusTopRight:function(){return this.radiusTopRight},setRadiusTopRight:function(a){this.radiusTopRight!=a&&(this.radiusTopRight=a,this.invalidateArrange())},getRadiusBottomLeft:function(){return this.radiusBottomLeft},setRadiusBottomLeft:function(a){this.radiusBottomLeft!=a&&(this.radiusBottomLeft=a,this.invalidateArrange())},getRadiusBottomRight:function(){return this.radiusBottomRight},setRadiusBottomRight:function(a){this.radiusBottomRight!=
a&&(this.radiusBottomRight=a,this.invalidateArrange())},genPath:function(a,b){var c="",c=0<this.radiusTopLeft?c+("M0,"+this.radiusTopLeft+" Q0,0 "+this.radiusTopLeft+",0 "):c+"M0,0 ",c=0<this.radiusTopRight?c+("L"+(a-this.radiusTopRight)+",0 Q"+a+",0 "+a+","+this.radiusTopRight+" "):c+("L"+a+",0 "),c=0<this.radiusBottomRight?c+("L"+a+","+(b-this.radiusBottomRight)+" Q"+a+","+b+" "+(a-this.radiusBottomRight)+","+b+" "):c+("L"+a+","+b+" "),c=0<this.radiusBottomLeft?c+("L"+this.radiusBottomLeft+","+
b+" Q0,"+b+" 0,"+(b-this.radiusBottomLeft)+" "):c+("L0,"+b+" ");this.radiusTopLeft>this.frameWidth?(c+="M"+this.radiusTopLeft+","+this.frameWidth+" ",c+="Q"+this.frameWidth+","+this.frameWidth+" "+this.frameWidth+","+this.radiusTopLeft+" "):c+="M"+this.frameWidth+","+this.frameWidth+" ";this.radiusBottomLeft>this.frameWidth?(c+="L"+this.frameWidth+","+(b-this.radiusBottomLeft)+" ",c+="Q"+this.frameWidth+","+(b-this.frameWidth)+" "+this.radiusBottomLeft+","+(b-this.frameWidth)+" "):c+="L"+this.frameWidth+
","+(b-this.frameWidth)+" ";this.radiusBottomRight>this.frameWidth?(c+="L"+(a-this.radiusBottomRight)+","+(b-this.frameWidth)+" ",c+="Q"+(a-this.frameWidth)+","+(b-this.frameWidth)+" "+(a-this.frameWidth)+","+(b-this.radiusBottomRight)+" "):c+="L"+(a-this.frameWidth)+","+(b-this.frameWidth)+" ";this.radiusTopRight>this.frameWidth?(c+="L"+(a-this.frameWidth)+","+this.radiusTopRight+" ",c+="Q"+(a-this.frameWidth)+","+this.frameWidth+" "+(a-this.radiusTopRight)+","+this.frameWidth+" "):c+="L"+(a-this.frameWidth)+
","+this.frameWidth+" ";return c+"z"}},{arrangeCore:function(a,b){Ui.Frame.base.arrangeCore.call(this,a,b);this.setPath(this.genPath(a,b))}});Ui.CanvasElement.extend("Ui.Shadow",{radiusTopLeft:0,radiusTopRight:0,radiusBottomLeft:0,radiusBottomRight:0,shadowWidth:0,inner:!1,color:void 0,constructor:function(a){this.color=Ui.Color.create("black");this.setShadowWidth(4)},getColor:function(){return this.color},setColor:function(a){this.color!=a&&(this.color=Ui.Color.create(a),this.invalidateDraw())},getInner:function(){return this.inner},setInner:function(a){this.inner!=a&&(this.inner=a,this.invalidateDraw())},setShadowWidth:function(a){this.shadowWidth!=
a&&(this.shadowWidth=a,this.invalidateDraw())},getShadowWidth:function(){return this.shadowWidth},setRadius:function(a){this.radiusBottomRight=this.radiusBottomLeft=this.radiusTopRight=this.radiusTopLeft=a;this.invalidateDraw()},getRadiusTopLeft:function(){return this.radiusTopLeft},setRadiusTopLeft:function(a){this.radiusTopLeft!=a&&(this.radiusTopLeft=a,this.invalidateDraw())},getRadiusTopRight:function(){return this.radiusTopRight},setRadiusTopRight:function(a){this.radiusTopRight!=a&&(this.radiusTopRight=
a,this.invalidateDraw())},getRadiusBottomLeft:function(){return this.radiusBottomLeft},setRadiusBottomLeft:function(a){this.radiusBottomLeft!=a&&(this.radiusBottomLeft=a,this.invalidateDraw())},getRadiusBottomRight:function(){return this.radiusBottomRight},setRadiusBottomRight:function(a){this.radiusBottomRight!=a&&(this.radiusBottomRight=a,this.invalidateDraw())}},{updateCanvas:function(a){for(var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=0;d<this.shadowWidth;d++){var e=this.color.getRgba(),
g;this.inner?1==this.shadowWidth?g=1:(g=(d+1)/this.shadowWidth,g*=g):g=(d+1)/(this.shadowWidth+1);e=new Ui.Color({r:e.r,g:e.g,b:e.b,a:e.a*g});a.fillStyle=e.getCssRgba();this.inner?(a.beginPath(),a.roundRect(0,0,b,c,this.radiusTopLeft,this.radiusTopRight,this.radiusBottomRight,this.radiusBottomLeft),a.roundRect(this.shadowWidth-d,this.shadowWidth-d,b-2*(this.shadowWidth-d),c-2*(this.shadowWidth-d),this.radiusTopLeft,this.radiusTopRight,this.radiusBottomRight,this.radiusBottomLeft,!0)):(a.beginPath(),
a.roundRect(d,d,b-2*d,c-2*d,this.radiusTopLeft,this.radiusTopRight,this.radiusBottomRight,this.radiusBottomLeft));a.closePath();a.fill()}}});Ui.Shape.extend("Ui.Icon",{constructor:function(a){this.setWidth(24);this.setHeight(24)},setIcon:function(a){this.setPath(Ui.Icon.icons[a])}},{arrangeCore:function(a,b){Ui.Icon.base.arrangeCore.call(this,a,b);var c=Math.min(a,b)/48;this.setScale(c)}},{icons:{},constructor:function(){this.register("check","m 9.1916229,24 7.0000001,-7 7,7 14,-14 7,7 -21,21 z");this.register("home","M 25.78125 8.4375 C 25.324787 8.4375 24.892151 8.63045 24.53125 8.96875 C 24.53125 8.96875 6.032579 23.87715 5.6875 24.21875 C 4.081261 25.55365 4.524131 25.86215 4.96875 26.46875 C 7.1319435 26.472745 6.9387918 26.465628 8.875 26.46875 L 8.875 38.40625 C 8.875 40.46895 10.593558 42.1875 12.65625 42.1875 L 37.3125 42.1875 C 39.375192 42.1875 41.09375 40.46895 41.09375 38.40625 L 41.09375 26.5 C 42.834133 26.49218 44.96875 26.46875 44.96875 26.46875 C 45.304525 25.79985 45.215875 24.96585 44.65625 24.40625 L 39.96875 20.3125 C 40.040347 20.078087 40.09375 19.817094 40.09375 19.5625 L 40.09375 11.875 C 40.09375 10.4883 38.949133 9.34375 37.5625 9.34375 L 33.25 9.34375 C 31.863368 9.34375 30.71875 10.4883 30.71875 11.875 L 30.71875 12.1875 L 27.03125 8.96875 C 26.681485 8.61895 26.237713 8.4375 25.78125 8.4375 z M 33.71875 12.34375 L 37.09375 12.34375 L 37.09375 17.78125 L 33.71875 14.8125 L 33.71875 12.34375 z M 12.875 26.46875 C 23.518938 26.483067 32.947599 26.505366 37.09375 26.5 L 37.09375 38.1875 L 12.875 38.1875 L 12.875 26.46875 z");
this.register("search","M 16.5625 2.78125 C 9.268416 2.78125 3.3125 8.73725 3.3125 16.03125 C 3.3125 23.32535 9.268416 29.28125 16.5625 29.28125 C 19.232656 29.28125 21.727527 28.494751 23.8125 27.125 L 26.53125 29.84375 C 26.040794 31.243763 26.345911 32.877161 27.46875 34 L 36.96875 43.5 C 38.531721 45.062971 41.062029 45.062971 42.625 43.5 L 44.3125 41.8125 C 45.875471 40.249529 45.875471 37.750471 44.3125 36.1875 L 34.78125 26.65625 C 33.730308 25.605308 32.270922 25.293885 30.9375 25.65625 L 28 22.71875 C 29.155313 20.754051 29.8125 18.465809 29.8125 16.03125 C 29.8125 8.73725 23.856584 2.78125 16.5625 2.78125 z M 16.5625 6.78125 C 21.694823 6.78125 25.8125 10.89895 25.8125 16.03125 C 25.8125 21.16365 21.694823 25.28125 16.5625 25.28125 C 11.430177 25.28125 7.3125 21.16365 7.3125 16.03125 C 7.3125 10.89895 11.430177 6.78125 16.5625 6.78125 z");
this.register("close","m 9,4 -5,5 15,15 -15,15 5,5 15,-15 15,15 5,-5 -15,-15 15,-15 -5,-5 -15,15 -15,-15 z");this.register("arrowleft","m 30,4 5,5 -15,15 15,15 -5,5 -20,-20 z");this.register("arrowright","m 18,4 -5,5 15,15 -15,15 5,5 20,-20 z");this.register("arrowtop","m 44,31 -5,5 -15,-15 -15,15 -5,-5 20,-20 z");this.register("arrowbottom","m 4,16 5,-5 15,15 15,-15 5,5 -20,20 z");this.register("refresh","M 23.9375 8.65625 C 18.315047 8.5110846 12.782031 11.461344 9.78125 16.8125 C 5.4164779 24.596 8.033743 34.59995 15.59375 39.09375 C 23.153757 43.58765 32.885228 40.9086 37.25 33.125 L 33.3125 30.78125 C 30.176679 36.37325 23.306402 38.25985 17.875 35.03125 C 12.443598 31.80275 10.582928 24.7169 13.71875 19.125 C 16.854571 13.533 23.724848 11.6464 29.15625 14.875 C 31.524806 16.282891 33.334721 18.493178 34.21875 21.125 L 25.9375 18.5 L 24.78125 22.125 L 39.25 26.6875 L 43.8125 12.21875 L 40.1875 11.0625 L 37.9375 18.21875 C 36.578889 15.137923 34.328741 12.531134 31.4375 10.8125 C 29.074997 9.4081875 26.493161 8.7222343 23.9375 8.65625 z M 36.84375 21.78125 L 36.78125 21.9375 L 36.5 21.84375 L 36.84375 21.78125 z");
this.register("deny","M 24.375 4.5625 C 13.844791 4.5625 5.3125 13.094791 5.3125 23.625 C 5.3125 34.155209 13.844791 42.6875 24.375 42.6875 C 34.905209 42.6875 43.4375 34.155209 43.4375 23.625 C 43.4375 13.094791 34.905209 4.5625 24.375 4.5625 z M 12.875 20.46875 L 36.375 20.46875 L 36.375 27.8125 L 12.875 27.8125 L 12.875 20.46875 z");this.register("warning","M 24.71875 4.4375 C 23.303716 4.4375 21.840759 5.2267 20.8125 6.9375 L 4.21875 34.59375 C 2.3252709 37.74415 3.3675561 42.27165 7.125 42.28125 L 42.34375 42.375 C 46.101193 42.385 45.807964 37.35645 44 34.15625 L 28.625 6.9375 C 27.64318 5.1996 26.133784 4.4375 24.71875 4.4375 z M 22.15625 13.25 L 27.46875 13.25 L 27.46875 20.125 C 27.46874 22.170821 27.369577 24.007046 27.15625 25.6875 C 26.942909 27.343595 26.663738 29.000155 26.34375 30.65625 L 23.25 30.65625 C 22.929998 29.000155 22.682075 27.343595 22.46875 25.6875 C 22.255413 24.007046 22.156245 22.170821 22.15625 20.125 L 22.15625 13.25 z M 24.8125 32.96875 C 26.596301 32.96875 28.03125 34.403699 28.03125 36.1875 C 28.03125 37.971301 26.596301 39.40625 24.8125 39.40625 C 23.028699 39.40625 21.59375 37.971301 21.59375 36.1875 C 21.59375 34.403699 23.028699 32.96875 24.8125 32.96875 z");
this.register("trash","m 22.83704,5 c -2.219688,0 -4.069448,1.8498 -4.069448,4.0695 l 0,0.7683 -10.3016789,0 c -2.4744975,0 -4.5247706,2.0503 -4.5247706,4.5248 l 0,1.1383 c 0,2.4745 2.0502731,4.5248 4.5247706,4.5248 l 1.1098496,0 0,18.3552 c 0,2.5298 2.2334483,4.6101 4.9231783,4.6101 l 18.042167,0 c 2.68973,0 4.923178,-2.0803 4.923178,-4.6101 l 0,-18.3552 2.162783,0 c 2.474498,0 4.524771,-2.0503 4.524771,-4.5248 l 0,-1.1383 c 0,-2.4745 -2.050273,-4.5248 -4.524771,-4.5248 l -9.504864,0 0,-0.7683 c 0,-2.2197 -1.849759,-4.0695 -4.069447,-4.0695 l -3.215718,0 z m 0.512238,2.8743 1.96358,0 c 1.045729,0 1.906664,0.8325 1.906664,1.8782 l 0,3.6995 c 3.933365,0.01 7.770635,0.028 12.407547,0.028 0.519514,0 0.882188,0.3627 0.882188,0.8822 l 0,1.1383 c 0,0.5196 -0.362674,0.8822 -0.882188,0.8822 -2.402264,0.1282 -4.712702,0.1729 -5.037008,0.2846 l 0,21.0586 c 0,1.5373 -1.22319,2.7889 -2.760395,2.7889 l -16.53391,0 c -1.537205,0 -2.782608,-1.2516 -2.788852,-2.7889 l -0.08537,-21.2294 c -3.1146968,-0.069 -0.416025,0.056 -3.9556179,-0.1138 -0.5195134,0 -0.882188,-0.3626 -0.882188,-0.8822 l 0,-1.1383 c 0,-0.5195 0.3626746,-0.8822 0.882188,-0.8822 5.0671389,-0.025 9.0192139,-0.032 13.0051589,-0.028 l 0,-3.6995 c 0,-1.0457 0.832477,-1.8782 1.878206,-1.8782 z m -5.890739,14.1434 c -0.573322,0 -1.024476,0.4796 -1.024476,1.053 l 0,13.3751 c 0,0.5733 0.451154,1.0245 1.024476,1.0245 l 0.825273,0 c 0.573322,0 1.052934,-0.4512 1.052934,-1.0245 l 0,-13.3751 c 0,-0.5734 -0.479612,-1.053 -1.052934,-1.053 l -0.825273,0 z m 5.463874,0 c -0.573322,0 -1.024476,0.4796 -1.024476,1.053 l 0,13.3751 c 0,0.5733 0.451154,1.0245 1.024476,1.0245 l 0.825273,0 c 0.573321,0 1.052934,-0.4512 1.052934,-1.0245 l 0,-13.3751 c 0,-0.5734 -0.479613,-1.053 -1.052934,-1.053 l -0.825273,0 z m 5.463874,0 c -0.573322,0 -1.024476,0.4796 -1.024476,1.053 l 0,13.3751 c 0,0.5733 0.451154,1.0245 1.024476,1.0245 l 0.825273,0 c 0.573321,0 1.052934,-0.4512 1.052934,-1.0245 l 0,-13.3751 c 0,-0.5734 -0.479613,-1.053 -1.052934,-1.053 l -0.825273,0 z");
this.register("new","M 10.15625 5.65625 L 10.15625 9.65625 L 6.15625 9.65625 L 6.15625 13.65625 L 10.15625 13.65625 L 10.15625 17.65625 L 14.15625 17.65625 L 14.15625 13.65625 L 18.15625 13.65625 L 18.15625 9.65625 L 14.15625 9.65625 L 14.15625 5.65625 L 10.15625 5.65625 z M 22.15625 9.65625 L 22.15625 13.65625 L 35.28125 13.65625 C 35.991645 13.65625 36.5 14.1645 36.5 14.875 L 36.5 36.28125 C 36.5 36.99165 35.991645 37.5 35.28125 37.5 L 15.375 37.5 C 14.664605 37.5 14.15625 36.99165 14.15625 36.28125 L 14.15625 21.78125 L 10.15625 21.78125 L 10.15625 36.28125 C 10.15625 39.13855 12.517793 41.5 15.375 41.5 L 35.28125 41.5 C 38.138457 41.5 40.5 39.13855 40.5 36.28125 L 40.5 14.875 C 40.5 12.0177 38.138457 9.65625 35.28125 9.65625 L 22.15625 9.65625 z");
this.register("star","m 23.757651,5 c -0.895163,0.015 -1.74266,0.4185 -2.31531,0.9115 -0.572649,0.493 -0.946681,1.0773 -1.269993,1.663 -0.646625,1.1715 -1.083333,2.481 -1.483178,3.7912 -0.399846,1.3103 -0.765223,2.611 -1.141013,3.6092 -0.375791,0.9982 -0.863354,1.6089 -0.826872,1.5814 0.03648,-0.027 -0.685072,0.2726 -1.748242,0.3583 -1.06317,0.086 -2.414188,0.078 -3.783891,0.1006 -1.3697035,0.023 -2.7488538,0.081 -4.0533165,0.3792 -0.6522312,0.1491 -1.3169807,0.3473 -1.9488982,0.7617 -0.6319175,0.4143 -1.2532513,1.1176 -1.515172,1.9737 -0.2619206,0.8562 -0.1215574,1.7731 0.1703706,2.47 0.2919279,0.697 0.7110554,1.2299 1.168227,1.7184 0.9143429,0.977 2.0261479,1.7874 3.1486997,2.5726 1.1225519,0.7851 2.2542114,1.524 3.0874544,2.1899 0.833242,0.6658 1.270874,1.3422 1.256012,1.299 -0.01486,-0.043 0.0533,0.7481 -0.193748,1.7857 -0.247047,1.0376 -0.682895,2.3074 -1.084578,3.6171 -0.401682,1.3097 -0.782999,2.6265 -0.902518,3.9592 -0.05976,0.6664 -0.06144,1.3623 0.137342,2.0913 0.198782,0.729 0.677406,1.5266 1.410693,2.0402 0.733287,0.5137 1.633944,0.686 2.387015,0.6237 0.753071,-0.062 1.403865,-0.2966 2.009725,-0.5804 1.21172,-0.5677 2.294997,-1.3744 3.388618,-2.1994 1.093621,-0.825 2.163213,-1.6885 3.053976,-2.2752 0.890762,-0.5867 1.655952,-0.8101 1.610285,-0.8093 -0.04567,8e-4 0.735345,0.2228 1.645831,0.7784 0.910486,0.5555 2.002164,1.3506 3.123614,2.1374 1.121449,0.7867 2.247516,1.5467 3.478111,2.0722 0.615298,0.2627 1.273355,0.4794 2.028127,0.5156 0.754772,0.036 1.657048,-0.1634 2.372165,-0.7021 0.715116,-0.5387 1.156065,-1.3508 1.329561,-2.0863 0.173495,-0.7354 0.146882,-1.4277 0.06415,-2.0916 -0.165459,-1.3279 -0.585097,-2.6199 -1.031754,-3.915 -0.446657,-1.295 -0.909557,-2.5637 -1.192279,-3.5922 -0.282722,-1.0284 -0.280534,-1.8404 -0.293896,-1.7967 -0.01336,0.044 0.412582,-0.6301 1.22234,-1.3244 0.809758,-0.6942 1.934952,-1.4839 3.029729,-2.3074 1.094777,-0.8234 2.169097,-1.642 3.049166,-2.6499 0.440034,-0.504 0.844908,-1.0649 1.112601,-1.7715 0.267692,-0.7066 0.350663,-1.6199 0.05934,-2.4664 -0.291321,-0.8466 -0.925793,-1.5268 -1.571637,-1.919 -0.645845,-0.3923 -1.315122,-0.5827 -1.972111,-0.7092 -1.313979,-0.253 -2.684905,-0.2499 -4.054575,-0.2253 -1.36967,0.025 -2.710455,0.093 -3.775949,0.044 -1.065494,-0.049 -1.807185,-0.3328 -1.769776,-0.3066 0.03741,0.026 -0.491907,-0.5811 -0.901934,-1.5658 -0.410028,-0.9846 -0.807845,-2.2763 -1.252686,-3.5719 -0.444841,-1.2957 -0.916948,-2.588 -1.603632,-3.7364 -0.343341,-0.5743 -0.739843,-1.1242 -1.329171,-1.5972 -0.589329,-0.4729 -1.431866,-0.8609 -2.327028,-0.8454 z m 0.04936,4.3522 c 0.05431,0.074 0.08677,0.06 0.149451,0.1649 0.375374,0.6278 0.800845,1.7333 1.223209,2.9635 0.422363,1.2302 0.846512,2.5796 1.362005,3.8175 0.515492,1.2379 1.017518,2.4514 2.291932,3.3441 1.274414,0.8927 2.575612,0.9499 3.915164,1.0114 1.339553,0.062 2.761636,-0.01 4.062098,-0.033 1.300462,-0.023 2.481817,0.024 3.2001,0.1626 0.109478,0.021 0.11064,0.032 0.193553,0.056 -0.05034,0.069 -0.03632,0.075 -0.10848,0.1574 -0.481088,0.551 -1.414422,1.3188 -2.453881,2.1007 -1.039458,0.7818 -2.180578,1.6122 -3.198616,2.485 -1.018038,0.8728 -2.008492,1.7049 -2.463696,3.1928 -0.455204,1.4879 -0.117336,2.7405 0.238105,4.0335 0.355441,1.293 0.845322,2.6325 1.269409,3.8621 0.424088,1.2295 0.770322,2.3592 0.860769,3.0851 0.01369,0.1099 -0.0028,0.1157 4.2e-4,0.2015 -0.08154,-0.027 -0.09172,-0.013 -0.193553,-0.056 -0.672702,-0.2873 -1.662942,-0.9319 -2.727726,-1.6789 -1.064785,-0.7469 -2.217014,-1.5875 -3.361689,-2.286 -1.144675,-0.6985 -2.25533,-1.3689 -3.811076,-1.3421 -1.555745,0.027 -2.628887,0.7492 -3.748765,1.4868 -1.119878,0.7376 -2.232995,1.6052 -3.271356,2.3885 -1.038361,0.7833 -2.033963,1.4685 -2.696346,1.7788 -0.09936,0.046 -0.101178,0.031 -0.18122,0.061 1.62e-4,-0.086 -0.01038,-0.09 -4.2e-4,-0.2015 0.06534,-0.7285 0.345562,-1.8772 0.726948,-3.1207 0.381386,-1.2435 0.841916,-2.5908 1.152507,-3.8953 0.310591,-1.3045 0.61475,-2.5709 0.10845,-4.0422 -0.5063,-1.4713 -1.534069,-2.2887 -2.581632,-3.1259 -1.047564,-0.8371 -2.227509,-1.6172 -3.29334,-2.3627 -1.0658309,-0.7455 -2.0109424,-1.4596 -2.5107659,-1.9936 -0.083457,-0.089 -0.06133,-0.1166 -0.1172617,-0.1892 0.080022,-0.026 0.076516,-0.037 0.18122,-0.061 0.7130816,-0.163 1.9269849,-0.2149 3.2274786,-0.2365 1.300494,-0.022 2.709163,-0.014 4.045793,-0.1212 1.336631,-0.1077 2.631554,-0.2164 3.874389,-1.1526 1.242836,-0.9362 1.70468,-2.1508 2.177128,-3.4058 0.472448,-1.255 0.853548,-2.6111 1.233189,-3.8552 0.379642,-1.244 0.76455,-2.3964 1.118026,-3.0368 0.0519,-0.094 0.06183,-0.087 0.10848,-0.1574 z");
this.register("exit","m 20.089945,9 0,21.7148 -1.697743,0 -2.29084,3.9589 0,1.3567 3.988583,0 0,6.4425 24.398557,0 -0.04449,-18.0228 -6.22011,0 -3.143419,-3.1434 -2.86911,4.9672 7.517512,13.026 -2.921005,0 -6.479593,-11.2319 -1.186195,0 -1.779294,6.6502 -9.756458,0 1.623605,-2.8024 5.819772,0 1.386367,-5.1896 3.640137,-6.2943 -4.574267,0 -1.586536,2.7505 -1.749639,-1.0157 2.483597,-4.2999 10.171627,0 3.721689,3.7291 5.849424,0 0.04449,0.01 -0.02966,-12.6033 -24.317006,0 z m 15.123992,1.6903 c 1.497414,0 2.70601,1.216 2.70601,2.7134 0,1.4974 -1.208596,2.7134 -2.70601,2.7134 -1.497413,0 -2.713422,-1.216 -2.713422,-2.7134 0,-1.4974 1.216009,-2.7134 2.713422,-2.7134 z m -25.7256143,6.0051 0,4.7967 -6.4721792,0.1186 0,5.0265 6.3535598,0 0,5.1526 7.6064777,-7.6065 -7.4878583,-7.4879 z");
this.register("loading","M 24 2.5 C 22.08477 2.5 20.5 4.0848 20.5 6 C 20.5 7.9152 22.08477 9.5 24 9.5 C 25.91523 9.5 27.5 7.9152 27.5 6 C 27.5 4.0848 25.91523 2.5 24 2.5 z M 11.28125 7.78125 C 10.382381 7.78125 9.4896359 8.1354 8.8125 8.8125 C 7.4582279 10.1668 7.4582281 12.3957 8.8125 13.75 C 10.166772 15.1043 12.395728 15.1043 13.75 13.75 C 15.104272 12.3957 15.104272 10.1668 13.75 8.8125 C 13.072864 8.1354 12.180119 7.78125 11.28125 7.78125 z M 36.71875 7.78125 C 35.819881 7.78125 34.927136 8.1354 34.25 8.8125 C 32.895728 10.1668 32.895728 12.3957 34.25 13.75 C 35.604272 15.1043 37.833228 15.1043 39.1875 13.75 C 40.541772 12.3957 40.541772 10.1668 39.1875 8.8125 C 38.510364 8.1354 37.617619 7.78125 36.71875 7.78125 z M 6 20.5 C 4.08477 20.5 2.5 22.0848 2.5 24 C 2.5 25.9152 4.08477 27.5 6 27.5 C 7.91523 27.5 9.5 25.9152 9.5 24 C 9.5 22.0848 7.91523 20.5 6 20.5 z M 42 20.5 C 40.08477 20.5 38.5 22.0848 38.5 24 C 38.5 25.9152 40.08477 27.5 42 27.5 C 43.91523 27.5 45.5 25.9152 45.5 24 C 45.5 22.0848 43.91523 20.5 42 20.5 z M 11.28125 33.25 C 10.382381 33.25 9.4896359 33.5729 8.8125 34.25 C 7.4582279 35.6043 7.4582281 37.8332 8.8125 39.1875 C 10.166772 40.5418 12.395728 40.5418 13.75 39.1875 C 15.104272 37.8332 15.104272 35.6043 13.75 34.25 C 13.072864 33.5729 12.180119 33.25 11.28125 33.25 z M 36.71875 33.25 C 35.819881 33.25 34.927136 33.5729 34.25 34.25 C 32.895728 35.6043 32.895728 37.8332 34.25 39.1875 C 35.604272 40.5418 37.833228 40.5418 39.1875 39.1875 C 40.541772 37.8332 40.541772 35.6043 39.1875 34.25 C 38.510364 33.5729 37.617619 33.25 36.71875 33.25 z M 24 38.5 C 22.08477 38.5 20.5 40.0848 20.5 42 C 20.5 43.9152 22.08477 45.5 24 45.5 C 25.91523 45.5 27.5 43.9152 27.5 42 C 27.5 40.0848 25.91523 38.5 24 38.5 z");
this.register("edit","m 8.9095805,3.1557733 -4.59375,4.59375 L 16.28125,20.09375 23.890625,23.064732 20.875,15.5 z M 19.517767,9.65625 l 4.027443,4 11.73604,0 c 0.710395,0 1.21875,0.50825 1.21875,1.21875 l 0,21.40625 C 36.5,36.99165 35.991645,37.5 35.28125,37.5 l -19.90625,0 c -0.710395,0 -1.21875,-0.50835 -1.21875,-1.21875 l 0,-14.5 -4,-4.15625 0,18.65625 c 0,2.8573 2.361543,5.21875 5.21875,5.21875 l 19.90625,0 C 38.138457,41.5 40.5,39.13855 40.5,36.28125 l 0,-21.40625 c 0,-2.8573 -2.361543,-5.21875 -5.21875,-5.21875 z");
this.register("upload","M 21.0625 5.90625 L 21.0625 19.25 L 17.75 15.90625 L 14.40625 19.25 L 24.40625 29.25 L 34.40625 19.25 L 31.0625 15.90625 L 27.75 19.25 L 27.75 5.90625 L 21.0625 5.90625 z M 6.96875 29.25 L 6.96875 39.25 L 41.96875 39.25 L 41.96875 29.25 L 36.96875 29.25 L 36.96875 34.25 L 11.96875 34.25 L 11.96875 29.25 L 6.96875 29.25 z");this.register("lock","m 18,5.3622 c -2.735406,0 -5,2.2646 -5,5 l 0,10 -1,0 c -1.662,0 -3,1.338 -3,3 l 0,17.0938 c 0,1.662 1.338,3 3,3 l 23.90625,0 c 1.662,0 3,-1.338 3,-3 l 0,-17.0938 c 0,-1.662 -1.338,-3 -3,-3 l -0.90625,0 0,-10 c 0,-2.7354 -2.264594,-5 -5,-5 l -12,0 z m 0,4 12,0 c 0.588594,0 1,0.4114 1,1 l 0,10 -14,0 0,-10 c 0,-0.5886 0.411406,-1 1,-1 z m 6.21875,15.2188 c 2.08518,0 3.78125,1.696 3.78125,3.7812 0,1.2414 -0.606288,2.3119 -1.53125,3 l 2.375,7.0625 -8.40625,0 2.21875,-6.625 c -1.299069,-0.5968 -2.21875,-1.9143 -2.21875,-3.4375 0,-2.0852 1.696069,-3.7812 3.78125,-3.7812 z");
this.register("savecloud","M 21.9375 3.8125 L 21.9375 17.1875 L 18.625 13.8125 L 15.28125 17.1875 L 25.28125 27.1875 L 35.28125 17.1875 L 31.9375 13.8125 L 28.625 17.1875 L 28.625 3.8125 L 21.9375 3.8125 z M 15.1875 20.28125 C 13.209285 21.36075 11.604359 23.011 10.59375 25.0625 C 6.8454548 26.2652 4.09375 29.6762 4.09375 33.8125 C 4.09375 38.9391 8.2797172 43.125 13.40625 43.125 C 20.743081 43.095 27.938701 43.03125 35.28125 43.03125 C 39.54139 43.03125 43.03125 39.54135 43.03125 35.28125 C 43.03125 31.64315 40.426505 28.72105 37.03125 27.90625 C 36.146814 25.82585 34.408457 24.2103 32.25 23.5625 L 28.15625 27.6875 L 29.09375 27.40625 C 29.429018 27.30195 29.779124 27.25 30.15625 27.25 C 31.886675 27.25 33.262207 28.4157 33.625 30 L 33.96875 31.46875 L 35.46875 31.5625 C 37.488443 31.6695 39.03125 33.23065 39.03125 35.28125 C 39.03125 37.40205 37.40213 39.03125 35.28125 39.03125 C 27.926002 39.03125 20.719684 39.095 13.40625 39.125 C 13.39551 39.125 13.38572 39.1251 13.375 39.125 C 10.404867 39.108 8.09375 36.7874 8.09375 33.8125 C 8.09375 31.1963 9.8983864 29.1112 12.34375 28.625 L 13.4375 28.40625 L 13.8125 27.375 C 14.559974 25.4264 16.147884 23.91675 18.125 23.21875 L 15.1875 20.28125 z");
this.register("calendar","M 14.1875 5.5625 C 13.0795 5.5625 12.1875 6.4545 12.1875 7.5625 L 12.1875 10.5625 C 12.1875 11.6705 13.0795 12.5625 14.1875 12.5625 C 15.2955 12.5625 16.1875 11.6705 16.1875 10.5625 L 16.1875 7.5625 C 16.1875 6.4545 15.2955 5.5625 14.1875 5.5625 z M 34.1875 5.5625 C 33.0795 5.5625 32.1875 6.4545 32.1875 7.5625 L 32.1875 10.5625 C 32.1875 11.6705 33.0795 12.5625 34.1875 12.5625 C 35.2955 12.5625 36.1875 11.6705 36.1875 10.5625 L 36.1875 7.5625 C 36.1875 6.4545 35.2955 5.5625 34.1875 5.5625 z M 7.1875 7.5625 C 5.5255 7.5625 4.1875 8.9005 4.1875 10.5625 L 4.1875 39.5625 C 4.1875 41.2245 5.5255 42.5625 7.1875 42.5625 L 41.1875 42.5625 C 42.8495 42.5625 44.1875 41.2245 44.1875 39.5625 L 44.1875 10.5625 C 44.1875 8.9005 42.8495 7.5625 41.1875 7.5625 L 37.1875 7.5625 L 37.1875 10.5625 C 37.1875 12.2245 35.8495 13.5625 34.1875 13.5625 C 32.5255 13.5625 31.1875 12.2245 31.1875 10.5625 L 31.1875 7.5625 L 17.1875 7.5625 L 17.1875 10.5625 C 17.1875 12.2245 15.8495 13.5625 14.1875 13.5625 C 12.5255 13.5625 11.1875 12.2245 11.1875 10.5625 L 11.1875 7.5625 L 7.1875 7.5625 z M 10.8125 16 L 37.3125 16 C 39.184739 16 40.71875 17.53405 40.71875 19.40625 L 40.71875 36.125 C 40.71875 37.9972 39.184739 39.53125 37.3125 39.53125 L 10.8125 39.53125 C 8.9402615 39.53125 7.40625 37.9972 7.40625 36.125 L 7.40625 19.40625 C 7.40625 17.53405 8.9402615 16 10.8125 16 z M 10.8125 18 C 10.013667 18 9.40625 18.60745 9.40625 19.40625 L 9.40625 22.71875 L 17.5 22.71875 L 17.5 18 L 10.8125 18 z M 20 18 L 20 22.71875 L 28.3125 22.71875 L 28.3125 18 L 20 18 z M 30.8125 18 L 30.8125 22.71875 L 38.71875 22.71875 L 38.71875 19.40625 C 38.71875 18.60745 38.111333 18 37.3125 18 L 30.8125 18 z M 9.40625 25.40625 L 9.40625 30.15625 L 17.5 30.15625 L 17.5 25.40625 L 9.40625 25.40625 z M 20 25.40625 L 20 30.15625 L 28.3125 30.15625 L 28.3125 25.40625 L 20 25.40625 z M 30.8125 25.40625 L 30.8125 30.15625 L 38.71875 30.15625 L 38.71875 25.40625 L 30.8125 25.40625 z M 9.40625 32.8125 L 9.40625 36.125 C 9.40625 36.9238 10.013667 37.53125 10.8125 37.53125 L 17.5 37.53125 L 17.5 32.8125 L 9.40625 32.8125 z M 20 32.8125 L 20 37.53125 L 28.3125 37.53125 L 28.3125 32.8125 L 20 32.8125 z M 30.8125 32.8125 L 30.8125 37.53125 L 37.3125 37.53125 C 38.111333 37.53125 38.71875 36.9238 38.71875 36.125 L 38.71875 32.8125 L 30.8125 32.8125 z");
this.register("phone","m 40.384499,14.35 c -1.119892,-3.9826 -6.075567,-6.426 -9.848629,-4.5362 -4.937864,1.8134 -9.401496,4.7793 -13.051821,8.5578 -2.728309,2.8266 -5.416044,5.8169 -7.164639,9.3668 -1.9606824,4.1618 -2.6965691,9.234 -0.7883623,13.5432 0.8953303,1.7539 2.2878593,3.5559 4.3483553,3.9039 1.538971,0.022 3.047187,-3.1414 4.749325,-5.6577 1.159581,-1.9264 1.891977,-3.1072 0.219874,-4.4568 -1.532716,-1.0108 -3.627001,-2.4014 -3.109132,-4.5295 0.895495,-3.426 3.681076,-5.8349 5.893522,-8.4361 1.553362,-1.6278 3.28975,-3.3638 5.537441,-3.9042 2.196492,0.034 2.908148,3.5456 5.280678,2.8274 2.909013,-1.2741 4.150319,-1.5616 6.601629,-2.6387 2.101818,-0.6214 2.154604,-2.3569 1.331759,-4.0399 z");
this.register("mail","m 3.9898475,12.1511 19.9999995,13.4062 20,-13.4062 -39.9999995,0 z m 0,0.9375 0,24.7812 15.4687495,-12.375 -15.4687495,-12.4062 z m 39.9999995,0 -15.46875,12.4062 15.46875,12.375 0,-24.7812 z m -23.8125,12.9687 -16.1874995,12.0938 0,0.062 39.9999995,0 0,-0.062 -16.21875,-12.0625 -3.78125,3.0312 -3.8125,-3.0625 z");this.register("plus","m 18.928571,4.4336 0,15 -14.9999996,0 0,10 14.9999996,0 0,15 10,0 0,-15 15,0 0,-10 -15,0 0,-15 z");this.register("eye","M 24.15625 10.40625 C 11.735751 10.40625 2.0024346 23.625025 1.59375 24.1875 L 0.90625 25.125 L 1.59375 26.09375 C 2.0024345 26.656226 11.735751 39.875 24.15625 39.875 C 36.576276 39.875 46.31054 26.655751 46.71875 26.09375 L 47.4375 25.125 L 46.71875 24.1875 C 46.31054 23.625025 36.576276 10.40625 24.15625 10.40625 z M 24.15625 13.6875 C 33.120256 13.6875 40.944331 22.21152 43.34375 25.125 C 40.948128 28.038954 33.140667 36.59375 24.15625 36.59375 C 15.193194 36.59375 7.3984708 28.038005 5 25.125 C 7.3946735 22.210571 15.171835 13.6875 24.15625 13.6875 z M 24.8125 15.1875 C 19.396945 15.1875 15 19.557753 15 24.9375 C 15 30.318383 19.396945 34.6875 24.8125 34.6875 C 30.229761 34.6875 34.625 30.318383 34.625 24.9375 C 34.625 23.144819 34.101438 21.474944 33.25 20.03125 C 33.134618 22.135405 31.391099 23.8125 29.25 23.8125 C 27.035579 23.8125 25.25 22.01328 25.25 19.8125 C 25.25 17.87204 26.649913 16.261489 28.5 15.90625 C 27.361528 15.448132 26.115803 15.1875 24.8125 15.1875 z");
this.register("map","M 32 5 L 16 13 L 16 45 L 32 37 L 32 5 z M 35 5 L 35 37 L 47 45 L 47 13 L 35 5 z M 1 6 L 1 38 L 13 45 L 13 13 L 1 6 z M 24.625 12.625 L 26.3125 14.3125 L 28 12.625 L 29.6875 14.3125 L 28 16 L 29.6875 17.6875 L 28 19.375 L 26.3125 17.6875 L 24.625 19.375 L 22.9375 17.6875 L 24.625 16 L 22.9375 14.3125 L 24.625 12.625 z")},getPath:function(a){return Ui.Icon.icons[a]},getNames:function(){var a=[],b;for(b in Ui.Icon.icons)a.push(b);return a},register:function(a,b){if(void 0!=Ui.Icon.icons[a])throw"Icon '"+
a+"' is already registered. To change it, use override";Ui.Icon.icons[a]=b},override:function(a,b){Ui.Icon.icons[a]=b},parse:function(a){return new Ui.Icon({icon:a})}});Ui.CanvasElement.extend("Ui.ButtonGraphic",{text:void 0,icon:void 0,iconSize:24,orientation:void 0,isDown:!1,buttonHasFocus:!1,fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal",textWidth:0,spacing:3,constructor:function(a){this.color=new Ui.Color({r:0.31,g:0.66,b:1})},getText:function(){return this.text},setText:function(a){this.text!=a&&(this.text=a,this.invalidateMeasure(),this.invalidateDraw())},getIcon:function(){return this.icon},setIcon:function(a){this.icon!=a&&(this.icon=a,this.invalidateMeasure(),
this.invalidateDraw())},getOrientation:function(){var a=this.orientation;void 0===a&&(a=this.getStyleProperty("orientation"));return"vertical"===a?"vertical":"horizontal"},setOrientation:function(a){this.orientation!==a&&(this.orientation=a,this.invalidateMeasure(),this.invalidateDraw())},getIsDown:function(){return this.isDown},setIsDown:function(a){this.isDown!=a&&(this.isDown=a,this.invalidateDraw())},setHasFocus:function(a){this.buttonHasFocus!==a&&(this.buttonHasFocus=a,this.invalidateDraw())},
getBackground:function(){var a=(this.buttonHasFocus?Ui.Color.create(this.getStyleProperty("focusBackground")):Ui.Color.create(this.getStyleProperty("background"))).getYuva(),b=0;this.getIsDown()&&(b=-0.2);return new Ui.Color({y:a.y+b,u:a.u,v:a.v,a:a.a})},getBackgroundDark:function(){var a=(this.buttonHasFocus?Ui.Color.create(this.getStyleProperty("focusBackground")):Ui.Color.create(this.getStyleProperty("background"))).getYuva(),b=0;this.getIsDown()&&(b=-0.2);return 0.5>a.y?new Ui.Color({y:a.y-0.3+
b,u:a.u,v:a.v,a:a.a}):new Ui.Color({y:a.y-0.2+b,u:a.u,v:a.v,a:a.a})},getForeground:function(){var a;a=this.buttonHasFocus?Ui.Color.create(this.getStyleProperty("focusForeground")):Ui.Color.create(this.getStyleProperty("foreground"));var b=0;this.getIsDown()&&(b=0.2);a=a.getYuva();return 0.4>a.y?new Ui.Color({y:a.y+b,u:a.u,v:a.v,a:a.a}):new Ui.Color({y:a.y-b,u:a.u,v:a.v,a:a.a})}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=Math.min(this.getStyleProperty("radius"),
Math.min(b,c)/2),e=this.getOrientation();a.fillStyle=this.getBackground().getCssRgba();a.beginPath();a.roundRect(0,0,b,c,d,d,d,d);a.closePath();a.fill();a.fillStyle=this.getBackgroundDark().getCssRgba();a.beginPath();a.roundRect(0,0,b,c,d,d,d,d);a.roundRect(1,1,b-2,c-2,d-1,d-1,d-1,d-1,!0);a.closePath();a.fill();this.getIsDisabled()&&(a.globalAlpha=0.4);void 0!==this.icon&&void 0===this.text?(d=Ui.Icon.getPath(this.icon),e=this.iconSize/48,a.save(),a.translate((b-this.iconSize)/2,(c-this.iconSize)/
2),a.scale(e,e),a.fillStyle=this.getForeground().getCssRgba(),a.beginPath(),a.svgPath(d),a.closePath(),a.fill(),a.restore()):void 0===this.icon&&void 0!==this.text?(a.font="normal "+this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,a.textBaseline="middle",a.fillStyle=this.getForeground().getCssRgba(),a.fillText(this.text,(b-this.textWidth)/2,c/2+2)):void 0!==this.icon&&void 0!==this.text&&("vertical"==e?(d=Ui.Icon.getPath(this.icon),e=this.iconSize/48,a.save(),a.translate((b-this.iconSize)/
2,(c-this.fontSize-this.iconSize-this.spacing)/2),a.scale(e,e),a.fillStyle=this.getForeground().getCssRgba(),a.beginPath(),a.svgPath(d),a.closePath(),a.fill(),a.restore(),a.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,a.textBaseline="top",a.fillStyle=this.getForeground().getCssRgba(),a.fillText(this.text,(b-this.textWidth)/2,c-this.fontSize-4-this.spacing-1)):(d=Ui.Icon.getPath(this.icon),e=this.iconSize/48,a.save(),a.translate(this.spacing+4,(c-this.iconSize)/2-1),a.scale(e,e),a.fillStyle=
this.getForeground().getCssRgba(),a.beginPath(),a.svgPath(d),a.closePath(),a.fill(),a.restore(),a.font="normal "+this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,a.textBaseline="middle",a.fillStyle=this.getForeground().getCssRgba(),a.fillText(this.text,3*this.spacing+this.iconSize,c/2+1)))},measureCore:function(a,b){void 0!=this.text&&(this.textWidth=Ui.Label.measureText(this.text,this.fontSize,this.fontFamily,this.fontWeight).width);var c={width:10,height:10};void 0!==this.icon&&void 0===
this.text?c={width:this.iconSize+2*this.spacing+6,height:this.iconSize+2*this.spacing+6}:void 0===this.icon&&void 0!==this.text?c={width:this.textWidth+2*this.spacing+6,height:this.fontSize+2*this.spacing+6}:void 0!==this.icon&&void 0!==this.text&&(c="vertical"===this.getOrientation()?{width:Math.max(this.textWidth,this.iconSize)+2*this.spacing+6,height:this.iconSize+this.fontSize+3*this.spacing+6}:{width:this.textWidth+this.iconSize+4*this.spacing+6,height:Math.max(this.iconSize,this.fontSize)+2*
this.spacing+6});return c},onDisable:function(){this.invalidateDraw()},onEnable:function(){this.invalidateDraw()},onStyleChange:function(){this.spacing=Math.max(0,this.getStyleProperty("spacing"));this.iconSize=Math.max(0,this.getStyleProperty("iconSize"));this.fontFamily=this.getStyleProperty("fontFamily");this.fontSize=Math.max(0,this.getStyleProperty("fontSize"));this.fontWeight=this.getStyleProperty("fontWeight");this.invalidateMeasure();this.invalidateDraw()}},{style:{orientation:"horizontal",
background:"rgba(250,250,250,1)",foreground:"#444444",focusBackground:new Ui.Color({r:0.13,g:0.83,b:1}),focusForeground:"#222222",radius:3,spacing:5,iconSize:24,fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal"}});Ui.Element.extend("Ui.Label",{text:"",orientation:"horizontal",fontSize:void 0,fontFamily:void 0,fontWeight:void 0,color:void 0,labelDrawing:void 0,textMeasureValid:!1,textWidth:0,textHeight:0,constructor:function(a){this.setSelectable(!1)},getText:function(){return this.text},setText:function(a){this.text!=a&&(this.text=a,"textContent"in this.labelDrawing?this.labelDrawing.textContent=this.text:this.labelDrawing.innerText=this.text,this.textMeasureValid=!1,this.invalidateMeasure())},setFontSize:function(a){this.fontSize!=
a&&(this.fontSize=a,this.labelDrawing.style.fontSize=this.getFontSize()+"px",this.textMeasureValid=!1,this.invalidateMeasure())},getFontSize:function(){return void 0!=this.fontSize?this.fontSize:this.getStyleProperty("fontSize")},setFontFamily:function(a){this.fontFamily!=a&&(this.fontFamily=a,this.labelDrawing.style.fontFamily=this.getFontFamily(),this.textMeasureValid=!1,this.invalidateMeasure())},getFontFamily:function(){return void 0!=this.fontFamily?this.fontFamily:this.getStyleProperty("fontFamily")},
setFontWeight:function(a){this.fontWeight!=a&&(this.fontWeight=a,this.labelDrawing.style.fontWeight=this.getFontWeight(),this.textMeasureValid=!1,this.invalidateMeasure())},getFontWeight:function(){return void 0!=this.fontWeight?this.fontWeight:this.getStyleProperty("fontWeight")},setColor:function(a){this.color!=a&&(this.color=Ui.Color.create(a),this.labelDrawing.style.color=navigator.supportRgba?this.getColor().getCssRgba():this.getColor().getCssHtml())},getColor:function(){return void 0!=this.color?
this.color:Ui.Color.create(this.getStyleProperty("color"))},getOrientation:function(){return this.orientation},setOrientation:function(a){this.orientation!=a&&(this.orientation=a,this.invalidateMeasure())}},{verticalAlign:"center",horizontalAlign:"center",onStyleChange:function(){this.labelDrawing.style.fontSize=this.getFontSize()+"px";this.labelDrawing.style.fontFamily=this.getFontFamily();this.labelDrawing.style.fontWeight=this.getFontWeight();this.labelDrawing.style.color=navigator.supportRgba?
this.getColor().getCssRgba():this.getColor().getCssHtml();this.textMeasureValid=!1;this.invalidateMeasure()},renderDrawing:function(){this.labelDrawing=document.createElement("div");this.labelDrawing.style.whiteSpace="nowrap";this.labelDrawing.style.display="inline";this.labelDrawing.style.position="absolute";this.labelDrawing.style.left="0px";this.labelDrawing.style.top="0px";return this.labelDrawing},measureCore:function(a,b){if(!this.textMeasureValid){this.textMeasureValid=!0;var c=Ui.Label.measureText(this.text,
this.getFontSize(),this.getFontFamily(),this.getFontWeight());this.textWidth=c.width;this.textHeight=c.height}return"vertical"==this.orientation?{width:this.textHeight,height:this.textWidth}:{width:this.textWidth,height:this.textHeight}},arrangeCore:function(a,b){var c;"vertical"==this.orientation?(c=Ui.Matrix.createTranslate(this.labelDrawing.offsetHeight,0),c.rotate(90),navigator.isIE?(this.labelDrawing.style.msTransform=c.toString(),this.labelDrawing.style.msTransformOrigin="0% 0%"):navigator.isGecko?
(this.labelDrawing.style.MozTransform="matrix("+c.svgMatrix.a.toFixed(4)+", "+c.svgMatrix.b.toFixed(4)+", "+c.svgMatrix.c.toFixed(4)+", "+c.svgMatrix.d.toFixed(4)+", "+c.svgMatrix.e.toFixed(0)+"px, "+c.svgMatrix.f.toFixed(0)+"px)",this.labelDrawing.style.MozTransformOrigin="0% 0%"):navigator.isWebkit?(this.labelDrawing.style.webkitTransform=c.toString(),this.labelDrawing.style.webkitTransformOrigin="0% 0%"):navigator.isOpera&&(this.labelDrawing.style.OTransform=c.toString(),this.labelDrawing.style.OTransformOrigin=
"0% 0%")):navigator.isIE&&"removeProperty"in this.labelDrawing?this.labelDrawing.style.removeProperty("-ms-transform"):navigator.isGecko?this.labelDrawing.style.removeProperty("-moz-transform"):navigator.isWebkit?this.labelDrawing.style.removeProperty("-webkit-transform"):navigator.isOpera&&this.labelDrawing.style.removeProperty("-o-transform")}},{measureBox:void 0,measureContext:void 0,measureTextCanvas:function(a,b,c,d){void 0===Ui.Label.measureBox&&this.createMeasureCanvas();Ui.Label.measureContext.font=
"normal "+d+" "+b+"px "+c;a=Ui.Label.measureContext.measureText(a);a.height=b;return a},createMeasureCanvas:function(){var a=window;if(navigator.isIE||navigator.isGecko)a=Ui.App.getRootWindow();if(void 0===a.document.body){var b=a.document.createElement("body");a.document.body=b}Ui.Label.measureBox=a.document.createElement("canvas");Ui.Label.measureBox.style.visibility="hidden";Ui.Label.measureBox.style.position="absolute";Ui.Label.measureBox.style.left="0px";Ui.Label.measureBox.style.top="0px";Ui.Label.measureBox.style.outline=
"none";Ui.Label.measureBox.setAttribute("width",10,null);Ui.Label.measureBox.setAttribute("height",10,null);a.document.body.appendChild(Ui.Label.measureBox);Ui.Label.measureContext=Ui.Label.measureBox.getContext("2d")},isFontAvailable:function(a,b){if(!navigator.supportCanvas)return!0;void 0===Ui.Label.measureBox&&Ui.Label.createMeasureCanvas();var c=Ui.Label.measureContext;c.fillStyle="rgba(0,0,0,0)";c.clearRect(0,0,10,10);c.textBaseline="top";c.font="normal "+b+" 10px "+a;c.fillStyle="rgba(255,255,255,1)";
c.fillText("@",0,0);for(var d=c.getImageData(0,0,10,10),e=!0,g=0;e&&g<d.data.length;g+=4)0!==d.data[g+3]&&(e=!1);if(e)return!1;c.fillStyle="rgba(0,0,0,0)";c.clearRect(0,0,10,10);c.fillStyle="rgba(255,255,255,1)";c.font="normal "+b+" 10px Sans-Serif";c.fillText("@",0,0);d=c.getImageData(0,0,10,10);c.fillStyle="rgba(0,0,0,0)";c.clearRect(0,0,10,10);c.fillStyle="rgba(255,255,255,1)";c.font="normal "+b+" 10px "+a+",Sans-Serif";c.fillText("@",0,0);c=c.getImageData(0,0,10,10);for(g=0;g<c.data.length;g+=
4)if(c.data[g+3]!==d.data[g+3])return!0;return!1},measureTextHtml:function(a,b,c,d){void 0===Ui.Label.measureBox&&this.createMeasureHtml();Ui.Label.measureBox.style.fontSize=b+"px";Ui.Label.measureBox.style.fontFamily=c;Ui.Label.measureBox.style.fontWeight=d;"textContent"in Ui.Label.measureBox?Ui.Label.measureBox.textContent=a:Ui.Label.measureBox.innerText=a;return{width:Ui.Label.measureBox.offsetWidth,height:Ui.Label.measureBox.offsetHeight}},createMeasureHtml:function(){var a=window;if(navigator.isIE||
navigator.isGecko)a=Ui.App.getRootWindow();if(void 0===a.document.body){var b=a.document.createElement("body");a.document.body=b}Ui.Label.measureBox=a.document.createElement("div");Ui.Label.measureBox.style.whiteSpace="nowrap";Ui.Label.measureBox.style.position="absolute";Ui.Label.measureBox.style.left="0px";Ui.Label.measureBox.style.top="0px";Ui.Label.measureBox.style.position="absolute";Ui.Label.measureBox.style.display="inline";Ui.Label.measureBox.style.visibility="hidden";a.document.body.appendChild(Ui.Label.measureBox)},
measureText:function(a,b,c,d){return""===a||void 0===a?{width:0,height:0}:navigator.supportCanvas?Ui.Label.measureTextCanvas(a,b,c,d):Ui.Label.measureTextHtml(a,b,c,d)},style:{color:new Ui.Color({r:0,g:0,b:0}),fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal"}});Ui.Element.extend("Ui.Text",{text:"",fontSize:void 0,fontFamily:void 0,fontWeight:void 0,color:void 0,textAlign:void 0,interLine:void 0,measureDrawing:void 0,textDrawing:void 0,line:void 0,word:void 0,words:void 0,flowRender:!1,offsetX:0,offsetY:0,spaceWidth:void 0,maxWidth:void 0,maxLineWidth:0,lineHeight:void 0,textMeasureValid:!1,lineCount:0,constructor:function(a){this.setSelectable(!1);this.words=[]},getText:function(){return this.text},setText:function(a){this.text!=a&&(this.text=a,this.splitText(),
this.textMeasureValid=!1,this.invalidateMeasure())},getTextAlign:function(){return void 0!==this.textAlign?this.textAlign:this.getStyleProperty("textAlign")},setTextAlign:function(a){this.textAlign!=a&&(this.textAlign=a,this.invalidateMeasure())},setFontSize:function(a){this.fontSize!=a&&(this.fontSize=a,this.textDrawing.style.fontSize=this.getFontSize()+"px",this.textMeasureValid=!1,this.invalidateMeasure())},getFontSize:function(){return void 0!==this.fontSize?this.fontSize:this.getStyleProperty("fontSize")},
setFontFamily:function(a){this.fontFamily!=a&&(this.fontFamily=a,this.textDrawing.style.fontFamily=this.getFontFamily(),this.textMeasureValid=!1,this.invalidateMeasure())},getFontFamily:function(){return void 0!==this.fontFamily?this.fontFamily:this.getStyleProperty("fontFamily")},setFontWeight:function(a){this.fontWeight!=a&&(this.fontWeight=a,this.textDrawing.style.fontWeight=this.getFontWeight(),this.textMeasureValid=!1,this.invalidateMeasure())},getFontWeight:function(){return void 0!==this.fontWeight?
this.fontWeight:this.getStyleProperty("fontWeight")},setInterLine:function(a){this.interLine!=a&&(this.interLine=a,this.invalidateMeasure())},getInterLine:function(){return void 0!==this.interLine?this.interLine:this.getStyleProperty("interLine")},setColor:function(a){this.color!=a&&(this.color=Ui.Color.create(a),this.textDrawing.style.color=navigator.supportRgba?this.color.getCssRgba():this.color.getCssHtml())},getColor:function(){return void 0!==this.color?this.color:Ui.Color.create(this.getStyleProperty("color"))},
addWord:function(a){a.size>this.maxWidth&&(this.maxWidth=a.size);var b=this.offsetX+a.size;""!=this.line&&(b+=this.spaceWidth);b>this.maxWidth&&this.flushLine(this.offsetX);""!=this.line&&(this.line+=" ",this.offsetX+=this.spaceWidth);this.line+=a.word;this.offsetX+=a.size},newLine:function(){this.flushLine(this.offsetX)},flushLine:function(a){if(this.flowRender&&""!=this.line){var b=document.createElement("div");b.style.whiteSpace="nowrap";b.style.display="inline";b.style.position="absolute";var c=
this.getTextAlign();b.style.left="left"==c?"0px":"right"==c?this.maxWidth-a+"px":(this.maxWidth-a)/2+"px";b.style.top=this.offsetY+"px";"textContent"in b?b.textContent=this.line:b.innerText=this.line;this.textDrawing.appendChild(b)}this.offsetX>this.maxLineWidth&&(this.maxLineWidth=this.offsetX);this.offsetX=0;this.offsetY+=this.lineHeight*this.getInterLine();this.line="";this.lineCount++},updateFlow:function(a,b){this.flowRender=b;this.maxWidth=a;this.lineCount=this.maxLineWidth=0;this.lineHeight=
this.getFontSize();this.offsetY=this.offsetX=0;var c=this.line="",d;for(d=0;d<this.words.length;d++)c=this.words[d],"word"==c.type?this.addWord(c):"newline"==c.type&&this.newLine()},splitText:function(){for(var a="",b=[],c=0;c<this.text.length;c++)" "==this.text.charAt(c)||"\n"==this.text.charAt(c)?(""!=a&&(b.push({type:"word",word:a}),a=""),"\n"==this.text.charAt(c)&&b.push({type:"newline"})):a+=this.text.charAt(c);""!=a&&b.push({type:"word",word:a});b.push({type:"newline"});this.words=b},updateMeasure:function(){if(!this.textMeasureValid){this.spaceWidth=
Ui.Label.measureText(". .",this.getFontSize(),this.getFontFamily(),this.getFontWeight()).width;this.spaceWidth-=Ui.Label.measureText("..",this.getFontSize(),this.getFontFamily(),this.getFontWeight()).width;for(var a=0;a<this.words.length;a++){var b=this.words[a];"word"==b.type&&(b.size=Ui.Label.measureText(b.word,this.getFontSize(),this.getFontFamily(),this.getFontWeight()).width)}this.textMeasureValid=!0}}},{onStyleChange:function(){this.textDrawing.style.fontSize=this.getFontSize()+"px";this.textDrawing.style.fontFamily=
this.getFontFamily();this.textDrawing.style.fontWeight=this.getFontWeight();this.textDrawing.style.color=navigator.supportRgba?this.getColor().getCssRgba():this.getColor().getCssHtml();this.textMeasureValid=!1;this.invalidateMeasure()},renderDrawing:function(){this.textDrawing=document.createElement("div");this.textDrawing.style.position="absolute";this.textDrawing.style.left="0px";this.textDrawing.style.top="0px";return this.textDrawing},measureCore:function(a,b){void 0!==this.getWidth()&&(a=this.getWidth());
this.updateMeasure();this.updateFlow(a,!1);return void 0===this.getWidth()?{width:this.maxLineWidth,height:this.offsetY}:{width:this.maxWidth,height:this.offsetY}},arrangeCore:function(a,b){for(;this.textDrawing.hasChildNodes();)this.textDrawing.removeChild(this.textDrawing.firstChild);this.updateFlow(a,!0)}},{style:{color:new Ui.Color({r:0,g:0,b:0}),fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal",textAlign:"left",interLine:1}});Ui.Element.extend("Ui.CompactLabel",{text:"",fontSize:void 0,fontFamily:void 0,fontWeight:void 0,color:void 0,textDrawing:void 0,maxLine:void 0,textAlign:"left",isMeasureValid:!1,isArrangeValid:!1,lastMeasureWidth:0,lastMeasureHeight:0,lastAvailableWidth:0,superCompact:!1,constructor:function(a){this.setSelectable(!1)},getSuperCompact:function(){return this.superCompact},setSuperCompact:function(a){a!=this.superCompact&&(this.superCompact=a,this.invalidateMeasure())},getMaxLine:function(){return this.maxLine},
setMaxLine:function(a){this.maxLine!=a&&(this.maxLine=a,this.isMeasureValid=!1,this.invalidateMeasure())},getTextAlign:function(){return this.textAlign},setTextAlign:function(a){this.textAlign!=a&&(this.textAlign=a,this.isMeasureValid=!1,this.invalidateArrange())},getText:function(){return this.text},setText:function(a){this.text!==a&&(this.text=a,this.isMeasureValid=!1,this.invalidateMeasure())},setFontSize:function(a){this.fontSize!=a&&(this.fontSize=a,this.isMeasureValid=!1,this.textDrawing.style.fontSize=
this.getFontSize()+"px",this.invalidateMeasure())},getFontSize:function(){return void 0!=this.fontSize?this.fontSize:this.getStyleProperty("fontSize")},setFontFamily:function(a){this.fontFamily!=a&&(this.fontFamily=a,this.isMeasureValid=!1,this.textDrawing.style.fontFamily=this.getFontFamily(),this.invalidateMeasure())},getFontFamily:function(){return void 0!=this.fontFamily?this.fontFamily:this.getStyleProperty("fontFamily")},setFontWeight:function(a){this.fontWeight!=a&&(this.fontWeight=a,this.isMeasureValid=
!1,this.textDrawing.style.fontWeight=this.getFontWeight(),this.invalidateMeasure())},getFontWeight:function(){return void 0!=this.fontWeight?this.fontWeight:this.getStyleProperty("fontWeight")},setColor:function(a){this.color!=a&&(this.color=Ui.Color.create(a),this.textDrawing.style.color=navigator.supportRgba?this.color.getCssRgba():this.color.getCssHtml())},getColor:function(){return void 0!==this.color?this.color:Ui.Color.create(this.getStyleProperty("color"))},flushLine:function(a,b,c,d){var e=
Ui.Label.measureText(b,this.getFontSize(),this.getFontFamily(),this.getFontWeight());d&&(c="left"==this.textAlign?0:"right"==this.textAlign?c-e.width:(c-e.width)/2,d=document.createElement("div"),d.style.whiteSpace="nowrap",d.style.display="inline",d.style.position="absolute",d.style.left=c+"px",d.style.top=a+"px","textContent"in d?d.textContent=b:d.innerText=b,this.textDrawing.appendChild(d));return e.height},updateFlow:function(a,b){if(void 0===this.text)return{width:0,height:0};for(var c=this.getFontSize(),
d=this.getFontFamily(),e=this.getFontWeight(),g=Ui.Label.measureText("...",c,d,e).width,f=0,h="",k=0,m=0,l=0;l<this.text.length;l++){var n=Ui.Label.measureText(h+this.text.charAt(l),c,d,e);if(void 0!=this.maxLine&&k+1>=this.maxLine&&n.width+g>a)return f+=this.flushLine(f,h+"...",a,b),x>m&&(m=x),{width:m,height:f};n.width>a?(f+=this.flushLine(f,h,a,b),k++,x>m&&(m=x),h=this.text.charAt(l)):h+=this.text.charAt(l)}""!=h&&(f+=this.flushLine(f,h,a,b),x>m&&(m=x));return{width:m,height:f}},updateFlowWords:function(a,
b){if(void 0===this.text||null===this.text)return{width:0,height:0};for(var c=this.getFontSize(),d=this.getFontFamily(),e=this.getFontWeight(),g=Ui.Label.measureText("...",c,d,e).width,f=[],h=[],k=this.text.split(" "),m=0;m<k.length;m++)for(var l=k[m];;){var n=Ui.Label.measureText(l,c,d,e).width;if(n<a){f.push(l);h.push(n);break}else for(var n="",p=0;p<l.length;p++)if(Ui.Label.measureText(n+l.charAt(p),c,d,e).width<a)n+=l.charAt(p);else{f.push(n);h.push(Ui.Label.measureText(n,c,d,e).width);l=l.substr(n.length,
l.length-n.length);break}if(0==l.length)break}for(var r=Ui.Label.measureText(". .",c,d,e).width-Ui.Label.measureText("..",c,d,e).width,n=l=k=0,p="",v=0,m=0;m<f.length;m++){if(""!=p)if(l+r>a){if(void 0!=this.maxLine&&v+1>=this.maxLine){for(;;)if(f=Ui.Label.measureText(p,c,d,e).width,f+g>a){if(1>=p.length){p="...";break}p=p.substr(0,p.length-1)}else{p+="...";break}k+=this.flushLine(k,p,a,b);l>n&&(n=l);return{width:n,height:k}}k+=this.flushLine(k,p,a,b);l>n&&(n=l);l=0;v++;p=""}else p+=" ",l+=r;if(l+
h[m]>a){if(void 0!=this.maxLine&&v+1>=this.maxLine){for(;;)if(f=Ui.Label.measureText(p,c,d,e).width,f+g>a){if(1>=p.length){p="...";break}p=p.substr(0,p.length-1)}else{p+="...";break}k+=this.flushLine(k,p,a,b);l>n&&(n=l);return{width:n,height:k}}k+=this.flushLine(k,p,a,b);v++;l>n&&(n=l);l=h[m];p=f[m]}else p+=f[m],l+=h[m]}""!=p&&(k+=this.flushLine(k,p,a,b),l>n&&(n=l));return{width:n,height:k}}},{renderDrawing:function(){var a=Ui.CompactLabel.base.renderDrawing.apply(this,arguments);this.textDrawing=
document.createElement("div");this.textDrawing.style.fontFamily=this.getFontFamily();this.textDrawing.style.fontWeight=this.getFontWeight();this.textDrawing.style.fontSize=this.getFontSize()+"px";this.textDrawing.style.color=navigator.supportRgba?this.getColor().getCssRgba():this.getColor().getCssHtml();this.textDrawing.style.position="absolute";this.textDrawing.style.left="0px";this.textDrawing.style.top="0px";a.appendChild(this.textDrawing);return a},onStyleChange:function(){this.textDrawing.style.fontSize=
this.getFontSize()+"px";this.textDrawing.style.fontFamily=this.getFontFamily();this.textDrawing.style.fontWeight=this.getFontWeight();this.textDrawing.style.color=navigator.supportRgba?this.getColor().getCssRgba():this.getColor().getCssHtml();this.invalidateMeasure()},measureCore:function(a,b){if(!this.isMeasureValid||this.lastAvailableWidth!=a){this.lastAvailableWidth=a;var c;c=this.superCompact?this.updateFlow(a,!1):this.updateFlowWords(a,!1);this.lastMeasureHeight=c.height;this.lastMeasureWidth=
c.width;this.isMeasureValid=!0;this.isArrangeValid=!1}return{width:this.lastMeasureWidth,height:this.lastMeasureHeight}},arrangeCore:function(a,b){if(!this.isArrangeValid){for(this.isArrangeValid=!0;this.textDrawing.hasChildNodes();)this.textDrawing.removeChild(this.textDrawing.firstChild);this.superCompact?this.updateFlow(a,!0):this.updateFlowWords(a,!0)}}},{style:{color:new Ui.Color({r:0,g:0,b:0}),fontSize:16,fontFamily:"Sans-serif",fontWeight:"normal"}});Ui.Element.extend("Ui.Html",{htmlDrawing:void 0,bindedOnImageLoad:void 0,constructor:function(a){this.addEvents("link");this.bindedOnImageLoad=this.onImageLoad.bind(this);this.connect(this.getDrawing(),"click",this.onClick);this.connect(this.getDrawing(),"DOMSubtreeModified",this.onSubtreeModified);this.connect(this.getDrawing(),"keypress",this.onKeyPress)},getHtml:function(){return this.htmlDrawing.innerHTML},getElements:function(a){var b=[];this.searchElements(a.toUpperCase(),this.htmlDrawing,b);
return b},searchElements:function(a,b,c){for(var d=0;d<b.childNodes.length;d++){var e=b.childNodes[d];"tagName"in e&&e.tagName.toUpperCase()==a&&c.push(e);this.searchElements(a,e,c)}},getParentElement:function(a,b){do{if("tagName"in b&&b.tagName.toUpperCase()==a)return b;if(void 0==b.parentNode||b.parentNode===this.getDrawing())break;b=b.parentNode}while(1)},setHtml:function(a){this.htmlDrawing.innerHTML=a;a=this.getElements("IMG");for(var b=0;b<a.length;b++)a[b].onload=this.bindedOnImageLoad;this.invalidateMeasure()},
setText:function(a){"textContent"in this.htmlDrawing?this.htmlDrawing.textContent=a:this.htmlDrawing.innerText=a;this.invalidateMeasure()},getText:function(){return"textContent"in this.htmlDrawing?this.htmlDrawing.textContent:this.htmlDrawing.innerText},onSubtreeModified:function(a){this.invalidateMeasure()},onKeyPress:function(a){this.invalidateMeasure()},onImageLoad:function(a){this.invalidateMeasure()},onClick:function(a){void 0!==this.getParentElement("A",a.target)&&(a.preventDefault(),a.stopPropagation())}},
{renderDrawing:function(){var a=Ui.Html.base.renderDrawing.apply(this,arguments);this.htmlDrawing=document.createElement("div");a.appendChild(this.htmlDrawing);return a},measureCore:function(a,b){this.htmlDrawing.style.width=(void 0!==this.getWidth()?Math.max(a,this.getWidth()):a)+"px";this.htmlDrawing.scrollWidth>this.htmlDrawing.clientWidth&&(this.htmlDrawing.style.width=this.htmlDrawing.scrollWidth+"px");return{width:this.htmlDrawing.clientWidth,height:this.htmlDrawing.clientHeight}},arrangeCore:function(a,
b){this.htmlDrawing.style.width=a+"px"}});Ui.Element.extend("Ui.ContentEditable",{html:void 0,anchorNode:null,anchorOffset:0,constructor:function(a){this.addEvents("anchorchange");this.setSelectable(!0);this.setFocusable(!0);this.getDrawing().setAttribute("contenteditable","true");this.connect(this.getDrawing(),"keyup",this.onKeyUp)},getHtml:function(){return this.getDrawing().innerHTML},setHtml:function(a){this.getDrawing().innerHTML=a;this.html=this.getDrawing().innerHTML;this.invalidateMeasure()},getTextContent:function(a){var b="";3===
a.nodeType?b+=a.textContent:1===a.nodeType&&"BR"==a.nodeName&&(b+="\n");if("childNodes"in a)for(var c=0;c<a.childNodes.length;c++)b+=this.getTextContent(a.childNodes[c]);return b},getText:function(){return"innerText"in this.getDrawing()?this.getDrawing().innerText:this.getTextContent(this.getDrawing())},onKeyUp:function(a){this.testAnchorChange()},onSubtreeModified:function(a){this.testAnchorChange();this.html=this.getDrawing().innerHTML;this.invalidateMeasure()},onKeyPress:function(a){this.getDrawing().innerHTML!==
this.html&&(this.html=this.getDrawing().innerHTML,this.invalidateMeasure())},onTouchEndCapture:function(){new Core.DelayedTask({delay:0,scope:this,callback:this.testAnchorChange})},testAnchorChange:function(){if(window.getSelection().anchorNode!=this.anchorNode||window.getSelection().anchorOffset!=this.anchorOffset)this.anchorNode=window.getSelection().anchorNode,this.anchorOffset=window.getSelection().anchorOffset,this.fireEvent("anchorchange",this)}},{renderDrawing:function(){var a=document.createElement("div");
a.style.display="block";a.style.position="absolute";a.style.left="0px";a.style.top="0px";this.connect(a,"DOMSubtreeModified",this.onSubtreeModified);this.connect(a,"keypress",this.onKeyPress);return a},measureCore:function(a,b){var c=document.createElement("div");c.style.display="block";c.style.visibility="hidden";c.style.position="absolute";c.style.left="0px";c.style.top="0px";c.style.fontSize=this.getStyleProperty("fontSize")+"px";c.style.fontFamily=this.getStyleProperty("fontFamily");c.style.fontWeight=
this.getStyleProperty("fontWeight");void 0!=this.getWidth()&&(c.style.width=this.getWidth()+"px");c.innerHTML=this.getDrawing().innerHTML;document.body.appendChild(c);var d=c.clientWidth,e=c.clientHeight;document.body.removeChild(c);return{width:d,height:e}},onDisable:function(){Ui.ContentEditable.base.onDisable.call(this);this.getDrawing().blur();this.getDrawing().style.cursor="default"},onEnable:function(){Ui.ContentEditable.base.onEnable.call(this);this.getDrawing().style.cursor="auto"},onStyleChange:function(){var a=
Ui.Color.create(this.getStyleProperty("color"));this.getDrawing().style.fontSize=this.getStyleProperty("fontSize")+"px";this.getDrawing().style.fontFamily=this.getStyleProperty("fontFamily");this.getDrawing().style.fontWeight=this.getStyleProperty("fontWeight");navigator.supportRgba?this.getDrawing().style.color=a.getCssRgba():this.getDrawing().style.color=a.getCssHtml();this.invalidateMeasure()}},{style:{color:new Ui.Color({r:0,g:0,b:0}),fontSize:18,fontFamily:"Sans-serif",fontWeight:"normal"}});Ui.Element.extend("Ui.Image",{src:void 0,loaddone:!1,naturalWidth:void 0,naturalHeight:void 0,imageDrawing:void 0,setSrcLock:!1,constructor:function(a){this.addEvents("ready","error");this.connect(this.imageDrawing,"contextmenu",function(a){a.preventDefault()});this.connect(this.imageDrawing,"load",this.onImageLoad);this.connect(this.imageDrawing,"error",this.onImageError)},getSrc:function(){return this.src},setSrc:function(a){if(void 0==a)throw"Image src cant be undefined";this.setSrcLock=!0;this.loaddone=
!1;this.naturalHeight=this.naturalWidth=void 0;this.src=a;this.imageDrawing.setAttribute("src",a);this.setSrcLock=!1},getNaturalWidth:function(){return this.naturalWidth},getNaturalHeight:function(){return this.naturalHeight},getIsReady:function(){return this.loaddone},onImageError:function(a){this.fireEvent("error",this)},onImageLoad:function(a){if(void 0!=a.target&&void 0!=a.target.naturalWidth&&void 0!=a.target.naturalHeight)this.loaddone=!0,this.naturalWidth=a.target.naturalWidth,this.naturalHeight=
a.target.naturalHeight,this.fireEvent("ready",this),this.invalidateMeasure();else if(this.setSrcLock)new Core.DelayedTask({delay:0,scope:this,callback:this.onImageDelayReady});else this.onImageDelayReady()},onAppReady:function(){this.disconnect(Ui.App.current,"ready",this.onAppReady);this.onImageDelayReady()},onIEDragStart:function(a){a.defaultPrevented=!0;return a.returnValue=!1},onImageDelayReady:function(){if(Ui.App.current.getIsReady()){this.loaddone=!0;if(void 0===document.body||null===document.body){var a=
document.createElement("body");document.body=a}a=document.createElement("img");a.setAttribute("src",this.src);document.body.appendChild(a);this.naturalWidth=a.width;this.naturalHeight=a.height;document.body.removeChild(a);this.fireEvent("ready",this);this.invalidateMeasure()}else this.connect(Ui.App.current,"ready",this.onAppReady)}},{renderDrawing:function(){this.imageDrawing=document.createElement("img");this.imageDrawing.style.position="absolute";this.imageDrawing.style.top="0px";this.imageDrawing.style.left=
"0px";this.imageDrawing.style.width="0px";this.imageDrawing.style.height="0px";this.imageDrawing.setAttribute("draggable",!1);navigator.isWebkit?(this.imageDrawing.style.webkitUserSelect="none",this.imageDrawing.style.webkitTouchCallout="none"):navigator.isGecko?this.imageDrawing.style.MozUserSelect="none":navigator.isIE?(this.connect(this.imageDrawing,"selectstart",function(a){a.preventDefault()}),"attachEvent"in this.imageDrawing&&this.imageDrawing.attachEvent("ondragstart",this.onIEDragStart)):
navigator.isOpera&&(this.imageDrawing.onmousedown=function(a){a.preventDefault()});return this.imageDrawing},measureCore:function(a,b){if(!this.loaddone)return{width:0,height:0};var c;void 0===this.getWidth()?void 0===this.getHeight()?c={width:this.naturalWidth,height:this.naturalHeight}:(c=this.getHeight()-(this.getMarginTop()+this.getMarginBottom()),c={width:this.naturalWidth*c/this.naturalHeight,height:c}):void 0===this.getHeight()?(c=this.getWidth()-(this.getMarginLeft()+this.getMarginRight()),
c={width:c,height:this.naturalHeight*c/this.naturalWidth}):c={width:0,height:0};return c},arrangeCore:function(a,b){void 0!=this.imageDrawing&&(this.imageDrawing.style.width=a+"px",this.imageDrawing.style.height=b+"px")}});Ui.Element.extend("Ui.Audio",{src:void 0,oggSrc:void 0,mp3Src:void 0,wavSrc:void 0,loaddone:!1,audioDrawing:void 0,canplaythrough:!1,state:"initial",constructor:function(a){this.addEvents("ready","ended","timeupdate","bufferingupdate","statechange","error");this.connect(this,"unload",this.onAudioUnload);if(void 0!=a.oggSrc||void 0!=a.mp3Src||void 0!=a.wavSrc)void 0!=a.oggSrc&&Ui.Audio.supportOgg?this.setSrc(a.oggSrc):void 0!=a.aacSrc&&Ui.Audio.supportAac?this.setSrc(a.aacSrc):void 0!=a.mp3Src&&Ui.Audio.supportMp3?
this.setSrc(a.mp3Src):void 0!=a.wavSrc&&Ui.Audio.supportWav&&this.setSrc(a.wavSrc),delete a.oggSrc,delete a.aacSrc,delete a.mp3Src,delete a.wavSrc},setSrc:function(a){this.canplaythrough=!1;this.state="initial";this.src=a;this.audioDrawing.setAttribute("src",a);try{this.audioDrawing.load()}catch(b){}},play:function(){this.state="playing";this.fireEvent("statechange",this,this.state);this.canplaythrough?this.audioDrawing.play():this.audioDrawing.load()},pause:function(){this.state="paused";this.fireEvent("statechange",
this,this.state);this.canplaythrough?this.audioDrawing.pause():this.audioDrawing.load()},stop:function(){this.audioDrawing.pause();this.onEnded()},setVolume:function(a){this.audioDrawing.volume=a},getVolume:function(){return this.audioDrawing.volume},getDuration:function(){return this.audioDrawing.duration},setCurrentTime:function(a){this.audioDrawing.currentTime=a},getCurrentTime:function(){return void 0==this.audioDrawing.currentTime?0:this.audioDrawing.currentTime},getState:function(){return this.state},
getIsReady:function(){return this.canplaythrough},onReady:function(){this.canplaythrough=!0;"playing"==this.state?this.audioDrawing.play():"paused"==this.state&&this.audioDrawing.pause();this.fireEvent("ready")},onTimeUpdate:function(){this.fireEvent("timeupdate",this,this.audioDrawing.currentTime);this.checkBuffering()},onEnded:function(){this.state="initial";this.audioDrawing.currentTime=0;this.fireEvent("ended",this);this.fireEvent("statechange",this,this.state)},onProgress:function(){this.checkBuffering()},
getCurrentBufferSize:function(){var a=this.audioDrawing.buffered,b=0,c=this.audioDrawing.currentTime;void 0==c&&(c=0);for(var d=void 0,e=0;e<a.length;e++){var g=a.start(e),f=a.end(e);void 0==d?g<=c&&f>=c&&(b=f-c,d=f):d>=g-0.01&&d<=f&&(b+=f-d,d=f)}return b},checkBuffering:function(){var a=this.getCurrentBufferSize(),b=this.audioDrawing.currentTime,c=this.audioDrawing.duration;if("buffering"==this.state){if(5<=a||1==this.audioDrawing.networkState||b+a>=c)this.state="playing",this.audioDrawing.play(),
this.fireEvent("statechange",this,this.state)}else"playing"==this.state&&0.1>=a&&b+a<c&&(this.state="buffering",this.audioDrawing.pause(),this.fireEvent("statechange",this,this.state));this.fireEvent("bufferingupdate",this,a)},onError:function(){this.state="error";this.fireEvent("error",this,this.audioDrawing.error.code);this.fireEvent("statechange",this,this.state)},onWaiting:function(){this.canplaythrough||this.audioDrawing.load()},onAudioUnload:function(){this.canplaythrough&&this.pause()}},{verticalAlign:"top",
horizontalAlign:"left",renderDrawing:function(){var a;Ui.Audio.htmlAudio?(this.audioDrawing=document.createElement("audio"),this.audioDrawing.style.display="none",this.connect(this.audioDrawing,"canplaythrough",this.onReady),this.connect(this.audioDrawing,"ended",this.onEnded),this.connect(this.audioDrawing,"timeupdate",this.onTimeUpdate),this.connect(this.audioDrawing,"error",this.onError),this.connect(this.audioDrawing,"progress",this.onProgress),this.connect(this.audioDrawing,"waiting",this.onWaiting),
this.audioDrawing.setAttribute("preload","auto"),this.audioDrawing.load(),a=this.audioDrawing):a=Ui.Audio.base.renderDrawing.apply(this,arguments);return a}});Ui.Audio.htmlAudio=!1;Ui.Audio.flashAudio=!1;Ui.Audio.supportOgg=!1;Ui.Audio.supportMp3=!1;Ui.Audio.supportWav=!1;Ui.Audio.supportAac=!1;Ui.Audio.audioTest=document.createElement("audio");
void 0!=Ui.Audio.audioTest.play&&(Ui.Audio.htmlAudio=!0,Ui.Audio.supportWav=!!Ui.Audio.audioTest.canPlayType&&""!=Ui.Audio.audioTest.canPlayType("audio/wav"),Ui.Audio.supportMp3=!!Ui.Audio.audioTest.canPlayType&&""!=Ui.Audio.audioTest.canPlayType("audio/mpeg"),Ui.Audio.supportOgg=!!Ui.Audio.audioTest.canPlayType&&""!=Ui.Audio.audioTest.canPlayType('audio/ogg; codecs="vorbis"'),Ui.Audio.supportAac=!!Ui.Audio.audioTest.canPlayType&&""!=Ui.Audio.audioTest.canPlayType('audio/mp4; codecs="mp4a.40.2"'));
Ui.Audio.audioTest=void 0;Ui.Element.extend("Ui.Video",{src:void 0,poster:void 0,oggSrc:void 0,mp4Src:void 0,webmSrc:void 0,loaddone:!1,videoDrawing:void 0,canplaythrough:!1,state:"initial",constructor:function(a){this.addEvents("ready","ended","timeupdate","bufferingupdate","statechange","error");this.connect(this,"unload",this.onVideoUnload);if(void 0!=a.oggSrc||void 0!=a.mp4Src||void 0!=a.webmSrc)void 0!=a.oggSrc&&Ui.Video.supportOgg?this.setSrc(a.oggSrc):void 0!=a.mp4Src&&Ui.Video.supportMp4?this.setSrc(a.mp4Src):void 0!=
a.webmSrc&&Ui.Video.supportWebm&&this.setSrc(a.webmSrc),delete a.oggSrc,delete a.mp4Src,delete a.webmSrc},setSrc:function(a){this.canplaythrough=!1;this.state="initial";this.src=a;"object"===typeof a?this.videoDrawing.src=URL.createObjectURL(a):this.videoDrawing.setAttribute("src",a);try{this.videoDrawing.load()}catch(b){}},setPoster:function(a){this.poster=a;this.videoDrawing.setAttribute("poster",a)},setAutoplay:function(a){this.videoDrawing.autoplay=a},play:function(){this.state="playing";this.fireEvent("statechange",
this,this.state);this.canplaythrough?this.videoDrawing.play():this.videoDrawing.load()},pause:function(){this.state="paused";this.fireEvent("statechange",this,this.state);this.canplaythrough?this.videoDrawing.pause():this.videoDrawing.load()},stop:function(){this.videoDrawing.pause();this.onEnded()},setVolume:function(a){this.videoDrawing.volume=a},getVolume:function(){return this.videoDrawing.volume},getDuration:function(){return this.videoDrawing.duration},setCurrentTime:function(a){this.videoDrawing.currentTime=
a},getCurrentTime:function(){return void 0==this.videoDrawing.currentTime?0:this.videoDrawing.currentTime},getState:function(){return this.state},getIsReady:function(){return this.canplaythrough},getNaturalWidth:function(){return this.naturalWidth},getNaturalHeight:function(){return this.naturalHeight},onReady:function(){this.canplaythrough=!0;this.naturalWidth=this.videoDrawing.videoWidth;this.naturalHeight=this.videoDrawing.videoHeight;"playing"==this.state?this.videoDrawing.play():"paused"==this.state&&
this.videoDrawing.pause();this.fireEvent("ready")},onTimeUpdate:function(){this.fireEvent("timeupdate",this,this.videoDrawing.currentTime);this.checkBuffering()},onEnded:function(){this.videoDrawing.pause();this.state="initial";this.videoDrawing.currentTime=0;this.fireEvent("ended",this);this.fireEvent("statechange",this,this.state)},onProgress:function(){this.checkBuffering()},getCurrentBufferSize:function(){var a=this.videoDrawing.buffered,b=0,c=this.videoDrawing.currentTime;void 0==c&&(c=0);for(var d=
void 0,e=0;e<a.length;e++){var g=a.start(e),f=a.end(e);void 0==d?g<=c&&f>=c&&(b=f-c,d=f):d>=g-0.01&&d<=f&&(b+=f-d,d=f)}return b},checkBuffering:function(){var a=this.getCurrentBufferSize(),b=this.videoDrawing.currentTime,c=this.videoDrawing.duration;if("buffering"==this.state){if(5<=a||1==this.videoDrawing.networkState||b+a>=c)this.state="playing",this.videoDrawing.play(),this.fireEvent("statechange",this,this.state)}else"playing"==this.state&&0.1>=a&&b+a<c&&(this.state="buffering",this.videoDrawing.pause(),
this.fireEvent("statechange",this,this.state));this.fireEvent("bufferingupdate",this,a)},onError:function(){this.state="error";this.fireEvent("error",this,this.videoDrawing.error.code);this.fireEvent("statechange",this,this.state)},onWaiting:function(){this.canplaythrough||this.videoDrawing.load()},onVideoUnload:function(){this.canplaythrough&&this.pause()}},{renderDrawing:function(){Ui.Video.htmlVideo&&(this.videoDrawing=document.createElement("video"),this.connect(this.videoDrawing,"canplaythrough",
this.onReady),this.connect(this.videoDrawing,"ended",this.onEnded),this.connect(this.videoDrawing,"timeupdate",this.onTimeUpdate),this.connect(this.videoDrawing,"error",this.onError),this.connect(this.videoDrawing,"progress",this.onProgress),this.connect(this.videoDrawing,"waiting",this.onWaiting),this.videoDrawing.setAttribute("preload","auto"),this.videoDrawing.load(),this.videoDrawing.style.position="absolute",this.videoDrawing.style.left="0px",this.videoDrawing.style.top="0px");return this.videoDrawing},
arrangeCore:function(a,b){Ui.Video.htmlVideo&&(this.videoDrawing.setAttribute("width",a),this.videoDrawing.setAttribute("height",b))}});Ui.Video.htmlVideo=!1;Ui.Video.flashVideo=!1;Ui.Video.supportOgg=!1;Ui.Video.supportMp4=!1;Ui.Video.supportWebm=!1;Ui.Video.videoTest=document.createElement("video");
void 0!=Ui.Video.videoTest.play&&(Ui.Video.htmlVideo=!0,Ui.Video.supportMp4=!!Ui.Video.videoTest.canPlayType&&""!=Ui.Video.videoTest.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'),Ui.Video.supportOgg=!!Ui.Video.videoTest.canPlayType&&""!=Ui.Video.videoTest.canPlayType('video/ogg; codecs="theora, vorbis"'),Ui.Video.supportWebm=!!Ui.Video.videoTest.canPlayType&&""!=Ui.Video.videoTest.canPlayType('video/webm; codecs="vp8, vorbis"'));delete Ui.Video.videoTest;Ui.LBox.extend("Ui.Pressable",{isDown:!1,lock:!1,lastTime:void 0,startPosition:void 0,constructor:function(a){this.addEvents("press","down","up","activate");this.getDrawing().style.cursor="pointer";this.getDrawing().style.touchAction="manipulation";this.setFocusable(!0);this.setRole("button");this.connect(this.getDrawing(),"click",this.onClick);this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"touchstart",this.onTouchStart);this.connect(this.getDrawing(),
"keydown",this.onKeyDown);this.connect(this.getDrawing(),"keyup",this.onKeyUp)},getIsDown:function(){return this.isDown},setLock:function(a){(this.lock=a)?this.getDrawing().style.cursor="":this.getDrawing().style.cursor="pointer"},getLock:function(){return this.lock},onClick:function(a){a.preventDefault();a.stopPropagation();var b=(new Date).getTime()/1E3,c=b-this.lastTime;this.fireEvent("press",this,a.clientX,a.clientY);void 0!==this.lastTime&&0.25>c&&this.fireEvent("activate",this);this.lastTime=
b},onMouseDown:function(a){0!==a.button||this.getIsDisabled()||this.lock||(a.stopPropagation(),this.connect(window,"mouseup",this.onMouseUp,!0),this.onDown())},onMouseUp:function(a){a.stopPropagation();this.disconnect(window,"mouseup",this.onMouseUp,!0);this.onUp()},onTouchStart:function(a){1!==a.changedTouches.length||this.getIsDisabled()||this.lock||(this.startPosition={x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY},this.connect(this.getDrawing(),"touchmove",this.onTouchMove),this.connect(this.getDrawing(),
"touchcancel",this.onTouchCancel),this.connect(this.getDrawing(),"touchend",this.onTouchEnd),this.onDown())},onTouchMove:function(a){var b=a.changedTouches[0].clientX-this.startPosition.x,c=a.changedTouches[0].clientY-this.startPosition.y;if(20<Math.sqrt(b*b+c*c))this.onTouchCancel(a)},onTouchCancel:function(a){this.disconnect(this.getDrawing(),"touchmove",this.onTouchMove);this.disconnect(this.getDrawing(),"touchcancel",this.onTouchCancel);this.disconnect(this.getDrawing(),"touchend",this.onTouchEnd);
this.onUp()},onTouchEnd:function(a){a.preventDefault();this.disconnect(this.getDrawing(),"touchmove",this.onTouchMove);this.disconnect(this.getDrawing(),"touchcancel",this.onTouchCancel);this.disconnect(this.getDrawing(),"touchend",this.onTouchEnd);this.onUp();this.getDrawing().click()},onKeyDown:function(a){13!=a.which||this.getIsDisabled()||this.lock||(a.preventDefault(),a.stopPropagation(),this.onDown())},onKeyUp:function(a){var b=a.which;!this.isDown||13!=b||this.getIsDisabled()||this.lock||(a.preventDefault(),
a.stopPropagation(),this.onUp(),this.fireEvent("press",this))},onDown:function(){this.isDown=!0;this.fireEvent("down",this)},onUp:function(){this.isDown=!1;this.fireEvent("up",this)}},{onDisable:function(){Ui.Pressable.base.onDisable.call(this);this.getDrawing().style.cursor=""},onEnable:function(){Ui.Pressable.base.onEnable.call(this);this.lock?this.getDrawing().style.cursor="":this.getDrawing().style.cursor="pointer"}});Ui.Pressable.extend("Ui.Togglable",{isToggled:!1,constructor:function(a){this.addEvents("toggle","untoggle");this.setRole("checkbox");this.getDrawing().setAttribute("aria-checked","false");this.connect(this,"press",this.onPress)},getIsToggled:function(){return this.isToggled},onPress:function(){if(this.isToggled)this.onUntoggle();else this.onToggle()},onToggle:function(){this.isToggled||(this.isToggled=!0,this.getDrawing().setAttribute("aria-checked","true"),this.fireEvent("toggle",this))},onUntoggle:function(){this.isToggled&&
(this.isToggled=!1,this.getDrawing().setAttribute("aria-checked","false"),this.fireEvent("untoggle",this))},toggle:function(){this.onToggle()},untoggle:function(){this.onUntoggle()}});Ui.Pressable.extend("Ui.Linkable",{link:void 0,openWindow:!0,target:"_blank",constructor:function(a){this.addEvents("link");this.connect(this,"press",this.onPress)},setSrc:function(a){this.link=a},setOpenWindow:function(a){this.openWindow=a},setTarget:function(a){this.target=a},onPress:function(){this.fireEvent("link",this);this.openWindow?window.open(this.link,this.target):window.location=this.link}});Ui.Pressable.extend("Ui.Uploadable",{content:void 0,input:void 0,constructor:function(a){this.getDrawing().style.cursor="pointer";this.setFocusable(!0);this.setRole("button");this.addEvents("file");this.input=new Ui.UploadableFileWrapper;this.append(this.input);this.connect(this.input,"file",this.onFile);this.connect(this,"press",this.onPress)},setDirectoryMode:function(a){this.input.setDirectoryMode(a)},onPress:function(){Ui.UploadableFileWrapper.hasInstance(this.input)&&new Core.DelayedTask({delay:0,
scope:this,callback:this.onPressDelayed})},onPressDelayed:function(){this.input.select()},onFile:function(a,b){this.fireEvent("file",this,b)}},{setContent:function(a){a=Ui.Element.create(a);this.content!=a&&(void 0!=this.content&&this.remove(this.content),void 0!=a&&(Ui.UploadableWrapper.hasInstance(this.input)?this.prepend(a):this.append(a)),this.content=a)}});
Ui.Element.extend("Ui.UploadableFileWrapper",{formDrawing:void 0,inputDrawing:void 0,iframeDrawing:void 0,directoryMode:!1,constructor:function(a){this.setOpacity(0);this.setClipToBounds(!0);this.addEvents("file")},select:function(){this.inputDrawing.click()},setDirectoryMode:function(a){this.directoryMode=a;void 0!=this.inputDrawing&&(this.directoryMode?this.inputDrawing.setAttribute("webkitdirectory",""):this.inputDrawing.removeAttribute("webkitdirectory"))},createInput:function(){this.formDrawing=
document.createElement("form");this.connect(this.formDrawing,"click",function(a){a.stopPropagation()});this.formDrawing.method="POST";this.formDrawing.enctype="multipart/form-data";this.formDrawing.encoding="multipart/form-data";this.formDrawing.style.position="absolute";this.formDrawing.style.zIndex=1;this.inputDrawing=document.createElement("input");this.inputDrawing.type="file";this.inputDrawing.setAttribute("name","file");this.directoryMode&&this.inputDrawing.setAttribute("webkitdirectory","");
this.inputDrawing.style.position="absolute";this.inputDrawing.style.zIndex=1;this.connect(this.inputDrawing,"change",this.onChange);this.formDrawing.appendChild(this.inputDrawing);if(navigator.supportFileAPI){for(;0<this.getDrawing().childNodes.length;)this.getDrawing().removeChild(this.getDrawing().childNodes[0]);this.getDrawing().appendChild(this.formDrawing);this.arrangeCore(this.getLayoutX(),this.getLayoutY(),this.getLayoutWidth(),this.getLayoutHeight())}else this.iframeDrawing=document.createElement("iframe"),
this.iframeDrawing.style.position="absolute",this.iframeDrawing.style.top="0px",this.iframeDrawing.style.left="0px",this.iframeDrawing.style.width="0px",this.iframeDrawing.style.height="0px",this.iframeDrawing.style.clip="rect(0px 0px 0px 0px)",document.body.appendChild(this.iframeDrawing),this.iframeDrawing.contentWindow.document.write("<!DOCTYPE html><html><body></body></html>"),this.iframeDrawing.contentWindow.document.body.appendChild(this.formDrawing)},onChange:function(a){a.preventDefault();
a.stopPropagation();if(navigator.supportFileAPI)for(a=0;a<this.inputDrawing.files.length;a++)this.fireEvent("file",this,new Core.File({fileApi:this.inputDrawing.files[a]}));else this.disconnect(this.inputDrawing,"change",this.onChange),a=new Core.File({iframe:this.iframeDrawing,form:this.formDrawing,fileInput:this.inputDrawing}),this.createInput(),this.fireEvent("file",this,a)}},{onLoad:function(){Ui.UploadableFileWrapper.base.onLoad.call(this);this.createInput()},onUnload:function(){this.disconnect(this.inputDrawing,
"change",this.onChange);void 0!==this.iframeDrawing&&document.body.removeChild(this.iframeDrawing);Ui.UploadableFileWrapper.base.onUnload.call(this)},arrangeCore:function(a,b,c,d){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=0);void 0===d&&(d=0);Ui.UploadableFileWrapper.base.arrangeCore.call(this,a,b,c,d);void 0!=this.formDrawing&&(this.formDrawing.style.top="0px",this.formDrawing.style.left="0px",this.formDrawing.style.width=Math.round(c)+"px",this.formDrawing.style.height=Math.round(d)+"px");
void 0!=this.inputDrawing&&(this.inputDrawing.style.top="0px",this.inputDrawing.style.left="0px",this.inputDrawing.style.width=Math.round(c)+"px",this.inputDrawing.style.height=Math.round(d)+"px")}});
Ui.Element.extend("Ui.UploadableWrapper",{formDrawing:void 0,inputDrawing:void 0,directoryMode:!1,constructor:function(a){this.setClipToBounds(!0);this.setOpacity(0);this.addEvents("file")},setDirectoryMode:function(a){},createInput:function(){this.formDrawing=document.createElement("form");this.formDrawing.method="POST";this.formDrawing.enctype="multipart/form-data";this.formDrawing.encoding="multipart/form-data";this.formDrawing.style.display="block";this.formDrawing.style.position="absolute";this.formDrawing.style.left=
"0px";this.formDrawing.style.top="0px";this.formDrawing.style.width=this.getLayoutWidth()+"px";this.formDrawing.style.height=this.getLayoutHeight()+"px";this.inputDrawing=document.createElement("input");this.inputDrawing.type="file";this.inputDrawing.name="file";this.inputDrawing.style.fontSize="200px";this.inputDrawing.style.display="block";this.inputDrawing.style.cursor="pointer";this.inputDrawing.style.position="absolute";this.inputDrawing.style.left="0px";this.inputDrawing.style.top="0px";this.inputDrawing.style.width=
this.getLayoutWidth()+"px";this.inputDrawing.style.height=this.getLayoutHeight()+"px";if(navigator.isIE7||navigator.isIE8)this.inputDrawing.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";this.formDrawing.appendChild(this.inputDrawing);this.connect(this.inputDrawing,"change",this.onChange);navigator.isWebkit&&(this.inputDrawing.style.webkitUserSelect="none");this.connect(this.inputDrawing,"touchstart",function(a){a.dontPreventDefault=!0});this.connect(this.inputDrawing,"touchend",
function(a){a.dontPreventDefault=!0});return this.formDrawing},onChange:function(a){if(!navigator.isOpera&&navigator.supportFileAPI)for(a=0;a<this.inputDrawing.files.length;a++)this.fireEvent("file",this,new Core.File({fileApi:this.inputDrawing.files[a]}));else this.getDrawing().removeChild(this.formDrawing),a=document.createElement("iframe"),a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style.width="0px",a.style.height="0px",a.style.clip="rect(0px 0px 0px 0px)",document.body.appendChild(a),
a.contentWindow.document.write("<!DOCTYPE html><html><body></body></html>"),a.contentWindow.document.body.appendChild(this.formDrawing),this.disconnect(this.inputDrawing,"change",this.onChange),this.fireEvent("file",this,new Core.File({iframe:a,form:this.formDrawing,fileInput:this.inputDrawing})),this.getDrawing().appendChild(this.createInput())}},{renderDrawing:function(){Ui.UploadableWrapper.base.renderDrawing.apply(this,arguments).appendChild(this.createInput())},arrangeCore:function(a,b){this.formDrawing.style.width=
Math.round(a)+"px";this.formDrawing.style.height=Math.round(b)+"px";this.inputDrawing.style.width=Math.round(a)+"px";this.inputDrawing.style.height=Math.round(b)+"px"}});navigator.supportFormData=!0;try{new FormData}catch(err$$5){navigator.supportFormData=!1}Ui.Uploadable.testInput=document.createElement("input");navigator.supportFileAPI="files"in Ui.Uploadable.testInput;navigator.supportUploadDirectory="webkitdirectory"in Ui.Uploadable.testInput;delete Ui.Uploadable.testInput;Ui.Container.extend("Ui.MovableBase",{moveHorizontal:!0,moveVertical:!0,mouseStart:void 0,mouseLast:void 0,posX:0,posY:0,isMoving:!1,measureSpeedTimer:void 0,speedX:0,speedY:0,speedComputed:!1,lastPosX:void 0,lastPosY:void 0,startPosX:void 0,startPosY:void 0,lastTime:void 0,inertiaClock:void 0,inertia:!1,touchStart:void 0,touchLast:void 0,isDown:!1,lock:!1,isInMoveEvent:!1,cumulMove:0,catcher:void 0,window:void 0,iframe:void 0,directionLock:!1,speedBuffer:void 0,startTime:void 0,constructor:function(a){this.addEvents("down",
"up","move");this.getDrawing().style.touchAction="none";this.connect(this.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.getDrawing(),"touchstart",this.onTouchStart)},setLock:function(a){(this.lock=a)&&this.stopInertia()},getLock:function(){return this.lock},getIsDown:function(){return this.isDown},getInertia:function(){return this.inertia},setInertia:function(a){this.inertia=a},getMoveHorizontal:function(){return this.moveHorizontal},setMoveHorizontal:function(a){this.moveHorizontal=
a;this.updateTouchAction()},getMoveVertical:function(){return this.moveVertical},setMoveVertical:function(a){this.moveVertical=a;this.updateTouchAction()},setPosition:function(a,b,c){void 0!==a&&this.moveHorizontal&&(isNaN(a)?this.posX=0:this.posX=a);void 0!==b&&this.moveVertical&&(isNaN(b)?this.posY=0:this.posY=b);this.isInMoveEvent||!0===c||(this.isInMoveEvent=!0,this.fireEvent("move",this),this.onMove(this.posX,this.posY),this.isInMoveEvent=!1)},getPositionX:function(){return this.posX},getPositionY:function(){return this.posY},
onMove:function(a,b){},updateTouchAction:function(){},onDown:function(){this.cumulMove=0;this.isDown=!0;this.fireEvent("down",this)},onUp:function(a){this.isDown=!1;this.fireEvent("up",this,this.speedX,this.speedY,this.posX-this.startPosX,this.posY-this.startPosY,this.cumulMove,a)},onMouseDown:function(a){if(!(this.isDown||this.lock||this.getIsDisabled()||0!=a.button)){this.startTime=(new Date).getTime()/1E3;this.directionLock=!1;a.stopPropagation();this.onDown();this.window=window;this.iframe=void 0;
if(navigator.isWebkit||navigator.isFirefox3){var b=Ui.App.getRootWindow();b!=window&&(this.window=b,this.iframe=Ui.App.getWindowIFrame())}this.connect(this.window,"mouseup",this.onMouseUp,!0);this.connect(this.window,"mousemove",this.onMouseMove,!0);this.mouseLast=this.mouseStart=this.pointFromWindow({x:a.clientX,y:a.clientY});this.startPosX=this.posX;this.startPosY=this.posY;this.startComputeInertia()}},onMouseMove:function(a){a.stopPropagation();if(0.5<=(new Date).getTime()/1E3-this.startTime||
20<this.cumulMove)this.directionLock=!0;var b={x:a.clientX,y:a.clientY};void 0!=this.iframe&&(b=Ui.Element.pointFromWindow(this.iframe,{x:a.clientX,y:a.clientY},this.window));var c=this.pointFromWindow(b),d=c.x-this.mouseStart.x,e=c.y-this.mouseStart.y,b=Math.sqrt(d*d+e*e),g=c.x-this.mouseLast.x,f=c.y-this.mouseLast.y,g=Math.sqrt(g*g+f*f);this.mouseLast=c;this.cumulMove+=g;this.setPosition(this.startPosX+d,this.startPosY+e);this.measureSpeed();c=this.posX-this.startPosX;d=this.posY-this.startPosY;
c=Math.sqrt(c*c+d*d);d=1;0!==b&&(d=c/b);this.directionLock?a.preventDefault():0.7<=d?a.preventDefault():(console.log("ABORT MOUSE MOVE"),this.onMouseUp(a,!0))},onMouseUp:function(a,b){this.directionLock&&a.preventDefault();a.stopPropagation();0==a.button&&(b=!0===b,this.disconnect(this.window,"mousemove",this.onMouseMove,!0),this.disconnect(this.window,"mouseup",this.onMouseUp,!0),this.stopComputeInertia(),!b&&this.inertia&&this.startInertia(),this.onUp(b))},onTouchStart:function(a){this.isDown||
1!==a.changedTouches.length||this.getIsDisabled()||this.lock||(this.startTime=(new Date).getTime()/1E3,this.directionLock=!1,this.isMoving=!0,this.connect(this.getDrawing(),"touchcancel",this.onTouchCancel),this.connect(this.getDrawing(),"touchend",this.onTouchEnd),this.connect(this.getDrawing(),"touchmove",this.onTouchMove),this.stopInertia(),this.onDown(),this.touchLast=this.touchStart=this.pointFromWindow({x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY}),this.startPosX=this.posX,this.startPosY=
this.posY,this.startComputeInertia())},onTouchMove:function(a){if(0.5<=(new Date).getTime()/1E3-this.startTime||20<this.cumulMove)this.directionLock=!0;var b=this.pointFromWindow({x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY}),c=b.x-this.touchStart.x,d=b.y-this.touchStart.y,e=Math.sqrt(c*c+d*d),c=this.startPosX+c,d=this.startPosY+d,g=b.x-this.touchLast.x,f=b.y-this.touchLast.y;this.touchLast=b;b=Math.sqrt(g*g+f*f);this.cumulMove+=b;this.setPosition(c,d);b=this.posX-this.startPosX;c=
this.posY-this.startPosY;b=Math.sqrt(b*b+c*c);this.measureSpeed();e=b/e;if(this.directionLock)a.preventDefault(),a.stopPropagation();else if(0.7<=e)a.preventDefault(),a.stopPropagation();else this.onTouchCancel(a)},onTouchCancel:function(a){this.disconnect(this.getDrawing(),"touchcancel",this.onTouchCancel);this.disconnect(this.getDrawing(),"touchend",this.onTouchEnd);this.disconnect(this.getDrawing(),"touchmove",this.onTouchMove);this.directionLock&&a.preventDefault();a.stopPropagation();this.isMoving=
!1;this.stopComputeInertia();this.onUp(!0)},onTouchEnd:function(a){this.disconnect(this.getDrawing(),"touchcancel",this.onTouchCancel);this.disconnect(this.getDrawing(),"touchend",this.onTouchEnd);this.disconnect(this.getDrawing(),"touchmove",this.onTouchMove);a.preventDefault();a.stopPropagation();a=this.pointFromWindow({x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY});var b=a.x-this.touchStart.x,c=a.y-this.touchStart.y;Math.sqrt(b*b+c*c);var b=this.startPosX+b,c=this.startPosY+c,d=
a.x-this.touchLast.x,e=a.y-this.touchLast.y;this.touchLast=a;a=Math.sqrt(d*d+e*e);this.cumulMove+=a;this.setPosition(b,c);this.isMoving=!1;this.stopComputeInertia();this.inertia&&this.startInertia();this.onUp(!1)},measureSpeed:function(){20<this.speedBuffer.length&&this.speedBuffer.shift();this.speedBuffer.push({time:(new Date).getTime()/1E3,x:this.posX,y:this.posY})},startComputeInertia:function(){this.speedBuffer=[];this.speedBuffer.push({time:(new Date).getTime()/1E3,x:this.posX,y:this.posY});
this.speedY=this.speedX=0},stopComputeInertia:function(){var a=(new Date).getTime()/1E3,b=this.speedBuffer.length,c=this.speedBuffer[0];do c=this.speedBuffer[--b];while(0<b&&0.15>a-c.time);a-=c.time;this.speedX=(this.posX-c.x)/a;this.speedY=(this.posY-c.y)/a},startInertia:function(){void 0===this.inertiaClock&&(this.inertiaClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:function(a,b,c){0!=c&&(a=this.posX,b=this.posY,this.setPosition(this.posX+this.speedX*c,this.posY+this.speedY*
c),this.posX==a&&this.posY==b?this.stopInertia():(this.speedX-=3*this.speedX*c,this.speedY-=3*this.speedY*c,0.1>Math.abs(this.speedX)&&(this.speedX=0),0.1>Math.abs(this.speedY)&&(this.speedY=0),0==this.speedX&&0==this.speedY&&this.stopInertia()))}}),this.inertiaClock.begin())},stopInertia:function(){void 0!=this.inertiaClock&&(this.inertiaClock.stop(),this.inertiaClock=void 0)}});Ui.MovableBase.extend("Ui.Movable",{constructor:function(a){this.setFocusable(!0);this.contentBox=new Ui.LBox;this.appendChild(this.contentBox);this.contentBox.getDrawing().style.cursor="move";this.connect(this.getDrawing(),"keydown",this.onKeyDown)},onKeyDown:function(a){if(!this.getIsDisabled()){var b=a.which;37!=b&&39!=b||!this.moveHorizontal||(a.preventDefault(),a.stopPropagation(),37==b&&this.setPosition(this.posX-10,void 0),39==b&&this.setPosition(this.posX+10,void 0));38!=b&&40!=b||!this.moveVertical||
(a.preventDefault(),a.stopPropagation(),38==b&&this.setPosition(void 0,this.posY-10),40==b&&this.setPosition(void 0,this.posY+10))}}},{onMove:function(a,b){this.contentBox.setTransform(Ui.Matrix.createTranslate(this.posX,this.posY))},measureCore:function(a,b){return this.contentBox.measure(a,b)},arrangeCore:function(a,b){this.getDrawing().style.width="1px";this.getDrawing().style.height="1px";this.contentBox.arrange(0,0,a,b)},getContent:function(){return this.contentBox.getChildren()[0]},setContent:function(a){this.contentBox.setContent(a)},
onDisable:function(){this.contentBox.getDrawing().style.cursor="inherit"},onEnable:function(){this.contentBox.getDrawing().style.cursor="move"}});Ui.LBox.extend("Ui.Transformable",{inertia:!0,mouseStart:void 0,contentBox:void 0,mouseStart:void 0,speedComputed:!1,lastTranslateX:void 0,lastTranslateY:void 0,lastAngle:0,isDown:!1,transformDone:!1,transformLock:!1,finger1:void 0,finger2:void 0,angle:0,scale:1,translateX:0,translateY:0,startAngle:0,startScale:0,startTranslateX:0,startTranslateY:0,allowScale:!0,allowRotate:!0,allowTranslate:!0,speedX:0,speedY:0,speedAngle:0,constructor:function(a){this.addEvents("down","up","transform");this.setFocusable(!0);
this.contentBox=new Ui.LBox;this.appendChild(this.contentBox);this.contentBox.getDrawing().style.cursor="move";this.connect(this.contentBox.getDrawing(),"touchstart",this.onTouchStart);this.connect(this.contentBox.getDrawing(),"touchmove",this.onTouchMove);this.connect(this.contentBox.getDrawing(),"touchend",this.onTouchEnd);this.connect(this.contentBox.getDrawing(),"touchcancel",this.onTouchCancel);this.connect(this.contentBox.getDrawing(),"mousedown",this.onMouseDown);this.connect(this.contentBox.getDrawing(),
"mousewheel",this.onMouseWheel);this.connect(this.contentBox.getDrawing(),"DOMMouseScroll",this.onMouseWheel)},setAllowScale:function(a){this.allowScale=a},setAllowRotate:function(a){this.allowRotate=a},setAllowTranslate:function(a){this.allowTranslate=a},getIsDown:function(){return this.isDown},getAngle:function(){return this.angle},setAngle:function(a){this.setContentTransform(void 0,void 0,void 0,a)},getScale:function(){return this.scale},setScale:function(a){this.setContentTransform(void 0,void 0,
a,void 0)},getTranslateX:function(){return this.translateX},setTranslateX:function(a){this.setContentTransform(a,void 0,void 0,void 0)},getTranslateY:function(){return this.translateY},setTranslateY:function(a){this.setContentTransform(void 0,a,void 0,void 0)},buildMatrix:function(a,b,c,d){void 0===a&&(a=this.translateX);void 0===b&&(b=this.translateY);void 0===c&&(c=this.scale);void 0===d&&(d=this.angle);var e=new Ui.Matrix;e.translate(this.getLayoutWidth()/2,this.getLayoutHeight()/2);e.translate(a,
b);e.scale(c,c);e.rotate(d);e.translate(-this.getLayoutWidth()/2,-this.getLayoutHeight()/2);return e},getMatrix:function(){var a=new Ui.Matrix;a.translate(this.getLayoutWidth()/2,this.getLayoutHeight()/2);a.translate(this.translateX,this.translateY);a.scale(this.scale,this.scale);a.rotate(this.angle);a.translate(-this.getLayoutWidth()/2,-this.getLayoutHeight()/2);return a},getBoundaryBox:function(a){void 0===a&&(a=this.getMatrix());var b=(new Ui.Point({x:0,y:0})).matrixTransform(a),c=(new Ui.Point({x:this.getLayoutWidth(),
y:0})).matrixTransform(a),d=(new Ui.Point({x:this.getLayoutWidth(),y:this.getLayoutHeight()})).matrixTransform(a),e=(new Ui.Point({x:0,y:this.getLayoutHeight()})).matrixTransform(a);a=Math.min(b.x,Math.min(c.x,Math.min(d.x,e.x)));var g=Math.min(b.y,Math.min(c.y,Math.min(d.y,e.y))),f=Math.max(b.x,Math.max(c.x,Math.max(d.x,e.x))),b=Math.max(b.y,Math.max(c.y,Math.max(d.y,e.y)));return{x:a,y:g,width:f-a,height:b-g}},setContentTransform:function(a,b,c,d){void 0===a&&(a=this.translateX);void 0===b&&(b=
this.translateY);void 0===c&&(c=this.scale);void 0===d&&(d=this.angle);this.translateX=a;this.translateY=b;this.scale=c;this.angle=d;this.contentBox.setTransformOrigin(0,0);this.contentBox.setTransform(this.getMatrix());this.transformLock||(this.transformLock=!0,this.fireEvent("transform",this),this.transformLock=!1)},onDown:function(){this.isDown=!0;this.fireEvent("down",this)},onUp:function(){this.isDown=!1;this.fireEvent("up",this)},onMouseDown:function(a){console.log(this+".onMouseDown");this.lock||
this.getIsDisabled()||0!==a.button||(a.preventDefault(),a.stopPropagation(),this.onDown(),this.connect(window,"mouseup",this.onMouseUp,!0),this.connect(window,"mousemove",this.onMouseMove,!0),this.mouseStart=this.pointFromWindow({x:a.clientX,y:a.clientY}),this.mouseStartClientX=a.clientX,this.mouseStartClientY=a.clientY,this.mouseStartScreenX=a.screenX,this.mouseStartScreenY=a.screenY,this.startAngle=this.angle,this.startScale=this.scale,this.startTranslateX=this.translateX,this.startTranslateY=this.translateY)},
onMouseMove:function(a){a.preventDefault();a.stopPropagation();var b=this.pointFromWindow({x:a.clientX,y:a.clientY});a=b.x-this.mouseStart.x;b=b.y-this.mouseStart.y;Math.sqrt(a*a+b*b);this.setContentTransform(this.startTranslateX+a,this.startTranslateY+b,void 0,void 0)},onMouseUp:function(a){a.preventDefault();a.stopPropagation();0==a.button&&(this.disconnect(window,"mousemove",this.onMouseMove,!0),this.disconnect(window,"mouseup",this.onMouseUp,!0),this.focus(),this.onUp())},onTouchStart:function(a){if(!(this.lock||
this.getIsDisabled()||2<a.changedTouches.length)){for(var b=0;b<a.changedTouches.length;b++)this.onFingerDown(a.changedTouches[b].identifier,a.changedTouches[b].clientX,a.changedTouches[b].clientY);if(void 0!==this.finger1&&void 0!==this.finger2||void 0!==this.finger1&&this.allowTranslate)a.preventDefault(),a.stopPropagation()}},onTouchMove:function(a){if(void 0!==this.finger1){for(var b=0;b<a.changedTouches.length;b++)this.onFingerMove(a.changedTouches[b].identifier,a.changedTouches[b].clientX,a.changedTouches[b].clientY);
if(void 0!==this.finger1&&void 0!==this.finger2||void 0!==this.finger1&&this.allowTranslate)a.preventDefault(),a.stopPropagation()}},onTouchCancel:function(a){if(void 0!==this.finger1)this.onTouchEnd(a)},onTouchEnd:function(a){if(void 0!==this.finger1){for(var b=0;b<a.changedTouches.length;b++)this.onFingerUp(a.changedTouches[b].identifier,a.changedTouches[b].clientX,a.changedTouches[b].clientY);if(void 0!==this.finger1&&void 0!==this.finger2||void 0!==this.finger1&&this.allowTranslate)a.preventDefault(),
a.stopPropagation()}},onFingerDown:function(a,b,c){if(void 0===this.finger1){if(this.allowTranslate)this.onDown();this.finger1={identifier:a,start:{x:b,y:c},current:{x:b,y:c}};this.startAngle=this.angle;this.startScale=this.scale;this.startTranslateX=this.translateX;this.startTranslateY=this.translateY;this.startComputeInertia()}else if(void 0===this.finger2){if(!this.allowTranslate)this.onDown();this.finger1.start={x:this.finger1.current.x,y:this.finger1.current.y};this.finger2={identifier:a,start:{x:b,
y:c},current:{x:b,y:c}};this.startAngle=this.angle;this.startScale=this.scale;this.startTranslateX=this.translateX;this.startTranslateY=this.translateY}},onFingerMove:function(a,b,c){if(void 0!==this.finger1&&this.finger1.identifier===a)this.finger1.current={x:b,y:c};else if(void 0!==this.finger2&&this.finger2.identifier===a)this.finger2.current={x:b,y:c};else return;if(void 0!==this.finger1&&void 0!==this.finger2){a=this.pointFromWindow({x:this.finger1.current.x,y:this.finger1.current.y});c=this.pointFromWindow({x:this.finger2.current.x,
y:this.finger2.current.y});b=this.pointFromWindow({x:this.finger1.start.x,y:this.finger1.start.y});var d=this.pointFromWindow({x:this.finger2.start.x,y:this.finger2.start.y}),e=d.x-b.x,d=d.y-b.y,g,f=c.x-a.x,h=c.y-a.y,k;g=Math.sqrt(e*e+d*d);k=Math.sqrt(f*f+h*h);c=k/g;e/=g;d/=g;f/=k;h/=k;e=-(180*Math.atan2(d*f-e*h,e*f+d*h))/Math.PI;d=new Ui.Matrix;d.translate(a.x-b.x,a.y-b.y);d.translate(b.x,b.y);d.scale(c,c);d.rotate(e);d.translate(-b.x,-b.y);d.translate(this.getLayoutWidth()/2,this.getLayoutHeight()/
2);d.translate(this.startTranslateX,this.startTranslateY);d.scale(this.startScale,this.startScale);d.rotate(this.startAngle);d.translate(-this.getLayoutWidth()/2,-this.getLayoutHeight()/2);a=new Ui.Point({x:this.getLayoutWidth()/2,y:this.getLayoutHeight()/2});a.matrixTransform(d);this.setContentTransform(a.x-this.getLayoutWidth()/2,a.y-this.getLayoutHeight()/2,this.startScale*c,this.startAngle+e)}else void 0!==this.finger1&&this.allowTranslate&&(a=this.pointFromWindow({x:this.finger1.current.x,y:this.finger1.current.y}),
b=this.pointFromWindow({x:this.finger1.start.x,y:this.finger1.start.y}),this.setContentTransform(this.startTranslateX+(a.x-b.x),this.startTranslateY+(a.y-b.y),this.startScale,this.startAngle))},onFingerUp:function(a,b,c){if(void 0!==this.finger1&&this.finger1.identifier===a)if(this.finger1=void 0,void 0!==this.finger2){if(this.finger1=this.finger2,this.finger2=void 0,this.finger1.start={x:this.finger1.current.x,y:this.finger1.current.y},this.startAngle=this.angle,this.startScale=this.scale,this.startTranslateX=
this.translateX,this.startTranslateY=this.translateY,!this.allowTranslate)this.onUp()}else{if(this.allowTranslate)this.onUp();this.stopComputeInertia();this.startInertia()}if(void 0!==this.finger2&&this.finger2.identifier===a&&(this.finger2=void 0,this.finger1.start={x:this.finger1.current.x,y:this.finger1.current.y},this.startAngle=this.angle,this.startScale=this.scale,this.startTranslateX=this.translateX,this.startTranslateY=this.translateY,!this.allowTranslate))this.onUp()},onMouseWheel:function(a){var b=
0;void 0!==a.wheelDeltaX&&void 0!==a.wheelDelaY?(b=Math.sqrt(a.wheelDeltaX*a.wheelDeltaX+a.wheelDelaY*a.wheelDelaY),b/=5):void 0!==a.wheelDelta?b=-a.wheelDelta/2:void 0!==a.detail&&(b=10*a.detail);if(a.altKey)this.setAngle(this.angle+b/5);else if(a.shiftKey)this.setScale(Math.max(0.1,this.scale-b/120));else return;a.preventDefault();a.stopPropagation()},measureSpeed:function(){var a=(new Date).getTime()/1E3,b=a-this.lastTime;if(!(0.025>b)){var c=this.angle-this.lastAngle,d=this.translateY-this.lastTranslateY;
this.speedX=(this.translateX-this.lastTranslateX)/b;this.speedY=d/b;this.speedAngle=c/b;this.lastTime=a;this.lastAngle=this.angle;this.lastTranslateX=this.translateX;this.lastTranslateY=this.translateY;this.speedComputed=!0}},getInertia:function(){return this.inertia},setInertia:function(a){this.inertia=a},startComputeInertia:function(){this.stopInertia();void 0!=this.measureSpeedTimer&&this.measureSpeedTimer.abort();this.lastTranslateX=this.translateX;this.lastTranslateY=this.translateY;this.lastTime=
(new Date).getTime()/1E3;this.speedAngle=this.speedY=this.speedX=0;this.speedComputed=!1;this.measureSpeedTimer=new Core.Timer({interval:0.025,onTimeupdate:this.measureSpeed})},stopComputeInertia:function(){void 0!=this.measureSpeedTimer&&(this.measureSpeedTimer.abort(),this.measureSpeedTimer=void 0);if(!this.speedComputed){var a=(new Date).getTime()/1E3-this.lastTime,b=this.angle-this.lastAngle,c=this.translateY-this.lastTranslateY;this.speedX=(this.translateX-this.lastTranslateX)/a;this.speedY=
c/a;this.speedAngle=b/a}},startInertia:function(){void 0===this.inertiaClock&&this.inertia&&(this.inertiaClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:this.onTimeupdate}),this.inertiaClock.begin())},onTimeupdate:function(a,b,c){0!=c&&(a=this.translateX,b=this.translateY,this.setContentTransform(this.translateX+this.speedX*c,this.translateY+this.speedY*c,void 0,this.angle+this.speedAngle*c),this.translateX==a&&this.translateY==b?this.stopInertia():(this.speedX-=3*this.speedX*
c,this.speedY-=3*this.speedY*c,this.speedAngle-=3*this.speedAngle*c,0.1>Math.abs(this.speedX)&&(this.speedX=0),0.1>Math.abs(this.speedY)&&(this.speedY=0),0==this.speedX&&0==this.speedY&&this.stopInertia()))},stopInertia:function(){void 0!=this.inertiaClock&&(this.inertiaClock.stop(),this.inertiaClock=void 0)}},{setContent:function(a){this.contentBox.setContent(a)},arrangeCore:function(a,b){Ui.Transformable.base.arrangeCore.apply(this,arguments);this.contentBox.setTransformOrigin(0,0);this.contentBox.setTransform(this.getMatrix())}});Ui.Container.extend("Ui.Scrollable",{contentBox:void 0,scrollHorizontal:!0,scrollVertical:!0,scrollbarHorizontalBox:void 0,scrollbarHorizontal:void 0,scrollbarVerticalBox:void 0,scrollbarVertical:void 0,showShadows:!1,constructor:function(a){this.addEvents("scroll");this.contentBox=new Ui.ScrollableContent;this.connect(this.contentBox,"scroll",this.onScroll);this.appendChild(this.contentBox);Ui.ScrollableContent.emulatedScrollbars&&(this.scrollbarHorizontalBox=new Ui.LBox,this.appendChild(this.scrollbarHorizontalBox),
this.scrollbarVerticalBox=new Ui.LBox,this.appendChild(this.scrollbarVerticalBox),this.connect(this.scrollbarHorizontalBox.getDrawing(),"mousedown",this.onHorizontalMouseDown),this.connect(this.scrollbarVerticalBox.getDrawing(),"mousedown",this.onVerticalMouseDown))},setContent:function(a){this.contentBox.setContent(a)},getContent:function(){return this.contentBox.getContent()},getScrollHorizontal:function(){return this.scrollHorizontal},setScrollHorizontal:function(a){a!=this.scrollHorizontal&&(this.scrollHorizontal=
a,this.invalidateMeasure())},getScrollVertical:function(){return this.scrollVertical},setScrollVertical:function(a){a!=this.scrollVertical&&(this.scrollVertical=a,this.invalidateMeasure())},setScrollbarVertical:function(a){Ui.ScrollableContent.emulatedScrollbars&&this.scrollbarVertical!==a&&(void 0!==this.scrollbarVertical&&this.scrollbarVerticalBox.remove(this.scrollbarVertical),this.scrollbarVertical=a,void 0!==this.scrollbarVertical&&this.scrollbarVerticalBox.append(this.scrollbarVertical))},setScrollbarHorizontal:function(a){Ui.ScrollableContent.emulatedScrollbars&&
this.scrollbarHorizontal!==a&&(void 0!==this.scrollbarHorizontal&&this.scrollbarHorizontalBox.remove(this.scrollbarHorizontal),this.scrollbarHorizontal=a,void 0!==this.scrollbarHorizontal&&this.scrollbarHorizontalBox.append(this.scrollbarHorizontal))},setOffset:function(a,b,c,d){void 0===c&&(c=!1);void 0===a?a=this.offsetX:c||(a*=this.contentWidth-this.viewWidth);void 0===b?b=this.offsetY:c||(b*=this.contentHeight-this.viewHeight);0>a?a=0:this.viewWidth+a>this.contentWidth&&(a=this.contentWidth-this.viewWidth);
0>b?b=0:this.viewHeight+b>this.contentHeight&&(b=this.contentHeight-this.viewHeight);this.relativeOffsetX=a/(this.contentWidth-this.viewWidth);this.relativeOffsetY=b/(this.contentHeight-this.viewHeight);return this.offsetX!==a||this.offsetY!==b?(this.offsetX=a,this.offsetY=b,this.contentBox.setOffset(a,b),!0):!1},getOffsetX:function(){return this.contentBox.getOffsetX()},getRelativeOffsetX:function(){return this.relativeOffsetX},getOffsetY:function(){return this.contentBox.getOffsetY()},getRelativeOffsetY:function(){return this.relativeOffsetY},
onScroll:function(){this.updateOffset();this.fireEvent("scroll",this,this.offsetX,this.offsetY)},updateOffset:function(){if(void 0!==this.contentBox&&(console.log(this+".updateOffset"),this.offsetX=this.contentBox.getOffsetX(),this.offsetY=this.contentBox.getOffsetY(),this.viewWidth=this.contentBox.getDrawing().clientWidth,this.viewHeight=this.contentBox.getDrawing().clientHeight,this.contentWidth=this.contentBox.getDrawing().scrollWidth,this.contentHeight=this.contentBox.getDrawing().scrollHeight,
this.relativeOffsetX=this.offsetX/(this.contentWidth-this.viewWidth),this.relativeOffsetY=this.offsetY/(this.contentHeight-this.viewHeight),Ui.ScrollableContent.emulatedScrollbars)){this.scrollbarVerticalNeeded=this.contentHeight>this.viewHeight?!0:!1;this.scrollbarHorizontalNeeded=this.contentWidth>this.viewWidth?!0:!1;this.scrollbarVerticalNeeded?(console.log(this+" scrollbarVerticalNeeded"),this.scrollbarVerticalHeight=Math.max(this.viewHeight/this.contentHeight*this.viewHeight,this.scrollbarVerticalBox.getMeasureHeight()),
this.scrollbarVerticalBox.arrange(this.getLayoutWidth()-this.scrollbarVerticalBox.getMeasureWidth(),0,this.scrollbarVerticalBox.getMeasureWidth(),this.scrollbarVerticalHeight),this.scrollbarVerticalBox.show()):(this.scrollbarVerticalBox.hide(),this.offsetY=0);this.scrollbarHorizontalNeeded?(this.scrollbarHorizontalWidth=Math.max(this.viewWidth/this.contentWidth*this.viewWidth,this.scrollbarHorizontalBox.getMeasureWidth()),this.scrollbarHorizontalBox.arrange(0,this.getLayoutHeight()-this.scrollbarHorizontalBox.getMeasureHeight(),
this.scrollbarHorizontalWidth,this.scrollbarHorizontalBox.getMeasureHeight()),this.scrollbarHorizontalBox.show()):(this.scrollbarHorizontalBox.hide(),this.offsetX=0);if(this.scrollbarHorizontalNeeded){var a=this.offsetX/(this.contentWidth-this.viewWidth);1<a&&(a=1,this.setOffset(a,void 0));this.scrollbarHorizontalBox.setTransform(Ui.Matrix.createTranslate((this.viewWidth-this.scrollbarHorizontalWidth)*a,0))}this.scrollbarVerticalNeeded&&(a=this.offsetY/(this.contentHeight-this.viewHeight),1<a&&(a=
1,this.setOffset(void 0,a)),this.scrollbarVerticalBox.setTransform(Ui.Matrix.createTranslate(0,(this.viewHeight-this.scrollbarVerticalHeight)*a)))}},onVerticalMouseDown:function(a){if(!this.lock&&!this.getIsDisabled()&&0==a.button){a.preventDefault();a.stopPropagation();this.window=window;this.iframe=void 0;if(navigator.isWebkit||navigator.isFirefox3){var b=Ui.App.getRootWindow();b!=window&&(this.window=b,this.iframe=Ui.App.getWindowIFrame())}this.connect(this.window,"mouseup",this.onVerticalMouseUp,
!0);this.connect(this.window,"mousemove",this.onVerticalMouseMove,!0);this.catcher=document.createElement("div");this.catcher.style.position="absolute";this.catcher.style.left="0px";this.catcher.style.right="0px";this.catcher.style.top="0px";this.catcher.style.bottom="0px";this.catcher.style.zIndex=1E3;this.window.document.body.appendChild(this.catcher);this.mouseStart=this.pointFromWindow({x:a.clientX,y:a.clientY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.speedY=this.speedX=
0}},onVerticalMouseMove:function(a){a.preventDefault();a.stopPropagation();var b={x:a.clientX,y:a.clientY};void 0!=this.iframe&&(b=Ui.Element.pointFromWindow(this.iframe,{x:a.clientX,y:a.clientY},this.window));a=this.pointFromWindow(b).y-this.mouseStart.y;b=this.viewHeight-this.scrollbarVerticalBox.getLayoutHeight();this.setOffset(void 0,this.startOffsetY+a/b*(this.contentHeight-this.viewHeight),!0)},onVerticalMouseUp:function(a){a.preventDefault();a.stopPropagation();0==a.button&&(this.window.document.body.removeChild(this.catcher),
this.disconnect(this.window,"mousemove",this.onVerticalMouseMove,!0),this.disconnect(this.window,"mouseup",this.onVerticalMouseUp,!0))},onHorizontalMouseDown:function(a){if(!this.lock&&!this.getIsDisabled()&&0==a.button){a.preventDefault();a.stopPropagation();this.window=window;this.iframe=void 0;if(navigator.isWebkit||navigator.isFirefox3){var b=Ui.App.getRootWindow();b!=window&&(this.window=b,this.iframe=Ui.App.getWindowIFrame())}this.connect(this.window,"mouseup",this.onHorizontalMouseUp,!0);this.connect(this.window,
"mousemove",this.onHorizontalMouseMove,!0);this.catcher=document.createElement("div");this.catcher.style.position="absolute";this.catcher.style.left="0px";this.catcher.style.right="0px";this.catcher.style.top="0px";this.catcher.style.bottom="0px";this.catcher.style.zIndex=1E3;this.window.document.body.appendChild(this.catcher);this.mouseStart=this.pointFromWindow({x:a.clientX,y:a.clientY});this.startOffsetX=this.offsetX;this.startOffsetY=this.offsetY;this.speedY=this.speedX=0}},onHorizontalMouseMove:function(a){a.preventDefault();
a.stopPropagation();var b={x:a.clientX,y:a.clientY};void 0!=this.iframe&&(b=Ui.Element.pointFromWindow(this.iframe,{x:a.clientX,y:a.clientY},this.window));a=this.pointFromWindow(b).x-this.mouseStart.x;b=this.viewWidth-this.scrollbarHorizontalBox.getLayoutWidth();this.setOffset(this.startOffsetX+a/b*(this.contentWidth-this.viewWidth),void 0,!0)},onHorizontalMouseUp:function(a){a.preventDefault();a.stopPropagation();0==a.button&&(this.window.document.body.removeChild(this.catcher),this.disconnect(this.window,
"mousemove",this.onHorizontalMouseMove,!0),this.disconnect(this.window,"mouseup",this.onHorizontalMouseUp,!0))}},{renderDrawing:function(){var a=Ui.Scrollable.base.renderDrawing.apply(this,arguments);a.style.overflow="hidden";return a},measureCore:function(a,b){var c={width:0,height:0};Ui.ScrollableContent.emulatedScrollbars&&(this.scrollbarHorizontalBox.measure(a,b),this.scrollbarVerticalBox.measure(a,b));var d=this.contentBox.measure(a,b);c.width=d.width<a?d.width:a;c.height=d.height<b?d.height:
b;this.scrollVertical||(c.height=d.height);this.scrollHorizontal||(c.width=d.width);return c},arrangeCore:function(a,b){this.viewWidth=a;this.viewHeight=b;this.contentWidth=a;this.contentHeight=b;this.contentBox.arrange(0,0,this.viewWidth,this.viewHeight);this.updateOffset()}});
Ui.Container.extend("Ui.ScrollableContent",{content:void 0,constructor:function(a){this.addEvents("scroll");this.connect(this.getDrawing(),"scroll",function(a){this.fireEvent("scroll",this,this.getDrawing().scrollLeft,this.getDrawing().scrollTop)})},setContent:function(a){this.content=a;this.appendChild(this.content)},getContent:function(){return this.content},setOffset:function(a,b){this.getDrawing().scrollLeft=a;this.getDrawing().scrollTop=b},getOffsetX:function(){return this.getDrawing().scrollLeft},
getOffsetY:function(){return this.getDrawing().scrollTop}},{renderDrawing:function(a){var b=Ui.Scrollable.base.renderDrawing.apply(this,arguments);b.style.overflow=Ui.ScrollableContent.emulatedScrollbars?"scroll":"auto";b.style.webkitOverflowScrolling="touch";return b},measureCore:function(a,b){var c={width:0,height:0};if(void 0!==this.content){var d=this.content.measure(a,b);c.width=d.width<a?d.width:a;c.height=d.height<b?d.height:b;this.scrollVertical||(c.height=d.height);this.scrollHorizontal||
(c.width=d.width)}return c},arrangeCore:function(a,b){if(void 0!==this.content){var c=this.content.getMeasureWidth();a>c&&(c=a);var d=this.content.getMeasureHeight();b>d&&(d=b);this.content.arrange(0,0,c,d);this.getDrawing().style.width=a+Ui.ScrollableContent.emulatedExtraWidth+"px";this.getDrawing().style.height=b+Ui.ScrollableContent.emulatedExtraHeight+"px"}}},{emulatedScrollbars:!0,emulatedExtraWidth:20,emulatedExtraHeight:20,constructor:function(){if(void 0===document.body||null===document.body){var a=
document.createElement("body");document.body=a}a=document.createElement("div");a.style.overflow="scroll";a.style.visibility="hidden";document.body.appendChild(a);Ui.ScrollableContent.emulatedExtraWidth=a.offsetWidth-a.clientWidth;Ui.ScrollableContent.emulatedExtraHeight=a.offsetHeight-a.clientHeight;Ui.ScrollableContent.emulatedScrollbars=0<this.emulatedExtraWidth||0<this.emulatedExtraHeight;document.body.removeChild(a)}});Ui.Pressable.extend("Ui.Draggable",{icon:void 0,downloadUrl:void 0,downloadMimetype:void 0,downloadFilename:void 0,allowedMode:"copyMove",mimetype:void 0,data:void 0,dragDelta:void 0,localkey:void 0,constructor:function(a){this.addEvents("dragstart","dragend");this.connect(this.getDrawing(),"dragstart",this.onDragStart,!0);this.connect(this.getDrawing(),"dragend",this.onDragEnd,!0);this.setData(this)},setMimetype:function(a){this.mimetype=a},getMimetype:function(){return this.mimetype},setData:function(a){this.data=
a;void 0===this.mimetype&&"object"===typeof this.data&&(Core.Object.hasInstance(this.data)?this.mimetype=Ui.Draggable.localmimetype+"-"+this.data.classType.toLowerCase():this.mimetype=Ui.Draggable.localmimetype);this.getDrawing().setAttribute("draggable",!0)},setAllowedMode:function(a){this.allowedMode=a},setIcon:function(a){this.icon=a},setDownloadUrl:function(a,b,c){this.downloadUrl=(new Core.Uri({uri:a})).toString();this.downloadMimetype=b;this.downloadFilename=c},getDragDelta:function(){return this.dragDelta},
onDragStart:function(a){if(!this.lock&&!this.getIsDisabled()){this.dragDelta=this.pointFromWindow({x:a.clientX,y:a.clientY});a.stopPropagation();a.dataTransfer.effectAllowed=this.allowedMode;if(void 0!==this.downloadUrl)try{a.dataTransfer.setData("DownloadURL",this.downloadMimetype+":"+this.downloadFilename+":"+this.downloadUrl)}catch(b){}var c="";if("object"===typeof this.data)if(this.localkey=Ui.Draggable.addLocalData(this.data),Core.Object.hasInstance(this.data))for(var d=this.data;void 0!==d&&
null!==d;)!navigator.supportDrag||navigator.supportMimetypeDrag?a.dataTransfer.setData(Ui.Draggable.localmimetype+"-"+d.classType.toLowerCase(),this.localkey):c+=Ui.Draggable.localmimetype+"-"+d.classType.toLowerCase()+":"+this.localkey+";",d=d.__baseclass__;else!navigator.supportDrag||navigator.supportMimetypeDrag?a.dataTransfer.setData(Ui.Draggable.localmimetype,this.localkey):c+=Ui.Draggable.localmimetype+":"+this.localkey+";";else!navigator.supportDrag||navigator.supportMimetypeDrag?a.dataTransfer.setData(this.mimetype,
this.data):c+=this.mimetype+":"+data+";";navigator.supportDrag&&!navigator.supportMimetypeDrag&&a.dataTransfer.setData("Text",c);this.fireEvent("dragstart",this);void 0!==this.icon&&void 0!==a.dataTransfer.setDragImage&&a.dataTransfer.setDragImage(this.icon.drawing.childNodes[0],0,0);return!1}},onDragEnd:function(a){a.stopPropagation();this.fireEvent("dragend",this,a.dataTransfer.dropEffect);void 0!==this.localkey&&(Ui.Draggable.removeLocalData(this.localkey),this.localkey=void 0)}},{},{localmimetype:void 0,
localdata:void 0,constructor:function(){Ui.Draggable.localdata={};for(var a="application/x-erajs-local-",b=0;16>b;b++)a+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(62*Math.random()));Ui.Draggable.localmimetype=a},addLocalData:function(a){for(var b="",c=0;16>c;c++)b+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(62*Math.random()));Ui.Draggable.localdata[b]=a;return b},getLocalData:function(a){return Ui.Draggable.localdata[a]},
removeLocalData:function(a){delete Ui.Draggable.localdata[a]}});Ui.LBox.extend("Ui.DropBox",{allowedMimetypes:void 0,allowFiles:!1,allowedMode:"all",constructor:function(a){this.addEvents("dragover","drop","dropfile");this.allowedMimetypes=[];this.connect(this.drawing,"dragenter",this.onDragEnter);this.connect(this.drawing,"dragover",this.onDragOver);this.connect(this.drawing,"drop",this.onDrop)},setAllowedMode:function(a){this.allowedMode=a},addMimetype:function(a){"function"===typeof a&&(a=Ui.Draggable.localmimetype+"-"+a.prototype.classType);this.allowedMimetypes.push(a);
"string"===typeof a&&"files"==a.toLowerCase()&&(this.allowFiles=!0)},dragMimetype:function(a){var b=void 0;if(void 0!=a.dataTransfer.types)for(var c=0;void 0===b&&c<a.dataTransfer.types.length;c++)for(var d=a.dataTransfer.types[c],e=0;void 0===b&&e<this.allowedMimetypes.length;e++)d.toLowerCase()===this.allowedMimetypes[e].toLowerCase()&&(b=this.allowedMimetypes[e]);return b},dragMergedMimetype:function(a){for(var b in a)for(a=0;a<this.allowedMimetypes.length;a++)if(b.toLowerCase()===this.allowedMimetypes[a].toLowerCase())return this.allowedMimetypes[a]},
onDragEnter:function(a){if(void 0!==this.dragMimetype(a))return a.preventDefault(),a.stopPropagation(),!1},onDragOver:function(a){if(void 0!==a.dataTransfer&&(navigator.supportDrag&&!navigator.supportMimetypeDrag||void 0!==this.dragMimetype(a))){var b="all";void 0!=a.dataTransfer.effectAllowed&&(b=a.dataTransfer.effectAllowed);"uninitialized"==b&&(b="all");var c="copy",c="all"!=this.allowedMode&&"copy"!=this.allowedMode&&"copyLink"!=this.allowedMode&&"copyMove"!=this.allowedMode||"copy"!=b&&"copyLink"!=
b&&"copyMove"!=b&&"all"!=b?"all"!=this.allowedMode&&"copyMove"!=this.allowedMode&&"linkMove"!=this.allowedMode&&"move"!=this.allowedMode||"all"!=b&&"copyMove"!=b&&"linkMove"!=b&&"move"!=b?"all"!=this.allowedMode&&"copyLink"!=this.allowedMode&&"link"!=this.allowedMode&&"linkMove"!=this.allowedMode||"all"!=b&&"copyLink"!=b&&"link"!=b&&"linkMove"!=b?"none":"link":"move":"copy";a.dataTransfer.dropEffect=c;a.preventDefault();navigator.supportDrag&&!navigator.supportMimetypeDrag||a.stopPropagation();a=
this.pointFromWindow({x:a.clientX,y:a.clientY});this.fireEvent("dragover",this,a.x,a.y);return!1}},onDrop:function(a){var b=this.pointFromWindow({x:a.clientX,y:a.clientY});if(void 0!=a.dataTransfer.files&&0<a.dataTransfer.files.length){a.preventDefault();a.stopPropagation();for(var c=0;c<a.dataTransfer.files.length;c++)this.fireEvent("dropfile",this,new Core.File({fileApi:a.dataTransfer.files[c]}),b.x,b.y,a.dataTransfer.effectAllowed)}else if(!navigator.supportDrag||navigator.supportMimetypeDrag){if(c=
this.dragMimetype(a),void 0!==c){var d=a.dataTransfer.getData(c);0===c.indexOf(Ui.Draggable.localmimetype)&&(d=Ui.Draggable.getLocalData(d));a.preventDefault();a.stopPropagation();this.fireEvent("drop",this,c,d,b.x,b.y,a.dataTransfer.effectAllowed)}}else{for(var c=a.dataTransfer.getData("Text"),d={},e=c.split(";"),c=0;c<e.length;c++){var g=e[c].indexOf(":");-1!==g&&(d[e[c].substring(0,g)]=e[c].substring(g+1))}c=this.dragMergedMimetype(d);void 0!==c&&(a.preventDefault(),a.stopPropagation(),d=d[c],
0===c.indexOf(Ui.Draggable.localmimetype)&&(d=Ui.Draggable.getLocalData(d)),this.fireEvent("drop",this,c,d,b.x,b.y,a.dataTransfer.effectAllowed))}return!1}});Ui.Element.extend("Ui.IFrame",{iframeDrawing:void 0,isReady:!1,constructor:function(a){this.connect(this.iframeDrawing,"load",this.onIFrameLoad);this.addEvents("ready")},getSrc:function(){return this.iframeDrawing.getAttribute("src")},setSrc:function(a){this.iframeDrawing.setAttribute("src",a)},getIFrame:function(){return this.iframeDrawing},onIFrameLoad:function(){this.isReady||(this.isReady=!0,this.fireEvent("ready",this))}},{renderDrawing:function(){if(navigator.iOs){var a=Ui.IFrame.base.renderDrawing.apply(this,
arguments);a.style.overflow="scroll";a.style.webkitOverflowScrolling="touch";this.iframeDrawing=document.createElement("iframe");this.iframeDrawing.scrolling="no";this.iframeDrawing.style.border="0px";this.iframeDrawing.style.margin="0px";this.iframeDrawing.style.padding="0px";this.iframeDrawing.style.width="100%";this.iframeDrawing.style.height="100%";a.appendChild(this.iframeDrawing);return a}this.iframeDrawing=document.createElement("iframe");this.iframeDrawing.style.border="0px";this.iframeDrawing.style.margin=
"0px";this.iframeDrawing.style.padding="0px";this.iframeDrawing.style.width="100%";this.iframeDrawing.style.height="100%";navigator.isIE&&(this.iframeDrawing.frameBorder="0");return this.iframeDrawing},onVisible:function(){if(navigator.isIE7||navigator.isIE8){var a=this.iframeDrawing.contentWindow;void 0!=a.document.body&&(a.document.body.clientWidth,a.document.body.clientHeight)}}});Ui.LBox.extend("Ui.MouseOverable",{task:void 0,isOver:!1,constructor:function(a){this.addEvents("enter","leave","move");this.connect(this.getDrawing(),"mouseover",this.onMouseOver);this.connect(this.getDrawing(),"mouseout",this.onMouseOut);this.connect(this.getDrawing(),"mousemove",this.onMouseMove,!0)},getIsOver:function(){return this.isOver},onMouseOver:function(a){void 0!=this.task?(this.task.abort(),this.task=void 0):(this.isOver=!0,this.fireEvent("enter",this))},onMouseOut:function(a){this.task=
new Core.DelayedTask({delay:0,scope:this,callback:this.onDelayedMouseOut})},onDelayedMouseOut:function(a){this.isOver=!1;this.fireEvent("leave",this);this.task=void 0},onMouseMove:function(a){this.isOver&&this.fireEvent("move",this)}});Ui.MovableBase.extend("Ui.Carouselable",{ease:void 0,items:void 0,pos:0,lastPosition:void 0,activeItems:void 0,alignClock:void 0,animNext:void 0,animStart:void 0,bufferingSize:1,constructor:function(a){this.addEvents("change");this.setClipToBounds(!0);this.setFocusable(!0);this.setMoveVertical(!1);this.items=[];this.activeItems=[];this.ease=Anim.EasingFunction.create({type:Anim.PowerEase,mode:"out"});this.connect(this,"down",this.onCarouselableDown);this.connect(this,"up",this.onCarouselableUp);this.connect(this.getDrawing(),
"keydown",this.onKeyDown);this.connect(this.getDrawing(),"mousewheel",this.onMouseWheel);this.connect(this.getDrawing(),"DOMMouseScroll",this.onMouseWheel)},getBufferingSize:function(){return this.bufferingSize},setBufferingSize:function(a){this.bufferingSize!=a&&(this.bufferingSize=a,this.updateItems())},getLogicalChildren:function(){return this.items},getCurrentPosition:function(){return void 0!==this.alignClock?this.animNext:this.pos},getCurrent:function(){return this.items[this.getCurrentPosition()]},
setCurrentAt:function(a){a=Math.min(2*(this.items.length-1),Math.max(0,a));this.startAnimation(2*(this.pos-a),a)},setCurrent:function(a){for(var b=0;b<this.items.length;b++)if(this.items[b]==a){this.setCurrentAt(b);break}},next:function(){void 0===this.alignClock?this.pos<this.items.length-1&&this.startAnimation(-2,this.pos+1):this.animNext>this.pos?this.startAnimation(-2*(this.animNext+1-Math.floor(this.pos)),Math.min(this.animNext+1,this.items.length-1)):this.startAnimation(-2,Math.min(Math.ceil(this.pos),
this.items.length-1))},previous:function(){void 0===this.alignClock?0<this.pos&&this.startAnimation(2,this.pos-1):this.animNext<this.pos?this.startAnimation(2*(Math.floor(this.pos)-(this.animNext-1)),Math.max(this.animNext-1,0)):this.startAnimation(2,Math.floor(this.pos))},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},append:function(a){this.items.push(Ui.Element.create(a));this.onChange()},remove:function(a){for(var b=0;b<this.items.length&&this.items[b]!=a;)b++;if(b<this.items.length){this.items.splice(b,
1);if(0>this.pos||this.pos>this.items.length-1)this.pos=Math.max(0,Math.min(this.pos,this.items.length-1));void 0!==this.alignClock&&(this.animNext=Math.max(0,Math.min(this.animNext,this.items.length-1)));this.setPosition(-this.pos*this.getLayoutWidth(),void 0,!0);this.onChange()}},insertAt:function(a,b){0>b&&(b=this.items.length+b);0>b&&(b=0);b>=this.items.length&&(b=this.items.length);this.items.splice(b,0,Ui.Element.create(a));this.onChange()},moveAt:function(a,b){0>b&&(b=this.items.length+b);
0>b&&(b=0);b>=this.items.length&&(b=this.items.length);for(var c=0;c<this.items.length&&this.items[c]!=a;)c++;c<this.items.length&&(this.items.splice(c,1),this.items.splice(b,0,a));this.onChange()},onKeyDown:function(a){if(!this.getIsDisabled()){var b=a.which;if(37==b||39==b)a.stopPropagation(),a.preventDefault(),37==b?this.previous():39==b&&this.next()}},onMouseWheel:function(a){var b=0;void 0!=a.wheelDeltaX&&void 0!=a.wheelDelaY&&(b=-a.wheelDeltaX/5);0!==b&&(a.preventDefault(),a.stopPropagation(),
0>b?this.previous():this.next())},onCarouselableDown:function(){this.stopAnimation()},onCarouselableUp:function(a,b,c,d,e,g,f){!0===f?(a=this.pos%1,b=0.5<a?-400:400):50>Math.abs(b)&&(d>0.2*this.getLayoutWidth()||100<Math.abs(d)?b=0>d?-400:400:(a=this.pos%1,b=0.5<a?-400:400));800>Math.abs(b)&&(b=0>b?-800:800);0!=b&&this.startAnimation(b/this.getLayoutWidth())},onChange:function(){this.loadItems();this.updateItems();var a=this.getCurrent();void 0!==a&&a.enable();a=this.getCurrentPosition();if(void 0===
this.lastPosition||this.lastPosition!==a)void 0!==this.lastPosition&&void 0!==this.items[this.lastPosition]&&this.items[this.lastPosition].disable(),this.lastPosition=a,this.fireEvent("change",this,a)},onAlignTick:function(a,b,c){if(0!=c&&(a=-(a.getTime()*this.speed)/(this.animNext-this.animStart),1<=a&&(this.alignClock.stop(),this.alignClock=void 0,a=1),a=this.ease.ease(a),this.pos=this.animStart+a*(this.animNext-this.animStart),this.setPosition(-this.pos*this.getLayoutWidth(),void 0),void 0===this.alignClock))this.onChange()},
startAnimation:function(a,b){this.stopAnimation();this.speed=a;this.animStart=this.pos;this.animNext=void 0===b?0>this.speed?Math.ceil(this.animStart):Math.floor(this.animStart):b;this.animStart!=this.animNext&&(this.alignClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:this.onAlignTick}),this.alignClock.begin())},stopAnimation:function(){void 0!=this.alignClock&&(this.alignClock.stop(),this.alignClock=void 0)},loadItems:function(){if(this.getIsLoaded()){for(var a=0;a<
this.activeItems.length;a++)this.activeItems[a].carouselableSeen=void 0;for(var b=[],a=Math.max(0,Math.floor(this.pos-this.bufferingSize));a<Math.min(this.items.length,Math.floor(this.pos+1+this.bufferingSize));a++){for(var c=this.items[a],d=!1,e=0;!d&&e<this.activeItems.length;e++)this.activeItems[e]===c&&(d=!0,this.activeItems[e].carouselableSeen=!0);b.push(c);d||(c.disable(),this.appendChild(c))}for(a=0;a<this.activeItems.length;a++)this.activeItems[a].carouselableSeen||this.removeChild(this.activeItems[a]);
this.activeItems=b}},updateItems:function(){if(this.getIsLoaded()){var a=this.getLayoutWidth(),b=this.getLayoutHeight();void 0!==this.animClock&&(target=this.animNext);for(var c=0;c<this.activeItems.length;c++){for(var d=this.activeItems[c],e=-1,e=0;e<this.items.length&&this.items[e]!==d;e++);e<this.items.length&&(d.measure(a,b),d.arrange(0,0,a,b),d.setTransform(Ui.Matrix.createTranslate((e-this.pos)*a,0)))}}}},{onLoad:function(){Ui.Carouselable.base.onLoad.call(this);this.loadItems();this.updateItems()},
onMove:function(a,b){this.pos=-a/this.getLayoutWidth();if(0>this.pos||this.pos>this.items.length-1)this.pos=Math.max(0,Math.min(this.pos,this.items.length-1)),this.setPosition(-this.pos*this.getLayoutWidth());this.updateItems()},arrangeCore:function(a,b){this.setPosition(-this.pos*a,void 0)},onChildInvalidateMeasure:function(a,b){}});Ui.Rectangle.extend("Ui.Separator",{constructor:function(a){this.setHeight(1);this.setWidth(1)}},{onStyleChange:function(){this.setFill(this.getStyleProperty("color"))}},{style:{color:new Ui.Color({r:0,g:0,b:0})}});Ui.LBox.extend("Ui.ContextBar",{selection:void 0,counter:void 0,actionsBox:void 0,bg:void 0,constructor:function(a){this.selection=a.selection;delete a.selection;this.bg=new Ui.Rectangle;this.append(this.bg);a=new Ui.HBox({spacing:5});this.append(a);var b=new Ui.Pressable({margin:5});b.setContent(new Ui.Icon({icon:"close",width:25,height:25,verticalAlign:"center"}));a.append(b);this.connect(b,"press",this.onClosePress);this.counter=new Ui.Label({horizontalAlign:"center",verticalAlign:"center",fontSize:24});
a.append(this.counter);this.actionsBox=new Ui.MenuToolBar({spacing:5,menuPosition:"left",itemsAlign:"right",uniform:!0});a.append(this.actionsBox,!0);this.connect(this.selection,"change",this.onSelectionChange)},onClosePress:function(){this.selection.clear()},onSelectionChange:function(){this.counter.setText(this.selection.getElements().length);var a=this.selection.getActions();this.actionsBox.clear();for(var b in a){var c=a[b];!0!==c.hidden&&(c=new Ui.ActionButton({icon:c.icon,text:c.text,action:c,
selection:this.selection}),c.addMimetype(this.selection.getElements()[0].getMimetype()),this.actionsBox.append(c))}},onDrop:function(a){a=a.dialogContextBarAction;var b=this;"scope"in a&&(b=a.scope);a.callback.call(b,this.selection)}},{onStyleChange:function(){this.bg.setFill(this.getStyleProperty("background"))}},{style:{background:"#90C0FF"}});Ui.Container.extend("Ui.Popup",{background:void 0,shadow:void 0,shadowGraphic:void 0,contentBox:void 0,ppContent:void 0,posX:void 0,posY:void 0,attachedElement:void 0,attachedBorder:void 0,lbox:void 0,autoHide:!0,expandable:!1,constructor:function(a){this.setHorizontalAlign("stretch");this.setVerticalAlign("stretch");this.shadow=new Ui.Pressable({focusable:!1});this.appendChild(this.shadow);this.shadowGraphic=new Ui.Rectangle;this.shadow.setContent(this.shadowGraphic);this.background=new Ui.PopupBackground({radius:0,
fill:"#f8f8f8"});this.appendChild(this.background);this.contentBox=new Ui.LBox({padding:4,paddingLeft:3});this.appendChild(this.contentBox);this.connect(this.shadow,"press",this.onShadowPress);this.connect(this.getDrawing(),"keyup",this.onKeyUp)},setExpandable:function(a){this.expandable!=a&&(this.expandable=a,this.invalidateMeasure())},setAutoHide:function(a){this.autoHide=a},setContent:function(a){a=Ui.Element.create(a);this.ppContent!==a&&(void 0!=this.ppContent&&this.contentBox.remove(this.ppContent),
this.ppContent=a,void 0!==this.ppContent&&this.contentBox.append(this.ppContent))},onKeyUp:function(a){27==a.which&&this.autoHide&&(a.preventDefault(),a.stopPropagation(),this.hide())},onWindowResize:function(){this.visible&&this.autoHide&&void 0!=this.posX&&this.hide()},onShadowPress:function(){this.autoHide&&this.hide()}},{visible:!1,onStyleChange:function(){this.background.setFill(this.getStyleProperty("background"));this.shadowGraphic.setFill(this.getStyleProperty("shadowColor"))},show:function(a,
b){var c=this.getIsVisible();Ui.Popup.base.show.call(this);this.posY=this.posX=this.attachedElement=void 0;c||("object"==typeof a&&Ui.Element.hasInstance(a)?(this.attachedElement=a,void 0!==b&&"string"===typeof b&&(this.attachedBorder=b),c=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth(),y:this.attachedElement.getLayoutHeight()/2}),this.posX=c.x,this.posY=c.y):void 0!=a&&void 0!=b?(this.posX=a,this.posY=b):this.posY=this.posX=void 0,this.invalidateArrange(),Ui.App.current.appendDialog(this),
this.connect(window,"resize",this.onWindowResize))},onHidden:function(){Ui.App.current.removeDialog(this);this.disconnect(window,"resize",this.onWindowResize)},measureCore:function(a,b){var c=Math.max(a-40,0),d=Math.max(b-40,0);this.expandable||(d=c=0);this.background.measure(c,d);c=this.contentBox.measure(c,d);return void 0!=this.posX||void 0!=this.attachedElement?{width:c.width,height:c.height}:{width:Math.max(a,c.width+40),height:Math.max(b,c.height+40)}},arrangeCore:function(a,b){this.shadow.arrange(0,
0,a,b);if(void 0===this.posX&&void 0===this.attachedElement||150>a||150>b)this.setCenter(a,b);else if(void 0!==this.attachedElement){var c=["left","right","top","bottom","center"];void 0!==this.attachedBorder&&c.unshift(this.attachedBorder);for(var d=0;d<c.length;d++){var e=c[d];if("left"===e){if(e=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth(),y:this.attachedElement.getLayoutHeight()/2}),this.contentBox.getMeasureWidth()+e.x+10<a){this.setLeft(e.x,e.y,a,b);break}}else if("right"===
e){if(e=this.attachedElement.pointToWindow({x:0,y:this.attachedElement.getLayoutHeight()/2}),this.contentBox.getMeasureWidth()+10<e.x){this.setRight(e.x,e.y,a,b);break}}else if("top"===e){if(e=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth()/2,y:0}),this.contentBox.getMeasureHeight()+10<e.y){this.setTop(e.x,e.y,a,b);break}}else if("bottom"===e){if(e=this.attachedElement.pointToWindow({x:this.attachedElement.getLayoutWidth()/2,y:this.attachedElement.getLayoutHeight()}),this.contentBox.getMeasureHeight()+
10+e.y<b){this.setBottom(e.x,e.y,a,b);break}}else{this.setCenter(a,b);break}}}else for(c=["left","right","top","bottom","center"],void 0!==this.attachedBorder&&c.unshift(this.attachedBorder),d=0;d<c.length;d++)if(e=c[d],"left"===e){if(this.contentBox.getMeasureWidth()+this.posX+10<a){this.setLeft(this.posX,this.posY,a,b);break}}else if("right"===e){if(this.contentBox.getMeasureWidth()+10<this.posX){this.setRight(this.posX,this.posY,a,b);break}}else if("top"===e){if(this.contentBox.getMeasureHeight()+
10<this.posY){this.setTop(this.posX,this.posY,a,b);break}}else if("bottom"===e){if(this.contentBox.getMeasureHeight()+10+this.posY<b){this.setBottom(this.posX,this.posY,a,b);break}}else{this.setCenter(a,b);break}},setLeft:function(a,b,c,d){a+=10;c=b-30;this.background.setArrowBorder("left");c+this.contentBox.getMeasureHeight()>d?(c=d-this.contentBox.getMeasureHeight(),b-=c,b>this.contentBox.getMeasureHeight()-18&&(b=this.contentBox.getMeasureHeight()-18),this.background.setArrowOffset(b)):this.background.setArrowOffset(30);
this.shadow.setOpacity(0);this.background.arrange(a-10,c,this.contentBox.getMeasureWidth()+10,this.contentBox.getMeasureHeight());this.contentBox.arrange(a,c,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},setRight:function(a,b,c,d){a-=10+this.contentBox.getMeasureWidth();c=b-30;this.background.setArrowBorder("right");c+this.contentBox.getMeasureHeight()>d?(c=d-this.contentBox.getMeasureHeight(),b-=c,b>this.contentBox.getMeasureHeight()-18&&(b=this.contentBox.getMeasureHeight()-
18),this.background.setArrowOffset(b)):this.background.setArrowOffset(30);this.shadow.setOpacity(0);this.background.arrange(a,c,this.contentBox.getMeasureWidth()+10,this.contentBox.getMeasureHeight());this.contentBox.arrange(a,c,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},setTop:function(a,b,c,d){b-=this.contentBox.getMeasureHeight();d=a-30;this.background.setArrowBorder("bottom");d+this.contentBox.getMeasureWidth()>c?(d=c-this.contentBox.getMeasureWidth(),a-=d,a>this.contentBox.getMeasureWidth()-
18&&(a=this.contentBox.getMeasureWidth()-18),this.background.setArrowOffset(a)):2>d?(this.background.setArrowOffset(a+2),d=2):this.background.setArrowOffset(30);this.shadow.setOpacity(0);this.background.arrange(d,b-10,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight()+10);this.contentBox.arrange(d,b-10,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},setBottom:function(a,b,c,d){b+=10;d=a-30;this.background.setArrowBorder("top");d+this.contentBox.getMeasureWidth()>
c?(d=c-this.contentBox.getMeasureWidth(),a-=d,a>this.contentBox.getMeasureWidth()-18&&(a=this.contentBox.getMeasureWidth()-18),this.background.setArrowOffset(a)):2>d?(this.background.setArrowOffset(a+2),d=2):this.background.setArrowOffset(30);this.shadow.setOpacity(0);this.background.arrange(d,b-10,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight()+10);this.contentBox.arrange(d,b,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight())},setCenter:function(a,b){this.background.setArrowBorder("none");
this.expandable?(this.background.arrange(20,20,a-40,b-40),this.shadow.setOpacity(1),this.contentBox.arrange(20,20,a-40,b-40)):(x=(a-this.contentBox.getMeasureWidth())/2,y=(b-this.contentBox.getMeasureHeight())/2,this.background.arrange(x,y,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight()),this.shadow.setOpacity(1),this.contentBox.arrange(x,y,this.contentBox.getMeasureWidth(),this.contentBox.getMeasureHeight()))}},{style:{background:Ui.Color.create("#f8f8f8"),shadowColor:new Ui.Color({r:1,
g:1,b:1,a:0.5})}});
Ui.CanvasElement.extend("Ui.PopupBackground",{radius:8,fill:"black",arrowBorder:"left",arrowOffset:30,arrowSize:10,constructor:function(a){},setArrowBorder:function(a){this.arrowBorder!=a&&(this.arrowBorder=a,this.invalidateArrange())},setArrowOffset:function(a){this.arrowOffset!=a&&(this.arrowOffset=a,this.invalidateArrange())},setRadius:function(a){this.radius!=a&&(this.radius=a,this.invalidateArrange())},setFill:function(a){this.fill!=a&&(this.fill=Ui.Color.create(a))},genPath:function(a,b,c,d,
e,g){if("none"==d){d=a-c;var f=b-c;return"M"+c+",0 L"+d+",0 Q"+a+",0 "+a+","+c+" L"+a+","+f+" Q"+a+","+b+" "+d+","+b+" L"+c+","+b+" Q0,"+b+" 0,"+f+" L0,"+c+" Q0,0 "+c+",0 z"}if("left"==d)return d=a-this.radius,f=b-this.radius,"M"+(c+e)+",0 L"+d+",0 Q"+a+",0 "+a+","+c+" L"+a+","+f+" Q"+a+","+b+" "+d+","+b+" L"+(c+e)+","+b+" Q"+e+","+b+" "+e+","+f+" L"+e+","+(g+e)+" L0,"+g+" L"+e+","+(g-e)+" L"+e+","+c+" Q"+e+",0 "+(c+e)+",0 z";if("right"==d)return d=a-(this.radius+e),f=b-this.radius,"M"+c+",0 L"+d+
",0 Q"+(a-e)+",0 "+(a-e)+","+c+" L"+(a-e)+","+(g-e)+" L"+a+","+g+" L"+(a-e)+","+(g+e)+" L "+(a-e)+","+f+" Q"+(a-e)+","+b+" "+d+","+b+" L"+c+","+b+" Q0,"+b+" 0,"+f+" L0,"+c+" Q0,0 "+c+",0 z";if("top"==d)return d=a-this.radius,f=b-this.radius,"M"+c+","+e+" L"+(g-e)+","+e+" L"+g+",0 L"+(g+e)+","+e+" L"+d+","+e+" Q"+a+","+e+" "+a+","+(e+c)+" L"+a+","+f+" Q"+a+","+b+" "+d+","+b+" L"+c+","+b+" Q0,"+b+" 0,"+f+" L0,"+(e+c)+" Q0,"+e+" "+c+","+e+" z";if("bottom"==d)return d=a-this.radius,f=b-(this.radius+e),
"M"+c+",0 L"+d+",0 Q"+a+",0 "+a+","+c+" L"+a+","+f+" Q"+a+","+(b-e)+" "+d+","+(b-e)+" L "+(g+e)+","+(b-e)+" L"+g+","+b+" L"+(g-e)+","+(b-e)+" L"+c+","+(b-e)+" Q0,"+(b-e)+" 0,"+f+" L0,"+c+" Q0,0 "+c+",0 z"}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight();"none"==this.arrowBorder?(a.fillStyle="rgba(0,0,0,0.1)",a.fillRect(0,0,b,c),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(1,1,b-2,c-2),a.fillStyle=this.fill.getCssRgba(),a.fillRect(2,2,b-4,c-4)):(a.fillStyle="rgba(0,0,0,0.1)",
a.svgPath(this.genPath(b,c,this.radius,this.arrowBorder,this.arrowSize,this.arrowOffset)),a.fill(),a.save(),a.fillStyle="rgba(0,0,0,0.5)",a.translate(1,1),a.svgPath(this.genPath(b-2,c-2,this.radius-1,this.arrowBorder,this.arrowSize-1,this.arrowOffset-1)),a.fill(),a.restore(),a.fillStyle=this.fill.getCssRgba(),a.translate(2,2),a.svgPath(this.genPath(b-4,c-4,this.radius-2,this.arrowBorder,this.arrowSize-1,this.arrowOffset-2)),a.fill())}});Ui.CanvasElement.extend("Ui.DialogGraphic",{background:void 0,constructor:function(){this.background=Ui.Color.create("#f8f8f8")},setBackground:function(a){this.background=Ui.Color.create(a);this.invalidateDraw()}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight();a.roundRectFilledShadow(0,0,b,c,2,2,2,2,!1,3,new Ui.Color({a:0.3}));a.fillStyle=this.background.getCssRgba();a.fillRect(3,3,b-6,c-6)}});
Ui.LBox.extend("Ui.DialogButtonBox",{bg:void 0,actionBox:void 0,cancelBox:void 0,actionButtonsBox:void 0,constructor:function(a){this.addEvents("cancel");this.bg=new Ui.Rectangle({fill:"#e8e8e8"});this.append(this.bg);this.actionBox=new Ui.HBox({margin:5,spacing:30});this.append(this.actionBox);this.cancelBox=new Ui.LBox;this.actionBox.append(this.cancelBox);this.actionButtonsBox=new Ui.MenuToolBar({spacing:5,itemsAlign:"right",menuPosition:"left",uniform:!0});this.actionBox.append(this.actionButtonsBox,
!0)},setCancelButton:function(a){var b=this.cancelBox.getFirstChild();void 0!==b&&Ui.Pressable.hasInstance(b)&&this.disconnect(b,"press",this.onCancelPress);this.cancelBox.setContent(a);a=this.cancelBox.getFirstChild();void 0!=a&&Ui.Pressable.hasInstance(a)&&this.connect(a,"press",this.onCancelPress)},setActionButtons:function(a){this.actionButtonsBox.setContent(a)},onCancelPress:function(){this.fireEvent("cancel",this)}});
Ui.Container.extend("Ui.Dialog",{dialogSelection:void 0,bg:void 0,graphic:void 0,lbox:void 0,vbox:void 0,titleLabel:void 0,contentBox:void 0,contentVBox:void 0,actionButtons:void 0,cancelButton:void 0,buttonsBox:void 0,buttonsVisible:!1,preferedWidth:100,preferedHeight:100,actionBox:void 0,contextBox:void 0,constructor:function(a){this.addEvents("close");this.dialogSelection=new Ui.Selection;this.bg=new Ui.Rectangle({fill:"rgba(255,255,255,0.7)"});this.appendChild(this.bg);this.lbox=new Ui.LBox;this.appendChild(this.lbox);
this.graphic=new Ui.DialogGraphic;this.lbox.append(this.graphic);this.vbox=new Ui.VBox({margin:3});this.lbox.append(this.vbox);this.scroll=new Ui.ScrollingArea({marginLeft:2,marginTop:2,marginRight:2});this.scroll.setScrollHorizontal(!1);this.scroll.setScrollVertical(!1);this.vbox.append(this.scroll,!0);this.contentVBox=new Ui.VBox;this.scroll.setContent(this.contentVBox);this.contentBox=new Ui.LBox({margin:8});this.contentVBox.append(this.contentBox,!0);this.buttonsBox=new Ui.VBox;this.buttonsBox.append(new Ui.Rectangle({height:1,
fill:"#d8d8d8"}));a=new Ui.LBox({height:32});this.buttonsBox.append(a);this.buttonsBox.hide(!0);this.vbox.append(this.buttonsBox);this.contextBox=new Ui.ContextBar({selection:this.dialogSelection});this.contextBox.hide();a.append(this.contextBox);this.actionBox=new Ui.DialogButtonBox;this.connect(this.actionBox,"cancel",this.close);a.append(this.actionBox);this.connect(this.dialogSelection,"change",this.onDialogSelectionChange);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},getSelectionHandler:function(){return this.dialogSelection},
setPreferedWidth:function(a){this.preferedWidth=a;this.invalidateMeasure()},setPreferedHeight:function(a){this.preferedHeight=a;this.invalidateMeasure()},open:function(){Ui.App.current.appendDialog(this)},close:function(){Ui.App.current.removeDialog(this);this.fireEvent("close",this)},setFullScrolling:function(a){this.scroll.setScrollHorizontal(a);this.scroll.setScrollVertical(a)},setTitle:function(a){this.title=a;""!=this.title&&void 0!==this.title||void 0===this.titleLabel?(void 0===this.titleLabel&&
(this.titleLabel=new Ui.Label({horizontalAlign:"left",margin:10,fontWeight:"bold",fontSize:18,color:"#666666"}),this.contentVBox.prepend(this.titleLabel)),this.titleLabel.setText(this.title)):(this.contentVBox.remove(this.titleLabel),this.titleLabel=void 0)},updateButtonsBoxVisible:function(){var a=void 0!==this.cancelButton||void 0!==this.actionButtons||0<this.dialogSelection.getElements().length;!this.buttonsVisible&&a?(this.buttonsVisible=!0,this.buttonsBox.show()):this.buttonsVisible&&!a&&(this.buttonsVisible=
!1,this.buttonsBox.hide(!0))},setCancelButton:function(a){this.cancelButton=a;this.actionBox.setCancelButton(a);this.updateButtonsBoxVisible()},setActionButtons:function(a){this.actionButtons=a;this.actionBox.setActionButtons(a);this.updateButtonsBoxVisible()},setContent:function(a){this.contentBox.setContent(a)},getContent:function(){return this.contentBox.getFirstChild()},onCancelPress:function(){this.close()},onDialogSelectionChange:function(a){0===a.getElements().length?(this.contextBox.hide(),
this.actionBox.show()):(this.contextBox.show(),this.actionBox.hide());this.updateButtonsBoxVisible()},onKeyDown:function(a){46===a.which&&0!==this.dialogSelection.getElements().length&&this.dialogSelection.executeDeleteAction()&&(a.preventDefault(),a.stopPropagation())}},{onStyleChange:function(){this.bg.setFill(this.getStyleProperty("shadow"));this.graphic.setBackground(this.getStyleProperty("background"))},measureCore:function(a,b){this.bg.measure(a,b);this.lbox.measure(a<this.preferedWidth?a:this.preferedWidth,
b<this.preferedHeight?b:this.preferedHeight);return{width:a,height:b}},arrangeCore:function(a,b){this.bg.arrange(0,0,a,b);var c=Math.max(a<this.preferedWidth?a:this.preferedWidth,this.lbox.getMeasureWidth()),d=Math.max(b<this.preferedHeight?b:this.preferedHeight,this.lbox.getMeasureHeight());this.lbox.arrange((a-c)/2,(b-d)/2,c,d)}},{style:{shadow:"rgba(255,255,255,0.7)",background:"#f8f8f8"}});Ui.Element.extend("Ui.Entry",{fontSize:void 0,fontFamily:void 0,fontWeight:void 0,color:void 0,value:"",passwordMode:!1,constructor:function(a){this.addEvents("change","validate");this.setFocusable(!0);this.connect(this.getDrawing(),"change",this.onChange);this.connect(this.getDrawing(),"paste",this.onPaste);this.connect(this.getDrawing(),"keyup",this.onKeyUp);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},setPasswordMode:function(a){if(this.passwordMode!=a){this.passwordMode=a;try{this.passwordMode?
this.getDrawing().setAttribute("type","password"):this.getDrawing().setAttribute("type","text")}catch(b){a=this.getDrawing().cloneNode(!1),this.passwordMode?a.setAttribute("type","password"):a.setAttribute("type","text"),this.getDrawing().parentNode.replaceChild(a,this.getDrawing()),this.drawing=a,this.invalidateArrange()}}},setFontSize:function(a){this.fontSize!=a&&(this.fontSize=a,this.getDrawing().style.fontSize=this.getFontSize()+"px",this.invalidateMeasure())},getFontSize:function(){return void 0!=
this.fontSize?this.fontSize:this.getStyleProperty("fontSize")},setFontFamily:function(a){this.fontFamily!=a&&(this.fontFamily=a,this.getDrawing().style.fontFamily=this.getFontFamily(),this.invalidateMeasure())},getFontFamily:function(){return void 0!=this.fontFamily?this.fontFamily:this.getStyleProperty("fontFamily")},setFontWeight:function(a){this.fontWeight!=a&&(this.fontWeight=a,this.getDrawing().style.fontWeight=this.getFontWeight(),this.invalidateMeasure())},getFontWeight:function(){return void 0!=
this.fontWeight?this.fontWeight:this.getStyleProperty("fontWeight")},setColor:function(a){this.color!=a&&(this.color=Ui.Color.create(a),navigator.supportRgba?this.getDrawing().style.color=this.getColor().getCssRgba():this.getDrawing().style.color=this.getColor().getCssHtml())},getColor:function(){return void 0!=this.color?this.color:Ui.Color.create(this.getStyleProperty("color"))},getValue:function(){return this.value},setValue:function(a){if(null===a||void 0===a)a="";this.value=a;this.getDrawing().value=
this.value},onPaste:function(a){a.stopPropagation();new Core.DelayedTask({delay:0,scope:this,callback:this.onAfterPaste})},onAfterPaste:function(){this.getDrawing().value!=this.value&&(this.value=this.getDrawing().value,this.fireEvent("change",this,this.value))},onChange:function(a){this.getDrawing().value!=this.value&&(this.value=this.getDrawing().value,this.fireEvent("change",this,this.value))},onKeyDown:function(a){13!=a.which&&37!=a.which&&39!=a.which&&36!=a.which&&35!=a.which||a.stopPropagation()},
onKeyUp:function(a){this.getDrawing().value!=this.value&&(this.value=this.getDrawing().value,this.fireEvent("change",this,this.value));13==a.which?(a.preventDefault(),a.stopPropagation(),this.fireEvent("validate",this)):13!=a.which&&37!=a.which&&39!=a.which&&36!=a.which&&35!=a.which||a.stopPropagation()}},{renderDrawing:function(){var a=document.createElement("input");a.setAttribute("type","text");a.style.opacity=1;a.style.border="0px";a.style.margin="0px";a.style.padding="0px";a.style.outline="none";
navigator.isIE?navigator.isIE7||navigator.isIE8?a.style.background="transparent":a.style.backgroundColor="rgba(255,255,255,0.01)":a.style.background="none";navigator.isWebkit&&(a.style.webkitAppearance="none");a.style.fontSize=this.getFontSize()+"px";a.style.fontFamily=this.getFontFamily();a.style.fontWeight=this.getFontWeight();a.style.color=this.getColor();return a},measureCore:function(a,b){return{width:8,height:3*this.getFontSize()/2}},arrangeCore:function(a,b){this.getDrawing().style.width=a+
"px";this.getDrawing().style.height=b+"px";this.getDrawing().style.lineHeight=b+"px"},onDisable:function(){Ui.Entry.base.onDisable.call(this);this.getDrawing().blur();this.getDrawing().style.cursor="default";this.getDrawing().disabled=!0},onEnable:function(){Ui.Entry.base.onEnable.call(this);this.getDrawing().style.cursor="auto";this.getDrawing().disabled=!1},onStyleChange:function(){this.getDrawing().style.fontSize=this.getFontSize()+"px";this.getDrawing().style.fontFamily=this.getFontFamily();this.getDrawing().style.fontWeight=
this.getFontWeight();navigator.supportRgba?this.getDrawing().style.color=this.getColor().getCssRgba():this.getDrawing().style.color=this.getColor().getCssHtml();this.invalidateMeasure()}},{style:{color:new Ui.Color({r:0,g:0,b:0}),fontSize:14,fontFamily:"Sans-serif",fontWeight:"normal"}});Ui.Element.extend("Ui.TextArea",{fontSize:void 0,fontFamily:void 0,fontWeight:void 0,color:void 0,value:"",constructor:function(a){this.addEvents("change","scroll");this.setSelectable(!0);this.setFocusable(!0);this.connect(this.getDrawing(),"change",this.onChange);this.connect(this.getDrawing(),"paste",this.onPaste);this.connect(this.getDrawing(),"keyup",this.onKeyUp);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},setFontSize:function(a){this.fontSize!=a&&(this.fontSize=a,this.getDrawing().style.fontSize=
this.getFontSize()+"px",this.invalidateMeasure())},getFontSize:function(){return void 0!=this.fontSize?this.fontSize:this.getStyleProperty("fontSize")},setFontFamily:function(a){this.fontFamily!=a&&(this.fontFamily=a,this.getDrawing().style.fontFamily=this.getFontFamily(),this.invalidateMeasure())},getFontFamily:function(){return void 0!=this.fontFamily?this.fontFamily:this.getStyleProperty("fontFamily")},setFontWeight:function(a){this.fontWeight!=a&&(this.fontWeight=a,this.getDrawing().style.fontWeight=
this.getFontWeight(),this.invalidateMeasure())},getFontWeight:function(){return void 0!=this.fontWeight?this.fontWeight:this.getStyleProperty("fontWeight")},setColor:function(a){this.color!=a&&(this.color=Ui.Color.create(a),navigator.supportRgba?this.getDrawing().style.color=this.getColor().getCssRgba():this.getDrawing().style.color=this.getColor().getCssHtml())},getColor:function(){return void 0!=this.color?this.color:Ui.Color.create(this.getStyleProperty("color"))},getValue:function(){return this.getDrawing().value},
setValue:function(a){null===a||void 0===a?this.getDrawing().value="":this.getDrawing().value=a;this.invalidateMeasure()},setOffset:function(a,b){this.getDrawing().scrollLeft=a;this.getDrawing().scrollTop=b},getOffsetX:function(){return this.getDrawing().scrollLeft},getOffsetY:function(){return this.getDrawing().scrollTop},onPaste:function(a){a.stopPropagation();new Core.DelayedTask({delay:0,scope:this,callback:this.onAfterPaste})},onAfterPaste:function(){this.getDrawing().value!=this.value&&(this.value=
this.getDrawing().value,this.fireEvent("change",this,this.value))},onChange:function(a){this.getDrawing().value!=this.value&&(this.value=this.getDrawing().value,this.fireEvent("change",this,this.value),this.invalidateMeasure())},onKeyDown:function(a){13!=a.which&&37!=a.which&&38!=a.which&&40!=a.which&&39!=a.which&&36!=a.which&&35!=a.which||a.stopPropagation()},onKeyUp:function(a){this.getDrawing().value!=this.value?(this.value=this.getDrawing().value,this.fireEvent("change",this,this.value)):13!=
a.which&&37!=a.which&&38!=a.which&&40!=a.which&&39!=a.which&&36!=a.which&&35!=a.which||a.stopPropagation();this.invalidateMeasure()}},{renderDrawing:function(){var a=document.createElement("textarea");a.setAttribute("rows",1);a.setAttribute("cols",1);a.style.opacity=1;a.style.display="block";a.style.resize="none";a.style.overflow="hidden";a.style.border="0px";a.style.margin="0px";a.style.padding="0px";a.style.outline="none";navigator.isIE?a.style.backgroundColor=navigator.isIE7||navigator.isIE8?"transparent":
"rgba(255,255,255,0.01)":a.style.background="none";navigator.isWebkit&&(a.style.webkitAppearance="none");a.style.fontSize=this.getFontSize()+"px";a.style.fontFamily=this.getFontFamily();a.style.fontWeight=this.getFontWeight();a.style.color=navigator.supportRgba?this.getColor().getCssRgba():this.getColor().getCssHtml();return a},measureCore:function(a,b){this.getDrawing().style.width=a+"px";this.getDrawing().style.height="0px";var c={width:this.getDrawing().scrollWidth,height:Math.max(3*this.getFontSize()/
2,this.getDrawing().scrollHeight)};this.getDrawing().style.width=this.getLayoutWidth()+"px";this.getDrawing().style.height=this.getLayoutHeight()+"px";return c},arrangeCore:function(a,b){this.getDrawing().style.width=a+"px";this.getDrawing().style.height=b+"px"},onDisable:function(){Ui.TextArea.base.onDisable.call(this);this.getDrawing().blur();this.getDrawing().style.cursor="default";this.getDrawing().disabled=!0},onEnable:function(){Ui.TextArea.base.onEnable.call(this);this.getDrawing().style.cursor=
"auto";this.getDrawing().disabled=!1},onStyleChange:function(){this.getDrawing().style.fontSize=this.getFontSize()+"px";this.getDrawing().style.fontFamily=this.getFontFamily();this.getDrawing().style.fontWeight=this.getFontWeight();navigator.supportRgba?this.getDrawing().style.color=this.getColor().getCssRgba():this.getDrawing().style.color=this.getColor().getCssHtml();this.invalidateMeasure()}},{style:{color:new Ui.Color({r:0,g:0,b:0}),fontSize:14,fontFamily:"Sans-serif",fontWeight:"normal"}});Ui.Pressable.extend("Ui.Button",{graphic:void 0,constructor:function(a){this.graphic=new Ui.ButtonGraphic;this.append(this.graphic);this.connect(this,"down",this.onButtonDown);this.connect(this,"up",this.onButtonUp);this.connect(this,"focus",this.onButtonFocus);this.connect(this,"blur",this.onButtonBlur)},getText:function(){return this.graphic.getText()},setText:function(a){this.graphic.setText(a)},getIcon:function(){return this.graphic.getIcon()},setIcon:function(a){this.graphic.setIcon(a)},getOrientation:function(){return this.graphic.getOrientation()},
setOrientation:function(a){this.graphic.setOrientation(a)},onButtonDown:function(){this.graphic.setIsDown(!0)},onButtonUp:function(){this.graphic.setIsDown(!1)},onButtonFocus:function(){this.graphic.setHasFocus(!0)},onButtonBlur:function(){this.graphic.setHasFocus(!1)}});Ui.Pressable.extend("Ui.Combo",{field:void 0,data:void 0,position:-1,dialog:void 0,graphic:void 0,current:void 0,placeHolder:void 0,sep:void 0,constructor:function(a){this.addEvents("change");this.graphic=new Ui.ButtonGraphic;this.append(this.graphic);a=new Ui.HBox({spacing:4});this.append(a);this.transitionbox=new Ui.TransitionBox({duration:0.25});a.append(this.transitionbox,!0);this.placeHolder=new Ui.Label({horizontalAlign:"left",margin:11,marginRight:0});this.transitionbox.append(this.placeHolder);
this.transitionbox.setCurrent(this.placeHolder);this.sep=new Ui.Rectangle({margin:1,width:1,fill:"#aaaaaa"});a.append(this.sep);var b=new Ui.VBox({verticalAlign:"center",marginRight:5});a.append(b);b.append(new Ui.Icon({icon:"arrowtop",width:10,height:10,fill:"#aaaaaa"}));b.append(new Ui.Icon({icon:"arrowbottom",width:10,height:10,fill:"#aaaaaa"}));this.dialog=new Ui.ComboDialog;this.connect(this.dialog,"item",this.onItemPress);this.connect(this,"press",this.onPress);this.connect(this,"down",this.onComboDown);
this.connect(this,"up",this.onComboUp);this.connect(this,"focus",this.onComboFocus);this.connect(this,"blur",this.onComboBlur)},setPlaceHolder:function(a){this.placeHolder.setText(a)},setField:function(a){this.field=a;void 0!=this.data&&this.setData(this.data)},setData:function(a){this.data=a;if(void 0!==this.field)for(var b=0;b<a.length;b++)this.dialog.appendItem(new Ui.Label({text:a[b][this.field],horizontalAlign:"left"})),this.transitionbox.append(new Ui.Label({text:a[b][this.field],horizontalAlign:"left",
margin:11,marginRight:0}))},getData:function(){return this.data},open:function(){this.dialog.show(this)},close:function(){this.dialog.hide(this)},getPosition:function(){return this.position},setCurrentAt:function(a){-1==a?(this.position=-1,this.current=void 0,this.transitionbox.setCurrentAt(0),this.fireEvent("change",this,this.current,this.position)):0<=a&&a<this.data.length&&(this.transitionbox.setCurrentAt(a+1),this.current=this.data[a],this.position=a,this.fireEvent("change",this,this.current,
this.position))},getCurrent:function(){return this.current},getValue:function(){return this.current},setCurrent:function(a){void 0===a&&this.setCurrentAt(-1);for(var b=-1,c=0;c<this.data.length;c++)if(this.data[c]==a){b=c;break}-1!=b&&this.setCurrentAt(b)},onPress:function(){this.open()},onItemPress:function(a,b,c){this.setCurrentAt(c)},onComboDown:function(){this.graphic.setIsDown(!0)},onComboUp:function(){this.graphic.setIsDown(!1)},onComboFocus:function(){this.graphic.setHasFocus(!0)},onComboBlur:function(){this.graphic.setHasFocus(!1)}},
{onDisable:function(){this.transitionbox.setOpacity(0.2)},onEnable:function(){this.transitionbox.setOpacity(1)}});
Ui.Popup.extend("Ui.ComboDialog",{scroll:void 0,list:void 0,constructor:function(a){this.addEvents("item");this.setExpandable(!0);this.setAutoHide(!0);this.scroll=new Ui.ScrollingArea;this.list=new Ui.VBox;this.scroll.setContent(this.list);this.setContent(this.scroll)},appendItem:function(a){var b=new Ui.ComboItem;b.setContent(a);this.connect(b,"press",this.onItemPress);this.list.append(b);return b},onItemPress:function(a){for(var b=a.getContent(),c=-1,d=0;d<this.list.getChildren().length;d++)if(this.list.getChildren()[d]==
a){c=d;break}this.fireEvent("item",this,b,c);this.hide()}});
Ui.MouseOverable.extend("Ui.ComboItem",{background:void 0,pressable:void 0,constructor:function(){this.addEvents("press");this.background=new Ui.Rectangle({fill:"#cecece",opacity:0});this.append(this.background);this.pressable=new Ui.Pressable({padding:10,paddingLeft:10,paddingRight:10});this.append(this.pressable);this.connect(this.pressable,"press",this.onPressablePress);this.connect(this,"enter",this.onEnter);this.connect(this,"leave",this.onLeave);this.connect(this.pressable,"down",this.onDown);
this.connect(this.pressable,"up",this.onUp)},getContent:function(){return this.pressable.getChildren()[0]},onEnter:function(){this.background.setOpacity(0.6)},onLeave:function(){this.background.setOpacity(0)},onDown:function(){this.background.setOpacity(1)},onUp:function(){this.background.setOpacity(0)},onPressablePress:function(){this.fireEvent("press",this)}},{setContent:function(a){this.pressable.setContent(Ui.Element.create(a))}});Ui.Togglable.extend("Ui.ToggleButton",{graphic:void 0,constructor:function(a){this.graphic=new Ui.ButtonGraphic;this.append(this.graphic);this.connect(this,"down",this.onToggleButtonUpdate);this.connect(this,"up",this.onToggleButtonUpdate);this.connect(this,"toggle",this.onToggleButtonUpdate);this.connect(this,"untoggle",this.onToggleButtonUpdate);this.connect(this,"focus",this.onToggleButtonFocus);this.connect(this,"blur",this.onToggleButtonBlur)},getText:function(){return this.graphic.getText()},
setText:function(a){this.graphic.setText(a)},getIcon:function(){return this.graphic.getIcon()},setIcon:function(a){this.graphic.setIcon(a)},getOrientation:function(){return this.graphic.getOrientation()},setOrientation:function(a){this.graphic.setOrientation(a)},onToggleButtonUpdate:function(){this.graphic.setIsDown(this.getIsDown()||this.getIsToggled())},onToggleButtonFocus:function(){this.graphic.setHasFocus(!0)},onToggleButtonBlur:function(){this.graphic.setHasFocus(!1)}});Ui.Uploadable.extend("Ui.UploadButton",{graphic:void 0,constructor:function(a){this.graphic=new Ui.ButtonGraphic;Ui.UploadButton.base.setContent.call(this,this.graphic);this.connect(this,"down",this.onUploadButtonDown);this.connect(this,"up",this.onUploadButtonUp);this.connect(this,"focus",this.onUploadButtonFocus);this.connect(this,"blur",this.onUploadButtonBlur)},getText:function(){return this.graphic.getText()},setText:function(a){this.graphic.setText(a)},getIcon:function(){return this.graphic.getIcon()},
setIcon:function(a){this.graphic.setIcon(a)},getOrientation:function(){return this.graphic.getOrientation()},setOrientation:function(a){this.graphic.setOrientation(a)},onUploadButtonDown:function(){this.graphic.setIsDown(!0)},onUploadButtonUp:function(){this.graphic.setIsDown(!1)},onUploadButtonFocus:function(){this.graphic.setHasFocus(!0)},onUploadButtonBlur:function(){this.graphic.setHasFocus(!1)}});Ui.Linkable.extend("Ui.LinkButton",{graphic:void 0,constructor:function(a){this.graphic=new Ui.ButtonGraphic;this.setContent(this.graphic);this.connect(this,"down",this.onLinkButtonDown);this.connect(this,"up",this.onLinkButtonUp);this.connect(this,"focus",this.onLinkButtonFocus);this.connect(this,"blur",this.onLinkButtonBlur)},getText:function(){return this.graphic.getText()},setText:function(a){this.graphic.setText(a)},getIcon:function(){return this.graphic.getIcon()},setIcon:function(a){this.graphic.setIcon(a)},
getOrientation:function(){return this.graphic.getOrientation()},setOrientation:function(a){this.graphic.setOrientation(a)},onLinkButtonDown:function(){this.graphic.setIsDown(!0)},onLinkButtonUp:function(){this.graphic.setIsDown(!1)},onLinkButtonFocus:function(){this.graphic.setHasFocus(!0)},onLinkButtonBlur:function(){this.graphic.setHasFocus(!1)}});Ui.LinkButton.extend("Ui.DownloadButton",{constructor:function(a){this.addEvents("download");this.connect(this,"link",this.onLinkPress)},onLinkPress:function(){this.fireEvent("download",this)}});Ui.Pressable.extend("Ui.ActionButton",{dropbox:void 0,graphic:void 0,action:void 0,selection:void 0,constructor:function(a){this.action=a.action;delete a.action;this.selection=a.selection;delete a.selection;this.dropbox=new Ui.DropBox;this.setContent(this.dropbox);this.graphic=new Ui.ButtonGraphic;this.dropbox.setContent(this.graphic);this.connect(this,"down",this.onButtonDown);this.connect(this,"up",this.onButtonUp);this.connect(this,"focus",this.onButtonFocus);this.connect(this,"blur",this.onButtonBlur);
this.connect(this,"press",this.onButtonPressDrop);this.connect(this.dropbox,"drop",this.onButtonPressDrop)},addMimetype:function(a){this.dropbox.addMimetype(a)},getText:function(){return this.graphic.getText()},setText:function(a){this.graphic.setText(a)},getIcon:function(){return this.graphic.getIcon()},setIcon:function(a){this.graphic.setIcon(a)},getOrientation:function(){return this.graphic.getOrientation()},setOrientation:function(a){this.graphic.setOrientation(a)},onButtonDown:function(){this.graphic.setIsDown(!0)},
onButtonUp:function(){this.graphic.setIsDown(!1)},onButtonFocus:function(){this.graphic.setHasFocus(!0)},onButtonBlur:function(){this.graphic.setHasFocus(!1)},onButtonPressDrop:function(){var a=this;"scope"in this.action&&(a=this.action.scope);this.action.callback.call(a,this.selection);this.selection.clear()}});Ui.CanvasElement.extend("Ui.CheckBoxGraphic",{isDown:!1,isChecked:!1,color:void 0,checkColor:void 0,constructor:function(a){this.color=new Ui.Color({r:1,g:1,b:1});this.checkColor=new Ui.Color({r:0.31,g:0.66,b:0.31})},getIsDown:function(){return this.isDown},setIsDown:function(a){this.isDown!=a&&(this.isDown=a,this.invalidateDraw())},getIsChecked:function(){return this.isChecked},setIsChecked:function(a){this.isChecked!=a&&(this.isChecked=a,this.invalidateDraw())},getColor:function(){return this.color},
setColor:function(a){this.color!=a&&(this.color=Ui.Color.create(a),this.invalidateDraw())},setCheckColor:function(a){this.checkColor!=a&&(this.checkColor=Ui.Color.create(a),this.invalidateDraw())},getCheckColor:function(){var a=0;this.getIsDown()&&(a=0.2);var b=this.checkColor.getYuv();return new Ui.Color({y:b.y+a,u:b.u,v:b.v})}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=b/2,e=c/2;this.getIsDown()&&(a.globalAlpha=0.8);this.getIsDisabled()&&(a.globalAlpha=0.2);
a.strokeStyle=this.getColor().getCssRgba();a.lineWidth=2;a.strokeRect(d-10,e-10,20,20);this.isChecked&&(d=Ui.Icon.getPath("check"),e=20/48,a.save(),a.translate((b-20)/2,(c-20)/2),a.scale(e,e),a.fillStyle=this.getCheckColor().getCssRgba(),a.beginPath(),a.svgPath(d),a.closePath(),a.fill(),a.restore())},measureCore:function(a,b){return{width:30,height:30}},onDisable:function(){this.invalidateDraw()},onEnable:function(){this.invalidateDraw()}});Ui.Togglable.extend("Ui.CheckBox",{graphic:void 0,contentBox:void 0,hbox:void 0,content:void 0,text:void 0,constructor:function(a){this.addEvents("change");this.setPadding(3);this.hbox=new Ui.HBox;this.append(this.hbox);this.graphic=new Ui.CheckBoxGraphic;this.hbox.append(this.graphic);this.connect(this,"down",this.onCheckBoxDown);this.connect(this,"up",this.onCheckBoxUp);this.connect(this,"toggle",this.onCheckBoxToggle);this.connect(this,"untoggle",this.onCheckBoxUntoggle);this.connect(this,"focus",
this.onCheckFocus);this.connect(this,"blur",this.onCheckBlur)},getValue:function(){return this.getIsToggled()},setValue:function(a){a?this.toggle():this.untoggle()},setText:function(a){void 0===a?(void 0!=this.contentBox&&(this.hbox.remove(this.contentBox),this.contentBox=void 0),this.content=this.text=void 0):void 0!=this.text?(this.text=a,this.contentBox.setText(this.text)):(void 0!=this.content&&(this.hbox.remove(this.contentBox),this.content=void 0),this.text=a,this.contentBox=new Ui.Text({margin:8,
text:this.text,verticalAlign:"center"}),this.hbox.append(this.contentBox,!0))},getText:function(){return this.text},onCheckFocus:function(){this.graphic.setColor(this.getStyleProperty("focusColor"))},onCheckBlur:function(){this.graphic.setColor(this.getStyleProperty("color"))},onCheckBoxDown:function(){this.graphic.setIsDown(!0)},onCheckBoxUp:function(){this.graphic.setIsDown(!1)},onCheckBoxToggle:function(){this.graphic.setIsChecked(!0);this.fireEvent("change",this,!0)},onCheckBoxUntoggle:function(){this.graphic.setIsChecked(!1);
this.fireEvent("change",this,!1)}},{onStyleChange:function(){this.getHasFocus()?this.graphic.setColor(this.getStyleProperty("focusColor")):this.graphic.setColor(this.getStyleProperty("color"));this.graphic.setCheckColor(this.getStyleProperty("checkColor"))},setContent:function(a){a=Ui.Element.create(a);void 0===a?(void 0!=this.contentBox&&(this.hbox.remove(this.contentBox),this.contentBox=void 0),this.content=this.text=void 0):(void 0!=this.text&&(this.hbox.remove(this.contentBox),this.text=void 0),
void 0!=this.content?this.contentBox.remove(this.content):(this.contentBox=new Ui.LBox({padding:8,verticalAlign:"center"}),this.hbox.append(this.contentBox)),this.content=a,this.contentBox.append(this.content))}},{style:{color:"#444444",focusColor:"#21d3ff",checkColor:new Ui.Color({r:0.03,g:0.63,b:0.9})}});Ui.LBox.extend("Ui.ToolBar",{hbox:void 0,scroll:void 0,constructor:function(a){a=new Ui.LBox;Ui.ToolBar.base.append.call(this,a);this.scroll=new Ui.ScrollingArea({scrollVertical:!1,verticalAlign:"center"});a.append(this.scroll);this.hbox=new Ui.HBox;this.scroll.setContent(this.hbox)}},{append:function(a,b){this.hbox.append(a,b)},remove:function(a){this.hbox.remove(a)},setContent:function(a){this.hbox.setContent(a)},onStyleChange:function(){var a=this.getStyleProperty("spacing");this.hbox.setMargin(a);
this.hbox.setSpacing(a)}},{style:{spacing:3}});Ui.Scrollable.extend("Ui.ScrollingArea",{horizontalScrollbar:void 0,verticalScrollbar:void 0,constructor:function(a){this.horizontalScrollbar=new Ui.Rectangle({width:30,height:4,margin:5});this.setScrollbarHorizontal(this.horizontalScrollbar);this.verticalScrollbar=new Ui.Rectangle({width:4,height:30,margin:5});this.setScrollbarVertical(this.verticalScrollbar)}},{onStyleChange:function(){var a=this.getStyleProperty("radius");this.horizontalScrollbar.setRadius(a);this.verticalScrollbar.setRadius(a);
a=this.getStyleProperty("color");this.horizontalScrollbar.setFill(a);this.verticalScrollbar.setFill(a)}},{style:{color:new Ui.Color({r:0,g:0.62,b:0.88}),radius:3}});Ui.Container.extend("Ui.Slider",{value:0,background:void 0,button:void 0,orientation:"horizontal",constructor:function(a){this.addEvents("change");this.background=new Ui.Frame({frameWidth:2,radius:4});this.appendChild(this.background);this.bar=new Ui.Rectangle({margin:1,height:4});this.appendChild(this.bar);this.button=new Ui.Movable({moveVertical:!1});this.appendChild(this.button);this.connect(this.button,"move",this.onButtonMove);this.connect(this.button,"focus",this.updateColors);this.connect(this.button,
"blur",this.updateColors);this.connect(this.button,"down",this.updateColors);this.connect(this.button,"up",this.updateColors);this.buttonContent=new Ui.SliderHorizontalContentDrawing({marginTop:10,marginBottom:2,marginLeft:12,marginRight:12});this.button.setContent(this.buttonContent)},getValue:function(){return this.value},setValue:function(a){this.value!=a&&(this.value=a,this.updateValue(),this.fireEvent("change",this))},getOrientation:function(){return this.orientation},setOrientation:function(a){this.orientation!==
a&&(this.orientation=a,this.button.setMoveHorizontal(!0),this.button.setMoveVertical(!0),this.updateValue(),"horizontal"===this.orientation?(this.button.setMoveHorizontal(!0),this.button.setMoveVertical(!1),this.buttonContent=new Ui.SliderHorizontalContentDrawing({marginTop:10,marginBottom:2,marginLeft:12,marginRight:12})):(this.button.setMoveHorizontal(!1),this.button.setMoveVertical(!0),this.buttonContent=new Ui.SliderVerticalContentDrawing({marginLeft:10,marginRight:2,marginTop:12,marginBottom:12})),
this.button.setContent(this.buttonContent),this.buttonContent.setFill(this.getButtonColor()),this.invalidateMeasure())},onButtonMove:function(a){var b;"horizontal"===this.orientation?(a=this.button.getPositionX(),b=this.getLayoutWidth(),b-=44):(b=this.getLayoutHeight(),b-=44,a=b-this.button.getPositionY());0>a?a=0:a>b&&(a=b);var c=this.value;this.value=a/b;this.disconnect(this.button,"move",this.onButtonMove);this.updateValue();this.connect(this.button,"move",this.onButtonMove);c!=this.value&&this.fireEvent("change",
this)},updateValue:function(){var a=this.getLayoutWidth(),b=this.getLayoutHeight();if("horizontal"===this.orientation)this.button.setPosition((a-44)*this.value,0),this.bar.arrange(18,(b-44)/2+18,(a-36)*this.value,9);else{var a=(a-44)/2,c=(b-36)*this.value;this.button.setPosition(0,b-(b-44)*this.value-44);this.bar.arrange(a+18,b-c-18,9,c)}},getColor:function(){var a=Ui.Color.create(this.getStyleProperty("color")).getYuv();return new Ui.Color({y:a.y,u:a.u,v:a.v})},getButtonColor:function(){var a=Ui.Color.create(this.getStyleProperty("color")).getYuv(),
b=0;this.button.getIsDown()?b=-0.3:this.button.getHasFocus()&&(b=0.1);return new Ui.Color({y:a.y+b,u:a.u,v:a.v})},updateColors:function(){this.bar.setFill(this.getColor());this.background.setFill(this.getColor());this.buttonContent.setFill(this.getButtonColor())}},{measureCore:function(a,b){if("horizontal"===this.orientation)return this.background.measure(a-36,10),this.bar.measure(a-38,9),this.button.measure(40,40),{width:88,height:44};this.background.measure(10,b-36);this.bar.measure(9,b-38);this.button.measure(40,
40);return{width:44,height:88}},arrangeCore:function(a,b){if("horizontal"===this.orientation){var c=(b-44)/2;this.background.arrange(18,c+18,a-36,10);this.button.arrange(2,c+2,40,40)}else c=(a-44)/2,this.background.arrange(c+18,18,10,b-36),this.button.arrange(c+2,2,40,40);this.updateValue()},onStyleChange:function(){this.updateColors()},onDisable:function(){Ui.Slider.base.onDisable.call(this);this.button.setOpacity(0.2)},onEnable:function(){Ui.Slider.base.onEnable.call(this);this.button.setOpacity(1)}},
{style:{color:Ui.Color.create("#b1b1b1")}});
Ui.LBox.extend("Ui.SliderHorizontalContentDrawing",{contentDrawing:void 0,shadow:void 0,background:void 0,radius:0,fill:"black",constructor:function(a){this.shadow=new Ui.Shape;this.append(this.shadow);this.background=new Ui.Shape({margin:1});this.append(this.background)},setRadius:function(a){this.radius!=a&&(this.radius=a)},setFill:function(a){this.fill!=a&&(this.fill=Ui.Color.create(a),a=this.fill.getYuv(),this.background.setFill(this.fill),this.shadow.setFill((new Ui.Color({y:a.y-0.3,u:a.u,v:a.v})).getCssHtml()))},
genPath:function(a,b,c){return"M"+c+",0 L"+(a-c)+",0 Q"+a+",0 "+a+","+c+"  L"+a+","+0.66*b+" L"+a/2+","+b+" L0,"+0.66*b+" L0,"+c+" Q0,0 "+c+",0 z"}},{arrangeCore:function(a,b){Ui.SliderHorizontalContentDrawing.base.arrangeCore.call(this,a,b);this.shadow.setPath(this.genPath(a,b,this.radius));this.background.setPath(this.genPath(a-2,b-2,this.radius-1.4))}});
Ui.LBox.extend("Ui.SliderVerticalContentDrawing",{contentDrawing:void 0,shadow:void 0,background:void 0,radius:0,fill:"black",constructor:function(a){this.shadow=new Ui.Shape;this.append(this.shadow);this.background=new Ui.Shape({margin:1});this.append(this.background)},setRadius:function(a){this.radius!=a&&(this.radius=a)},setFill:function(a){this.fill!=a&&(this.fill=Ui.Color.create(a),a=this.fill.getYuv(),this.background.setFill(this.fill),this.shadow.setFill((new Ui.Color({y:a.y-0.3,u:a.u,v:a.v})).getCssHtml()))},
genPath:function(a,b,c){return"M"+c+",0 L"+0.66*a+",0 L"+a+","+b/2+" L"+0.66*a+","+b+" L"+c+","+b+" Q0,"+b+" 0,"+(b-c)+" L0,"+c+" z"}},{arrangeCore:function(a,b){Ui.SliderVerticalContentDrawing.base.arrangeCore.call(this,a,b);this.shadow.setPath(this.genPath(a,b,this.radius));this.background.setPath(this.genPath(a-2,b-2,this.radius-1.4))}});Ui.Container.extend("Ui.ProgressBar",{value:0,bar:void 0,border:void 0,constructor:function(a){this.bar=new Ui.Rectangle({margin:1,height:4});this.appendChild(this.bar);this.border=new Ui.Frame({frameWidth:2});this.appendChild(this.border)},setValue:function(a){a!=this.value&&(this.value=a,a=this.getLayoutWidth()*this.value,2>a?this.bar.hide():(this.bar.show(),this.bar.arrange(0,0,a,this.getLayoutHeight())))},getValue:function(){return this.value}},{measureCore:function(a,b){var c=0,d=0,e;e=this.bar.measure(a,
b);c=Math.max(e.height,c);d=Math.max(e.width,d);e=this.border.measure(a,b);c=Math.max(e.height,c);d=Math.max(e.width,d);return{width:Math.max(d,12),height:c}},arrangeCore:function(a,b){this.border.arrange(0,0,a,b);var c=a*this.value;2>c?this.bar.hide():(this.bar.show(),this.bar.arrange(0,0,c,this.getLayoutHeight()))},onStyleChange:function(){var a=this.getStyleProperty("radius");this.bar.setRadius(a-1);this.bar.setFill(this.getStyleProperty("color"));this.border.setRadius(a);this.border.setFill(this.getStyleProperty("color"))}},
{style:{color:"#999999",radius:0}});Ui.LBox.extend("Ui.Loading",{icon:void 0,clock:void 0,constructor:function(a){this.icon=new Ui.Icon({icon:"loading"});this.icon.setTransformOrigin(0.5,0.5);this.append(this.icon);this.clock=new Anim.Clock({repeat:"forever",duration:2,onTimeupdate:this.onTick,scope:this})},onTick:function(a,b){this.icon.setTransform(Ui.Matrix.createRotate(360*b))}},{onLoad:function(){Ui.Loading.base.onLoad.call(this);this.clock.begin()},onUnload:function(){Ui.Loading.base.onUnload.call(this);this.clock.stop()},onStyleChange:function(){this.icon.setFill(this.getStyleProperty("color"))}},
{style:{color:new Ui.Color({r:0.39,g:0.39,b:0.39})}});Ui.Container.extend("Ui.Locator",{path:void 0,foregrounds:void 0,backgrounds:void 0,border:void 0,constructor:function(a){this.addEvents("change");this.connect(this,"focus",this.updateColors);this.connect(this,"blur",this.updateColors)},setPath:function(a){var b=this.getStyleProperty("spacing"),c=this.getStyleProperty("radius");for(this.path=a;0<this.getChildren().length;)this.removeChild(this.getChildren()[0]);this.border=new Ui.Rectangle({fill:"#888888",radius:c});this.appendChild(this.border);
this.backgrounds=[];this.foregrounds=[];if("/"==a){var d=new Ui.Rectangle({radius:c-1});this.backgrounds.push(d);this.appendChild(d);b=new Ui.Pressable;b.locatorPath="/";b.locatorPos=0;this.connect(b,"press",this.onPathPress);this.connect(b,"down",this.onPathDown);this.connect(b,"up",this.onPathUp);var e=new Ui.Icon({icon:"home",width:25,height:25});e.setVerticalAlign("center");e.setHorizontalAlign("center");e.setMargin(5);b.appendChild(e);this.foregrounds.push(b);this.appendChild(b)}else{a=a.split("/");
for(var d=[],g=0;g<a.length;g++)""!=a[g]&&d.push(a[g]);a=d;d=new Ui.LocatorRightArrow({arrowLength:b,radius:c-1});this.backgrounds.push(d);this.appendChild(d);for(g=0;g<a.length;g++)d=g==a.length-1?new Ui.LocatorLeftArrow({arrowLength:b,radius:c-1}):new Ui.LocatorLeftRightArrow({arrowLength:b}),this.backgrounds.push(d),this.appendChild(d);b=new Ui.Pressable;b.locatorPath=e;b.locatorPos=0;this.connect(b,"press",this.onPathPress);this.connect(b,"down",this.onPathDown);this.connect(b,"up",this.onPathUp);
e=new Ui.Icon({icon:"home",width:25,height:25});e.setVerticalAlign("center");e.setHorizontalAlign("center");e.setMargin(5);b.locatorPos=0;b.locatorPath="/";b.appendChild(e);this.foregrounds.push(b);this.appendChild(b);e="/";for(g=0;g<a.length;g++)e+=a[g],b=new Ui.Pressable,b.locatorPos=g+1,this.connect(b,"press",this.onPathPress),this.connect(b,"down",this.onPathDown),this.connect(b,"up",this.onPathUp),b.locatorPath=e,b.appendChild(new Ui.Label({text:a[g],margin:5,verticalAlign:"center"})),this.foregrounds.push(b),
this.appendChild(b),e+="/"}this.updateColors()},getPath:function(){return this.path},getColor:function(){return Ui.Color.create(this.getStyleProperty("color"))},getDarkColor:function(){var a=this.getColor().getYuv();return 0.4>a.y?new Ui.Color({y:a.y-0.6+0,u:a.u,v:a.v,a:0.8}):new Ui.Color({y:a.y-0.4+0,u:a.u,v:a.v,a:0.4})},getLightColor:function(){var a=this.getColor().getYuv();return 0.4>a.y?new Ui.Color({y:a.y-0.15+0,u:a.u,v:a.v}):new Ui.Color({y:a.y+0.15+0,u:a.u,v:a.v})},getDownColor:function(){var a=
this.getColor().getYuv();return 0.4>a.y?new Ui.Color({y:a.y-0.15+-0.2,u:a.u,v:a.v}):new Ui.Color({y:a.y+0.15+-0.2,u:a.u,v:a.v})},onPathPress:function(a){this.fireEvent("change",this,a.locatorPath,a.locatorPos)},onPathDown:function(a){this.backgrounds[a.locatorPos].setFill(this.getDownColor())},onPathUp:function(a){this.backgrounds[a.locatorPos].setFill(this.getLightColor())},updateColors:function(){var a=this.getLightColor();this.border.setFill(this.getDarkColor());for(var b=0;b<this.backgrounds.length;b++)this.backgrounds[b].setFill(a)}},
{measureCore:function(a,b){if(0==this.foregrounds.length)return{width:0,height:0};for(var c=0;c<this.foregrounds.length;c++)this.foregrounds[c].measure(0,0);for(c=0;c<this.backgrounds.length;c++)this.backgrounds[c].measure(0,0);this.border.measure(0,0);if(1==this.foregrounds.length)return{width:this.foregrounds[0].getMeasureWidth()+2,height:this.foregrounds[0].getMeasureHeight()+2};for(var d=0,e=0,c=0;c<this.foregrounds.length;c++){var g=this.foregrounds[c];g.getMeasureHeight()>e&&(e=g.getMeasureHeight());
d+=g.getMeasureWidth()}c=this.getStyleProperty("spacing");d+=(this.foregrounds.length-1)*(c+1);return{width:d+2,height:e+2}},arrangeCore:function(a,b){if(1==this.foregrounds.length)this.foregrounds[0].arrange(1,1,a-2,b-2),this.backgrounds[0].arrange(1,1,a-2,b-2);else{var c=this.getStyleProperty("spacing");x=1;for(var d=0;d<this.foregrounds.length;d++){var e=this.backgrounds[d],g=this.foregrounds[d],f=g.getMeasureWidth();g.arrange(x+1,1,f,b-2);0==d?e.arrange(x,1,f+c,b-2):d==this.foregrounds.length-
1?e.arrange(x-c,1,f+c,b-2):e.arrange(x-c,1,f+2*c,b-2);x+=f+c+1}}this.border.arrange(0,0,a,b)},onStyleChange:function(){for(var a=this.getStyleProperty("spacing"),b=this.getStyleProperty("radius"),c=0;c<this.backgrounds.length;c++){var d=this.backgrounds[c];"setArrowLength"in d&&d.setArrowLength(a);d.setRadius(b-1)}this.border.setRadius(b);this.updateColors()},onDisable:function(){Ui.Locator.base.onDisable.apply(this,arguments);for(var a=0;a<this.foregrounds.length;a++)this.foregrounds[a].setOpacity(0.4)},
onEnable:function(){Ui.Locator.base.onEnable.apply(this,arguments);for(var a=0;a<this.foregrounds.length;a++)this.foregrounds[a].setOpacity(1)}},{style:{color:new Ui.Color({r:0.31,g:0.66,b:1}),focusColor:"#f6caa2",radius:3,spacing:20}});
Ui.CanvasElement.extend("Ui.LocatorRightArrow",{radius:8,length:10,fill:void 0,constructor:function(a){this.fill=new Ui.Color},setRadius:function(a){this.radius=a;this.invalidateArrange()},setArrowLength:function(a){this.length=a;this.invalidateArrange()},setFill:function(a){this.fill=Ui.Color.create(a);this.invalidateDraw()}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=b-this.length;a.svgPath("M"+this.radius+",0 L"+d+",0 L"+b+","+c/2+" L"+d+","+c+" L"+this.radius+
","+c+" Q0,"+c+" 0,"+(c-this.radius)+" L0,"+this.radius+" Q0,0 "+this.radius+",0 z");a.fillStyle=this.fill.getCssRgba();a.fill()}});
Ui.Shape.extend("Ui.LocatorLeftArrow",{radius:8,length:10,constructor:function(a){},setRadius:function(a){this.radius=a},setArrowLength:function(a){this.length=a;this.invalidateDraw()}},{arrangeCore:function(a,b){Ui.LocatorLeftArrow.base.arrangeCore.call(this,a,b);var c=a-this.radius;this.setPath("M0,0 L"+c+",0 Q"+a+",0 "+a+","+this.radius+" L"+a+","+(b-this.radius)+" Q"+a+","+b+" "+c+","+b+" L0,"+b+" L"+this.length+","+b/2+" z")}});
Ui.Shape.extend("Ui.LocatorLeftRightArrow",{length:10,constructor:function(a){},setRadius:function(a){},setArrowLength:function(a){this.length=a;this.invalidateDraw()}},{arrangeCore:function(a,b){Ui.LocatorLeftRightArrow.base.arrangeCore.call(this,a,b);var c=a-this.length,d=b/2;this.setPath("M0,0 L"+c+",0 L"+a+","+d+" L"+c+","+b+" L0,"+b+" L"+this.length+","+d+" z")}});Ui.CanvasElement.extend("Ui.TextBgGraphic",{textHasFocus:!1,setHasFocus:function(a){this.textHasFocus!==a&&(this.textHasFocus=a,this.invalidateDraw())},getBackground:function(){return this.textHasFocus?Ui.Color.create(this.getStyleProperty("focusBackground")):Ui.Color.create(this.getStyleProperty("background"))}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight(),d=Math.max(8,c-4-16);this.getIsDisabled()&&(a.globalAlpha=0.2);a.fillStyle=this.getBackground().getCssRgba();
a.beginPath();a.moveTo(0,c-d-4);a.lineTo(0,c-4);a.lineTo(b,c-4);a.lineTo(b,c-8-4+2);a.lineTo(b-2,c-8-4+2);a.lineTo(b-2,c-4-2);a.lineTo(2,c-4-2);a.lineTo(2,c-d-4);a.closePath();a.fill()},onDisable:function(){this.invalidateDraw()},onEnable:function(){this.invalidateDraw()},onStyleChange:function(){this.spacing=Math.max(0,this.getStyleProperty("spacing"));this.iconSize=Math.max(0,this.getStyleProperty("iconSize"));this.fontFamily=this.getStyleProperty("fontFamily");this.fontSize=Math.max(0,this.getStyleProperty("fontSize"));
this.fontWeight=this.getStyleProperty("fontWeight");this.invalidateDraw()}},{style:{background:"#444444",focusBackground:"#21d3ff"}});Ui.LBox.extend("Ui.TextField",{entry:void 0,graphic:void 0,textholder:void 0,constructor:function(a){this.addEvents("change","validate");this.setPadding(3);this.graphic=new Ui.TextBgGraphic;this.append(this.graphic);this.textholder=new Ui.Label({opacity:0.5,horizontalAlign:"center",color:new Ui.Color({r:0.4,g:0.4,b:0.4}),margin:3});navigator.isIE7||navigator.isIE8||this.append(this.textholder);this.entry=new Ui.Entry({margin:4,fontSize:16});this.connect(this.entry,"focus",this.onEntryFocus);this.connect(this.entry,
"blur",this.onEntryBlur);this.append(this.entry);this.connect(this.entry,"change",this.onEntryChange);this.connect(this.entry,"validate",this.onEntryValidate)},setTextHolder:function(a){this.textholder.setText(a)},setPasswordMode:function(a){this.entry.setPasswordMode(a)},getValue:function(){return this.entry.getValue()},setValue:function(a){this.entry.setValue(a);void 0==a||""==a?this.textholder.show():this.textholder.hide()},onEntryFocus:function(){this.textholder.hide();this.graphic.setHasFocus(!0)},
onEntryBlur:function(){""==this.getValue()&&this.textholder.show();this.graphic.setHasFocus(!1)},onEntryChange:function(a,b){this.fireEvent("change",this,b)},onEntryValidate:function(a){this.fireEvent("validate",this)}},{onStyleChange:function(){}});Ui.HBox.extend("Ui.TextButtonField",{entry:void 0,button:void 0,buttonIcon:void 0,buttonText:void 0,constructor:function(a){this.addEvents("change","validate","buttonpress");this.entry=new Ui.TextField;this.append(this.entry,!0);this.button=new Ui.Button({orientation:"horizontal"});this.append(this.button);this.connect(this.entry,"change",this.onEntryChange);this.connect(this.entry,"validate",this.onEntryValidate);this.connect(this.button,"press",this.onButtonPress)},setWidthText:function(a){this.entry.setWidth(32*
a/3)},getButtonIcon:function(){return this.buttonIcon},setButtonIcon:function(a){this.button.setIcon(a)},setButtonText:function(a){this.button.setText(a)},getValue:function(){return this.entry.getValue()},setValue:function(a){this.entry.setValue(a)},onButtonPress:function(){this.fireEvent("buttonpress",this);this.fireEvent("validate",this)},onEntryChange:function(a,b){this.fireEvent("change",this,b)},onEntryValidate:function(a){this.fireEvent("validate",this)}});Ui.LBox.extend("Ui.TextAreaField",{textarea:void 0,graphic:void 0,textholder:void 0,constructor:function(a){this.addEvents("change");this.setPadding(3);this.graphic=new Ui.TextBgGraphic;this.append(this.graphic);this.textholder=new Ui.Label({opacity:0.5,horizontalAlign:"center",color:new Ui.Color({r:0.4,g:0.4,b:0.4}),margin:3});navigator.isIE7||navigator.isIE8||this.append(this.textholder);this.textarea=new Ui.TextArea({margin:4,fontSize:16});this.append(this.textarea);this.connect(this.textarea,
"focus",this.onTextAreaFocus);this.connect(this.textarea,"blur",this.onTextAreaBlur);this.connect(this.textarea,"change",this.onTextAreaChange)},setTextHolder:function(a){this.textholder.setText(a)},getValue:function(){return this.textarea.getValue()},setValue:function(a){this.textarea.setValue(a);void 0==a||""==a?this.textholder.show():this.textholder.hide()},onTextAreaFocus:function(){this.textholder.hide();this.graphic.setHasFocus(!0)},onTextAreaBlur:function(){""==this.getValue()&&this.textholder.show();
this.graphic.setHasFocus(!1)},onTextAreaChange:function(a,b){this.fireEvent("change",this,b)}},{onStyleChange:function(){}});Ui.Container.extend("Ui.ListView",{data:void 0,headers:void 0,cols:void 0,rowsHeight:0,headersHeight:0,selectedRow:void 0,headersVisible:!0,mode:"manual",constructor:function(a){this.addEvents("select","unselect","activate","header");this.rowContainer=new Ui.Container;this.appendChild(this.rowContainer);void 0!=a.headers?(this.headers=a.headers,delete a.headers):this.headers=[{width:100,type:"string",title:"Title",key:"default"}];this.data=[];this.cols=[];for(a=0;a<this.headers.length;a++){var b=
this.headers[a];b.ui=new Ui.ListViewHeader({title:b.title,width:b.width});this.connect(b.ui,"up",this.onHeaderUp);b.rows=[];b.colWidth=b.width;this.appendChild(b.ui)}for(a=0;a<this.headers.length;a++)b=new Ui.ListViewColBar({header:this.headers[a].ui}),this.cols.push(b),this.appendChild(b)},setMode:function(a){if(this.mode!==a){if(DEBUG&&"manual"!==a&&"auto"!==a)throw"Ui.ListView only support mode [auto|manual]";this.mode=a;for(a=0;a<this.cols.length;a++)"manual"===this.mode?this.cols[a].enable():
this.cols[a].disable();this.invalidateMeasure()}},showHeaders:function(){if(!this.headersVisible){this.headersVisible=!0;for(var a=0;a<this.headers.length;a++)this.headers[a].ui.show();this.invalidateMeasure()}},hideHeaders:function(){if(this.headersVisible){this.headersVisible=!1;for(var a=0;a<this.headers.length;a++)this.headers[a].ui.hide();this.invalidateMeasure()}},getSelectedRow:function(){return this.selectedRow},appendData:function(a){this.data.push(a);for(var b=0;b<this.headers.length;b++){var c=
new Ui.ListViewCellString({key:this.headers[b].key});this.connect(c,"down",this.onCellDown);this.connect(c,"up",this.onCellUp);this.connect(c,"toggle",this.onCellSelect);this.connect(c,"activate",this.onCellActivate);c.setString(a[this.headers[b].key]);this.headers[b].rows.push(c);this.rowContainer.appendChild(c)}this.invalidateMeasure()},updateData:function(a){var b=this.findDataRow(a);if(-1!=b)for(var c=0;c<this.headers.length;c++)this.headers[c].rows[b].setString(a[this.headers[c].key])},removeData:function(a){a=
this.findDataRow(a);-1!=a&&this.removeDataAt(a)},removeDataAt:function(a){if(a<this.data.length){this.selectedRow==a&&this.fireEvent("unselect",this,this.selectedRow);this.data.splice(a,1);for(var b=0;b<this.headers.length;b++){var c=this.headers[b].rows[a];this.selectedRow==a&&c.untoggle();this.disconnect(c,"down",this.onCellDown);this.disconnect(c,"up",this.onCellUp);this.disconnect(c,"toggle",this.onCellSelect);this.disconnect(c,"activate",this.onCellActivate);this.rowContainer.removeChild(c);
this.headers[b].rows.splice(a,1)}void 0!=this.selectedRow&&(this.selectedRow==a?this.selectedRow=void 0:a<this.selectedRow&&this.selectedRow--);this.invalidateMeasure()}},clearData:function(){for(;0<this.data.length;)this.removeDataAt(0)},getData:function(){return this.data},setData:function(a){this.clearData();if(void 0!=a)for(var b=0;b<a.length;b++)this.appendData(a[b])},selectRow:function(a){if(0<=a&&a<this.data.length){if(void 0!=this.selectedRow){if(this.selectedRow==a)return;for(var b=0;b<this.headers.length;b++)this.headers[b].rows[this.selectedRow].untoggle();
this.fireEvent("unselect",this,this.selectedRow)}this.selectedRow=a;for(b=0;b<this.headers.length;b++){var c=this.headers[b].rows[a];this.disconnect(c,"toggle",this.onCellSelect);c.toggle();this.connect(c,"toggle",this.onCellSelect)}this.fireEvent("select",this,this.selectedRow)}},findDataRow:function(a){for(var b=0;b<this.data.length;b++)if(a==this.data[b])return b;return-1},findCellRow:function(a){for(var b=a.getKey(),c=void 0,d=0;d<this.headers.length;d++)if(this.headers[d].key==b){c=this.headers[d];
break}if(void 0===c)return-1;b=void 0;for(d=0;d<c.rows.length;d++)if(a==c.rows[d]){b=d;break}return void 0===b?-1:b},onCellDown:function(a){a=this.findCellRow(a);if(-1!=a)for(var b=0;b<this.headers.length;b++)this.headers[b].rows[a].down()},onCellUp:function(a){a=this.findCellRow(a);if(-1!=a)for(var b=0;b<this.headers.length;b++)this.headers[b].rows[a].up()},onCellSelect:function(a){a=this.findCellRow(a);-1!=a&&this.selectRow(a)},onCellActivate:function(a){var b=this.findCellRow(a);-1!=b&&this.fireEvent("activate",
this,b,a.getKey())},onHeaderUp:function(a){for(var b,c=0;c<this.headers.length;c++){var d=this.headers[c];d.ui===a&&(b=d.key)}null!=b&&this.fireEvent("header",this,b)}},{measureCoreAuto:function(a,b){for(var c=0;c<this.headers.length;c++)this.headers[c].minWidth=0;var d;do{d=!0;this.headersHeight=this.rowsHeight=0;var e;do{e=!0;for(var g=0,f=a,c=0;c<this.headers.length;c++){var h=this.headers[c],k=h.minWidth;c==this.headers.length-1&&(k=Math.max(f,k));k=this.headersVisible?h.ui.measure(k,this.headersHeight):
{width:0,height:0};k.height>g&&(g=k.height);k.width>h.minWidth&&(h.minWidth=k.width,d=!1);f-=h.minWidth}g>this.headersHeight&&(this.headersHeight=g,e=!1)}while(!e);for(var m=0;m<this.data.length;m++){var l=this.data[m];l.rowHeight=0;do{e=!0;g=0;f=a;for(c=0;c<this.headers.length;c++){var h=this.headers[c],n=this.headers[c].rows[m],k=h.minWidth;c==this.headers.length-1&&(k=Math.max(f,k));k=n.measure(k,l.rowHeight);k.height>g&&(g=k.height);k.width>h.minWidth&&(h.minWidth=k.width,d=!1);f-=h.minWidth}g!=
l.rowHeight&&(e=!1,l.rowHeight=g)}while(!e);this.rowsHeight+=l.rowHeight}}while(!d);for(c=d=0;c<this.headers.length;c++)d+=this.headers[c].minWidth;return{width:d,height:this.headersHeight+this.rowsHeight}},measureCoreManual:function(a,b){for(var c=this.headersHeight=this.rowsHeight=0,d=0;d<this.headers.length;d++){var e=this.headers[d],g=e.ui.measure(0,0);g.height>c&&(c=g.height)}this.headersVisible&&(this.headersHeight=c);for(var f=0;f<this.data.length;f++){for(var h=this.data[f],d=c=0;d<this.headers.length;d++)e=
this.headers[d],g=this.headers[d].rows[f],e=e.ui.getMeasureWidth(),g=g.measure(e,0),g.height>c&&(c=g.height);h.rowHeight=c;this.rowsHeight+=h.rowHeight}for(d=c=0;d<this.headers.length;d++)c+=this.headers[d].ui.getMeasureWidth();for(f=0;f<this.cols.length;f++)d=this.cols[f],d.measure(0,this.headersHeight+this.rowsHeight);return{width:c,height:this.headersHeight+this.rowsHeight}},arrangeCoreAuto:function(a,b){for(var c=0,d=a,e=0;e<this.headers.length;e++){var g=this.headers[e],f=this.cols[e],h=g.minWidth;
e==this.headers.length-1&&(h=Math.max(h,d));g.ui.arrange(c,0,h,this.headersHeight);f.setHeaderHeight(this.headersHeight);f.arrange(c+h-f.getMeasureWidth(),0,f.getMeasureWidth(),this.headersHeight+this.rowsHeight);c+=h;d-=h}if(0!=this.data.length){for(var k=f=0;k<this.data.length;k++){for(var m=this.data[k],c=0,d=a,e=0;e<this.headers.length;e++)g=this.headers[e],h=g.minWidth,e==this.headers.length-1&&(h=Math.max(h,d)),g.rows[k].arrange(c,f,h,m.rowHeight),c+=h,d-=h;f+=m.rowHeight}this.rowContainer.arrange(0,
this.headersHeight,a,b-this.headersHeight)}},arrangeCoreManual:function(a,b){for(var c=0,d=a,e=0;e<this.headers.length;e++){var g=this.headers[e],f=this.cols[e],h=g.ui.getMeasureWidth();e==this.headers.length-1&&(h=Math.max(h,d));g.ui.arrange(c,0,h,this.headersHeight);f.setHeaderHeight(this.headersHeight);f.arrange(c+h-f.getMeasureWidth(),0,f.getMeasureWidth(),this.headersHeight+this.rowsHeight);c+=h;d-=h}if(0!=this.data.length){for(var k=f=0;k<this.data.length;k++){for(var m=this.data[k],c=0,d=a,
e=0;e<this.headers.length;e++)g=this.headers[e],h=g.ui.getMeasureWidth(),e==this.headers.length-1&&(h=Math.max(h,d)),g.rows[k].arrange(c,f,h,m.rowHeight),c+=h,d-=h;f+=m.rowHeight}this.rowContainer.arrange(0,this.headersHeight,a,b-this.headersHeight)}},measureCore:function(a,b){return"auto"===this.mode?this.measureCoreAuto(a,b):this.measureCoreManual(a,b)},arrangeCore:function(a,b){"auto"===this.mode?this.arrangeCoreAuto(a,b):this.arrangeCoreManual(a,b)}});
Ui.Pressable.extend("Ui.ListViewHeader",{title:void 0,uiTitle:void 0,background:void 0,constructor:function(a){this.background=new Ui.Rectangle({verticalAlign:"bottom",height:4});this.append(this.background);this.uiTitle=new Ui.Label({margin:8,fontWeight:"bold"});this.append(this.uiTitle);this.connect(this,"down",this.onListViewHeaderDown);this.connect(this,"up",this.onListViewHeaderUp)},getTitle:function(){return this.title},setTitle:function(a){this.title!=a&&(this.title=a,this.uiTitle.setText(a))},
getColor:function(){return Ui.Color.create(this.getStyleProperty("color"))},getColorDown:function(){var a=Ui.Color.create(this.getStyleProperty("color")).getYuv();return new Ui.Color({y:a.y+0.4,u:a.u,v:a.v})},onListViewHeaderDown:function(){this.background.setFill(this.getColorDown())},onListViewHeaderUp:function(){this.background.setFill(this.getColor())}},{onStyleChange:function(){this.background.setFill(this.getStyleProperty("color"));var a=this.getStyleProperty("spacing");this.uiTitle.setMargin(a+
2)}},{style:{color:"#444444",spacing:5}});
Ui.Togglable.extend("Ui.ListViewCellString",{string:"",ui:void 0,background:void 0,border:void 0,cellDown:!1,cellSelected:!1,key:void 0,constructor:function(a){this.setClipToBounds(!0);this.border=new Ui.Rectangle({height:1,verticalAlign:"bottom"});this.append(this.border);this.background=new Ui.Rectangle({fill:"white",marginBottom:1,marginRight:1});this.append(this.background);this.ui=new Ui.Label({margin:8,horizontalAlign:"left"});this.append(this.ui);this.connect(this,"toggle",this.onCellSelect);
this.connect(this,"untoggle",this.onCellUnselect)},getKey:function(){return this.key},setKey:function(a){this.key=a},getString:function(){return this.string},setString:function(a){this.string!=a&&(this.string=a,this.ui.setText(a))},down:function(){this.cellDown=!0;this.getIsToggled()||this.background.setFill(this.getBackgroundDownColor())},up:function(){this.cellDown=!1;this.getIsToggled()||this.background.setFill(this.getBackgroundColor())},getDarkColor:function(){var a=this.getStyleProperty("color").getYuv();
return new Ui.Color({y:a.y-0.3,u:a.u,v:a.v})},getBackgroundSelectColor:function(){return this.getStyleProperty("selectColor")},getBackgroundColor:function(){return this.getStyleProperty("color")},getBackgroundDownColor:function(){var a=this.getStyleProperty("color").getYuv();return new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})},onCellSelect:function(){this.background.setFill(this.getBackgroundSelectColor())},onCellUnselect:function(){this.background.setFill(this.getBackgroundColor())}},{onStyleChange:function(){var a=
this.getStyleProperty("color"),b=a.getYuv(),b=new Ui.Color({y:b.y-0.3,u:b.u,v:b.v});this.background.setFill(a);this.border.setFill(b);a=this.getStyleProperty("spacing");this.ui.setMargin(a+2)}},{style:{color:new Ui.Color({r:0.99,g:0.99,b:0.99,a:0.1}),selectColor:new Ui.Color({r:0.88,g:0.88,b:0.88}),spacing:5}});
Ui.Container.extend("Ui.ListViewColBar",{headerHeight:0,header:void 0,grip:void 0,separator:void 0,constructor:function(a){this.grip=new Ui.Movable({moveVertical:!1});this.appendChild(this.grip);this.connect(this.grip,"move",this.onMove);this.connect(this.grip,"up",this.onUp);a=new Ui.LBox;this.grip.setContent(a);a.append(new Ui.Rectangle({width:1,opacity:0.2,fill:"black",marginLeft:14,marginRight:10,marginTop:6,marginBottom:6}));a.append(new Ui.Rectangle({width:1,opacity:0.2,fill:"black",marginLeft:19,
marginRight:5,marginTop:6,marginBottom:6}));this.separator=new Ui.Rectangle({width:1,fill:"black",opacity:0.3});this.appendChild(this.separator)},setHeader:function(a){this.header=a},setHeaderHeight:function(a){this.headerHeight=a},onMove:function(){this.separator.setTransform(Ui.Matrix.createTranslate(this.grip.getPositionX(),0))},onUp:function(){var a=this.grip.getPositionX();this.header.setWidth(Math.max(this.getMeasureWidth(),this.header.getMeasureWidth()+a));this.invalidateArrange()}},{measureCore:function(a,
b){var c=this.grip.measure(a,b);this.separator.measure(a,b);return{width:c.width,height:0}},arrangeCore:function(a,b){this.grip.setPosition(0,0);this.separator.setTransform(Ui.Matrix.createTranslate(0,0));this.grip.arrange(0,0,a,this.headerHeight);this.separator.arrange(a-1,0,1,b)},onDisable:function(){Ui.ListViewColBar.base.onDisable.call(this);this.grip.hide()},onEnable:function(){Ui.ListViewColBar.base.onEnable.call(this);this.grip.show()}});Ui.IFrame.extend("Ui.Program",{arguments:void 0,constructor:function(a){this.connect(window,"message",this.onMessage,!1);if(!("location"in a))throw"location config parameter is NEEDED";var b=a.location;delete a.location;"arguments"in a&&(b+="?base64="+encodeURIComponent(JSON.stringify(a.arguments).toBase64()),delete a.arguments);this.setSrc(b);this.addEvents("message")},sendMessage:function(a){this.getIFrame().contentWindow.postMessage(a.serialize(),"*")},onMessage:function(a){this.getIFrame().contentWindow===
a.source&&(a.preventDefault(),a.stopPropagation(),a=JSON.parse(a.data),this.fireEvent("message",this,a))}});Core.Object.extend("Ui.Transition",{constructor:function(a){},run:function(a,b,c){throw"transition classes MUST override run method";}},{},{transitions:{},register:function(a,b){this.transitions[a]=b},parse:function(a){return new this.transitions[a]}});Ui.Transition.extend("Ui.Fade",{},{run:function(a,b,c){void 0!=a&&(1==c?(a.hide(),a.setOpacity(1)):a.setOpacity(Math.min(1,Math.max(0,1-3*c))));void 0!=b&&b.setOpacity(c)}},{constructor:function(){Ui.Transition.register("fade",this)}});Ui.Transition.extend("Ui.Flip",{orientation:"horizontal",constructor:function(a){},setOrientation:function(a){this.orientation=a}},{run:function(a,b,c){0.5>c?(void 0!=a&&(a.setTransformOrigin(0.5,0.5),"horizontal"==this.orientation?a.setTransform(Ui.Matrix.createScale(1-2*c,1)):a.setTransform(Ui.Matrix.createScale(1,1-2*c))),void 0!=b&&b.hide()):(void 0!=a&&(a.hide(),a.setTransformOrigin(0,0),a.setTransform(void 0)),void 0!=b&&(1==c?(b.show(),b.setTransformOrigin(0,0),b.setTransform(void 0)):(b.show(),
b.setTransformOrigin(0.5,0.5),"horizontal"==this.orientation?b.setTransform(Ui.Matrix.createScale(2*(c-0.5),1)):b.setTransform(Ui.Matrix.createScale(1,2*(c-0.5))))))}},{constructor:function(){Ui.Transition.register("flip",this)}});Ui.Transition.extend("Ui.Slide",{direction:"right",constructor:function(a){},setDirection:function(a){this.direction=a}},{run:function(a,b,c){void 0!=a&&(1==c?(a.hide(),a.setTransformOrigin(0,0),a.setTransform(void 0)):(a.setTransformOrigin(0,0),"right"==this.direction?a.setTransform(Ui.Matrix.createTranslate(-a.getLayoutWidth()*c,0)):"left"==this.direction?a.setTransform(Ui.Matrix.createTranslate(a.getLayoutWidth()*c,0)):"top"==this.direction?a.setTransform(Ui.Matrix.createTranslate(0,a.getLayoutHeight()*
c)):a.setTransform(Ui.Matrix.createTranslate(0,-a.getLayoutHeight()*c))));void 0!=b&&(1==c?(b.setTransformOrigin(0,0),b.setTransform(void 0)):(b.setTransformOrigin(0,0),"right"==this.direction?b.setTransform(Ui.Matrix.createTranslate(b.getLayoutWidth()*(1-c),0)):"left"==this.direction?b.setTransform(Ui.Matrix.createTranslate(-b.getLayoutWidth()*(1-c),0)):"top"==this.direction?b.setTransform(Ui.Matrix.createTranslate(0,-b.getLayoutHeight()*(1-c))):b.setTransform(Ui.Matrix.createTranslate(0,b.getLayoutHeight()*
(1-c)))))}},{constructor:function(){Ui.Transition.register("slide",this)}});Ui.LBox.extend("Ui.TransitionBox",{transition:void 0,duration:0.5,ease:void 0,position:-1,transitionClock:void 0,current:void 0,next:void 0,replaceMode:!1,constructor:function(a){this.addEvents("change");this.connect(this,"load",this.onTransitionBoxLoad);this.connect(this,"unload",this.onTransitionBoxUnload);this.setClipToBounds(!0);this.setTransition("fade")},getPosition:function(){return this.position},setDuration:function(a){this.duration=a},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},
setTransition:function(a){this.transition=Ui.Transition.create(a)},setCurrent:function(a){a=this.getChildPosition(a);-1!=a&&this.setCurrentAt(a)},setCurrentAt:function(a){this.position!=a&&(void 0!==this.next&&void 0!==this.current&&(this.current.hide(),this.current=this.next,this.current.show(),this.next=void 0),void 0!=this.transitionClock&&(this.disconnect(this.transitionClock,"complete",this.onTransitionComplete),this.transitionClock.stop()),this.current=-1!=this.position?this.getChildren()[this.position]:
void 0,this.next=this.getChildren()[a],this.next.show(),navigator.isIE7||navigator.isIE8?(this.position=a,this.transition.run(this.current,this.next,1),this.onTransitionComplete()):(this.transition.run(this.current,this.next,0),this.transitionClock=new Anim.Clock({duration:this.duration,scope:this,onTimeupdate:this.onTransitionTick,ease:this.ease}),this.connect(this.transitionClock,"complete",this.onTransitionComplete),this.transitionClock.begin(),this.position=a))},getCurrent:function(){return-1==
this.position?void 0:this.getChildren()[this.position].getChildren()[0]},replaceContent:function(a){this.replaceMode=!0;this.append(a);this.setCurrent(a)},onTransitionBoxLoad:function(){},onTransitionBoxUnload:function(){void 0!=this.transitionClock&&(this.transitionClock.stop(),this.transitionClock=void 0)},onTransitionTick:function(a,b){this.progress=b;this.transition.run(this.current,this.next,b)},onTransitionComplete:function(a){this.transitionClock=void 0;a=this.next;void 0!=this.current&&this.current.hide();
this.next=void 0;if(this.replaceMode){this.replaceMode=!1;for(var b=[],c=0;c<this.getChildren().length;c++){var d=this.getChildren()[c];d!==a&&b.push(d.getFirstChild())}for(c=0;c<b.length;c++)this.remove(b[c])}this.fireEvent("change",this,this.position)}},{arrangeCore:function(a,b){Ui.TransitionBox.base.arrangeCore.call(this,a,b);void 0!=this.transitionClock&&this.transition.run(this.current,this.next,this.transitionClock.getProgress())},append:function(a){a=Ui.Element.create(a);var b=new Ui.TransitionBoxContent;
b.append(a);b.hide();Ui.TransitionBox.base.append.call(this,b)},prepend:function(a){a=Ui.Element.create(a);-1!=this.position&&this.position++;var b=new Ui.TransitionBoxContent;b.append(a);b.hide();Ui.TransitionBox.base.prepend.call(this,this.position)},remove:function(a){for(var b=0;b<this.getChildren().length;b++)if(this.getChildren()[b].getFirstChild()==a){b<this.position?this.position--:b==this.position&&(this.position=-1);this.getChildren()[b].remove(a);Ui.TransitionBox.base.remove.call(this,
this.getChildren()[b]);break}},getChildPosition:function(a){for(var b=0;b<this.getChildren().length;b++)if(this.getChildren()[b].getChildren()[0]==a)return b;return-1}});Ui.LBox.extend("Ui.TransitionBoxContent",{});Ui.Accordeonable.extend("Ui.Accordeon",{});Ui.MouseOverable.extend("Ui.Carousel",{carouselable:void 0,buttonNext:void 0,buttonNextIcon:void 0,buttonPrevious:void 0,buttonPreviousIcon:void 0,showClock:void 0,hideTimeout:void 0,showNext:!1,showPrevious:!1,constructor:function(a){this.addEvents("change");this.connect(this,"enter",this.onMouseEnter);this.connect(this,"leave",this.onMouseLeave);this.connect(this,"move",this.onMouseOverMove);this.carouselable=new Ui.Carouselable;Ui.Carousel.base.append.call(this,this.carouselable);this.connect(this.carouselable,
"focus",this.onCarouselableFocus);this.connect(this.carouselable,"blur",this.onCarouselableBlur);this.connect(this.carouselable,"change",this.onCarouselableChange);this.buttonPrevious=new Ui.Pressable({horizontalAlign:"left",verticalAlign:"center",opacity:0});this.buttonPrevious.setFocusable(!1);this.buttonPreviousIcon=new Ui.Icon({icon:"arrowleft",width:48,height:48});this.buttonPrevious.append(this.buttonPreviousIcon);Ui.Carousel.base.append.call(this,this.buttonPrevious);this.connect(this.buttonPrevious,
"press",this.onPreviousPress);this.buttonNext=new Ui.Pressable({horizontalAlign:"right",verticalAlign:"center",opacity:0});this.buttonNext.setFocusable(!1);this.buttonNextIcon=new Ui.Icon({icon:"arrowright",width:48,height:48});this.buttonNext.append(this.buttonNextIcon);Ui.Carousel.base.append.call(this,this.buttonNext);this.connect(this.buttonNext,"press",this.onNextPress)},setAutoPlay:function(a){this.carouselable.setAutoPlay(a)},next:function(){this.carouselable.next()},previous:function(){this.carouselable.previous()},
getLogicalChildren:function(){return this.carouselable.getLogicalChildren()},getCurrentPosition:function(){return this.carouselable.getCurrentPosition()},getCurrent:function(){return this.carouselable.getCurrent()},setCurrentAt:function(a){this.carouselable.setCurrentAt(a)},setCurrent:function(a){this.carouselable.setCurrent(a)},getBufferingSize:function(){return this.carouselable.getBufferingSize()},setBufferingSize:function(a){this.carouselable.setBufferingSize(a)},onCarouselableChange:function(a,
b){this.showArrows();this.fireEvent("change",this,b)},onCarouselableFocus:function(){this.showArrows()},onCarouselableBlur:function(){this.hideArrows()},onPreviousPress:function(){this.previous()},onNextPress:function(){this.next()},onMouseEnter:function(){this.showArrows()},onMouseOverMove:function(){this.showArrows()},onMouseLeave:function(){this.hideArrows()},showArrows:function(){void 0!=this.hideTimeout&&this.hideTimeout.abort();this.hideTimeout=new Core.DelayedTask({delay:2,scope:this,callback:this.hideArrows});
var a=this.carouselable.getCurrentPosition(),b=this.carouselable.getLogicalChildren();0<b.length?(this.showPrevious=0<a,this.showNext=a<b.length-1):this.showNext=this.showPrevious=!1;void 0===this.showClock&&(this.showClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:this.onShowTick}),this.showClock.begin())},hideArrows:function(){void 0!=this.hideTimeout&&(this.hideTimeout.abort(),this.hideTimeout=void 0);this.showNext=this.showPrevious=!1;void 0===this.showClock&&(this.showClock=
new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:this.onShowTick}),this.showClock.begin())},onShowTick:function(a,b,c){if(0!=c){a=!1;this.showPrevious?(b=this.buttonPrevious.getOpacity(),b=Math.min(b+c,1),this.buttonPrevious.setOpacity(b),1==b&&(a=!0)):(b=this.buttonPrevious.getOpacity(),b=Math.max(b-2*c,0),this.buttonPrevious.setOpacity(b),0==b&&(a=!0));var d=!1;this.showNext?(b=this.buttonNext.getOpacity(),b=Math.min(b+c,1),this.buttonNext.setOpacity(b),1==b&&(d=!0)):(b=this.buttonNext.getOpacity(),
b=Math.max(b-2*c,0),this.buttonNext.setOpacity(b),0==b&&(d=!0));a&&d&&(this.showClock.stop(),this.showClock=void 0)}}},{append:function(a){this.carouselable.append(a)},remove:function(a){this.carouselable.remove(a)},insertAt:function(a,b){this.carouselable.insertAt(a,b)},moveAt:function(a,b){this.carouselable.moveAt(a,b)},onStyleChange:function(){var a=this.getStyleProperty("focusColor");this.buttonPreviousIcon.setFill(a);this.buttonNextIcon.setFill(a)}},{style:{focusColor:"#21d3ff"}});Ui.LBox.extend("Ui.Switch",{value:!1,background:void 0,pos:1,movable:void 0,switchbox:void 0,fixed:void 0,alignClock:void 0,speed:0,animNext:0,animStart:0,ease:void 0,constructor:function(a){this.setFocusable(!0);this.connect(this,"focus",this.updateColors);this.connect(this,"blur",this.updateColors);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.fixed=new Ui.Fixed;this.append(this.fixed);this.bg1=new Ui.Rectangle({fill:new Ui.Color({r:0.2,g:0.9,b:0.6}),radius:4});this.fixed.append(this.bg1);
this.bg2=new Ui.Rectangle({fill:new Ui.Color({r:0.9,g:0.2,b:0.2}),radius:4});this.fixed.append(this.bg2);this.append(new Ui.Frame({fill:"#aaaaaa",frameWidth:1,radius:4}));this.setClipToBounds(!0);this.movable=new Ui.Movable({moveVertical:!1,margin:1});this.movable.setFocusable(!1);this.append(this.movable);this.switchbox=new Ui.SwitchBox;this.movable.setContent(this.switchbox);this.connect(this.movable,"move",this.onMove);this.connect(this.movable,"down",this.onDown);this.connect(this.movable,"up",
this.onUp);this.addEvents("change");"trueContent"in a?this.setTrueContent(a.trueContent):this.setTrueContent(new Ui.Label({text:"ON",marginLeft:5,marginRight:5}));"falseContent"in a?this.setFalseContent(a.falseContent):this.setFalseContent(new Ui.Label({text:"OFF",marginLeft:5,marginRight:5}));"ease"in a?this.setEase(a.ease):this.ease=Anim.EasingFunction.create({type:Anim.PowerEase,mode:"out"});"value"in a&&(this.pos=(this.value=a.value)?0:1)},setEase:function(a){this.ease=Anim.EasingFunction.create(a)},
setTrueContent:function(a){this.switchbox.setContent1(a)},setFalseContent:function(a){this.switchbox.setContent2(a)},getValue:function(){return this.value},setValue:function(a){this.value!=a&&((this.value=a)?this.startAnimation(2):this.startAnimation(-2))},onKeyDown:function(a){if(!this.getIsDisabled()){var b=a.which;if(32==b||13==b||37==b||39==b)a.stopPropagation(),a.preventDefault();32==b||13==b?this.setValue(!this.value):37==b?this.setValue(!1):39==b&&this.setValue(!0)}},onMove:function(a){a=this.movable.getPositionX();
var b=this.switchbox.getContentWidth();a=Math.min(0,Math.max(a,-b));this.pos=-a/b;this.updatePos()},onDown:function(a){this.stopAnimation()},onUp:function(a,b,c,d,e,g,f){!f&&10>g?this.setValue(!this.value):(b=100>Math.abs(b)?0.5<this.pos?-1:1:b/this.switchbox.getContentWidth(),0!=b&&this.startAnimation(b))},updatePos:function(){var a=this.switchbox.getContentWidth(),b=-this.pos*a;this.movable.setPosition(b,void 0);var c=this.getLayoutWidth()-a;this.bg1.setHeight(this.getLayoutHeight()-1);this.bg1.setWidth(a+
b+c/2);this.bg2.setHeight(this.getLayoutHeight()-1);this.bg2.setWidth(-b+c/2);this.fixed.setPosition(this.bg2,this.getLayoutWidth()+b-c/2,0)},startAnimation:function(a){this.stopAnimation();this.speed=a;this.animStart=this.pos;this.animNext=0>this.speed?1:0;this.animStart!=this.animNext?(this.alignClock=new Anim.Clock({duration:"forever",scope:this,target:this,onTimeupdate:this.onAlignTick}),this.alignClock.begin()):this.value!=(0==this.animNext)&&(this.value=0==this.animNext,this.fireEvent("change",
this,this.value))},stopAnimation:function(){void 0!=this.alignClock&&(this.alignClock.stop(),this.alignClock=void 0)},onAlignTick:function(a,b,c){0!=c&&(a=-(a.getTime()*this.speed)/(this.animNext-this.animStart),1<=a&&(this.alignClock.stop(),this.alignClock=void 0,a=1,this.value=0==this.animNext,this.fireEvent("change",this,this.value)),a=this.ease.ease(a),this.pos=this.animStart+a*(this.animNext-this.animStart),this.updatePos())},getGradient:function(){var a=this.getStyleProperty("color").getYuv();
return new Ui.LinearGradient({stops:[{offset:0,color:new Ui.Color({y:a.y+0.1,u:a.u,v:a.v})},{offset:1,color:new Ui.Color({y:a.y-0.1,u:a.u,v:a.v})}]})},updateColors:function(){var a=this.getStyleProperty("color");this.getHasFocus()&&(a=this.getStyleProperty("focusColor"));this.switchbox.getSwitchButton().setFill(a);this.bg1.setFill(this.getStyleProperty("trueColor"));this.bg2.setFill(this.getStyleProperty("falseColor"))}},{arrangeCore:function(a,b){Ui.Switch.base.arrangeCore.call(this,a,b);this.updatePos()},
onStyleChange:function(){this.updateColors()},onDisable:function(){Ui.Switch.base.onDisable.call(this);this.switchbox.getContent1Box().setOpacity(0.2);this.switchbox.getContent2Box().setOpacity(0.2)},onEnable:function(){Ui.Switch.base.onEnable.call(this);this.switchbox.getContent1Box().setOpacity(1);this.switchbox.getContent2Box().setOpacity(1)}},{style:{color:new Ui.Color({r:0.96,g:0.96,b:0.96}),focusColor:new Ui.Color({r:0.13,g:0.83,b:1,a:1}),trueColor:"#b1f5c1",falseColor:"#f5b1b1"}});
Ui.LBox.extend("Ui.SwitchButton",{shadow:void 0,background:void 0,radius:3,fill:void 0,constructor:function(a){this.shadow=new Ui.Rectangle({radius:3});this.append(this.shadow);this.background=new Ui.Rectangle({radius:2,margin:1});this.append(this.background);"radius"in a&&this.setRadius(a.radius);"fill"in a?this.setFill(a.fill):this.setFill(new Ui.Color({r:0.96,g:0.96,b:0.96}))},setRadius:function(a){this.radius!=a&&(this.radius=a)},setFill:function(a){this.fill!=a&&(this.fill=Ui.Color.create(a),
a=this.fill.getYuv(),this.background.setFill(this.fill),this.shadow.setFill((new Ui.Color({y:a.y-0.6,u:a.u,v:a.v})).getCssHtml()))}});
Ui.Container.extend("Ui.SwitchBox",{content1Box:void 0,content2Box:void 0,button:void 0,constructor:function(){this.content1Box=new Ui.LBox({margin:5});this.appendChild(this.content1Box);this.button=new Ui.SwitchButton({width:28,height:28});this.appendChild(this.button);this.content2Box=new Ui.LBox({margin:5});this.appendChild(this.content2Box)},getSwitchButton:function(){return this.button},getContent1Box:function(){return this.content1Box},getContent2Box:function(){return this.content2Box},setContent1:function(a){this.content1!=
a&&(void 0!=this.content1&&this.content1Box.remove(this.content1),this.content1=a,void 0!=this.content1&&this.content1Box.append(this.content1))},setContent2:function(a){this.content2!=a&&(void 0!=this.content2&&this.content2Box.remove(this.content2),this.content2=a,void 0!=this.content2&&this.content2Box.append(this.content2))},getContentWidth:function(){return this.getLayoutWidth()-this.button.getLayoutWidth()}},{measureCore:function(a,b){var c=this.content1Box.measure(0,0),d=this.content2Box.measure(0,
0),e=this.button.measure(0,0);return{width:Math.max(c.width,d.width)+e.width,height:Math.max(c.height,Math.max(d.height,e.height))}},arrangeCore:function(a,b){var c=a-this.button.getMeasureWidth();this.content1Box.arrange(0,0,c,b);this.content2Box.arrange(c+this.button.getMeasureWidth(),0,c,b);this.button.arrange(c,0,this.button.getMeasureWidth(),b)}});Ui.LBox.extend("Ui.Embed",{content:void 0,div:void 0,divId:void 0,updateTask:void 0,constructor:function(a){void 0===Ui.App.current&&new Ui.App;this.getDrawing().style.cursor="default";this.setIsLoaded(!0);this.connect(Ui.App.current,"ready",this.onReady)},getDiv:function(){return this.div},setDiv:function(a){void 0!=this.div&&this.div.removeChild(this.getDrawing());this.div=a;void 0!=this.div&&(this.div.style.position="relative",this.div.style.left="0px",this.div.style.top="0px",this.div.style.width=
this.getWidth()+"px",this.div.style.height=this.getHeight()+"px",this.div.appendChild(this.getDrawing()),this.update())},setDivId:function(a){this.divId=a},getContent:function(){return this.content},update:function(){var a=void 0!=this.getWidth()?this.getWidth():0,b=void 0!=this.getHeight()?this.getHeight():0,c=this.measure(a,b),a=Math.max(a,c.width),b=Math.max(b,c.height);this.arrange(0,0,a,b);this.updateTask=void 0;void 0!==this.div&&(this.div.style.width=Math.round(a)+"px",this.div.style.height=
Math.round(b)+"px")},onReady:function(){console.log(this+".onReady");void 0===this.div&&void 0!==this.divId&&this.setDiv(document.getElementById(this.divId))}},{invalidateMeasure:function(){this.invalidateArrange();this.measureValid=!1;void 0===this.updateTask&&(this.updateTask=new Core.DelayedTask({delay:0,scope:this,callback:this.update}))},invalidateArrange:function(){this.arrangeValid=!1;void 0===this.updateTask&&(this.updateTask=new Core.DelayedTask({delay:0,scope:this,callback:this.update}))},
setContent:function(a){a=Ui.Element.create(a);this.content!=a&&(void 0!=this.content&&this.remove(this.content),void 0!=a&&this.append(a),this.content=a)}});Ui.VBox.extend("Ui.MonthCalendar",{selectedDate:void 0,date:void 0,title:void 0,leftarrow:void 0,rightarrow:void 0,grid:void 0,dayFilter:void 0,dateFilter:void 0,constructor:function(a){this.addEvents("dayselect");"date"in a?(this.date=new Date(a.date.getTime()),delete a.date):this.date=new Date;"selectedDate"in a&&(this.selectedDate=a.selectedDate,delete a.selectedDate);a=new Ui.HBox;this.append(a);var b=new Ui.Pressable({verticalAlign:"center"});this.leftarrow=new Ui.Icon({icon:"arrowleft",width:24,
height:24});b.append(this.leftarrow);a.append(b);this.connect(b,"press",this.onLeftButtonPress);this.title=new Ui.Label({fontWeight:"bold",fontSize:18,margin:5});a.append(this.title,!0);b=new Ui.Pressable({verticalAlign:"center"});this.rightarrow=new Ui.Icon({icon:"arrowright",width:24,height:24});b.append(this.rightarrow);a.append(b);this.connect(b,"press",this.onRightButtonPress);this.grid=new Ui.Grid({cols:"auto,auto,auto,auto,auto,auto,auto",rows:"auto,auto,auto,auto,auto,auto,auto",horizontalAlign:"center"});
this.append(this.grid);this.updateDate()},setDayFilter:function(a){this.dayFilter=a;this.updateDate()},setDateFilter:function(a){this.dateFilter=a;this.updateDate()},onLeftButtonPress:function(){this.date.setMonth(this.date.getMonth()-1);this.updateDate()},onRightButtonPress:function(){this.date.setMonth(this.date.getMonth()+1);this.updateDate()},getSelectedDate:function(){return this.selectedDate},onDaySelect:function(a){this.selectedDate=a.monthCalendarDate;this.updateDate();this.fireEvent("dayselect",
this,this.selectedDate)},updateDate:function(){var a=[6,0,1,2,3,4,5],b="Lu Ma Me Je Ve Sa Di".split(" ");for(this.title.setText("Janvier F\u00e9vrier Mars Avril Mai Juin Juillet Ao\u00fbt Septembre Octobre Novembre D\u00e9cembre".split(" ")[this.date.getMonth()]+" "+this.date.getFullYear());void 0!=this.grid.getFirstChild();)this.grid.detach(this.grid.getFirstChild());for(var c=0;7>c;c++)this.grid.attach(new Ui.Label({text:b[c],fontWeight:"bold",margin:5}),c,0);var b=this.date.getMonth(),d=new Date(this.date.getTime());
d.setDate(1);var e=1,g=new Date;do{var f=new Ui.Pressable;f.monthCalendarDate=d;this.connect(f,"press",this.onDaySelect);d.getFullYear()==g.getFullYear()&&d.getMonth()==g.getMonth()&&d.getDate()==g.getDate()?(f.monthCalendarCurrent=!0,c=new Ui.Rectangle({fill:new Ui.Color({r:0.2,g:0.4,b:1,a:0.4}),margin:1})):c=new Ui.Rectangle({fill:new Ui.Color({r:0.8,g:0.8,b:0.8,a:0.4}),margin:1});f.append(c);void 0!=this.selectedDate&&d.getFullYear()==this.selectedDate.getFullYear()&&d.getMonth()==this.selectedDate.getMonth()&&
d.getDate()==this.selectedDate.getDate()&&f.append(new Ui.Frame({frameWidth:3,fill:"red",radius:0}));var h=!1;if(void 0!=this.dayFilter)for(var k=d.getDay(),c=0;c<this.dayFilter.length&&!h;c++)k==this.dayFilter[c]&&(h=!0);if(void 0!=this.dateFilter)for(k=d.getFullYear()+"/",10>d.getMonth()+1&&(k+="0"),k+=d.getMonth()+1+"/",10>d.getDate()&&(k+="0"),k+=d.getDate(),c=0;c<this.dateFilter.length&&!h;c++)RegExp(this.dateFilter[c]).test(k)&&(h=!0);h&&(f.disable(),f.setOpacity(0.2));f.append(new Ui.Label({text:d.getDate(),
margin:5}));this.grid.attach(f,a[d.getDay()],e);d=new Date(d.getTime()+864E5);0==a[d.getDay()]&&e++}while(b==d.getMonth());this.onStyleChange()}},{onStyleChange:function(){var a=this.getStyleProperty("color"),b=this.getStyleProperty("dayColor"),c=this.getStyleProperty("currentDayColor");this.title.setColor(a);this.leftarrow.setFill(a);this.rightarrow.setFill(a);for(var d=0;d<this.grid.getChildren().length;d++){var e=this.grid.getChildren()[d];if(Ui.Label.hasInstance(e))e.setColor(a);else if(Ui.Pressable.hasInstance(e))for(var g=
0;g<e.getChildren().length;g++){var f=e.getChildren()[g];Ui.Label.hasInstance(f)?f.setColor(a):Ui.Rectangle.hasInstance(f)&&(e.monthCalendarCurrent?f.setFill(c):f.setFill(b))}}}},{style:{color:"black",dayColor:new Ui.Color({r:0.81,g:0.81,b:0.81,a:0.5}),currentDayColor:new Ui.Color({r:1,g:0.31,b:0.66,a:0.5})}});Ui.TextButtonField.extend("Ui.DatePicker",{popup:void 0,calendar:void 0,selectedDate:void 0,lastValid:"",isValid:!1,dayFilter:void 0,dateFilter:void 0,constructor:function(a){this.setButtonIcon("calendar");this.setWidthText(9);this.connect(this,"buttonpress",this.onDatePickerButtonPress);this.connect(this,"change",this.onDatePickerChange)},setDayFilter:function(a){this.dayFilter=a},setDateFilter:function(a){this.dateFilter=a},getIsValid:function(){return this.isValid},getSelectedDate:function(){return this.selectedDate},
setSelectedDate:function(a){this.lastValid=(10>a.getDate()?"0":"")+a.getDate()+"/"+(9>a.getMonth()?"0":"")+(a.getMonth()+1)+"/"+a.getFullYear();this.selectedDate=a;this.setValue(this.lastValid);this.isValid=!0;this.fireEvent("change",this,this.getValue())},onDatePickerButtonPress:function(){var a=this.getValue().match(/^(\d{1,2})\/(\d{1,2})\/(\d{1,4})$/);null!=a&&(this.selectedDate=new Date,this.selectedDate.setFullYear(new Number(a[3]),new Number(a[2])-1,new Number(a[1])));this.popup=new Ui.Popup;
this.calendar=void 0!=this.selectedDate?new Ui.MonthCalendar({margin:10,selectedDate:this.selectedDate,date:this.selectedDate}):new Ui.MonthCalendar({margin:10});void 0!=this.dayFilter&&this.calendar.setDayFilter(this.dayFilter);void 0!=this.dateFilter&&this.calendar.setDateFilter(this.dateFilter);this.popup.setContent(this.calendar);this.connect(this.calendar,"dayselect",this.onDaySelect);this.popup.show(this)},onDatePickerChange:function(){this.isValid=!1;this.selectedDate=void 0;var a=this.getValue();
if(a.match(/^(\d{1,2})\/(\d{1,2})\/(\d{1,4})$/)){var a=this.getValue().match(/^(\d{1,2})\/(\d{1,2})\/(\d{1,4})$/),b=new Date;b.setFullYear(new Number(a[3]),new Number(a[2])-1,new Number(a[1]));var c=(10>b.getDate()?"0":"")+b.getDate()+"/"+(9>b.getMonth()?"0":"")+(b.getMonth()+1)+"/"+b.getFullYear();if(new Number(a[3])!=b.getFullYear()||new Number(a[2])-1!=b.getMonth()||new Number(a[1])!=b.getDate())this.lastValid=c,this.setValue(this.lastValid);this.selectedDate=b;this.isValid=!0}else a.match(/^(\d{1,2})\/(\d{1,2})\/(\d{0,4})$/)?
this.lastValid=a:a.match(/^(\d{1,2})\/(\d{0,2})$/)?this.lastValid=a:a.match(/^(\d{0,2})$/)?this.lastValid=a:this.setValue(this.lastValid)},onDaySelect:function(a,b){this.setSelectedDate(b);this.popup.hide();this.popup=void 0}});Ui.Container.extend("Ui.Notebook",{current:-1,currentPage:void 0,pages:void 0,headerHeight:0,hiddenColor:void 0,currentColor:void 0,constructor:function(a){this.addEvents("change");this.setFocusable(!0);this.connect(this,"focus",this.updateColors);this.connect(this,"blur",this.updateColors);this.connect(this.getDrawing(),"keydown",this.onKeyDown);this.pages=[]},setContent:function(a){for(;0<this.getPages().length;)this.removePage(this.getPages()[0]);if(void 0!=a&&"object"==typeof a)if(a.constructor==
Array)for(var b=0;b<a.length;b++)this.appendPage(a[b]);else this.appendPage(a)},setCurrentPage:function(a){for(var b=0;b<this.pages.length;b++)if(this.pages[b]==a){this.setCurrentPosition(b);break}},getCurrentPosition:function(){return this.current},setCurrentPosition:function(a){0==this.pages.length?(void 0!=this.currentPage&&this.currentPage.unselect(),this.currentPage=void 0,this.current=-1):(this.current=a,a=this.pages[this.current],a!=this.currentPage&&(void 0!=this.currentPage&&this.currentPage.unselect(),
this.currentPage=a,this.fireEvent("change",this,this.currentPage,this.current),this.disconnect(this.currentPage,"select",this.onPageSelect),this.currentPage.select(),this.connect(this.currentPage,"select",this.onPageSelect)));this.invalidateArrange()},appendPage:function(a){a=Ui.NotebookPage.create(a);this.pages.push(a);this.prependChild(a.getBackground());this.appendChild(a.getHeaderBox());this.appendChild(a.getContentBox());this.connect(a,"select",this.onPageSelect);this.connect(a,"close",this.onPageClose);
1==this.pages.length&&a.select()},removePage:function(a){for(var b=0;b<this.pages.length&&this.pages[b]!=a;)b++;b<this.pages.length&&(this.pages.splice(b,1),this.removeChild(a.getBackground()),this.removeChild(a.getHeaderBox()),this.removeChild(a.getContentBox()),this.disconnect(a,"select",this.onPageSelect),this.disconnect(a,"close",this.onPageClose),this.current==b&&0==this.current?this.setCurrentPosition(0):this.current>=b?this.setCurrentPosition(this.current-1):this.setCurrentPosition(this.current))},
getPages:function(){return this.pages},getCurrentPage:function(){return this.currentPage},next:function(){0<=this.current&&this.current+1<this.pages.length&&this.setCurrentPosition(this.current+1)},previous:function(){1<=this.current&&this.setCurrentPosition(this.current-1)},onKeyDown:function(a){if(!this.getIsDisabled()){var b=a.which;if(37==b||39==b)a.stopPropagation(),a.preventDefault();37==b?this.previous():39==b&&this.next()}},onPageSelect:function(a){this.setCurrentPage(a);this.focus()},onPageClose:function(a){this.removePage(a)},
getCurrentColor:function(){var a=this.getStyleProperty("color");this.getHasFocus()&&(a=this.getStyleProperty("focusColor"));return a},updateColors:function(){void 0!==this.currentPage&&this.currentPage.getBackground().setFill(this.getCurrentColor())}},{measureCore:function(a,b){for(var c=0,d=0,e=0;e<this.pages.length;e++){var g=this.pages[e];g.getBackground().measure(a,b);g=g.getHeaderBox().measure(0,0);c+=g.width+20;g.height>d&&(d=g.height)}for(var d=d+20,f=Math.max(c,a-20),h=Math.max(b-(d+20),0),
k=0,m=0,e=0;e<this.pages.length;e++)g=this.pages[e],g=g.getContentBox().measure(f,h),g.width>k&&(k=g.width),g.height>m&&(m=g.height);m+=20;this.headerHeight=d;return{width:Math.max(k+20,c),height:m+d}},arrangeCore:function(a,b){for(var c=0,d=0;d<this.pages.length;d++){var e=this.pages[d],g=e.getHeaderBox().getMeasureWidth();e.getHeaderBox().arrange(c+10,10,g,this.headerHeight-20);this.current==d?(e.getContentBox().show(),e.getContentBox().arrange(10,this.headerHeight+10,a-20,b-(this.headerHeight+
20)),void 0!=this.currentColor&&e.getBackground().setFill(this.getCurrentColor())):(this.moveChildAt(e.getBackground(),0),e.getContentBox().hide(),void 0!=this.hiddenColor&&e.getBackground().setFill(this.hiddenColor));e.getBackground().setTab(c,g+20,this.headerHeight);e.getBackground().arrange(0,0,a,b);c+=g+20}},onStyleChange:function(){this.currentColor=Ui.Color.create(this.getStyleProperty("color"));var a=this.currentColor.getYuva();this.hiddenColor=new Ui.Color({y:a.y-0.08,u:a.u,v:a.v});for(a=
0;a<this.pages.length;a++)a==this.current?this.pages[a].getBackground().setFill(this.currentColor):this.pages[a].getBackground().setFill(this.hiddenColor)}},{style:{color:"#f8f8f8",focusColor:"#f8ead2"}});
Core.Object.extend("Ui.NotebookPage",{headerBox:void 0,header:void 0,contentBox:void 0,content:void 0,background:void 0,isSelected:!1,constructor:function(a){this.addEvents("select","unselect","close");this.headerBox=new Ui.Pressable;this.headerBox.setFocusable(!1);this.connect(this.headerBox,"press",this.onHeaderPress);this.contentBox=new Ui.LBox;this.contentBox.hide();this.background=new Ui.NotebookBackground},close:function(){this.fireEvent("close",this)},select:function(){this.isSelected||(this.isSelected=
!0,this.contentBox.show(),this.fireEvent("select",this))},getIsSelected:function(){return this.isSelected},getHeader:function(){return this.header},setHeader:function(a){a!=this.header&&(void 0!=this.header&&this.headerBox.removeChild(this.header),this.header=Ui.Element.create(a),void 0!=this.header&&this.headerBox.appendChild(this.header))},getContent:function(){return this.content},setContent:function(a){a!=this.content&&(void 0!=this.content&&this.contentBox.removeChild(this.content),this.content=
Ui.Element.create(a),void 0!=this.content&&this.contentBox.appendChild(this.content))},unselect:function(){this.isSelected&&(this.isSelected=!1,this.fireEvent("unselect",this),this.contentBox.hide())},getHeaderBox:function(){return this.headerBox},getContentBox:function(){return this.contentBox},getBackground:function(){return this.background},onHeaderPress:function(){this.select()}});
Ui.CanvasElement.extend("Ui.NotebookBackground",{darkShadow:void 0,lightShadow:void 0,background:void 0,radius:0,fill:"black",tabOffset:30,tabWidth:10,tabHeight:10,constructor:function(a){},setTab:function(a,b,c){this.tabOffset=a;this.tabWidth=b;this.tabHeight=c;this.invalidateArrange()},setRadius:function(a){this.radius!=a&&(this.radius=a,this.invalidateArrange())},setFill:function(a){this.fill!=a&&(this.fill=Ui.Color.create(a),this.invalidateDraw())},genPath:function(a,b,c,d,e,g){a="M"+d+","+g+
" L"+d+","+c+" Q"+d+",0 "+(d+c)+",0 L"+(d+e-c)+",0 Q"+(d+e)+",0 "+(d+e)+","+c+" L"+(d+e)+","+g+" L"+(a-c)+","+g+" Q"+a+","+g+" "+a+","+(g+c)+" L"+a+","+(b-c)+" Q"+a+","+b+" "+(a-c)+","+b+" L"+c+","+b+" Q0,"+b+" 0,"+(b-c);return 0==d?a+" z":a+(" L0,"+(g+c)+" Q0,"+g+" "+c+","+g+" z")}},{updateCanvas:function(a){var b=this.getLayoutWidth(),c=this.getLayoutHeight();a.fillStyle="#cccccc";a.svgPath(this.genPath(b,c,this.radius,this.tabOffset,this.tabWidth,this.tabHeight));a.fill();a.translate(1,1);a.fillStyle=
this.fill.getCssRgba();a.svgPath(this.genPath(b-2,c-2,this.radius,this.tabOffset,this.tabWidth-2,this.tabHeight));a.fill()}});Ui.ToolBar.extend("Ui.MenuBar",{});
Ui.Pressable.extend("Ui.Menu",{headerLabel:void 0,header:void 0,dialog:void 0,scope:void 0,constructor:function(a){this.addEvents("item");a=new Ui.VBox;this.append(a);this.headerLabel=new Ui.Label({margin:5,marginBottom:0,horizontalAlign:"left"});a.append(this.headerLabel);a.append(new Ui.Rectangle({height:1,width:1,fill:"#aaaaaa",marginLeft:5,marginRight:5}));this.dialog=new Ui.MenuDialog({element:this.headerLabel});this.connect(this.dialog,"item",this.onItemPress);this.connect(this,"press",this.onTitlePress)},
setHeader:function(a){this.header!=a&&(this.header=a,this.headerLabel.setText(a))},appendItem:function(a,b,c){"string"==typeof a&&(a=new Ui.Label({horizontalAlign:"left",text:a}));var d=this;a=this.dialog.appendItem(a);void 0!=b&&(void 0===c&&(c=void 0===this.scope?this:this.scope),c.connect(a,"press",function(a){b.call(this,d,a.getChildren()[0])}))},setScope:function(a){this.scope=a},setItems:function(a){this.dialog.clearItems();for(var b=0;b<a.length;b++)this.appendItem(a[b].item,a[b].callback,
a[b].scope)},appendSeparator:function(){this.dialog.appendSeparator()},getIsOpen:function(){return this.dialog.getIsVisible()},open:function(){this.dialog.show()},close:function(){this.dialog.hide()},onItemPress:function(a,b){this.fireEvent("item",this,b)},onTitlePress:function(){this.open()}});
Ui.Popup.extend("Ui.MenuDialog",{element:void 0,scroll:void 0,content:void 0,constructor:function(a){this.addEvents("item");if("element"in a)this.element=a.element,delete a.element;else throw"element property is NEEDED for Ui.MenuDialog";this.setExpandable(!0);this.setAutoHide(!0);this.scroll=new Ui.ScrollingArea({scrollHorizontal:!0});this.content=new Ui.VBox;this.scroll.setContent(this.content);this.setContent(this.scroll);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},clearItems:function(){for(;void 0!=
this.content.getFirstChild();)this.content.remove(this.content.getFirstChild())},appendItem:function(a){var b=new Ui.MenuItem;b.setContent(a);this.connect(b,"press",this.onItemPress);this.content.append(b);return b},appendSeparator:function(){this.content.append(new Ui.Separator)},onItemPress:function(a){a=a.getContent();this.fireEvent("item",this,a);this.hide()},onKeyDown:function(a){var b=a.which;if(27==b)a.preventDefault(),a.stopPropagation(),this.hide();else if(40==b)for(b=0;b<this.content.getChildren().length;b++){if(Ui.MenuItem.hasInstance(this.content.getChildren()[b])&&
this.content.getChildren()[b].getIsCurrent())for(b+=1;b<this.content.getChildren().length;b++)if(Ui.MenuItem.hasInstance(this.content.getChildren()[b])){a.preventDefault();a.stopPropagation();this.content.getChildren()[b].setCurrent();break}}else if(38==b)for(var c=void 0,b=0;b<this.content.getChildren().length;b++)if(Ui.MenuItem.hasInstance(this.content.getChildren()[b])){if(this.content.getChildren()[b].getIsCurrent()){void 0!=c&&(a.preventDefault(),a.stopPropagation(),c.setCurrent());break}c=this.content.getChildren()[b]}}},
{show:function(){this.getIsVisible();Ui.MenuDialog.base.show.call(this,this.element,"bottom")}});
Ui.MouseOverable.extend("Ui.MenuItem",{background:void 0,pressable:void 0,constructor:function(){this.addEvents("press");this.background=new Ui.Rectangle({fill:"#cecece",opacity:0});this.append(this.background);this.pressable=new Ui.Pressable({padding:10});this.append(this.pressable);this.connect(this.pressable,"press",this.onItemPress);this.connect(this,"enter",this.onEnter);this.connect(this,"leave",this.onLeave);this.connect(this.pressable,"down",this.onDown);this.connect(this.pressable,"up",this.onUp);
this.connect(this.pressable,"focus",this.onItemFocus);this.connect(this.pressable,"blur",this.onItemBlur)},getIsCurrent:function(){return this.pressable.getHasFocus()},setCurrent:function(){this.pressable.focus()},getContent:function(){return this.pressable.getChildren()[0]},onEnter:function(){this.pressable.focus()},onLeave:function(){},onDown:function(){this.background.setOpacity(1)},onUp:function(){this.background.setOpacity(0)},onItemFocus:function(){this.background.setOpacity(0.6)},onItemBlur:function(){this.background.setOpacity(0)},
onItemPress:function(){this.fireEvent("press",this)}},{setContent:function(a){this.pressable.append(Ui.Element.create(a))}});Ui.LBox.extend("Ui.SegmentBar",{border:void 0,box:void 0,current:void 0,field:"text",data:void 0,orientation:"horizontal",constructor:function(a){this.setFocusable(!0);this.addEvents("change");this.border=new Ui.Rectangle({fill:"#888888"});this.append(this.border);this.box=new Ui.Box({uniform:!0,margin:1,spacing:1,orientation:this.orientation});this.append(this.box);this.connect(this,"focus",this.updateColors);this.connect(this,"blur",this.updateColors);this.connect(this.getDrawing(),"keydown",this.onKeyDown)},
setOrientation:function(a){this.orientation=a;this.box.setOrientation(a)},setField:function(a){this.field=a},setData:function(a){for(;void 0!=this.box.getFirstChild();)this.disconnect(this.box.getFirstChild(),"toggle",this.onSegmentSelect),this.box.remove(this.box.getFirstChild());this.data=a;for(var b=0;b<a.length;b++){var c=new Ui.SegmentButton({data:a[b],text:a[b][this.field],mode:"horizontal"===this.orientation?0==b?"left":b==a.length-1?"right":"middle":0==b?"top":b==a.length-1?"bottom":"middle"});
this.box.append(c,!0);this.connect(c,"toggle",this.onSegmentSelect)}},setCurrentPosition:function(a){0<=a&&a<this.box.getChildren().length&&this.box.getChildren()[a].toggle()},getCurrentPosition:function(){for(var a=0;a<this.box.getChildren().length;a++)if(this.box.getChildren()[a].getIsToggled())return a},next:function(){for(var a=0;a<this.box.getChildren().length;a++)if(this.box.getChildren()[a]===this.current){this.setCurrentPosition(a+1);break}},previous:function(){for(var a=0;a<this.box.getChildren().length;a++)if(this.box.getChildren()[a]===
this.current){this.setCurrentPosition(a-1);break}},onSegmentSelect:function(a){void 0!=this.current&&this.current.untoggle();this.current=a;this.fireEvent("change",this,a.getData())},onKeyDown:function(a){if(!this.getIsDisabled()){var b=a.which;if(37==b||39==b)a.stopPropagation(),a.preventDefault();37==b?this.previous():39==b&&this.next()}},getCurrentColor:function(){var a=this.getStyleProperty("color");this.getHasFocus()&&(a=this.getStyleProperty("focusColor"));return a},updateColors:function(){for(var a=
this.getCurrentColor(),b=0;b<this.box.getChildren().length;b++)this.box.getChildren()[b].setFill(a)}},{onStyleChange:function(){var a=this.getStyleProperty("spacing"),b=this.getStyleProperty("radius");this.border.setRadius(b);for(var c=0;c<this.box.getChildren().length;c++)this.box.getChildren()[c].setRadius(b-1),this.box.getChildren()[c].setSpacing(a);this.updateColors()}},{style:{color:new Ui.Color({r:0.99,g:0.99,b:0.99}),focusColor:"#fff0c8",radius:3,spacing:5}});
Ui.Togglable.extend("Ui.SegmentButton",{label:void 0,bg:void 0,shadow:void 0,mode:void 0,data:void 0,fill:void 0,downFill:void 0,radius:3,constructor:function(a){this.setFocusable(!1);this.bg=new Ui.Rectangle;this.append(this.bg);this.label=new Ui.Label({margin:7});this.append(this.label);this.connect(this,"toggle",this.onButtonSelect);this.connect(this,"untoggle",this.onButtonUnselect)},getData:function(){return this.data},setData:function(a){this.data=a},setText:function(a){this.label.setText(a)},
setMode:function(a){this.mode=a;"left"==a?(this.bg.setRadiusTopLeft(this.radius),this.bg.setRadiusBottomLeft(this.radius),this.bg.setRadiusTopRight(0),this.bg.setRadiusBottomRight(0)):"right"==a?(this.bg.setRadiusTopLeft(0),this.bg.setRadiusBottomLeft(0),this.bg.setRadiusTopRight(this.radius),this.bg.setRadiusBottomRight(this.radius)):"top"==a?(this.bg.setRadiusTopLeft(this.radius),this.bg.setRadiusBottomLeft(0),this.bg.setRadiusTopRight(this.radius),this.bg.setRadiusBottomRight(0)):"bottom"==a?(this.bg.setRadiusTopLeft(0),
this.bg.setRadiusBottomLeft(this.radius),this.bg.setRadiusTopRight(0),this.bg.setRadiusBottomRight(this.radius)):(this.bg.setRadiusTopLeft(0),this.bg.setRadiusBottomLeft(0),this.bg.setRadiusTopRight(0),this.bg.setRadiusBottomRight(0))},setFill:function(a){this.fill!==a&&(this.fill=Ui.Color.create(a),a=this.fill.getYuva(),this.downFill=new Ui.Color({y:a.y-0.2,u:a.u,v:a.v}),this.getIsToggled()?this.bg.setFill(this.downFill):this.bg.setFill(this.fill))},setRadius:function(a){this.radius=a;this.setMode(this.mode)},
setSpacing:function(a){this.label.setMargin(a)},onButtonSelect:function(){this.bg.setFill(this.downFill)},onButtonUnselect:function(){this.bg.setFill(this.fill)}},{onDisable:function(){Ui.Selectable.base.onDisable.call(this);this.bg.setOpacity(0.2)},onEnable:function(){Ui.Selectable.base.onEnable.call(this);this.bg.setOpacity(1)}});Ui.Container.extend("Ui.Paned",{vertical:!0,cursor:void 0,content1Box:void 0,content1:void 0,minContent1Size:0,content2Box:void 0,content2:void 0,minContent2Size:0,pos:0.5,constructor:function(a){this.addEvents("change");this.content1Box=new Ui.LBox;this.appendChild(this.content1Box);this.content2Box=new Ui.LBox;this.appendChild(this.content2Box);this.cursor=new Ui.Movable;this.appendChild(this.cursor);this.cursor.setContent(new Ui.VPanedCursor);this.connect(this.cursor,"move",this.onCursorMove);
void 0!=a.orientation&&this.setOrientation(a.orientation)},getOrientation:function(){return this.vertical?"vertical":"horizontal"},setOrientation:function(a){var b=!0;"vertical"!=a&&(b=!1);this.vertical!=b&&((this.vertical=b)?this.cursor.setContent(new Ui.VPanedCursor):this.cursor.setContent(new Ui.HPanedCursor),this.invalidateMeasure())},getPos:function(){return this.pos},setPos:function(a){this.pos=a;this.invalidateMeasure()},getContent1:function(){return this.content1},setContent1:function(a){this.content1!=
a&&(void 0!=this.content1&&this.content1Box.remove(this.content1),this.content1=a,void 0!=this.content1&&this.content1Box.append(this.content1))},getContent2:function(){return this.content2},setContent2:function(a){this.content2!=a&&(void 0!=this.content2&&this.content2Box.remove(this.content2),this.content2=a,void 0!=this.content2&&this.content2Box.append(this.content2))},invert:function(){var a;a=this.content1Box;this.content1Box=this.content2Box;this.content2Box=a;a=this.content1;this.content1=
this.content2;this.content2=a;this.pos=1-this.pos;this.invalidateArrange()},onCursorMove:function(){this.disconnect(this.cursor,"move",this.onCursorMove);var a,b;this.vertical?(a=this.cursor.getPositionY(),b=this.getLayoutHeight()-this.cursor.getLayoutHeight()):(a=this.cursor.getPositionX(),b=this.getLayoutWidth()-this.cursor.getLayoutWidth());this.pos=a/b;b*this.pos<this.minContent1Size&&(this.pos=this.minContent1Size/b);b*(1-this.pos)<this.minContent2Size&&(this.pos=1-this.minContent2Size/b);a=
this.pos*b;0>a&&(a=0);a>b&&(a=b);this.vertical?this.cursor.setPosition(0,a):this.cursor.setPosition(a,0);this.invalidateMeasure();this.connect(this.cursor,"move",this.onCursorMove);this.fireEvent("change",this,this.pos)}},{measureCore:function(a,b){if(this.vertical){var c=this.cursor.measure(a,0);this.minContent1Size=this.content1Box.measure(a,0).height;this.minContent2Size=this.content2Box.measure(a,0).height;var d=this.content1Box.measure(a,(b-c.height)*this.pos),e=this.content2Box.measure(a,(b-
c.height)*(1-this.pos));return{width:Math.max(c.width,Math.max(d.width,e.width)),height:d.height+c.height+e.height}}c=this.cursor.measure(0,b);this.minContent1Size=this.content1Box.measure(0,0).width;this.minContent2Size=this.content2Box.measure(0,0).width;d=this.content1Box.measure((a-c.width)*this.pos,b);e=this.content2Box.measure((a-c.width)*(1-this.pos),b);return{width:d.width+c.width+e.width,height:Math.max(c.height,Math.max(d.height,e.height))}},arrangeCore:function(a,b){if(this.vertical){var c=
this.cursor.getMeasureHeight(),d=b-c;this.cursor.arrange(0,0,a,c);this.cursor.setPosition(0,d*this.pos);this.content1Box.arrange(0,0,a,d*this.pos);this.content2Box.arrange(0,d*this.pos+c,a,d*(1-this.pos))}else c=this.cursor.getMeasureWidth(),d=a-c,this.content1Box.arrange(0,0,d*this.pos,b),this.cursor.arrange(0,0,c,b),this.cursor.setPosition(d*this.pos,0),this.content2Box.arrange(d*this.pos+c,0,d*(1-this.pos),b)}});Ui.Paned.extend("Ui.VPaned",{constructor:function(a){this.setOrientation("vertical")}});
Ui.Paned.extend("Ui.HPaned",{constructor:function(a){this.setOrientation("horizontal")}});
Ui.LBox.extend("Ui.HPanedCursor",{constructor:function(a){this.append(new Ui.Frame({frameWidth:1,fill:new Ui.Color({r:0,g:0,b:0,a:0.1})}));this.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.05})}));this.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.1}),width:1,margin:5,marginRight:10,height:30,verticalAlign:"center"}));this.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.1}),width:1,margin:5,marginLeft:10,height:30,verticalAlign:"center"}))}});
Ui.LBox.extend("Ui.VPanedCursor",{constructor:function(a){this.append(new Ui.Frame({frameWidth:1,radius:0,fill:new Ui.Color({r:0,g:0,b:0,a:0.1})}));this.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.05})}));this.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.1}),height:1,margin:5,marginTop:10,width:30,horizontalAlign:"center"}));this.append(new Ui.Rectangle({fill:new Ui.Color({r:0,g:0,b:0,a:0.1}),height:1,margin:5,marginBottom:10,width:30,horizontalAlign:"center"}))}});Core.Object.extend("Ui.Selection",{elements:void 0,constructor:function(a){this.addEvents("change");this.elements=[]},clear:function(){for(var a=0;a<this.elements.length;a++)this.elements[a].setIsSelected(!1),this.connect(this.elements[a],"unload",this.onElementUnload);this.elements=[];this.fireEvent("change",this)},append:function(a){for(var b=!1,c=0;!b&&c<this.elements.length;c++)b=this.elements[c]===a;if(!b){var b=!1,d;for(d in a.getSelectionActions())!0===a.getSelectionActions()[d].multiple&&
(b=!0);if(0<this.elements.length){d=!0;for(c=0;d&&c<this.elements.length;c++)d=this.elements[c].getSelectionActions()===a.getSelectionActions();if(!d||!b){for(c=0;c<this.elements.length;c++)this.elements[c].setIsSelected(!1);this.elements=[]}}this.elements.push(a);this.connect(a,"unload",this.onElementUnload);this.fireEvent("change",this)}},remove:function(a){for(var b=void 0,c=0;void 0===b&&c<this.elements.length;c++)this.elements[c]===a&&(b=c);void 0!==b&&(this.elements.splice(b,1),this.disconnect(a,
"unload",this.onElementUnload),this.fireEvent("change",this))},getElements:function(){return this.elements},getActions:function(){if(0!==this.elements.length){if(1===this.elements.length){var a={},b=this.elements[0].getSelectionActions(),c;for(c in b){var d=b[c];"testRight"in d&&!d.testRight.call(this.elements[0])||(a[c]=b[c])}}else for(c in a={},b=this.elements[0].getSelectionActions(),b)if(d=b[c],!0===d.multiple){var e=!0;if("testRight"in d)for(var g=0;e&&g<this.elements.length;g++)e&=d.testRight.call(this.elements[g]);
e&&(a[c]=b[c])}return a}},getDefaultAction:function(){var a=this.getActions(),b;for(b in a)if(!0===a[b]["default"])return a[b]},executeDefaultAction:function(){var a=this.getDefaultAction();if(void 0!==a){var b=this;"scope"in a&&(b=a.scope);a.callback.call(b,this);this.clear();return!0}return!1},getDeleteAction:function(){var a=this.getActions();if("delete"in a)return a["delete"];if("suppress"in a)return a.suppress},executeDeleteAction:function(){var a=this.getDeleteAction();if(void 0!==a){var b=
this;"scope"in a&&(b=a.scope);a.callback.call(b,this);this.clear();return!0}return!1},onElementUnload:function(a){this.remove(a)}});Ui.Draggable.extend("Ui.Selectionable",{isSelected:!1,focusRing:void 0,bg:void 0,contentBox:void 0,handler:void 0,constructor:function(a){this.setData(this);this.bg=new Ui.Rectangle({margin:2});this.bg.hide();this.append(this.bg);this.focusRing=new Ui.Frame({frameWidth:2});this.focusRing.hide();this.append(this.focusRing);this.contentBox=new Ui.LBox({margin:5});this.append(this.contentBox);this.connect(this,"press",this.onPress);this.connect(this,"activate",this.onActivate);this.connect(this,"dragstart",
this.onSelectionableDragStart);this.connect(this,"dragend",this.onSelectionableDragEnd);this.connect(this,"focus",this.onSelectionableFocus);this.connect(this,"blur",this.onSelectionableBlur)},getIsSelected:function(){return this.isSelected},setIsSelected:function(a){(this.isSelected=a)?this.bg.show():this.bg.hide()},getSelectionActions:function(){return{}},getParentSelectionHandler:function(){for(var a=this.getParent();void 0!=a&&!("getSelectionHandler"in a);)a=a.getParent();if(void 0!=a)return a.getSelectionHandler()},
onSelectionableDragStart:function(){this.select()},onSelectionableDragEnd:function(){if(this.getIsSelected()){var a=this.getParentSelectionHandler();void 0!==a&&a.clear()}},onActivate:function(){if(this.getIsLoaded()){this.select();var a=this.getParentSelectionHandler();void 0!==a&&a.executeDefaultAction()}},onPress:function(){this.getIsSelected()?this.unselect():this.select()},select:function(){this.getIsLoaded()&&(this.handler=this.getParentSelectionHandler(),void 0!==this.handler&&(this.handler.append(this),
this.setIsSelected(!0)))},unselect:function(){void 0!==this.handler&&(this.handler.remove(this),this.setIsSelected(!1))},onSelectionableFocus:function(){this.focusRing.show()},onSelectionableBlur:function(){this.focusRing.hide()}},{onStyleChange:function(){this.focusRing.setFill(this.getStyleProperty("focus"));this.bg.setFill(this.getStyleProperty("shadow"))},setContent:function(a){this.contentBox.setContent(a)},onUnload:function(){this.getIsSelected()&&this.unselect();Ui.Selectionable.base.onUnload.call(this)},
onDisable:function(){Ui.Selectionable.base.onDisable.apply(this,arguments);this.contentBox.setOpacity(0.4)},onEnable:function(){Ui.Selectionable.base.onEnable.apply(this,arguments);this.contentBox.setOpacity(1)}},{style:{focus:"#21d3ff",shadow:"#dddddd"}});Ui.Popup.extend("Ui.MenuToolBarPopup",{});Ui.Button.extend("Ui.MenuToolBarButton",{constructor:function(){this.setIcon("arrowbottom")}});
Ui.Container.extend("Ui.MenuToolBar",{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,star:0,measureLock:void 0,items:void 0,menuButton:void 0,itemsAlign:"left",menuPosition:"right",uniform:!1,uniformSize:0,spacing:0,itemsWidth:0,keepItems:void 0,menuNeeded:!1,bg:void 0,constructor:function(a){this.items=[];this.bg=new Ui.Rectangle;this.appendChild(this.bg);this.menuButton=new Ui.MenuToolBarButton;this.connect(this.menuButton,"press",this.onMenuButtonPress);this.appendChild(this.menuButton)},
getUniform:function(){return this.uniform},setUniform:function(a){this.uniform!==a&&(this.uniform=a,this.invalidateMeasure())},getMenuPosition:function(){return this.menuPosition},setMenuPosition:function(a){this.menuPosition!==a&&(this.menuPosition=a,this.invalidateArrange())},getItemsAlign:function(){return this.itemsAlign},setItemsAlign:function(a){this.itemsAlign!==a&&(this.itemsAlign=a,this.invalidateArrange())},getLogicalChildren:function(){return this.items},setPadding:function(a){this.setPaddingTop(a);
this.setPaddingBottom(a);this.setPaddingLeft(a);this.setPaddingRight(a)},getPaddingTop:function(){return this.paddingTop},setPaddingTop:function(a){this.paddingTop!=a&&(this.paddingTop=a,this.invalidateMeasure())},getPaddingBottom:function(){return this.paddingBottom},setPaddingBottom:function(a){this.paddingBottom!=a&&(this.paddingBottom=a,this.invalidateMeasure())},getPaddingLeft:function(){return this.paddingLeft},setPaddingLeft:function(a){this.paddingLeft!=a&&(this.paddingLeft=a,this.invalidateMeasure())},
getPaddingRight:function(){return this.paddingRight},setPaddingRight:function(a){this.paddingRight!=a&&(this.paddingRight=a,this.invalidateMeasure())},getSpacing:function(){return this.spacing},setSpacing:function(a){this.spacing!==a&&(this.spacing=a,this.invalidateMeasure())},append:function(a,b){a=Ui.Element.create(a);b&&Ui.MenuToolBar.setResizable(a,!0);this.items.push(a);this.invalidateMeasure()},prepend:function(a,b){a=Ui.Element.create(a);b&&Ui.MenuToolBar.setResizable(a,!0);this.items.unshift(a);
this.invalidateMeasure()},remove:function(a){for(var b=0;b<this.items.length&&this.items[b]!=a;)b++;b<this.items.length&&(this.items.splice(b,1),a.getParent()===this&&a.getParent().removeChild(a),this.invalidateMeasure())},moveAt:function(a,b){0>b&&(b=this.items.length+b);0>b&&(b=0);b>=this.items.length&&(b=this.items.length);for(var c=0;c<this.items.length&&this.items[c]!==a;)c++;c<this.items.length&&(this.items.splice(c,1),this.items.splice(b,0,a));this.onChildInvalidateMeasure(a,"move")},insertAt:function(a,
b,c){this.append(a,c);this.moveAt(a,b)},setContent:function(a){if(void 0===a)this.clear();else if("object"===typeof a){a.constructor!==Array&&(a=[a]);for(var b=0;b<this.items.length;b++){for(var c=!1,d=0;!1===c&&d<a.length;d++)c=this.items[b]===a[d];!1===c&&this.items[b].getParent()===this&&this.removeChild(this.items[b])}this.items=a;this.invalidateMeasure()}},onMenuButtonPress:function(){var a=new Ui.MenuToolBarPopup({expandable:!0}),b=new Ui.ScrollingArea;a.setContent(b);var c=new Ui.Flow({spacing:this.spacing,
margin:10});b.setContent(c);for(b=0;b<this.items.length;b++){var d=this.items[b];d.getParent()!==this&&c.append(d)}a.show(this.menuButton,"bottom")}},{clear:function(){for(var a=0;a<this.items.length;a++)this.items[a].getParent()===this&&this.items[a].getParent().removeChild(this.items[a]);this.items=[];this.invalidateMeasure()},measureCore:function(a,b){var c=this.getPaddingLeft(),d=this.getPaddingRight(),e=this.getPaddingTop(),g=this.getPaddingBottom(),f=Math.max(0,a-(c+d)),h=Math.max(0,b-(e+g));
this.measureLock=!0;this.bg.measure(a,b);for(var k=this.menuButton.measure(0,0),m=[],l=0;l<this.items.length;l++){var n=this.items[l];n.getParent()!==this&&(void 0!==n.getParent()&&n.getParent().removeChild(n),this.appendChild(n));m.push(n.measure(0,0))}this.keepItems=[];for(var p=0,r=n=0,v=k.height,u=0,l="left"===this.menuPosition?l=this.items.length-1:0;0<=l&&l<this.items.length;){var s=m[l];if(p+s.width+this.spacing>f)break;p+=s.width+this.spacing;if(p+k.width>f)break;"left"===this.menuPosition?
this.keepItems.unshift(this.items[l]):this.keepItems.push(this.items[l]);Ui.MenuToolBar.getResizable(this.items[l])?n++:u+=s.width;s.width>r&&(r=s.width);s.height>v&&(v=s.height);"left"===this.menuPosition?l--:l++}this.menuNeeded=this.keepItems.length!==this.items.length;m=f;if(this.menuNeeded)for(m-=k.width+this.spacing;0<=l&&l<this.items.length;)this.removeChild(this.items[l]),"left"===this.menuPosition?l--:l++;if(this.uniform)if(this.keepItems.length*(r+this.spacing)-this.spacing<=f){for(l=0;l<
this.keepItems.length;l++)this.keepItems[l].measure(r,v);this.uniformSize=r;f={width:this.keepItems.length*(r+this.spacing)-this.spacing,height:v}}else this.uniformSize=void 0,f={width:p,height:v};else if(0<n){m=m-u-(this.keepItems.length-1)*this.spacing;p=!0;r=m/n;do for(p=!0,l=0;l<this.keepItems.length;l++)if(s=this.getChildren()[l],Ui.MenuToolBar.getResizable(s)&&!s.menutoolbarStarDone&&(f=s.measure(r,h),f.height>v&&(v=f.height),f.width>r)){s.menutoolbarStarDone=!0;p=!1;m-=f.width;u+=f.width;n--;
r=m/n;break}while(!p);u+=this.spacing*(this.keepItems.length-1);0<n?(u+=r*n,this.star=r):this.star=0;f={width:u,height:v}}else f={width:p,height:v};this.menuNeeded&&(f.width+=k.width+this.spacing);f.width+=c+d;f.height+=e+g;this.measureLock=void 0;return f},arrangeCore:function(a,b){this.bg.arrange(0,0,a,b);var c=this.paddingLeft,d=this.paddingTop,e=this.paddingBottom;a-=c+this.paddingRight;b-=d+e;e=!0;"left"!==this.itemsAlign&&(c=a-this.getMeasureWidth());this.menuNeeded&&"left"===this.menuPosition&&
(e=!1,this.menuButton.arrange(c,d,this.menuButton.getMeasureWidth(),b),c+=this.menuButton.getMeasureWidth());for(var g=0;g<this.keepItems.length;g++){var f=this.keepItems[g];e?e=!1:c+=this.spacing;var h;this.uniform&&void 0!==this.uniformSize?h=this.uniformSize:(h=f.getMeasureWidth(),Ui.MenuToolBar.getResizable(f)&&h<this.star&&(h=this.star));f.arrange(c,d,h,b);c+=h}this.menuNeeded&&"left"!==this.menuPosition&&(e||(c+=this.spacing),this.menuButton.arrange(c,d,this.menuButton.getMeasureWidth(),b));
this.menuNeeded?this.menuButton.getDrawing().style.visibility="":this.menuButton.getDrawing().style.visibility="hidden"},onChildInvalidateMeasure:function(a,b){!0!==this.measureLock&&Ui.MenuToolBar.base.onChildInvalidateMeasure.call(this,a,b)},onStyleChange:function(){this.bg.setFill(this.getStyleProperty("background"))}},{getResizable:function(a){return a["Ui.MenuToolBar.resizable"]?!0:!1},setResizable:function(a,b){Ui.MenuToolBar.getResizable(a)!=b&&(a["Ui.MenuToolBar.resizable"]=b,a.invalidateMeasure())},
style:{background:"rgba(255,255,255,0)"}});Ui.LBox.extend("Ui.App",{styles:void 0,updateTask:!1,loaded:!1,focusElement:void 0,arguments:void 0,ready:!1,orientation:0,webApp:!0,lastArrangeHeight:0,drawList:void 0,layoutList:void 0,windowWidth:0,windowHeight:0,contentBox:void 0,content:void 0,dialogs:void 0,requireFonts:void 0,testFontTask:void 0,constructor:function(a){this.addEvents("resize","ready","parentmessage","orientationchange");this.setClipToBounds(!0);Ui.App.current=this;this.getDrawing().style.cursor="default";if(void 0!=window.location.search&&
""!=window.location.search){var b=void 0;arguments={};for(var c=window.location.search.substring(1).split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(2==e.length){var g=decodeURIComponent(e[0]),e=decodeURIComponent(e[1]);"base64"==g?b=JSON.parse(e.fromBase64()):arguments[g]=e}}if(void 0!=b){this.arguments=b;for(var f in arguments)this.arguments[f]=arguments[f]}else this.arguments=arguments}else this.arguments={};void 0!=this.arguments.remotedebug&&(b=this.arguments.remotedebug.split(":"),new Core.RemoteDebug({host:b[0],
port:b[1]}));this.contentBox=new Ui.VBox;this.append(this.contentBox);"webApp"in a&&(this.webApp=a.webApp,delete a.webApp);this.setTransformOrigin(0,0);this.connect(window,"load",this.onWindowLoad);this.connect(window,"resize",this.onWindowResize);"style"in a?this.setStyle(a.style):this.setStyle(Ui.Styles["default"]);this.connect(window,"focus",function(a){void 0!=a.target&&(this.focusElement=a.target)},!0);this.connect(window,"blur",function(a){this.focusElement=void 0},!0);this.connect(window,"dragstart",
function(a){a.preventDefault()});this.connect(window,"dragenter",function(a){a.preventDefault();return!1});this.connect(window,"dragover",function(a){a.dataTransfer.dropEffect="none";a.preventDefault();return!1});this.connect(window,"drop",function(a){a.preventDefault();return!1});"onorientationchange"in window&&this.connect(window,"orientationchange",this.onOrientationChange);this.connect(window,"message",this.onMessage)},forceInvalidateMeasure:function(a){void 0===a&&(a=this);if("getChildren"in
a)for(var b=0;b<a.getChildren().length;b++)this.forceInvalidateMeasure(a.getChildren()[b]);a.invalidateMeasure()},requireFont:function(a,b){var c=a+":"+b;void 0===this.requireFonts&&(this.requireFonts={});if(!this.requireFonts[c]){var d=!1;this.getIsReady()&&(d=Ui.Label.isFontAvailable(a,b));(this.requireFonts[c]=d)?this.forceInvalidateMeasure(this):this.getIsReady()&&!d&&void 0===this.testFontTask&&(this.testFontTask=new Core.DelayedTask({scope:this,delay:0.25,callback:this.testRequireFonts}))}},
testRequireFonts:function(){var a=!0,b;for(b in this.requireFonts){var c=this.requireFonts[b];c||(c=b.split(":"),(c=Ui.Label.isFontAvailable(c[0],c[1]))?(this.requireFonts[b]=!0,this.forceInvalidateMeasure(this)):a=!1)}this.testFontTask=a?void 0:new Core.DelayedTask({scope:this,delay:0.25,callback:this.testRequireFonts})},checkWindowSize:function(){var a=void 0!==window.innerHeight?window.innerHeight:document.body.clientHeight;(void 0!==window.innerWidth?window.innerWidth:document.body.clientWidth)===
this.getLayoutWidth()&&a===this.getLayoutHeight()||this.invalidateMeasure()},getOrientation:function(){return this.orientation},onWindowLoad:function(){if(navigator.iPad||navigator.iPhone||navigator.Android){if(this.webApp){var a=document.createElement("meta");a.name="apple-mobile-web-app-capable";a.content="yes";document.getElementsByTagName("head")[0].appendChild(a);a=document.createElement("meta");a.name="apple-mobile-web-app-status-bar-style";a.content="black";document.getElementsByTagName("head")[0].appendChild(a);
a=document.createElement("meta");a.name="mobile-web-app-capable";a.content="yes";document.getElementsByTagName("head")[0].appendChild(a)}a=document.createElement("meta");a.name="viewport";a.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";document.getElementsByTagName("head")[0].appendChild(a)}navigator.isWebkit?(a=document.createElement("style"),a.type="text/css",a.innerHTML="* { -webkit-tap-highlight-color: rgba(0, 0, 0, 0); }",document.getElementsByTagName("head")[0].appendChild(a)):
!navigator.isIE||navigator.isIE8||navigator.isIE7||(a=document.createElement("style"),a.type="text/css",a.innerHTML="@-ms-viewport { width: device-width; } body { -ms-content-zooming: none; }",document.getElementsByTagName("head")[0].appendChild(a));this.loaded=!0;this.onReady()},onWindowResize:function(a){this.checkWindowSize()},onOrientationChange:function(a){this.orientation=window.orientation;this.fireEvent("orientationchange",this.orientation);this.checkWindowSize()},update:function(){void 0===
this.updateCounter?this.updateCounter=0:this.updateCounter++;var a=void 0!==window.innerWidth?window.innerWidth:document.body.clientWidth,b=void 0!==window.innerHeight?window.innerHeight:document.body.clientHeight;if(navigator.isIE7||navigator.isIE8)document.body.scrollLeft="0px";this.measure(a,b);for(this.arrange(0,0,a,b);void 0!=this.drawList;){var c=this.drawList.drawNext;this.drawList.drawNext=void 0;this.drawList.draw();this.drawList=c}if(this.windowWidth!==a||this.windowHeight!==b)this.windowWidth=
a,this.windowHeight=b,this.fireEvent("resize",this,this.windowWidth,this.windowHeight);this.updateTask=!1},getContent:function(){return this.content},getFocusElement:function(){return this.focusElement},appendDialog:function(a){void 0===this.dialogs&&(this.focusStack=[],this.dialogs=new Ui.LBox,this.append(this.dialogs));this.focusStack.push(this.focusElement);this.dialogs.append(a);this.contentBox.disable();for(a=0;a<this.dialogs.getChildren().length-1;a++)this.dialogs.getChildren()[a].disable()},
removeDialog:function(a){if(void 0!=this.dialogs&&(this.dialogs.remove(a),0==this.dialogs.getChildren().length?(this.remove(this.dialogs),this.dialogs=void 0,this.contentBox.enable()):this.dialogs.getLastChild().enable(),a=this.focusStack.pop(),void 0!==a))try{a.focus()}catch(b){}},getArguments:function(){return this.arguments},getIsReady:function(){return this.ready},onReady:function(){if(this.loaded&&(document.documentElement.style.padding="0px",document.documentElement.style.margin="0px",document.documentElement.style.border=
"0px solid black",document.documentElement.style.overflow="hidden",document.body.style.padding="0px",document.body.style.margin="0px",document.body.style.border="0px solid black",document.body.style.outline="none",document.body.style.overflow="hidden",document.body.style.position="absolute",document.body.style.right="0px",document.body.style.left="0px",document.body.style.top="0px",document.body.style.bottom="0px",document.body.appendChild(this.getDrawing()),navigator.iOs&&this.connect(document.body,
"touchstart",function(a){}),void 0!==this.requireFonts&&void 0===this.testFontTask&&this.testRequireFonts(),this.setIsLoaded(!0),this.setParentVisible(!0),this.fireEvent("ready"),this.ready=!0,!1===this.updateTask&&this.ready)){var a=this;this.updateTask=!0;requestAnimationFrame(function(){a.update()});navigator.iOs&&new Core.DelayedTask({delay:0.5,scope:this,callback:this.update})}},onMessage:function(a){parent===a.source&&(a.preventDefault(),a.stopPropagation(),a=JSON.parse(a.data),this.fireEvent("parentmessage",
a))},sendMessageToParent:function(a){parent.postMessage(a.serialize(),"*")},findFocusableDiv:function(a){if("tabIndex"in a&&0<=a.tabIndex)return a;if("childNodes"in a)for(var b=0;b<a.childNodes.length;b++){var c=this.findFocusableDiv(a.childNodes[b]);if(void 0!==c)return c}},enqueueDraw:function(a){a.drawNext=this.drawList;this.drawList=a;if(!1===this.updateTask&&this.ready){var b=this;this.updateTask=!0;requestAnimationFrame(function(){b.update()})}}},{invalidateMeasure:function(){this.invalidateArrange();
this.measureValid=!1;if(!1===this.updateTask&&this.ready){var a=this;this.updateTask=!0;requestAnimationFrame(function(){a.update()})}},invalidateArrange:function(){this.arrangeValid=!1;if(!1===this.updateTask&&this.ready){var a=this;this.updateTask=!0;requestAnimationFrame(function(){a.update()})}},setContent:function(a){a=Ui.Element.create(a);this.content!==a&&(void 0!==this.content&&this.contentBox.remove(this.content),void 0!==a&&this.contentBox.prepend(a,!0),this.content=a)}},{current:void 0,
getWindowIFrame:function(a){void 0===a&&(a=window);var b=void 0;if(a.parent!==a)try{for(var c=a.parent.document.getElementsByTagName("IFRAME"),d=0;d<c.length;d++)if(c[d].contentWindow===a){b=c[d];break}}catch(e){}return b},getRootWindow:function(){for(var a=window;a.parent!=a;)a=a.parent;return a}});Core.Object.extend("Ui.Styles",{},{},{"default":{"Ui.Label":{fontSize:16,color:"#000000"},"Ui.Button":{spacing:8,color:"#e4e4e4",focusColor:"#f6caa2"},"Ui.ToggleButton":{spacing:8,color:"#e4e4e4",focusColor:"#f6caa2",toggleColor:"#dc6c36"},"Ui.Combo":{spacing:8,color:"#e4e4e4",focusColor:"#f6caa2"},"Ui.SegmentBar":{spacing:8},"Ui.Locator":{spacing:10,color:"#e4e4e4",focusColor:"#f6caa2"},"Ui.ScrollingArea":{color:"#999999",showScrollbar:!1,overScroll:!0,radius:0},"Ui.LinkButton":{spacing:8,color:"#a4f4f4",
focusColor:"#f6caa2"},"Ui.DownloadButton":{spacing:8,color:"#a4f4a4",focusColor:"#f6caa2"},"Ui.UploadButton":{spacing:8,color:"#f4a4a4",focusColor:"#f6caa2"},"Ui.Separator":{color:"#000000"},"Ui.VirtualKeyboardKey":{radius:3,color:new Ui.Color({r:0.9,g:0.9,b:0.9}),focusColor:new Ui.Color({r:0.9,g:0.9,b:0.9})}}});Ui.LBox.extend("Form.Field",{label:void 0,labelBox:void 0,requireStar:void 0,require:!1,description:void 0,validation:void 0,defaultValue:void 0,fieldBox:void 0,contentBox:void 0,labelAlign:void 0,error:void 0,background:void 0,uiElt:void 0,uiEltType:Ui.Element,constructor:function(a){this.addEvents("change");this.setWidth(200);this.labelAlign=this.getStyleProperty("labelAlign");a="top"===this.labelAlign?Ui.VBox:Ui.HBox;var b="right"===this.labelAlign?"right":"left";this.setMargin(2);this.setContent([{type:Ui.Rectangle,
name:"background",opacity:0,fill:"pink",radius:8},{type:a,margin:5,name:"contentBox",content:[{type:Ui.HBox,name:"labelBox",spacing:2,horizontalAlign:b,verticalAlign:"top",content:[{type:Ui.Label,name:"label"}]},{type:Ui.VBox,name:"fieldBox",content:[{type:Ui.Text,name:"description",textAlign:"left",color:"#444444"},{type:Ui.Text,name:"error",color:"#bf1010",textAlign:"left",fontWeight:"bold"}]}]}])},setLabelAlign:function(a){this.labelAlign!==a&&(this.labelAlign=a,this.contentBox.clear(),this.remove(this.contentBox),
a="right"===this.labelAlign?"right":"left",this.contentBox=new ("top"===this.labelAlign?Ui.VBox:Ui.HBox)({content:[this.labelBox,this.fieldBox]}),this.labelBox.setHorizontalAlign(a),this.append(this.contentBox))},setUiElementType:function(a){this.uiEltType=a;this.setUiElement({})},setLabel:function(a){this.label.setText(a)},setRequire:function(a){(this.require=a)?(this.requireStar=new Ui.Label({text:"*",color:"#bf1010",fontWeight:"bold"}),this.labelBox.append(this.requireStar)):null!=this.requireStar&&
this.labelBox.hasChild(this.requireStar)&&this.labelBox.remove(this.requireStar)},isRequire:function(){return this.require},setDescription:function(a){this.description.setText(a)},setValidation:function(a){this.validation=a},getValidation:function(){return this.validation},setDefaultValue:function(a){this.defaultValue=a;this.setValue(this.defaultValue)},getError:function(){return this.error.getText()},setError:function(a){""!==a?this.background.setOpacity(1):this.background.setOpacity(0);this.error.setText(a)},
validate:function(){this.setError("")},setRequireError:function(){this.setError("Champs obligatoire")},getValue:function(){return void 0!==this.uiElt?this.uiElt.getValue():void 0},setValue:function(a){void 0!==this.uiElt&&this.uiElt.setValue(a)},setUiElement:function(a){void 0!==this.uiElt&&this.fieldBox.remove(this.uiElt);this.uiElt=this.uiEltType.create(a);this.fieldBox.prepend(this.uiElt)},reset:function(){void 0!==this.defaultValue&&this.setValue(this.defaultValue)},isValid:function(){return!0},
onChange:function(){this.fireEvent("change",this)}},{},{style:{labelAlign:"top"}});
Form.Field.extend("Form.ComboField",{constructor:function(a){this.setUiElementType(Ui.Combo);"uiElement"in a||this.setUiElement({horizontalAlign:"left"});this.connect(this.uiElt,"change",this.onChange)}},{getValue:function(){return this.uiElt.getCurrent()},setValue:function(a){this.uiElt.setData(a)},setUiElement:function(a){a=Ui.Combo.create(a);a.setHorizontalAlign("left");Form.ComboField.base.setUiElement.call(this,a)},isValid:function(){if(this.isRequire()&&void 0===this.getValue())return this.setRequireError(),
!1;this.validate();return!0}});
Form.Field.extend("Form.TextField",{constructor:function(a){this.setUiElementType(Ui.TextField)}},{setUiElement:function(a){Form.TextField.base.setUiElement.call(this,a);null!=this.uiElt.entry&&(this.uiElt.entry.setFontSize(this.getStyleProperty("fontSize")),this.connect(this.uiElt,"change",this.onChange))},isValid:function(){var a=!0,b=null!=this.getValue()?this.getValue().trim():"",c=this.getValidation(),d=0===b.length?!0:!1;this.isRequire()&&d?(a=!1,this.setRequireError()):d||void 0===c||(c instanceof
RegExp?a=c.test(b):"function"===typeof c&&(a=c(b)),a||this.setError("Non valide"));a&&this.validate();return a},onChange:function(){Form.TextField.base.onChange.call(this);this.isValid()}},{style:{fontSize:14}});
Form.TextField.extend("Form.TextAreaField",{constructor:function(a){this.setUiElementType(Ui.TextAreaField)}},{setUiElement:function(a){Form.TextAreaField.base.setUiElement.call(this,a);null!=this.uiElt.textarea&&(this.uiElt.textarea.setFontSize(this.getStyleProperty("fontSize")),this.connect(this.uiElt.textarea,"change",this.onChange))}});Form.TextField.extend("Form.PasswordField",{},{setUiElement:function(a){Form.PasswordField.base.setUiElement.call(this,a);this.uiElt.setPasswordMode(!0)}});
Form.Field.extend("Form.DateField",{constructor:function(a){this.setUiElementType(Ui.DatePicker);"uiElement"in a||this.setUiElement({horizontalAlign:"left"})}},{getValue:function(){return this.uiElt.getSelectedDate()},setValue:function(a){this.uiElt.setSelectedDate(a)},setUiElement:function(a){Form.DateField.base.setUiElement.call(this,a);this.connect(this.uiElt,"change",this.onChange)},isValid:function(){if(this.isRequire()&&!this.uiElt.getIsValid())return this.setRequireError(),!1;this.validate();
return!0}});Form.Field.extend("Form.CheckBoxField",{constructor:function(){this.setUiElementType(Ui.CheckBox)}},{isValid:function(){if(this.isRequire()&&!this.getValue())return this.setRequireError(),!1;this.validate();return!0}});Form.Field.extend("Form.LabelField",{constructor:function(){this.setUiElementType(Ui.Label)}},{setUiElement:function(a){Form.LabelField.base.setUiElement.call(this,a);this.uiElt.setHorizontalAlign("left")},setValue:function(a){this.uiElt.setText(a)},getValue:function(){this.uiElt.getText()}});Form.Field.extend("Form.FieldContainer",{fields:void 0,constructor:function(a){this.setUiElementType(Ui.HBox)},setFields:function(a){this.fields={};for(var b in a){var c=this.fields[b]=Form.Field.create(a[b]);this.uiElt.append(c)}}},{setUiElement:function(a){Form.FieldContainer.base.setUiElement.call(this,a);this.fieldBox.moveChildAt(this.description,0);null!=this.fields&&this.setFields(this.fields);this.require&&this.setRequire(this.require)},setValue:function(a){if("object"===typeof a&&null!=this.uiElt)for(var b in a){var c=
this.fields[b];null!=c&&c.setValue(a[b])}},getValue:function(){var a={},b;for(b in this.fields){var c=this.fields[b];null!=c&&(a[b]=c.getValue())}return a},isValid:function(){for(var a=this.uiElt.getChildren(),b=0;b<a.length;b++)if(!a[b].isValid())return!1;return!0},setRequire:function(a){if(this.require=a)for(var b=this.uiElt.getChildren(),c=0;c<b.length;c++)b[c].setRequire(a)}});Ui.LBox.extend("Form.Panel",{title:void 0,description:void 0,requireFieldMsg:void 0,fields:void 0,layout:void 0,defaultLayout:!0,value:void 0,submitUrl:void 0,submitHandler:void 0,submitType:"ajax",constructor:function(a){this.addEvents("change","submit");this.setPadding(10);this.title=new Ui.Label({fontSize:18,horizontalAlign:"left"});this.description=new Ui.Text({textAlign:"left",marginBottom:10});this.requireFieldMsg=new Ui.HBox({spacing:2,marginBottom:5,content:[{type:Ui.Label,text:"*",color:"#bf1010",
fontWeight:"bold"},{type:Ui.Label,text:"Champs indispensables"}]});this.requireFieldMsg.hide(!0);"layout"in a&&(this.defaultLayout=!1)},reset:function(){for(var a in this.fields)this.fields[a].reset()},isValid:function(){var a=!0,b;for(b in this.fields)this.fields[b].isValid()||(a=!1);return a},getValue:function(){var a={},b;for(b in this.fields)a[b]=this.fields[b].getValue();for(var c in this.value)a[c]=this.value[c];return a},setValue:function(a){this.value=a;this.updateValue()},updateValue:function(){var a=
{};if(void 0!==this.value&&void 0!==this.fields){for(var b in this.value)if(b in this.fields){var c="set"+b.charAt(0).toUpperCase()+b.substr(1);c in this&&"function"===typeof this[c]?this[c].call(this,this.value[b]):this.fields[b].setValue(this.value[b])}else a[b]=this.value[b];this.value=a}},submit:function(){var a=this.isValid();if(void 0!==this.submitUrl&&a){var b=this.getValue();void 0!==this.submitHandler&&(b=this.submitHandler(b));if("ajax"===this.submitType)req=new Core.HttpRequest({url:this.submitUrl,
method:"POST",arguments:b}),this.connect(req,"done",this.onSubmitDone),req.send();else if("link"===this.submitType){var b=Core.Util.encodeURIQuery(b),c=this.submitUrl,d=-1===c.indexOf("?")?"?":"&";window.open(c+(d+b))}}return a},onSubmitDone:function(a){this.fireEvent("submit",a)},_buildDefaultLayout:function(a){var b=new Ui.VBox({content:[this.title,this.description,this.requireFieldMsg]});a&&this.requireFieldMsg.show();for(var c in this.fields)b.append(this.fields[c]);return b},getTitle:function(){return this.title.getText()},
setTitle:function(a){this.title.setText(a)},setDescription:function(a){this.description.setText(a)},setFields:function(a){var b=!1;this.fields={};for(var c in a){var d=this.fields[c]=Form.Field.create(a[c]);this.connect(d,"change",this.onChange);d.isRequire()&&(b=!0)}this.defaultLayout?(a=this._buildDefaultLayout(b),this.setLayout(a)):void 0!==this.layout&&void 0===this.content&&this.setLayout(this.layout);this.updateValue()},appendField:function(a,b){if(null==this.fields&&(this.fields={},this.defaultLayout)){var c=
this._buildDefaultLayout(!1);this.setLayout(c)}c=this.fields[a]=Form.Field.create(b);this.connect(c,"change",this.onChange);this.layout.append(c)},removeField:function(a){null!=this.fields&&(a=this.fields[a],null!=a&&this.layout.remove(a))},getField:function(a){return null!=this.fields?this.fields[a]:void 0},setLayout:function(a){this.layout=a;void 0!==this.fields&&this.setContent(a)},setSubmitUrl:function(a){"string"===typeof a&&(this.submitUrl=a)},getSubmitUrl:function(){return this.submitUrl},
setSubmitType:function(a){this.submitType=a},getSubmitType:function(){return this.submitType},setSubmitHandler:function(a){"function"===typeof a&&(this.submitHandler=a)},onChange:function(a){this.fireEvent("change",a)}});Ui.LBox.extend("Form.PanelContainer",{layout:void 0,layoutType:Ui.VBox,panels:void 0,constructor:function(a){},setLayoutType:function(a){this.layoutType=a;this._rebuildLayout()},setPanels:function(a){this.panels={};for(var b in a)this.panels[b]=Form.Panel.create(a[b]);this._rebuildLayout()},appendPanel:function(a,b){null==this.panels&&(this.panels={});var c=this.panels[a]=Form.Panel.create(b);this.layout.append(c)},removePanel:function(a){null!=this.panels&&(a=this.panels[a],null!=a&&this.layout.remove(a))},
getPanel:function(a){return null!=this.panels?this.panels[a]:void 0},setValue:function(a){if(null!=this.panels)for(var b in a){var c=this.panels[b];null!=c&&c.setValue(a[b])}},getValue:function(){var a={};if(null!=this.panels)for(var b in this.panels)a[b]=this.panels[b].getValue();return a},_rebuildLayout:function(){null!=this.layout&&this.layout.clear();if(null!=this.panels){this.layout=new this.layoutType;for(var a in this.panels)this.layout.append(this.panels[a]);this.append(this.layout)}}});Ui.Dialog.extend("Form.Dialog",{panel:void 0,formVbox:void 0,buttonBox:void 0,undoBtn:void 0,submitBtn:void 0,constructor:function(a){this.setFullScrolling(!0);this.setPreferedWidth(600);this.setPreferedHeight(600);this.undoBtn=new Ui.Button({text:"Annuler"});this.connect(this.undoBtn,"press",this.close);this.setCancelButton(this.undoBtn);this.submitBtn=new Ui.Button({text:"Valider"});this.connect(this.submitBtn,"press",this.onSubmit);this.setActionButtons([this.submitBtn])},setPanel:function(a){this.panel=
Form.Panel.create(a);this.setTitle(this.panel.getTitle());this.setContent(this.panel)},setUndoText:function(a){this.undoBtn.setText(a)},setSubmitText:function(a){this.submitBtn.setText(a)},onSubmit:function(){this.panel.submit();this.hide()}});
